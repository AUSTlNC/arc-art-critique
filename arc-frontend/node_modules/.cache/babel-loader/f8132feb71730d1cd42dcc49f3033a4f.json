{"ast":null,"code":"/*!\n * FilePond 4.30.3\n * Licensed under MIT, https://opensource.org/licenses/MIT/\n * Please visit https://pqina.nl/filepond/ for details.\n */\n\n/* eslint-disable */\n(function (global, factory) {\n  typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports) : typeof define === 'function' && define.amd ? define(['exports'], factory) : (global = global || self, factory(global.FilePond = {}));\n})(this, function (exports) {\n  'use strict';\n\n  var isNode = function isNode(value) {\n    return value instanceof HTMLElement;\n  };\n\n  var createStore = function createStore(initialState) {\n    var queries = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];\n    var actions = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : []; // internal state\n\n    var state = Object.assign({}, initialState); // contains all actions for next frame, is clear when actions are requested\n\n    var actionQueue = [];\n    var dispatchQueue = []; // returns a duplicate of the current state\n\n    var getState = function getState() {\n      return Object.assign({}, state);\n    }; // returns a duplicate of the actions array and clears the actions array\n\n\n    var processActionQueue = function processActionQueue() {\n      // create copy of actions queue\n      var queue = [].concat(actionQueue); // clear actions queue (we don't want no double actions)\n\n      actionQueue.length = 0;\n      return queue;\n    }; // processes actions that might block the main UI thread\n\n\n    var processDispatchQueue = function processDispatchQueue() {\n      // create copy of actions queue\n      var queue = [].concat(dispatchQueue); // clear actions queue (we don't want no double actions)\n\n      dispatchQueue.length = 0; // now dispatch these actions\n\n      queue.forEach(function (_ref) {\n        var type = _ref.type,\n            data = _ref.data;\n        dispatch(type, data);\n      });\n    }; // adds a new action, calls its handler and\n\n\n    var dispatch = function dispatch(type, data, isBlocking) {\n      // is blocking action (should never block if document is hidden)\n      if (isBlocking && !document.hidden) {\n        dispatchQueue.push({\n          type: type,\n          data: data\n        });\n        return;\n      } // if this action has a handler, handle the action\n\n\n      if (actionHandlers[type]) {\n        actionHandlers[type](data);\n      } // now add action\n\n\n      actionQueue.push({\n        type: type,\n        data: data\n      });\n    };\n\n    var query = function query(str) {\n      var _queryHandles;\n\n      for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n        args[_key - 1] = arguments[_key];\n      }\n\n      return queryHandles[str] ? (_queryHandles = queryHandles)[str].apply(_queryHandles, args) : null;\n    };\n\n    var api = {\n      getState: getState,\n      processActionQueue: processActionQueue,\n      processDispatchQueue: processDispatchQueue,\n      dispatch: dispatch,\n      query: query\n    };\n    var queryHandles = {};\n    queries.forEach(function (query) {\n      queryHandles = Object.assign({}, query(state), {}, queryHandles);\n    });\n    var actionHandlers = {};\n    actions.forEach(function (action) {\n      actionHandlers = Object.assign({}, action(dispatch, query, state), {}, actionHandlers);\n    });\n    return api;\n  };\n\n  var defineProperty = function defineProperty(obj, property, definition) {\n    if (typeof definition === 'function') {\n      obj[property] = definition;\n      return;\n    }\n\n    Object.defineProperty(obj, property, Object.assign({}, definition));\n  };\n\n  var forin = function forin(obj, cb) {\n    for (var key in obj) {\n      if (!obj.hasOwnProperty(key)) {\n        continue;\n      }\n\n      cb(key, obj[key]);\n    }\n  };\n\n  var createObject = function createObject(definition) {\n    var obj = {};\n    forin(definition, function (property) {\n      defineProperty(obj, property, definition[property]);\n    });\n    return obj;\n  };\n\n  var attr = function attr(node, name) {\n    var value = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;\n\n    if (value === null) {\n      return node.getAttribute(name) || node.hasAttribute(name);\n    }\n\n    node.setAttribute(name, value);\n  };\n\n  var ns = 'http://www.w3.org/2000/svg';\n  var svgElements = ['svg', 'path']; // only svg elements used\n\n  var isSVGElement = function isSVGElement(tag) {\n    return svgElements.includes(tag);\n  };\n\n  var createElement = function createElement(tag, className) {\n    var attributes = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n\n    if (typeof className === 'object') {\n      attributes = className;\n      className = null;\n    }\n\n    var element = isSVGElement(tag) ? document.createElementNS(ns, tag) : document.createElement(tag);\n\n    if (className) {\n      if (isSVGElement(tag)) {\n        attr(element, 'class', className);\n      } else {\n        element.className = className;\n      }\n    }\n\n    forin(attributes, function (name, value) {\n      attr(element, name, value);\n    });\n    return element;\n  };\n\n  var appendChild = function appendChild(parent) {\n    return function (child, index) {\n      if (typeof index !== 'undefined' && parent.children[index]) {\n        parent.insertBefore(child, parent.children[index]);\n      } else {\n        parent.appendChild(child);\n      }\n    };\n  };\n\n  var appendChildView = function appendChildView(parent, childViews) {\n    return function (view, index) {\n      if (typeof index !== 'undefined') {\n        childViews.splice(index, 0, view);\n      } else {\n        childViews.push(view);\n      }\n\n      return view;\n    };\n  };\n\n  var removeChildView = function removeChildView(parent, childViews) {\n    return function (view) {\n      // remove from child views\n      childViews.splice(childViews.indexOf(view), 1); // remove the element\n\n      if (view.element.parentNode) {\n        parent.removeChild(view.element);\n      }\n\n      return view;\n    };\n  };\n\n  var IS_BROWSER = function () {\n    return typeof window !== 'undefined' && typeof window.document !== 'undefined';\n  }();\n\n  var isBrowser = function isBrowser() {\n    return IS_BROWSER;\n  };\n\n  var testElement = isBrowser() ? createElement('svg') : {};\n  var getChildCount = 'children' in testElement ? function (el) {\n    return el.children.length;\n  } : function (el) {\n    return el.childNodes.length;\n  };\n\n  var getViewRect = function getViewRect(elementRect, childViews, offset, scale) {\n    var left = offset[0] || elementRect.left;\n    var top = offset[1] || elementRect.top;\n    var right = left + elementRect.width;\n    var bottom = top + elementRect.height * (scale[1] || 1);\n    var rect = {\n      // the rectangle of the element itself\n      element: Object.assign({}, elementRect),\n      // the rectangle of the element expanded to contain its children, does not include any margins\n      inner: {\n        left: elementRect.left,\n        top: elementRect.top,\n        right: elementRect.right,\n        bottom: elementRect.bottom\n      },\n      // the rectangle of the element expanded to contain its children including own margin and child margins\n      // margins will be added after we've recalculated the size\n      outer: {\n        left: left,\n        top: top,\n        right: right,\n        bottom: bottom\n      }\n    }; // expand rect to fit all child rectangles\n\n    childViews.filter(function (childView) {\n      return !childView.isRectIgnored();\n    }).map(function (childView) {\n      return childView.rect;\n    }).forEach(function (childViewRect) {\n      expandRect(rect.inner, Object.assign({}, childViewRect.inner));\n      expandRect(rect.outer, Object.assign({}, childViewRect.outer));\n    }); // calculate inner width and height\n\n    calculateRectSize(rect.inner); // append additional margin (top and left margins are included in top and left automatically)\n\n    rect.outer.bottom += rect.element.marginBottom;\n    rect.outer.right += rect.element.marginRight; // calculate outer width and height\n\n    calculateRectSize(rect.outer);\n    return rect;\n  };\n\n  var expandRect = function expandRect(parent, child) {\n    // adjust for parent offset\n    child.top += parent.top;\n    child.right += parent.left;\n    child.bottom += parent.top;\n    child.left += parent.left;\n\n    if (child.bottom > parent.bottom) {\n      parent.bottom = child.bottom;\n    }\n\n    if (child.right > parent.right) {\n      parent.right = child.right;\n    }\n  };\n\n  var calculateRectSize = function calculateRectSize(rect) {\n    rect.width = rect.right - rect.left;\n    rect.height = rect.bottom - rect.top;\n  };\n\n  var isNumber = function isNumber(value) {\n    return typeof value === 'number';\n  };\n  /**\n   * Determines if position is at destination\n   * @param position\n   * @param destination\n   * @param velocity\n   * @param errorMargin\n   * @returns {boolean}\n   */\n\n\n  var thereYet = function thereYet(position, destination, velocity) {\n    var errorMargin = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 0.001;\n    return Math.abs(position - destination) < errorMargin && Math.abs(velocity) < errorMargin;\n  };\n  /**\n   * Spring animation\n   */\n\n\n  var spring = // default options\n  function spring() // method definition\n  {\n    var _ref = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {},\n        _ref$stiffness = _ref.stiffness,\n        stiffness = _ref$stiffness === void 0 ? 0.5 : _ref$stiffness,\n        _ref$damping = _ref.damping,\n        damping = _ref$damping === void 0 ? 0.75 : _ref$damping,\n        _ref$mass = _ref.mass,\n        mass = _ref$mass === void 0 ? 10 : _ref$mass;\n\n    var target = null;\n    var position = null;\n    var velocity = 0;\n    var resting = false; // updates spring state\n\n    var interpolate = function interpolate(ts, skipToEndState) {\n      // in rest, don't animate\n      if (resting) return; // need at least a target or position to do springy things\n\n      if (!(isNumber(target) && isNumber(position))) {\n        resting = true;\n        velocity = 0;\n        return;\n      } // calculate spring force\n\n\n      var f = -(position - target) * stiffness; // update velocity by adding force based on mass\n\n      velocity += f / mass; // update position by adding velocity\n\n      position += velocity; // slow down based on amount of damping\n\n      velocity *= damping; // we've arrived if we're near target and our velocity is near zero\n\n      if (thereYet(position, target, velocity) || skipToEndState) {\n        position = target;\n        velocity = 0;\n        resting = true; // we done\n\n        api.onupdate(position);\n        api.oncomplete(position);\n      } else {\n        // progress update\n        api.onupdate(position);\n      }\n    };\n    /**\n     * Set new target value\n     * @param value\n     */\n\n\n    var setTarget = function setTarget(value) {\n      // if currently has no position, set target and position to this value\n      if (isNumber(value) && !isNumber(position)) {\n        position = value;\n      } // next target value will not be animated to\n\n\n      if (target === null) {\n        target = value;\n        position = value;\n      } // let start moving to target\n\n\n      target = value; // already at target\n\n      if (position === target || typeof target === 'undefined') {\n        // now resting as target is current position, stop moving\n        resting = true;\n        velocity = 0; // done!\n\n        api.onupdate(position);\n        api.oncomplete(position);\n        return;\n      }\n\n      resting = false;\n    }; // need 'api' to call onupdate callback\n\n\n    var api = createObject({\n      interpolate: interpolate,\n      target: {\n        set: setTarget,\n        get: function get() {\n          return target;\n        }\n      },\n      resting: {\n        get: function get() {\n          return resting;\n        }\n      },\n      onupdate: function onupdate(value) {},\n      oncomplete: function oncomplete(value) {}\n    });\n    return api;\n  };\n\n  var easeLinear = function easeLinear(t) {\n    return t;\n  };\n\n  var easeInOutQuad = function easeInOutQuad(t) {\n    return t < 0.5 ? 2 * t * t : -1 + (4 - 2 * t) * t;\n  };\n\n  var tween = // default values\n  function tween() // method definition\n  {\n    var _ref = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {},\n        _ref$duration = _ref.duration,\n        duration = _ref$duration === void 0 ? 500 : _ref$duration,\n        _ref$easing = _ref.easing,\n        easing = _ref$easing === void 0 ? easeInOutQuad : _ref$easing,\n        _ref$delay = _ref.delay,\n        delay = _ref$delay === void 0 ? 0 : _ref$delay;\n\n    var start = null;\n    var t;\n    var p;\n    var resting = true;\n    var reverse = false;\n    var target = null;\n\n    var interpolate = function interpolate(ts, skipToEndState) {\n      if (resting || target === null) return;\n\n      if (start === null) {\n        start = ts;\n      }\n\n      if (ts - start < delay) return;\n      t = ts - start - delay;\n\n      if (t >= duration || skipToEndState) {\n        t = 1;\n        p = reverse ? 0 : 1;\n        api.onupdate(p * target);\n        api.oncomplete(p * target);\n        resting = true;\n      } else {\n        p = t / duration;\n        api.onupdate((t >= 0 ? easing(reverse ? 1 - p : p) : 0) * target);\n      }\n    }; // need 'api' to call onupdate callback\n\n\n    var api = createObject({\n      interpolate: interpolate,\n      target: {\n        get: function get() {\n          return reverse ? 0 : target;\n        },\n        set: function set(value) {\n          // is initial value\n          if (target === null) {\n            target = value;\n            api.onupdate(value);\n            api.oncomplete(value);\n            return;\n          } // want to tween to a smaller value and have a current value\n\n\n          if (value < target) {\n            target = 1;\n            reverse = true;\n          } else {\n            // not tweening to a smaller value\n            reverse = false;\n            target = value;\n          } // let's go!\n\n\n          resting = false;\n          start = null;\n        }\n      },\n      resting: {\n        get: function get() {\n          return resting;\n        }\n      },\n      onupdate: function onupdate(value) {},\n      oncomplete: function oncomplete(value) {}\n    });\n    return api;\n  };\n\n  var animator = {\n    spring: spring,\n    tween: tween\n  };\n  /*\n                     { type: 'spring', stiffness: .5, damping: .75, mass: 10 };\n                     { translation: { type: 'spring', ... }, ... }\n                     { translation: { x: { type: 'spring', ... } } }\n                    */\n\n  var createAnimator = function createAnimator(definition, category, property) {\n    // default is single definition\n    // we check if transform is set, if so, we check if property is set\n    var def = definition[category] && typeof definition[category][property] === 'object' ? definition[category][property] : definition[category] || definition;\n    var type = typeof def === 'string' ? def : def.type;\n    var props = typeof def === 'object' ? Object.assign({}, def) : {};\n    return animator[type] ? animator[type](props) : null;\n  };\n\n  var addGetSet = function addGetSet(keys, obj, props) {\n    var overwrite = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : false;\n    obj = Array.isArray(obj) ? obj : [obj];\n    obj.forEach(function (o) {\n      keys.forEach(function (key) {\n        var name = key;\n\n        var getter = function getter() {\n          return props[key];\n        };\n\n        var setter = function setter(value) {\n          return props[key] = value;\n        };\n\n        if (typeof key === 'object') {\n          name = key.key;\n          getter = key.getter || getter;\n          setter = key.setter || setter;\n        }\n\n        if (o[name] && !overwrite) {\n          return;\n        }\n\n        o[name] = {\n          get: getter,\n          set: setter\n        };\n      });\n    });\n  }; // add to state,\n  // add getters and setters to internal and external api (if not set)\n  // setup animators\n\n\n  var animations = function animations(_ref) {\n    var mixinConfig = _ref.mixinConfig,\n        viewProps = _ref.viewProps,\n        viewInternalAPI = _ref.viewInternalAPI,\n        viewExternalAPI = _ref.viewExternalAPI; // initial properties\n\n    var initialProps = Object.assign({}, viewProps); // list of all active animations\n\n    var animations = []; // setup animators\n\n    forin(mixinConfig, function (property, animation) {\n      var animator = createAnimator(animation);\n\n      if (!animator) {\n        return;\n      } // when the animator updates, update the view state value\n\n\n      animator.onupdate = function (value) {\n        viewProps[property] = value;\n      }; // set animator target\n\n\n      animator.target = initialProps[property]; // when value is set, set the animator target value\n\n      var prop = {\n        key: property,\n        setter: function setter(value) {\n          // if already at target, we done!\n          if (animator.target === value) {\n            return;\n          }\n\n          animator.target = value;\n        },\n        getter: function getter() {\n          return viewProps[property];\n        }\n      }; // add getters and setters\n\n      addGetSet([prop], [viewInternalAPI, viewExternalAPI], viewProps, true); // add it to the list for easy updating from the _write method\n\n      animations.push(animator);\n    }); // expose internal write api\n\n    return {\n      write: function write(ts) {\n        var skipToEndState = document.hidden;\n        var resting = true;\n        animations.forEach(function (animation) {\n          if (!animation.resting) resting = false;\n          animation.interpolate(ts, skipToEndState);\n        });\n        return resting;\n      },\n      destroy: function destroy() {}\n    };\n  };\n\n  var addEvent = function addEvent(element) {\n    return function (type, fn) {\n      element.addEventListener(type, fn);\n    };\n  };\n\n  var removeEvent = function removeEvent(element) {\n    return function (type, fn) {\n      element.removeEventListener(type, fn);\n    };\n  }; // mixin\n\n\n  var listeners = function listeners(_ref) {\n    var mixinConfig = _ref.mixinConfig,\n        viewProps = _ref.viewProps,\n        viewInternalAPI = _ref.viewInternalAPI,\n        viewExternalAPI = _ref.viewExternalAPI,\n        viewState = _ref.viewState,\n        view = _ref.view;\n    var events = [];\n    var add = addEvent(view.element);\n    var remove = removeEvent(view.element);\n\n    viewExternalAPI.on = function (type, fn) {\n      events.push({\n        type: type,\n        fn: fn\n      });\n      add(type, fn);\n    };\n\n    viewExternalAPI.off = function (type, fn) {\n      events.splice(events.findIndex(function (event) {\n        return event.type === type && event.fn === fn;\n      }), 1);\n      remove(type, fn);\n    };\n\n    return {\n      write: function write() {\n        // not busy\n        return true;\n      },\n      destroy: function destroy() {\n        events.forEach(function (event) {\n          remove(event.type, event.fn);\n        });\n      }\n    };\n  }; // add to external api and link to props\n\n\n  var apis = function apis(_ref) {\n    var mixinConfig = _ref.mixinConfig,\n        viewProps = _ref.viewProps,\n        viewExternalAPI = _ref.viewExternalAPI;\n    addGetSet(mixinConfig, viewExternalAPI, viewProps);\n  };\n\n  var isDefined = function isDefined(value) {\n    return value != null;\n  }; // add to state,\n  // add getters and setters to internal and external api (if not set)\n  // set initial state based on props in viewProps\n  // apply as transforms each frame\n\n\n  var defaults = {\n    opacity: 1,\n    scaleX: 1,\n    scaleY: 1,\n    translateX: 0,\n    translateY: 0,\n    rotateX: 0,\n    rotateY: 0,\n    rotateZ: 0,\n    originX: 0,\n    originY: 0\n  };\n\n  var styles = function styles(_ref) {\n    var mixinConfig = _ref.mixinConfig,\n        viewProps = _ref.viewProps,\n        viewInternalAPI = _ref.viewInternalAPI,\n        viewExternalAPI = _ref.viewExternalAPI,\n        view = _ref.view; // initial props\n\n    var initialProps = Object.assign({}, viewProps); // current props\n\n    var currentProps = {}; // we will add those properties to the external API and link them to the viewState\n\n    addGetSet(mixinConfig, [viewInternalAPI, viewExternalAPI], viewProps); // override rect on internal and external rect getter so it takes in account transforms\n\n    var getOffset = function getOffset() {\n      return [viewProps['translateX'] || 0, viewProps['translateY'] || 0];\n    };\n\n    var getScale = function getScale() {\n      return [viewProps['scaleX'] || 0, viewProps['scaleY'] || 0];\n    };\n\n    var getRect = function getRect() {\n      return view.rect ? getViewRect(view.rect, view.childViews, getOffset(), getScale()) : null;\n    };\n\n    viewInternalAPI.rect = {\n      get: getRect\n    };\n    viewExternalAPI.rect = {\n      get: getRect\n    }; // apply view props\n\n    mixinConfig.forEach(function (key) {\n      viewProps[key] = typeof initialProps[key] === 'undefined' ? defaults[key] : initialProps[key];\n    }); // expose api\n\n    return {\n      write: function write() {\n        // see if props have changed\n        if (!propsHaveChanged(currentProps, viewProps)) {\n          return;\n        } // moves element to correct position on screen\n\n\n        applyStyles(view.element, viewProps); // store new transforms\n\n        Object.assign(currentProps, Object.assign({}, viewProps)); // no longer busy\n\n        return true;\n      },\n      destroy: function destroy() {}\n    };\n  };\n\n  var propsHaveChanged = function propsHaveChanged(currentProps, newProps) {\n    // different amount of keys\n    if (Object.keys(currentProps).length !== Object.keys(newProps).length) {\n      return true;\n    } // lets analyze the individual props\n\n\n    for (var prop in newProps) {\n      if (newProps[prop] !== currentProps[prop]) {\n        return true;\n      }\n    }\n\n    return false;\n  };\n\n  var applyStyles = function applyStyles(element, _ref2) {\n    var opacity = _ref2.opacity,\n        perspective = _ref2.perspective,\n        translateX = _ref2.translateX,\n        translateY = _ref2.translateY,\n        scaleX = _ref2.scaleX,\n        scaleY = _ref2.scaleY,\n        rotateX = _ref2.rotateX,\n        rotateY = _ref2.rotateY,\n        rotateZ = _ref2.rotateZ,\n        originX = _ref2.originX,\n        originY = _ref2.originY,\n        width = _ref2.width,\n        height = _ref2.height;\n    var transforms = '';\n    var styles = ''; // handle transform origin\n\n    if (isDefined(originX) || isDefined(originY)) {\n      styles += 'transform-origin: ' + (originX || 0) + 'px ' + (originY || 0) + 'px;';\n    } // transform order is relevant\n    // 0. perspective\n\n\n    if (isDefined(perspective)) {\n      transforms += 'perspective(' + perspective + 'px) ';\n    } // 1. translate\n\n\n    if (isDefined(translateX) || isDefined(translateY)) {\n      transforms += 'translate3d(' + (translateX || 0) + 'px, ' + (translateY || 0) + 'px, 0) ';\n    } // 2. scale\n\n\n    if (isDefined(scaleX) || isDefined(scaleY)) {\n      transforms += 'scale3d(' + (isDefined(scaleX) ? scaleX : 1) + ', ' + (isDefined(scaleY) ? scaleY : 1) + ', 1) ';\n    } // 3. rotate\n\n\n    if (isDefined(rotateZ)) {\n      transforms += 'rotateZ(' + rotateZ + 'rad) ';\n    }\n\n    if (isDefined(rotateX)) {\n      transforms += 'rotateX(' + rotateX + 'rad) ';\n    }\n\n    if (isDefined(rotateY)) {\n      transforms += 'rotateY(' + rotateY + 'rad) ';\n    } // add transforms\n\n\n    if (transforms.length) {\n      styles += 'transform:' + transforms + ';';\n    } // add opacity\n\n\n    if (isDefined(opacity)) {\n      styles += 'opacity:' + opacity + ';'; // if we reach zero, we make the element inaccessible\n\n      if (opacity === 0) {\n        styles += 'visibility:hidden;';\n      } // if we're below 100% opacity this element can't be clicked\n\n\n      if (opacity < 1) {\n        styles += 'pointer-events:none;';\n      }\n    } // add height\n\n\n    if (isDefined(height)) {\n      styles += 'height:' + height + 'px;';\n    } // add width\n\n\n    if (isDefined(width)) {\n      styles += 'width:' + width + 'px;';\n    } // apply styles\n\n\n    var elementCurrentStyle = element.elementCurrentStyle || ''; // if new styles does not match current styles, lets update!\n\n    if (styles.length !== elementCurrentStyle.length || styles !== elementCurrentStyle) {\n      element.style.cssText = styles; // store current styles so we can compare them to new styles later on\n      // _not_ getting the style value is faster\n\n      element.elementCurrentStyle = styles;\n    }\n  };\n\n  var Mixins = {\n    styles: styles,\n    listeners: listeners,\n    animations: animations,\n    apis: apis\n  };\n\n  var updateRect = function updateRect() {\n    var rect = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    var element = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    var style = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n\n    if (!element.layoutCalculated) {\n      rect.paddingTop = parseInt(style.paddingTop, 10) || 0;\n      rect.marginTop = parseInt(style.marginTop, 10) || 0;\n      rect.marginRight = parseInt(style.marginRight, 10) || 0;\n      rect.marginBottom = parseInt(style.marginBottom, 10) || 0;\n      rect.marginLeft = parseInt(style.marginLeft, 10) || 0;\n      element.layoutCalculated = true;\n    }\n\n    rect.left = element.offsetLeft || 0;\n    rect.top = element.offsetTop || 0;\n    rect.width = element.offsetWidth || 0;\n    rect.height = element.offsetHeight || 0;\n    rect.right = rect.left + rect.width;\n    rect.bottom = rect.top + rect.height;\n    rect.scrollTop = element.scrollTop;\n    rect.hidden = element.offsetParent === null;\n    return rect;\n  };\n\n  var createView = // default view definition\n  function createView() {\n    var _ref = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {},\n        _ref$tag = _ref.tag,\n        tag = _ref$tag === void 0 ? 'div' : _ref$tag,\n        _ref$name = _ref.name,\n        name = _ref$name === void 0 ? null : _ref$name,\n        _ref$attributes = _ref.attributes,\n        attributes = _ref$attributes === void 0 ? {} : _ref$attributes,\n        _ref$read = _ref.read,\n        read = _ref$read === void 0 ? function () {} : _ref$read,\n        _ref$write = _ref.write,\n        write = _ref$write === void 0 ? function () {} : _ref$write,\n        _ref$create = _ref.create,\n        create = _ref$create === void 0 ? function () {} : _ref$create,\n        _ref$destroy = _ref.destroy,\n        destroy = _ref$destroy === void 0 ? function () {} : _ref$destroy,\n        _ref$filterFrameActio = _ref.filterFrameActionsForChild,\n        filterFrameActionsForChild = _ref$filterFrameActio === void 0 ? function (child, actions) {\n      return actions;\n    } : _ref$filterFrameActio,\n        _ref$didCreateView = _ref.didCreateView,\n        didCreateView = _ref$didCreateView === void 0 ? function () {} : _ref$didCreateView,\n        _ref$didWriteView = _ref.didWriteView,\n        didWriteView = _ref$didWriteView === void 0 ? function () {} : _ref$didWriteView,\n        _ref$ignoreRect = _ref.ignoreRect,\n        ignoreRect = _ref$ignoreRect === void 0 ? false : _ref$ignoreRect,\n        _ref$ignoreRectUpdate = _ref.ignoreRectUpdate,\n        ignoreRectUpdate = _ref$ignoreRectUpdate === void 0 ? false : _ref$ignoreRectUpdate,\n        _ref$mixins = _ref.mixins,\n        mixins = _ref$mixins === void 0 ? [] : _ref$mixins;\n\n    return function ( // each view requires reference to store\n    store) {\n      var props = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {}; // root element should not be changed\n\n      var element = createElement(tag, 'filepond--' + name, attributes); // style reference should also not be changed\n\n      var style = window.getComputedStyle(element, null); // element rectangle\n\n      var rect = updateRect();\n      var frameRect = null; // rest state\n\n      var isResting = false; // pretty self explanatory\n\n      var childViews = []; // loaded mixins\n\n      var activeMixins = []; // references to created children\n\n      var ref = {}; // state used for each instance\n\n      var state = {}; // list of writers that will be called to update this view\n\n      var writers = [write // default writer\n      ];\n      var readers = [read // default reader\n      ];\n      var destroyers = [destroy // default destroy\n      ]; // core view methods\n\n      var getElement = function getElement() {\n        return element;\n      };\n\n      var getChildViews = function getChildViews() {\n        return childViews.concat();\n      };\n\n      var getReference = function getReference() {\n        return ref;\n      };\n\n      var createChildView = function createChildView(store) {\n        return function (view, props) {\n          return view(store, props);\n        };\n      };\n\n      var getRect = function getRect() {\n        if (frameRect) {\n          return frameRect;\n        }\n\n        frameRect = getViewRect(rect, childViews, [0, 0], [1, 1]);\n        return frameRect;\n      };\n\n      var getStyle = function getStyle() {\n        return style;\n      };\n      /**\n       * Read data from DOM\n       * @private\n       */\n\n\n      var _read = function _read() {\n        frameRect = null; // read child views\n\n        childViews.forEach(function (child) {\n          return child._read();\n        });\n        var shouldUpdate = !(ignoreRectUpdate && rect.width && rect.height);\n\n        if (shouldUpdate) {\n          updateRect(rect, element, style);\n        } // readers\n\n\n        var api = {\n          root: internalAPI,\n          props: props,\n          rect: rect\n        };\n        readers.forEach(function (reader) {\n          return reader(api);\n        });\n      };\n      /**\n       * Write data to DOM\n       * @private\n       */\n\n\n      var _write = function _write(ts, frameActions, shouldOptimize) {\n        // if no actions, we assume that the view is resting\n        var resting = frameActions.length === 0; // writers\n\n        writers.forEach(function (writer) {\n          var writerResting = writer({\n            props: props,\n            root: internalAPI,\n            actions: frameActions,\n            timestamp: ts,\n            shouldOptimize: shouldOptimize\n          });\n\n          if (writerResting === false) {\n            resting = false;\n          }\n        }); // run mixins\n\n        activeMixins.forEach(function (mixin) {\n          // if one of the mixins is still busy after write operation, we are not resting\n          var mixinResting = mixin.write(ts);\n\n          if (mixinResting === false) {\n            resting = false;\n          }\n        }); // updates child views that are currently attached to the DOM\n\n        childViews.filter(function (child) {\n          return !!child.element.parentNode;\n        }).forEach(function (child) {\n          // if a child view is not resting, we are not resting\n          var childResting = child._write(ts, filterFrameActionsForChild(child, frameActions), shouldOptimize);\n\n          if (!childResting) {\n            resting = false;\n          }\n        }); // append new elements to DOM and update those\n\n        childViews //.filter(child => !child.element.parentNode)\n        .forEach(function (child, index) {\n          // skip\n          if (child.element.parentNode) {\n            return;\n          } // append to DOM\n\n\n          internalAPI.appendChild(child.element, index); // call read (need to know the size of these elements)\n\n          child._read(); // re-call write\n\n\n          child._write(ts, filterFrameActionsForChild(child, frameActions), shouldOptimize); // we just added somthing to the dom, no rest\n\n\n          resting = false;\n        }); // update resting state\n\n        isResting = resting;\n        didWriteView({\n          props: props,\n          root: internalAPI,\n          actions: frameActions,\n          timestamp: ts\n        }); // let parent know if we are resting\n\n        return resting;\n      };\n\n      var _destroy = function _destroy() {\n        activeMixins.forEach(function (mixin) {\n          return mixin.destroy();\n        });\n        destroyers.forEach(function (destroyer) {\n          destroyer({\n            root: internalAPI,\n            props: props\n          });\n        });\n        childViews.forEach(function (child) {\n          return child._destroy();\n        });\n      }; // sharedAPI\n\n\n      var sharedAPIDefinition = {\n        element: {\n          get: getElement\n        },\n        style: {\n          get: getStyle\n        },\n        childViews: {\n          get: getChildViews\n        }\n      }; // private API definition\n\n      var internalAPIDefinition = Object.assign({}, sharedAPIDefinition, {\n        rect: {\n          get: getRect\n        },\n        // access to custom children references\n        ref: {\n          get: getReference\n        },\n        // dom modifiers\n        is: function is(needle) {\n          return name === needle;\n        },\n        appendChild: appendChild(element),\n        createChildView: createChildView(store),\n        linkView: function linkView(view) {\n          childViews.push(view);\n          return view;\n        },\n        unlinkView: function unlinkView(view) {\n          childViews.splice(childViews.indexOf(view), 1);\n        },\n        appendChildView: appendChildView(element, childViews),\n        removeChildView: removeChildView(element, childViews),\n        registerWriter: function registerWriter(writer) {\n          return writers.push(writer);\n        },\n        registerReader: function registerReader(reader) {\n          return readers.push(reader);\n        },\n        registerDestroyer: function registerDestroyer(destroyer) {\n          return destroyers.push(destroyer);\n        },\n        invalidateLayout: function invalidateLayout() {\n          return element.layoutCalculated = false;\n        },\n        // access to data store\n        dispatch: store.dispatch,\n        query: store.query\n      }); // public view API methods\n\n      var externalAPIDefinition = {\n        element: {\n          get: getElement\n        },\n        childViews: {\n          get: getChildViews\n        },\n        rect: {\n          get: getRect\n        },\n        resting: {\n          get: function get() {\n            return isResting;\n          }\n        },\n        isRectIgnored: function isRectIgnored() {\n          return ignoreRect;\n        },\n        _read: _read,\n        _write: _write,\n        _destroy: _destroy\n      }; // mixin API methods\n\n      var mixinAPIDefinition = Object.assign({}, sharedAPIDefinition, {\n        rect: {\n          get: function get() {\n            return rect;\n          }\n        }\n      }); // add mixin functionality\n\n      Object.keys(mixins).sort(function (a, b) {\n        // move styles to the back of the mixin list (so adjustments of other mixins are applied to the props correctly)\n        if (a === 'styles') {\n          return 1;\n        } else if (b === 'styles') {\n          return -1;\n        }\n\n        return 0;\n      }).forEach(function (key) {\n        var mixinAPI = Mixins[key]({\n          mixinConfig: mixins[key],\n          viewProps: props,\n          viewState: state,\n          viewInternalAPI: internalAPIDefinition,\n          viewExternalAPI: externalAPIDefinition,\n          view: createObject(mixinAPIDefinition)\n        });\n\n        if (mixinAPI) {\n          activeMixins.push(mixinAPI);\n        }\n      }); // construct private api\n\n      var internalAPI = createObject(internalAPIDefinition); // create the view\n\n      create({\n        root: internalAPI,\n        props: props\n      }); // append created child views to root node\n\n      var childCount = getChildCount(element); // need to know the current child count so appending happens in correct order\n\n      childViews.forEach(function (child, index) {\n        internalAPI.appendChild(child.element, childCount + index);\n      }); // call did create\n\n      didCreateView(internalAPI); // expose public api\n\n      return createObject(externalAPIDefinition);\n    };\n  };\n\n  var createPainter = function createPainter(read, write) {\n    var fps = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 60;\n    var name = '__framePainter'; // set global painter\n\n    if (window[name]) {\n      window[name].readers.push(read);\n      window[name].writers.push(write);\n      return;\n    }\n\n    window[name] = {\n      readers: [read],\n      writers: [write]\n    };\n    var painter = window[name];\n    var interval = 1000 / fps;\n    var last = null;\n    var id = null;\n    var requestTick = null;\n    var cancelTick = null;\n\n    var setTimerType = function setTimerType() {\n      if (document.hidden) {\n        requestTick = function requestTick() {\n          return window.setTimeout(function () {\n            return tick(performance.now());\n          }, interval);\n        };\n\n        cancelTick = function cancelTick() {\n          return window.clearTimeout(id);\n        };\n      } else {\n        requestTick = function requestTick() {\n          return window.requestAnimationFrame(tick);\n        };\n\n        cancelTick = function cancelTick() {\n          return window.cancelAnimationFrame(id);\n        };\n      }\n    };\n\n    document.addEventListener('visibilitychange', function () {\n      if (cancelTick) cancelTick();\n      setTimerType();\n      tick(performance.now());\n    });\n\n    var tick = function tick(ts) {\n      // queue next tick\n      id = requestTick(tick); // limit fps\n\n      if (!last) {\n        last = ts;\n      }\n\n      var delta = ts - last;\n\n      if (delta <= interval) {\n        // skip frame\n        return;\n      } // align next frame\n\n\n      last = ts - delta % interval; // update view\n\n      painter.readers.forEach(function (read) {\n        return read();\n      });\n      painter.writers.forEach(function (write) {\n        return write(ts);\n      });\n    };\n\n    setTimerType();\n    tick(performance.now());\n    return {\n      pause: function pause() {\n        cancelTick(id);\n      }\n    };\n  };\n\n  var createRoute = function createRoute(routes, fn) {\n    return function (_ref) {\n      var root = _ref.root,\n          props = _ref.props,\n          _ref$actions = _ref.actions,\n          actions = _ref$actions === void 0 ? [] : _ref$actions,\n          timestamp = _ref.timestamp,\n          shouldOptimize = _ref.shouldOptimize;\n      actions.filter(function (action) {\n        return routes[action.type];\n      }).forEach(function (action) {\n        return routes[action.type]({\n          root: root,\n          props: props,\n          action: action.data,\n          timestamp: timestamp,\n          shouldOptimize: shouldOptimize\n        });\n      });\n\n      if (fn) {\n        fn({\n          root: root,\n          props: props,\n          actions: actions,\n          timestamp: timestamp,\n          shouldOptimize: shouldOptimize\n        });\n      }\n    };\n  };\n\n  var insertBefore = function insertBefore(newNode, referenceNode) {\n    return referenceNode.parentNode.insertBefore(newNode, referenceNode);\n  };\n\n  var insertAfter = function insertAfter(newNode, referenceNode) {\n    return referenceNode.parentNode.insertBefore(newNode, referenceNode.nextSibling);\n  };\n\n  var isArray = function isArray(value) {\n    return Array.isArray(value);\n  };\n\n  var isEmpty = function isEmpty(value) {\n    return value == null;\n  };\n\n  var trim = function trim(str) {\n    return str.trim();\n  };\n\n  var toString = function toString(value) {\n    return '' + value;\n  };\n\n  var toArray = function toArray(value) {\n    var splitter = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : ',';\n\n    if (isEmpty(value)) {\n      return [];\n    }\n\n    if (isArray(value)) {\n      return value;\n    }\n\n    return toString(value).split(splitter).map(trim).filter(function (str) {\n      return str.length;\n    });\n  };\n\n  var isBoolean = function isBoolean(value) {\n    return typeof value === 'boolean';\n  };\n\n  var toBoolean = function toBoolean(value) {\n    return isBoolean(value) ? value : value === 'true';\n  };\n\n  var isString = function isString(value) {\n    return typeof value === 'string';\n  };\n\n  var toNumber = function toNumber(value) {\n    return isNumber(value) ? value : isString(value) ? toString(value).replace(/[a-z]+/gi, '') : 0;\n  };\n\n  var toInt = function toInt(value) {\n    return parseInt(toNumber(value), 10);\n  };\n\n  var toFloat = function toFloat(value) {\n    return parseFloat(toNumber(value));\n  };\n\n  var isInt = function isInt(value) {\n    return isNumber(value) && isFinite(value) && Math.floor(value) === value;\n  };\n\n  var toBytes = function toBytes(value) {\n    var base = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 1000; // is in bytes\n\n    if (isInt(value)) {\n      return value;\n    } // is natural file size\n\n\n    var naturalFileSize = toString(value).trim(); // if is value in megabytes\n\n    if (/MB$/i.test(naturalFileSize)) {\n      naturalFileSize = naturalFileSize.replace(/MB$i/, '').trim();\n      return toInt(naturalFileSize) * base * base;\n    } // if is value in kilobytes\n\n\n    if (/KB/i.test(naturalFileSize)) {\n      naturalFileSize = naturalFileSize.replace(/KB$i/, '').trim();\n      return toInt(naturalFileSize) * base;\n    }\n\n    return toInt(naturalFileSize);\n  };\n\n  var isFunction = function isFunction(value) {\n    return typeof value === 'function';\n  };\n\n  var toFunctionReference = function toFunctionReference(string) {\n    var ref = self;\n    var levels = string.split('.');\n    var level = null;\n\n    while (level = levels.shift()) {\n      ref = ref[level];\n\n      if (!ref) {\n        return null;\n      }\n    }\n\n    return ref;\n  };\n\n  var methods = {\n    process: 'POST',\n    patch: 'PATCH',\n    revert: 'DELETE',\n    fetch: 'GET',\n    restore: 'GET',\n    load: 'GET'\n  };\n\n  var createServerAPI = function createServerAPI(outline) {\n    var api = {};\n    api.url = isString(outline) ? outline : outline.url || '';\n    api.timeout = outline.timeout ? parseInt(outline.timeout, 10) : 0;\n    api.headers = outline.headers ? outline.headers : {};\n    forin(methods, function (key) {\n      api[key] = createAction(key, outline[key], methods[key], api.timeout, api.headers);\n    }); // remove process if no url or process on outline\n\n    api.process = outline.process || isString(outline) || outline.url ? api.process : null; // special treatment for remove\n\n    api.remove = outline.remove || null; // remove generic headers from api object\n\n    delete api.headers;\n    return api;\n  };\n\n  var createAction = function createAction(name, outline, method, timeout, headers) {\n    // is explicitely set to null so disable\n    if (outline === null) {\n      return null;\n    } // if is custom function, done! Dev handles everything.\n\n\n    if (typeof outline === 'function') {\n      return outline;\n    } // build action object\n\n\n    var action = {\n      url: method === 'GET' || method === 'PATCH' ? '?' + name + '=' : '',\n      method: method,\n      headers: headers,\n      withCredentials: false,\n      timeout: timeout,\n      onload: null,\n      ondata: null,\n      onerror: null\n    }; // is a single url\n\n    if (isString(outline)) {\n      action.url = outline;\n      return action;\n    } // overwrite\n\n\n    Object.assign(action, outline); // see if should reformat headers;\n\n    if (isString(action.headers)) {\n      var parts = action.headers.split(/:(.+)/);\n      action.headers = {\n        header: parts[0],\n        value: parts[1]\n      };\n    } // if is bool withCredentials\n\n\n    action.withCredentials = toBoolean(action.withCredentials);\n    return action;\n  };\n\n  var toServerAPI = function toServerAPI(value) {\n    return createServerAPI(value);\n  };\n\n  var isNull = function isNull(value) {\n    return value === null;\n  };\n\n  var isObject = function isObject(value) {\n    return typeof value === 'object' && value !== null;\n  };\n\n  var isAPI = function isAPI(value) {\n    return isObject(value) && isString(value.url) && isObject(value.process) && isObject(value.revert) && isObject(value.restore) && isObject(value.fetch);\n  };\n\n  var getType = function getType(value) {\n    if (isArray(value)) {\n      return 'array';\n    }\n\n    if (isNull(value)) {\n      return 'null';\n    }\n\n    if (isInt(value)) {\n      return 'int';\n    }\n\n    if (/^[0-9]+ ?(?:GB|MB|KB)$/gi.test(value)) {\n      return 'bytes';\n    }\n\n    if (isAPI(value)) {\n      return 'api';\n    }\n\n    return typeof value;\n  };\n\n  var replaceSingleQuotes = function replaceSingleQuotes(str) {\n    return str.replace(/{\\s*'/g, '{\"').replace(/'\\s*}/g, '\"}').replace(/'\\s*:/g, '\":').replace(/:\\s*'/g, ':\"').replace(/,\\s*'/g, ',\"').replace(/'\\s*,/g, '\",');\n  };\n\n  var conversionTable = {\n    array: toArray,\n    boolean: toBoolean,\n    int: function int(value) {\n      return getType(value) === 'bytes' ? toBytes(value) : toInt(value);\n    },\n    number: toFloat,\n    float: toFloat,\n    bytes: toBytes,\n    string: function string(value) {\n      return isFunction(value) ? value : toString(value);\n    },\n    function: function _function(value) {\n      return toFunctionReference(value);\n    },\n    serverapi: toServerAPI,\n    object: function object(value) {\n      try {\n        return JSON.parse(replaceSingleQuotes(value));\n      } catch (e) {\n        return null;\n      }\n    }\n  };\n\n  var convertTo = function convertTo(value, type) {\n    return conversionTable[type](value);\n  };\n\n  var getValueByType = function getValueByType(newValue, defaultValue, valueType) {\n    // can always assign default value\n    if (newValue === defaultValue) {\n      return newValue;\n    } // get the type of the new value\n\n\n    var newValueType = getType(newValue); // is valid type?\n\n    if (newValueType !== valueType) {\n      // is string input, let's attempt to convert\n      var convertedValue = convertTo(newValue, valueType); // what is the type now\n\n      newValueType = getType(convertedValue); // no valid conversions found\n\n      if (convertedValue === null) {\n        throw 'Trying to assign value with incorrect type to \"' + option + '\", allowed type: \"' + valueType + '\"';\n      } else {\n        newValue = convertedValue;\n      }\n    } // assign new value\n\n\n    return newValue;\n  };\n\n  var createOption = function createOption(defaultValue, valueType) {\n    var currentValue = defaultValue;\n    return {\n      enumerable: true,\n      get: function get() {\n        return currentValue;\n      },\n      set: function set(newValue) {\n        currentValue = getValueByType(newValue, defaultValue, valueType);\n      }\n    };\n  };\n\n  var createOptions = function createOptions(options) {\n    var obj = {};\n    forin(options, function (prop) {\n      var optionDefinition = options[prop];\n      obj[prop] = createOption(optionDefinition[0], optionDefinition[1]);\n    });\n    return createObject(obj);\n  };\n\n  var createInitialState = function createInitialState(options) {\n    return {\n      // model\n      items: [],\n      // timeout used for calling update items\n      listUpdateTimeout: null,\n      // timeout used for stacking metadata updates\n      itemUpdateTimeout: null,\n      // queue of items waiting to be processed\n      processingQueue: [],\n      // options\n      options: createOptions(options)\n    };\n  };\n\n  var fromCamels = function fromCamels(string) {\n    var separator = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : '-';\n    return string.split(/(?=[A-Z])/).map(function (part) {\n      return part.toLowerCase();\n    }).join(separator);\n  };\n\n  var createOptionAPI = function createOptionAPI(store, options) {\n    var obj = {};\n    forin(options, function (key) {\n      obj[key] = {\n        get: function get() {\n          return store.getState().options[key];\n        },\n        set: function set(value) {\n          store.dispatch('SET_' + fromCamels(key, '_').toUpperCase(), {\n            value: value\n          });\n        }\n      };\n    });\n    return obj;\n  };\n\n  var createOptionActions = function createOptionActions(options) {\n    return function (dispatch, query, state) {\n      var obj = {};\n      forin(options, function (key) {\n        var name = fromCamels(key, '_').toUpperCase();\n\n        obj['SET_' + name] = function (action) {\n          try {\n            state.options[key] = action.value;\n          } catch (e) {} // nope, failed\n          // we successfully set the value of this option\n\n\n          dispatch('DID_SET_' + name, {\n            value: state.options[key]\n          });\n        };\n      });\n      return obj;\n    };\n  };\n\n  var createOptionQueries = function createOptionQueries(options) {\n    return function (state) {\n      var obj = {};\n      forin(options, function (key) {\n        obj['GET_' + fromCamels(key, '_').toUpperCase()] = function (action) {\n          return state.options[key];\n        };\n      });\n      return obj;\n    };\n  };\n\n  var InteractionMethod = {\n    API: 1,\n    DROP: 2,\n    BROWSE: 3,\n    PASTE: 4,\n    NONE: 5\n  };\n\n  var getUniqueId = function getUniqueId() {\n    return Math.random().toString(36).substr(2, 9);\n  };\n\n  function _typeof(obj) {\n    if (typeof Symbol === 'function' && typeof Symbol.iterator === 'symbol') {\n      _typeof = function (obj) {\n        return typeof obj;\n      };\n    } else {\n      _typeof = function (obj) {\n        return obj && typeof Symbol === 'function' && obj.constructor === Symbol && obj !== Symbol.prototype ? 'symbol' : typeof obj;\n      };\n    }\n\n    return _typeof(obj);\n  }\n\n  var REACT_ELEMENT_TYPE;\n\n  function _jsx(type, props, key, children) {\n    if (!REACT_ELEMENT_TYPE) {\n      REACT_ELEMENT_TYPE = typeof Symbol === 'function' && Symbol['for'] && Symbol['for']('react.element') || 0xeac7;\n    }\n\n    var defaultProps = type && type.defaultProps;\n    var childrenLength = arguments.length - 3;\n\n    if (!props && childrenLength !== 0) {\n      props = {\n        children: void 0\n      };\n    }\n\n    if (props && defaultProps) {\n      for (var propName in defaultProps) {\n        if (props[propName] === void 0) {\n          props[propName] = defaultProps[propName];\n        }\n      }\n    } else if (!props) {\n      props = defaultProps || {};\n    }\n\n    if (childrenLength === 1) {\n      props.children = children;\n    } else if (childrenLength > 1) {\n      var childArray = new Array(childrenLength);\n\n      for (var i = 0; i < childrenLength; i++) {\n        childArray[i] = arguments[i + 3];\n      }\n\n      props.children = childArray;\n    }\n\n    return {\n      $$typeof: REACT_ELEMENT_TYPE,\n      type: type,\n      key: key === undefined ? null : '' + key,\n      ref: null,\n      props: props,\n      _owner: null\n    };\n  }\n\n  function _asyncIterator(iterable) {\n    var method;\n\n    if (typeof Symbol !== 'undefined') {\n      if (Symbol.asyncIterator) {\n        method = iterable[Symbol.asyncIterator];\n        if (method != null) return method.call(iterable);\n      }\n\n      if (Symbol.iterator) {\n        method = iterable[Symbol.iterator];\n        if (method != null) return method.call(iterable);\n      }\n    }\n\n    throw new TypeError('Object is not async iterable');\n  }\n\n  function _AwaitValue(value) {\n    this.wrapped = value;\n  }\n\n  function _AsyncGenerator(gen) {\n    var front, back;\n\n    function send(key, arg) {\n      return new Promise(function (resolve, reject) {\n        var request = {\n          key: key,\n          arg: arg,\n          resolve: resolve,\n          reject: reject,\n          next: null\n        };\n\n        if (back) {\n          back = back.next = request;\n        } else {\n          front = back = request;\n          resume(key, arg);\n        }\n      });\n    }\n\n    function resume(key, arg) {\n      try {\n        var result = gen[key](arg);\n        var value = result.value;\n        var wrappedAwait = value instanceof _AwaitValue;\n        Promise.resolve(wrappedAwait ? value.wrapped : value).then(function (arg) {\n          if (wrappedAwait) {\n            resume('next', arg);\n            return;\n          }\n\n          settle(result.done ? 'return' : 'normal', arg);\n        }, function (err) {\n          resume('throw', err);\n        });\n      } catch (err) {\n        settle('throw', err);\n      }\n    }\n\n    function settle(type, value) {\n      switch (type) {\n        case 'return':\n          front.resolve({\n            value: value,\n            done: true\n          });\n          break;\n\n        case 'throw':\n          front.reject(value);\n          break;\n\n        default:\n          front.resolve({\n            value: value,\n            done: false\n          });\n          break;\n      }\n\n      front = front.next;\n\n      if (front) {\n        resume(front.key, front.arg);\n      } else {\n        back = null;\n      }\n    }\n\n    this._invoke = send;\n\n    if (typeof gen.return !== 'function') {\n      this.return = undefined;\n    }\n  }\n\n  if (typeof Symbol === 'function' && Symbol.asyncIterator) {\n    _AsyncGenerator.prototype[Symbol.asyncIterator] = function () {\n      return this;\n    };\n  }\n\n  _AsyncGenerator.prototype.next = function (arg) {\n    return this._invoke('next', arg);\n  };\n\n  _AsyncGenerator.prototype.throw = function (arg) {\n    return this._invoke('throw', arg);\n  };\n\n  _AsyncGenerator.prototype.return = function (arg) {\n    return this._invoke('return', arg);\n  };\n\n  function _wrapAsyncGenerator(fn) {\n    return function () {\n      return new _AsyncGenerator(fn.apply(this, arguments));\n    };\n  }\n\n  function _awaitAsyncGenerator(value) {\n    return new _AwaitValue(value);\n  }\n\n  function _asyncGeneratorDelegate(inner, awaitWrap) {\n    var iter = {},\n        waiting = false;\n\n    function pump(key, value) {\n      waiting = true;\n      value = new Promise(function (resolve) {\n        resolve(inner[key](value));\n      });\n      return {\n        done: false,\n        value: awaitWrap(value)\n      };\n    }\n\n    if (typeof Symbol === 'function' && Symbol.iterator) {\n      iter[Symbol.iterator] = function () {\n        return this;\n      };\n    }\n\n    iter.next = function (value) {\n      if (waiting) {\n        waiting = false;\n        return value;\n      }\n\n      return pump('next', value);\n    };\n\n    if (typeof inner.throw === 'function') {\n      iter.throw = function (value) {\n        if (waiting) {\n          waiting = false;\n          throw value;\n        }\n\n        return pump('throw', value);\n      };\n    }\n\n    if (typeof inner.return === 'function') {\n      iter.return = function (value) {\n        return pump('return', value);\n      };\n    }\n\n    return iter;\n  }\n\n  function asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) {\n    try {\n      var info = gen[key](arg);\n      var value = info.value;\n    } catch (error) {\n      reject(error);\n      return;\n    }\n\n    if (info.done) {\n      resolve(value);\n    } else {\n      Promise.resolve(value).then(_next, _throw);\n    }\n  }\n\n  function _asyncToGenerator(fn) {\n    return function () {\n      var self = this,\n          args = arguments;\n      return new Promise(function (resolve, reject) {\n        var gen = fn.apply(self, args);\n\n        function _next(value) {\n          asyncGeneratorStep(gen, resolve, reject, _next, _throw, 'next', value);\n        }\n\n        function _throw(err) {\n          asyncGeneratorStep(gen, resolve, reject, _next, _throw, 'throw', err);\n        }\n\n        _next(undefined);\n      });\n    };\n  }\n\n  function _classCallCheck(instance, Constructor) {\n    if (!(instance instanceof Constructor)) {\n      throw new TypeError('Cannot call a class as a function');\n    }\n  }\n\n  function _defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if ('value' in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descriptor);\n    }\n  }\n\n  function _createClass(Constructor, protoProps, staticProps) {\n    if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n    if (staticProps) _defineProperties(Constructor, staticProps);\n    return Constructor;\n  }\n\n  function _defineEnumerableProperties(obj, descs) {\n    for (var key in descs) {\n      var desc = descs[key];\n      desc.configurable = desc.enumerable = true;\n      if ('value' in desc) desc.writable = true;\n      Object.defineProperty(obj, key, desc);\n    }\n\n    if (Object.getOwnPropertySymbols) {\n      var objectSymbols = Object.getOwnPropertySymbols(descs);\n\n      for (var i = 0; i < objectSymbols.length; i++) {\n        var sym = objectSymbols[i];\n        var desc = descs[sym];\n        desc.configurable = desc.enumerable = true;\n        if ('value' in desc) desc.writable = true;\n        Object.defineProperty(obj, sym, desc);\n      }\n    }\n\n    return obj;\n  }\n\n  function _defaults(obj, defaults) {\n    var keys = Object.getOwnPropertyNames(defaults);\n\n    for (var i = 0; i < keys.length; i++) {\n      var key = keys[i];\n      var value = Object.getOwnPropertyDescriptor(defaults, key);\n\n      if (value && value.configurable && obj[key] === undefined) {\n        Object.defineProperty(obj, key, value);\n      }\n    }\n\n    return obj;\n  }\n\n  function _defineProperty(obj, key, value) {\n    if (key in obj) {\n      Object.defineProperty(obj, key, {\n        value: value,\n        enumerable: true,\n        configurable: true,\n        writable: true\n      });\n    } else {\n      obj[key] = value;\n    }\n\n    return obj;\n  }\n\n  function _extends() {\n    _extends = Object.assign || function (target) {\n      for (var i = 1; i < arguments.length; i++) {\n        var source = arguments[i];\n\n        for (var key in source) {\n          if (Object.prototype.hasOwnProperty.call(source, key)) {\n            target[key] = source[key];\n          }\n        }\n      }\n\n      return target;\n    };\n\n    return _extends.apply(this, arguments);\n  }\n\n  function _objectSpread(target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i] != null ? arguments[i] : {};\n      var ownKeys = Object.keys(source);\n\n      if (typeof Object.getOwnPropertySymbols === 'function') {\n        ownKeys = ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function (sym) {\n          return Object.getOwnPropertyDescriptor(source, sym).enumerable;\n        }));\n      }\n\n      ownKeys.forEach(function (key) {\n        _defineProperty(target, key, source[key]);\n      });\n    }\n\n    return target;\n  }\n\n  function ownKeys(object, enumerableOnly) {\n    var keys = Object.keys(object);\n\n    if (Object.getOwnPropertySymbols) {\n      var symbols = Object.getOwnPropertySymbols(object);\n      if (enumerableOnly) symbols = symbols.filter(function (sym) {\n        return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n      });\n      keys.push.apply(keys, symbols);\n    }\n\n    return keys;\n  }\n\n  function _objectSpread2(target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i] != null ? arguments[i] : {};\n\n      if (i % 2) {\n        ownKeys(source, true).forEach(function (key) {\n          _defineProperty(target, key, source[key]);\n        });\n      } else if (Object.getOwnPropertyDescriptors) {\n        Object.defineProperties(target, Object.getOwnPropertyDescriptors(source));\n      } else {\n        ownKeys(source).forEach(function (key) {\n          Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n        });\n      }\n    }\n\n    return target;\n  }\n\n  function _inherits(subClass, superClass) {\n    if (typeof superClass !== 'function' && superClass !== null) {\n      throw new TypeError('Super expression must either be null or a function');\n    }\n\n    subClass.prototype = Object.create(superClass && superClass.prototype, {\n      constructor: {\n        value: subClass,\n        writable: true,\n        configurable: true\n      }\n    });\n    if (superClass) _setPrototypeOf(subClass, superClass);\n  }\n\n  function _inheritsLoose(subClass, superClass) {\n    subClass.prototype = Object.create(superClass.prototype);\n    subClass.prototype.constructor = subClass;\n    subClass.__proto__ = superClass;\n  }\n\n  function _getPrototypeOf(o) {\n    _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {\n      return o.__proto__ || Object.getPrototypeOf(o);\n    };\n    return _getPrototypeOf(o);\n  }\n\n  function _setPrototypeOf(o, p) {\n    _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) {\n      o.__proto__ = p;\n      return o;\n    };\n\n    return _setPrototypeOf(o, p);\n  }\n\n  function isNativeReflectConstruct() {\n    if (typeof Reflect === 'undefined' || !Reflect.construct) return false;\n    if (Reflect.construct.sham) return false;\n    if (typeof Proxy === 'function') return true;\n\n    try {\n      Date.prototype.toString.call(Reflect.construct(Date, [], function () {}));\n      return true;\n    } catch (e) {\n      return false;\n    }\n  }\n\n  function _construct(Parent, args, Class) {\n    if (isNativeReflectConstruct()) {\n      _construct = Reflect.construct;\n    } else {\n      _construct = function _construct(Parent, args, Class) {\n        var a = [null];\n        a.push.apply(a, args);\n        var Constructor = Function.bind.apply(Parent, a);\n        var instance = new Constructor();\n        if (Class) _setPrototypeOf(instance, Class.prototype);\n        return instance;\n      };\n    }\n\n    return _construct.apply(null, arguments);\n  }\n\n  function _isNativeFunction(fn) {\n    return Function.toString.call(fn).indexOf('[native code]') !== -1;\n  }\n\n  function _wrapNativeSuper(Class) {\n    var _cache = typeof Map === 'function' ? new Map() : undefined;\n\n    _wrapNativeSuper = function _wrapNativeSuper(Class) {\n      if (Class === null || !_isNativeFunction(Class)) return Class;\n\n      if (typeof Class !== 'function') {\n        throw new TypeError('Super expression must either be null or a function');\n      }\n\n      if (typeof _cache !== 'undefined') {\n        if (_cache.has(Class)) return _cache.get(Class);\n\n        _cache.set(Class, Wrapper);\n      }\n\n      function Wrapper() {\n        return _construct(Class, arguments, _getPrototypeOf(this).constructor);\n      }\n\n      Wrapper.prototype = Object.create(Class.prototype, {\n        constructor: {\n          value: Wrapper,\n          enumerable: false,\n          writable: true,\n          configurable: true\n        }\n      });\n      return _setPrototypeOf(Wrapper, Class);\n    };\n\n    return _wrapNativeSuper(Class);\n  }\n\n  function _instanceof(left, right) {\n    if (right != null && typeof Symbol !== 'undefined' && right[Symbol.hasInstance]) {\n      return !!right[Symbol.hasInstance](left);\n    } else {\n      return left instanceof right;\n    }\n  }\n\n  function _interopRequireDefault(obj) {\n    return obj && obj.__esModule ? obj : {\n      default: obj\n    };\n  }\n\n  function _interopRequireWildcard(obj) {\n    if (obj && obj.__esModule) {\n      return obj;\n    } else {\n      var newObj = {};\n\n      if (obj != null) {\n        for (var key in obj) {\n          if (Object.prototype.hasOwnProperty.call(obj, key)) {\n            var desc = Object.defineProperty && Object.getOwnPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : {};\n\n            if (desc.get || desc.set) {\n              Object.defineProperty(newObj, key, desc);\n            } else {\n              newObj[key] = obj[key];\n            }\n          }\n        }\n      }\n\n      newObj.default = obj;\n      return newObj;\n    }\n  }\n\n  function _newArrowCheck(innerThis, boundThis) {\n    if (innerThis !== boundThis) {\n      throw new TypeError('Cannot instantiate an arrow function');\n    }\n  }\n\n  function _objectDestructuringEmpty(obj) {\n    if (obj == null) throw new TypeError('Cannot destructure undefined');\n  }\n\n  function _objectWithoutPropertiesLoose(source, excluded) {\n    if (source == null) return {};\n    var target = {};\n    var sourceKeys = Object.keys(source);\n    var key, i;\n\n    for (i = 0; i < sourceKeys.length; i++) {\n      key = sourceKeys[i];\n      if (excluded.indexOf(key) >= 0) continue;\n      target[key] = source[key];\n    }\n\n    return target;\n  }\n\n  function _objectWithoutProperties(source, excluded) {\n    if (source == null) return {};\n\n    var target = _objectWithoutPropertiesLoose(source, excluded);\n\n    var key, i;\n\n    if (Object.getOwnPropertySymbols) {\n      var sourceSymbolKeys = Object.getOwnPropertySymbols(source);\n\n      for (i = 0; i < sourceSymbolKeys.length; i++) {\n        key = sourceSymbolKeys[i];\n        if (excluded.indexOf(key) >= 0) continue;\n        if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue;\n        target[key] = source[key];\n      }\n    }\n\n    return target;\n  }\n\n  function _assertThisInitialized(self) {\n    if (self === void 0) {\n      throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n    }\n\n    return self;\n  }\n\n  function _possibleConstructorReturn(self, call) {\n    if (call && (typeof call === 'object' || typeof call === 'function')) {\n      return call;\n    }\n\n    return _assertThisInitialized(self);\n  }\n\n  function _superPropBase(object, property) {\n    while (!Object.prototype.hasOwnProperty.call(object, property)) {\n      object = _getPrototypeOf(object);\n      if (object === null) break;\n    }\n\n    return object;\n  }\n\n  function _get(target, property, receiver) {\n    if (typeof Reflect !== 'undefined' && Reflect.get) {\n      _get = Reflect.get;\n    } else {\n      _get = function _get(target, property, receiver) {\n        var base = _superPropBase(target, property);\n\n        if (!base) return;\n        var desc = Object.getOwnPropertyDescriptor(base, property);\n\n        if (desc.get) {\n          return desc.get.call(receiver);\n        }\n\n        return desc.value;\n      };\n    }\n\n    return _get(target, property, receiver || target);\n  }\n\n  function set(target, property, value, receiver) {\n    if (typeof Reflect !== 'undefined' && Reflect.set) {\n      set = Reflect.set;\n    } else {\n      set = function set(target, property, value, receiver) {\n        var base = _superPropBase(target, property);\n\n        var desc;\n\n        if (base) {\n          desc = Object.getOwnPropertyDescriptor(base, property);\n\n          if (desc.set) {\n            desc.set.call(receiver, value);\n            return true;\n          } else if (!desc.writable) {\n            return false;\n          }\n        }\n\n        desc = Object.getOwnPropertyDescriptor(receiver, property);\n\n        if (desc) {\n          if (!desc.writable) {\n            return false;\n          }\n\n          desc.value = value;\n          Object.defineProperty(receiver, property, desc);\n        } else {\n          _defineProperty(receiver, property, value);\n        }\n\n        return true;\n      };\n    }\n\n    return set(target, property, value, receiver);\n  }\n\n  function _set(target, property, value, receiver, isStrict) {\n    var s = set(target, property, value, receiver || target);\n\n    if (!s && isStrict) {\n      throw new Error('failed to set property');\n    }\n\n    return value;\n  }\n\n  function _taggedTemplateLiteral(strings, raw) {\n    if (!raw) {\n      raw = strings.slice(0);\n    }\n\n    return Object.freeze(Object.defineProperties(strings, {\n      raw: {\n        value: Object.freeze(raw)\n      }\n    }));\n  }\n\n  function _taggedTemplateLiteralLoose(strings, raw) {\n    if (!raw) {\n      raw = strings.slice(0);\n    }\n\n    strings.raw = raw;\n    return strings;\n  }\n\n  function _temporalRef(val, name) {\n    if (val === _temporalUndefined) {\n      throw new ReferenceError(name + ' is not defined - temporal dead zone');\n    } else {\n      return val;\n    }\n  }\n\n  function _readOnlyError(name) {\n    throw new Error('\"' + name + '\" is read-only');\n  }\n\n  function _classNameTDZError(name) {\n    throw new Error('Class \"' + name + '\" cannot be referenced in computed property keys.');\n  }\n\n  var _temporalUndefined = {};\n\n  function _slicedToArray(arr, i) {\n    return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _nonIterableRest();\n  }\n\n  function _slicedToArrayLoose(arr, i) {\n    return _arrayWithHoles(arr) || _iterableToArrayLimitLoose(arr, i) || _nonIterableRest();\n  }\n\n  function _toArray(arr) {\n    return _arrayWithHoles(arr) || _iterableToArray(arr) || _nonIterableRest();\n  }\n\n  function _toConsumableArray(arr) {\n    return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _nonIterableSpread();\n  }\n\n  function _arrayWithoutHoles(arr) {\n    if (Array.isArray(arr)) {\n      for (var i = 0, arr2 = new Array(arr.length); i < arr.length; i++) arr2[i] = arr[i];\n\n      return arr2;\n    }\n  }\n\n  function _arrayWithHoles(arr) {\n    if (Array.isArray(arr)) return arr;\n  }\n\n  function _iterableToArray(iter) {\n    if (Symbol.iterator in Object(iter) || Object.prototype.toString.call(iter) === '[object Arguments]') return Array.from(iter);\n  }\n\n  function _iterableToArrayLimit(arr, i) {\n    var _arr = [];\n    var _n = true;\n    var _d = false;\n    var _e = undefined;\n\n    try {\n      for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) {\n        _arr.push(_s.value);\n\n        if (i && _arr.length === i) break;\n      }\n    } catch (err) {\n      _d = true;\n      _e = err;\n    } finally {\n      try {\n        if (!_n && _i['return'] != null) _i['return']();\n      } finally {\n        if (_d) throw _e;\n      }\n    }\n\n    return _arr;\n  }\n\n  function _iterableToArrayLimitLoose(arr, i) {\n    var _arr = [];\n\n    for (var _iterator = arr[Symbol.iterator](), _step; !(_step = _iterator.next()).done;) {\n      _arr.push(_step.value);\n\n      if (i && _arr.length === i) break;\n    }\n\n    return _arr;\n  }\n\n  function _nonIterableSpread() {\n    throw new TypeError('Invalid attempt to spread non-iterable instance');\n  }\n\n  function _nonIterableRest() {\n    throw new TypeError('Invalid attempt to destructure non-iterable instance');\n  }\n\n  function _skipFirstGeneratorNext(fn) {\n    return function () {\n      var it = fn.apply(this, arguments);\n      it.next();\n      return it;\n    };\n  }\n\n  function _toPrimitive(input, hint) {\n    if (typeof input !== 'object' || input === null) return input;\n    var prim = input[Symbol.toPrimitive];\n\n    if (prim !== undefined) {\n      var res = prim.call(input, hint || 'default');\n      if (typeof res !== 'object') return res;\n      throw new TypeError('@@toPrimitive must return a primitive value.');\n    }\n\n    return (hint === 'string' ? String : Number)(input);\n  }\n\n  function _toPropertyKey(arg) {\n    var key = _toPrimitive(arg, 'string');\n\n    return typeof key === 'symbol' ? key : String(key);\n  }\n\n  function _initializerWarningHelper(descriptor, context) {\n    throw new Error('Decorating class property failed. Please ensure that ' + 'proposal-class-properties is enabled and set to use loose mode. ' + 'To use proposal-class-properties in spec mode with decorators, wait for ' + 'the next major version of decorators in stage 2.');\n  }\n\n  function _initializerDefineProperty(target, property, descriptor, context) {\n    if (!descriptor) return;\n    Object.defineProperty(target, property, {\n      enumerable: descriptor.enumerable,\n      configurable: descriptor.configurable,\n      writable: descriptor.writable,\n      value: descriptor.initializer ? descriptor.initializer.call(context) : void 0\n    });\n  }\n\n  function _applyDecoratedDescriptor(target, property, decorators, descriptor, context) {\n    var desc = {};\n    Object.keys(descriptor).forEach(function (key) {\n      desc[key] = descriptor[key];\n    });\n    desc.enumerable = !!desc.enumerable;\n    desc.configurable = !!desc.configurable;\n\n    if ('value' in desc || desc.initializer) {\n      desc.writable = true;\n    }\n\n    desc = decorators.slice().reverse().reduce(function (desc, decorator) {\n      return decorator(target, property, desc) || desc;\n    }, desc);\n\n    if (context && desc.initializer !== void 0) {\n      desc.value = desc.initializer ? desc.initializer.call(context) : void 0;\n      desc.initializer = undefined;\n    }\n\n    if (desc.initializer === void 0) {\n      Object.defineProperty(target, property, desc);\n      desc = null;\n    }\n\n    return desc;\n  }\n\n  var id = 0;\n\n  function _classPrivateFieldLooseKey(name) {\n    return '__private_' + id++ + '_' + name;\n  }\n\n  function _classPrivateFieldLooseBase(receiver, privateKey) {\n    if (!Object.prototype.hasOwnProperty.call(receiver, privateKey)) {\n      throw new TypeError('attempted to use private field on non-instance');\n    }\n\n    return receiver;\n  }\n\n  function _classPrivateFieldGet(receiver, privateMap) {\n    var descriptor = privateMap.get(receiver);\n\n    if (!descriptor) {\n      throw new TypeError('attempted to get private field on non-instance');\n    }\n\n    if (descriptor.get) {\n      return descriptor.get.call(receiver);\n    }\n\n    return descriptor.value;\n  }\n\n  function _classPrivateFieldSet(receiver, privateMap, value) {\n    var descriptor = privateMap.get(receiver);\n\n    if (!descriptor) {\n      throw new TypeError('attempted to set private field on non-instance');\n    }\n\n    if (descriptor.set) {\n      descriptor.set.call(receiver, value);\n    } else {\n      if (!descriptor.writable) {\n        throw new TypeError('attempted to set read only private field');\n      }\n\n      descriptor.value = value;\n    }\n\n    return value;\n  }\n\n  function _classPrivateFieldDestructureSet(receiver, privateMap) {\n    if (!privateMap.has(receiver)) {\n      throw new TypeError('attempted to set private field on non-instance');\n    }\n\n    var descriptor = privateMap.get(receiver);\n\n    if (descriptor.set) {\n      if (!('__destrObj' in descriptor)) {\n        descriptor.__destrObj = {\n          set value(v) {\n            descriptor.set.call(receiver, v);\n          }\n\n        };\n      }\n\n      return descriptor.__destrObj;\n    } else {\n      if (!descriptor.writable) {\n        throw new TypeError('attempted to set read only private field');\n      }\n\n      return descriptor;\n    }\n  }\n\n  function _classStaticPrivateFieldSpecGet(receiver, classConstructor, descriptor) {\n    if (receiver !== classConstructor) {\n      throw new TypeError('Private static access of wrong provenance');\n    }\n\n    return descriptor.value;\n  }\n\n  function _classStaticPrivateFieldSpecSet(receiver, classConstructor, descriptor, value) {\n    if (receiver !== classConstructor) {\n      throw new TypeError('Private static access of wrong provenance');\n    }\n\n    if (!descriptor.writable) {\n      throw new TypeError('attempted to set read only private field');\n    }\n\n    descriptor.value = value;\n    return value;\n  }\n\n  function _classStaticPrivateMethodGet(receiver, classConstructor, method) {\n    if (receiver !== classConstructor) {\n      throw new TypeError('Private static access of wrong provenance');\n    }\n\n    return method;\n  }\n\n  function _classStaticPrivateMethodSet() {\n    throw new TypeError('attempted to set read only static private field');\n  }\n\n  function _decorate(decorators, factory, superClass, mixins) {\n    var api = _getDecoratorsApi();\n\n    if (mixins) {\n      for (var i = 0; i < mixins.length; i++) {\n        api = mixins[i](api);\n      }\n    }\n\n    var r = factory(function initialize(O) {\n      api.initializeInstanceElements(O, decorated.elements);\n    }, superClass);\n    var decorated = api.decorateClass(_coalesceClassElements(r.d.map(_createElementDescriptor)), decorators);\n    api.initializeClassElements(r.F, decorated.elements);\n    return api.runClassFinishers(r.F, decorated.finishers);\n  }\n\n  function _getDecoratorsApi() {\n    _getDecoratorsApi = function () {\n      return api;\n    };\n\n    var api = {\n      elementsDefinitionOrder: [['method'], ['field']],\n      initializeInstanceElements: function (O, elements) {\n        ['method', 'field'].forEach(function (kind) {\n          elements.forEach(function (element) {\n            if (element.kind === kind && element.placement === 'own') {\n              this.defineClassElement(O, element);\n            }\n          }, this);\n        }, this);\n      },\n      initializeClassElements: function (F, elements) {\n        var proto = F.prototype;\n        ['method', 'field'].forEach(function (kind) {\n          elements.forEach(function (element) {\n            var placement = element.placement;\n\n            if (element.kind === kind && (placement === 'static' || placement === 'prototype')) {\n              var receiver = placement === 'static' ? F : proto;\n              this.defineClassElement(receiver, element);\n            }\n          }, this);\n        }, this);\n      },\n      defineClassElement: function (receiver, element) {\n        var descriptor = element.descriptor;\n\n        if (element.kind === 'field') {\n          var initializer = element.initializer;\n          descriptor = {\n            enumerable: descriptor.enumerable,\n            writable: descriptor.writable,\n            configurable: descriptor.configurable,\n            value: initializer === void 0 ? void 0 : initializer.call(receiver)\n          };\n        }\n\n        Object.defineProperty(receiver, element.key, descriptor);\n      },\n      decorateClass: function (elements, decorators) {\n        var newElements = [];\n        var finishers = [];\n        var placements = {\n          static: [],\n          prototype: [],\n          own: []\n        };\n        elements.forEach(function (element) {\n          this.addElementPlacement(element, placements);\n        }, this);\n        elements.forEach(function (element) {\n          if (!_hasDecorators(element)) return newElements.push(element);\n          var elementFinishersExtras = this.decorateElement(element, placements);\n          newElements.push(elementFinishersExtras.element);\n          newElements.push.apply(newElements, elementFinishersExtras.extras);\n          finishers.push.apply(finishers, elementFinishersExtras.finishers);\n        }, this);\n\n        if (!decorators) {\n          return {\n            elements: newElements,\n            finishers: finishers\n          };\n        }\n\n        var result = this.decorateConstructor(newElements, decorators);\n        finishers.push.apply(finishers, result.finishers);\n        result.finishers = finishers;\n        return result;\n      },\n      addElementPlacement: function (element, placements, silent) {\n        var keys = placements[element.placement];\n\n        if (!silent && keys.indexOf(element.key) !== -1) {\n          throw new TypeError('Duplicated element (' + element.key + ')');\n        }\n\n        keys.push(element.key);\n      },\n      decorateElement: function (element, placements) {\n        var extras = [];\n        var finishers = [];\n\n        for (var decorators = element.decorators, i = decorators.length - 1; i >= 0; i--) {\n          var keys = placements[element.placement];\n          keys.splice(keys.indexOf(element.key), 1);\n          var elementObject = this.fromElementDescriptor(element);\n          var elementFinisherExtras = this.toElementFinisherExtras((0, decorators[i])(elementObject) || elementObject);\n          element = elementFinisherExtras.element;\n          this.addElementPlacement(element, placements);\n\n          if (elementFinisherExtras.finisher) {\n            finishers.push(elementFinisherExtras.finisher);\n          }\n\n          var newExtras = elementFinisherExtras.extras;\n\n          if (newExtras) {\n            for (var j = 0; j < newExtras.length; j++) {\n              this.addElementPlacement(newExtras[j], placements);\n            }\n\n            extras.push.apply(extras, newExtras);\n          }\n        }\n\n        return {\n          element: element,\n          finishers: finishers,\n          extras: extras\n        };\n      },\n      decorateConstructor: function (elements, decorators) {\n        var finishers = [];\n\n        for (var i = decorators.length - 1; i >= 0; i--) {\n          var obj = this.fromClassDescriptor(elements);\n          var elementsAndFinisher = this.toClassDescriptor((0, decorators[i])(obj) || obj);\n\n          if (elementsAndFinisher.finisher !== undefined) {\n            finishers.push(elementsAndFinisher.finisher);\n          }\n\n          if (elementsAndFinisher.elements !== undefined) {\n            elements = elementsAndFinisher.elements;\n\n            for (var j = 0; j < elements.length - 1; j++) {\n              for (var k = j + 1; k < elements.length; k++) {\n                if (elements[j].key === elements[k].key && elements[j].placement === elements[k].placement) {\n                  throw new TypeError('Duplicated element (' + elements[j].key + ')');\n                }\n              }\n            }\n          }\n        }\n\n        return {\n          elements: elements,\n          finishers: finishers\n        };\n      },\n      fromElementDescriptor: function (element) {\n        var obj = {\n          kind: element.kind,\n          key: element.key,\n          placement: element.placement,\n          descriptor: element.descriptor\n        };\n        var desc = {\n          value: 'Descriptor',\n          configurable: true\n        };\n        Object.defineProperty(obj, Symbol.toStringTag, desc);\n        if (element.kind === 'field') obj.initializer = element.initializer;\n        return obj;\n      },\n      toElementDescriptors: function (elementObjects) {\n        if (elementObjects === undefined) return;\n        return _toArray(elementObjects).map(function (elementObject) {\n          var element = this.toElementDescriptor(elementObject);\n          this.disallowProperty(elementObject, 'finisher', 'An element descriptor');\n          this.disallowProperty(elementObject, 'extras', 'An element descriptor');\n          return element;\n        }, this);\n      },\n      toElementDescriptor: function (elementObject) {\n        var kind = String(elementObject.kind);\n\n        if (kind !== 'method' && kind !== 'field') {\n          throw new TypeError('An element descriptor\\'s .kind property must be either \"method\" or' + ' \"field\", but a decorator created an element descriptor with' + ' .kind \"' + kind + '\"');\n        }\n\n        var key = _toPropertyKey(elementObject.key);\n\n        var placement = String(elementObject.placement);\n\n        if (placement !== 'static' && placement !== 'prototype' && placement !== 'own') {\n          throw new TypeError('An element descriptor\\'s .placement property must be one of \"static\",' + ' \"prototype\" or \"own\", but a decorator created an element descriptor' + ' with .placement \"' + placement + '\"');\n        }\n\n        var descriptor = elementObject.descriptor;\n        this.disallowProperty(elementObject, 'elements', 'An element descriptor');\n        var element = {\n          kind: kind,\n          key: key,\n          placement: placement,\n          descriptor: Object.assign({}, descriptor)\n        };\n\n        if (kind !== 'field') {\n          this.disallowProperty(elementObject, 'initializer', 'A method descriptor');\n        } else {\n          this.disallowProperty(descriptor, 'get', 'The property descriptor of a field descriptor');\n          this.disallowProperty(descriptor, 'set', 'The property descriptor of a field descriptor');\n          this.disallowProperty(descriptor, 'value', 'The property descriptor of a field descriptor');\n          element.initializer = elementObject.initializer;\n        }\n\n        return element;\n      },\n      toElementFinisherExtras: function (elementObject) {\n        var element = this.toElementDescriptor(elementObject);\n\n        var finisher = _optionalCallableProperty(elementObject, 'finisher');\n\n        var extras = this.toElementDescriptors(elementObject.extras);\n        return {\n          element: element,\n          finisher: finisher,\n          extras: extras\n        };\n      },\n      fromClassDescriptor: function (elements) {\n        var obj = {\n          kind: 'class',\n          elements: elements.map(this.fromElementDescriptor, this)\n        };\n        var desc = {\n          value: 'Descriptor',\n          configurable: true\n        };\n        Object.defineProperty(obj, Symbol.toStringTag, desc);\n        return obj;\n      },\n      toClassDescriptor: function (obj) {\n        var kind = String(obj.kind);\n\n        if (kind !== 'class') {\n          throw new TypeError('A class descriptor\\'s .kind property must be \"class\", but a decorator' + ' created a class descriptor with .kind \"' + kind + '\"');\n        }\n\n        this.disallowProperty(obj, 'key', 'A class descriptor');\n        this.disallowProperty(obj, 'placement', 'A class descriptor');\n        this.disallowProperty(obj, 'descriptor', 'A class descriptor');\n        this.disallowProperty(obj, 'initializer', 'A class descriptor');\n        this.disallowProperty(obj, 'extras', 'A class descriptor');\n\n        var finisher = _optionalCallableProperty(obj, 'finisher');\n\n        var elements = this.toElementDescriptors(obj.elements);\n        return {\n          elements: elements,\n          finisher: finisher\n        };\n      },\n      runClassFinishers: function (constructor, finishers) {\n        for (var i = 0; i < finishers.length; i++) {\n          var newConstructor = (0, finishers[i])(constructor);\n\n          if (newConstructor !== undefined) {\n            if (typeof newConstructor !== 'function') {\n              throw new TypeError('Finishers must return a constructor.');\n            }\n\n            constructor = newConstructor;\n          }\n        }\n\n        return constructor;\n      },\n      disallowProperty: function (obj, name, objectType) {\n        if (obj[name] !== undefined) {\n          throw new TypeError(objectType + \" can't have a .\" + name + ' property.');\n        }\n      }\n    };\n    return api;\n  }\n\n  function _createElementDescriptor(def) {\n    var key = _toPropertyKey(def.key);\n\n    var descriptor;\n\n    if (def.kind === 'method') {\n      descriptor = {\n        value: def.value,\n        writable: true,\n        configurable: true,\n        enumerable: false\n      };\n    } else if (def.kind === 'get') {\n      descriptor = {\n        get: def.value,\n        configurable: true,\n        enumerable: false\n      };\n    } else if (def.kind === 'set') {\n      descriptor = {\n        set: def.value,\n        configurable: true,\n        enumerable: false\n      };\n    } else if (def.kind === 'field') {\n      descriptor = {\n        configurable: true,\n        writable: true,\n        enumerable: true\n      };\n    }\n\n    var element = {\n      kind: def.kind === 'field' ? 'field' : 'method',\n      key: key,\n      placement: def.static ? 'static' : def.kind === 'field' ? 'own' : 'prototype',\n      descriptor: descriptor\n    };\n    if (def.decorators) element.decorators = def.decorators;\n    if (def.kind === 'field') element.initializer = def.value;\n    return element;\n  }\n\n  function _coalesceGetterSetter(element, other) {\n    if (element.descriptor.get !== undefined) {\n      other.descriptor.get = element.descriptor.get;\n    } else {\n      other.descriptor.set = element.descriptor.set;\n    }\n  }\n\n  function _coalesceClassElements(elements) {\n    var newElements = [];\n\n    var isSameElement = function (other) {\n      return other.kind === 'method' && other.key === element.key && other.placement === element.placement;\n    };\n\n    for (var i = 0; i < elements.length; i++) {\n      var element = elements[i];\n      var other;\n\n      if (element.kind === 'method' && (other = newElements.find(isSameElement))) {\n        if (_isDataDescriptor(element.descriptor) || _isDataDescriptor(other.descriptor)) {\n          if (_hasDecorators(element) || _hasDecorators(other)) {\n            throw new ReferenceError('Duplicated methods (' + element.key + \") can't be decorated.\");\n          }\n\n          other.descriptor = element.descriptor;\n        } else {\n          if (_hasDecorators(element)) {\n            if (_hasDecorators(other)) {\n              throw new ReferenceError(\"Decorators can't be placed on different accessors with for \" + 'the same property (' + element.key + ').');\n            }\n\n            other.decorators = element.decorators;\n          }\n\n          _coalesceGetterSetter(element, other);\n        }\n      } else {\n        newElements.push(element);\n      }\n    }\n\n    return newElements;\n  }\n\n  function _hasDecorators(element) {\n    return element.decorators && element.decorators.length;\n  }\n\n  function _isDataDescriptor(desc) {\n    return desc !== undefined && !(desc.value === undefined && desc.writable === undefined);\n  }\n\n  function _optionalCallableProperty(obj, name) {\n    var value = obj[name];\n\n    if (value !== undefined && typeof value !== 'function') {\n      throw new TypeError(\"Expected '\" + name + \"' to be a function\");\n    }\n\n    return value;\n  }\n\n  function _classPrivateMethodGet(receiver, privateSet, fn) {\n    if (!privateSet.has(receiver)) {\n      throw new TypeError('attempted to get private field on non-instance');\n    }\n\n    return fn;\n  }\n\n  function _classPrivateMethodSet() {\n    throw new TypeError('attempted to reassign private method');\n  }\n\n  function _wrapRegExp(re, groups) {\n    _wrapRegExp = function (re, groups) {\n      return new BabelRegExp(re, groups);\n    };\n\n    var _RegExp = _wrapNativeSuper(RegExp);\n\n    var _super = RegExp.prototype;\n\n    var _groups = new WeakMap();\n\n    function BabelRegExp(re, groups) {\n      var _this = _RegExp.call(this, re);\n\n      _groups.set(_this, groups);\n\n      return _this;\n    }\n\n    _inherits(BabelRegExp, _RegExp);\n\n    BabelRegExp.prototype.exec = function (str) {\n      var result = _super.exec.call(this, str);\n\n      if (result) result.groups = buildGroups(result, this);\n      return result;\n    };\n\n    BabelRegExp.prototype[Symbol.replace] = function (str, substitution) {\n      if (typeof substitution === 'string') {\n        var groups = _groups.get(this);\n\n        return _super[Symbol.replace].call(this, str, substitution.replace(/\\$<([^>]+)>/g, function (_, name) {\n          return '$' + groups[name];\n        }));\n      } else if (typeof substitution === 'function') {\n        var _this = this;\n\n        return _super[Symbol.replace].call(this, str, function () {\n          var args = [];\n          args.push.apply(args, arguments);\n\n          if (typeof args[args.length - 1] !== 'object') {\n            args.push(buildGroups(args, _this));\n          }\n\n          return substitution.apply(this, args);\n        });\n      } else {\n        return _super[Symbol.replace].call(this, str, substitution);\n      }\n    };\n\n    function buildGroups(result, re) {\n      var g = _groups.get(re);\n\n      return Object.keys(g).reduce(function (groups, name) {\n        groups[name] = result[g[name]];\n        return groups;\n      }, Object.create(null));\n    }\n\n    return _wrapRegExp.apply(this, arguments);\n  }\n\n  var arrayRemove = function arrayRemove(arr, index) {\n    return arr.splice(index, 1);\n  };\n\n  var run = function run(cb, sync) {\n    if (sync) {\n      cb();\n    } else if (document.hidden) {\n      Promise.resolve(1).then(cb);\n    } else {\n      setTimeout(cb, 0);\n    }\n  };\n\n  var on = function on() {\n    var listeners = [];\n\n    var off = function off(event, cb) {\n      arrayRemove(listeners, listeners.findIndex(function (listener) {\n        return listener.event === event && (listener.cb === cb || !cb);\n      }));\n    };\n\n    var _fire = function fire(event, args, sync) {\n      listeners.filter(function (listener) {\n        return listener.event === event;\n      }).map(function (listener) {\n        return listener.cb;\n      }).forEach(function (cb) {\n        return run(function () {\n          return cb.apply(void 0, _toConsumableArray(args));\n        }, sync);\n      });\n    };\n\n    return {\n      fireSync: function fireSync(event) {\n        for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n          args[_key - 1] = arguments[_key];\n        }\n\n        _fire(event, args, true);\n      },\n      fire: function fire(event) {\n        for (var _len2 = arguments.length, args = new Array(_len2 > 1 ? _len2 - 1 : 0), _key2 = 1; _key2 < _len2; _key2++) {\n          args[_key2 - 1] = arguments[_key2];\n        }\n\n        _fire(event, args, false);\n      },\n      on: function on(event, cb) {\n        listeners.push({\n          event: event,\n          cb: cb\n        });\n      },\n      onOnce: function onOnce(event, _cb) {\n        listeners.push({\n          event: event,\n          cb: function cb() {\n            off(event, _cb);\n\n            _cb.apply(void 0, arguments);\n          }\n        });\n      },\n      off: off\n    };\n  };\n\n  var copyObjectPropertiesToObject = function copyObjectPropertiesToObject(src, target, excluded) {\n    Object.getOwnPropertyNames(src).filter(function (property) {\n      return !excluded.includes(property);\n    }).forEach(function (key) {\n      return Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(src, key));\n    });\n  };\n\n  var PRIVATE = ['fire', 'process', 'revert', 'load', 'on', 'off', 'onOnce', 'retryLoad', 'extend', 'archive', 'archived', 'release', 'released', 'requestProcessing', 'freeze'];\n\n  var createItemAPI = function createItemAPI(item) {\n    var api = {};\n    copyObjectPropertiesToObject(item, api, PRIVATE);\n    return api;\n  };\n\n  var removeReleasedItems = function removeReleasedItems(items) {\n    items.forEach(function (item, index) {\n      if (item.released) {\n        arrayRemove(items, index);\n      }\n    });\n  };\n\n  var ItemStatus = {\n    INIT: 1,\n    IDLE: 2,\n    PROCESSING_QUEUED: 9,\n    PROCESSING: 3,\n    PROCESSING_COMPLETE: 5,\n    PROCESSING_ERROR: 6,\n    PROCESSING_REVERT_ERROR: 10,\n    LOADING: 7,\n    LOAD_ERROR: 8\n  };\n  var FileOrigin = {\n    INPUT: 1,\n    LIMBO: 2,\n    LOCAL: 3\n  };\n\n  var getNonNumeric = function getNonNumeric(str) {\n    return /[^0-9]+/.exec(str);\n  };\n\n  var getDecimalSeparator = function getDecimalSeparator() {\n    return getNonNumeric(1.1.toLocaleString())[0];\n  };\n\n  var getThousandsSeparator = function getThousandsSeparator() {\n    // Added for browsers that do not return the thousands separator (happend on native browser Android 4.4.4)\n    // We check against the normal toString output and if they're the same return a comma when decimal separator is a dot\n    var decimalSeparator = getDecimalSeparator();\n    var thousandsStringWithSeparator = 1000.0.toLocaleString();\n    var thousandsStringWithoutSeparator = 1000.0.toString();\n\n    if (thousandsStringWithSeparator !== thousandsStringWithoutSeparator) {\n      return getNonNumeric(thousandsStringWithSeparator)[0];\n    }\n\n    return decimalSeparator === '.' ? ',' : '.';\n  };\n\n  var Type = {\n    BOOLEAN: 'boolean',\n    INT: 'int',\n    NUMBER: 'number',\n    STRING: 'string',\n    ARRAY: 'array',\n    OBJECT: 'object',\n    FUNCTION: 'function',\n    ACTION: 'action',\n    SERVER_API: 'serverapi',\n    REGEX: 'regex'\n  }; // all registered filters\n\n  var filters = []; // loops over matching filters and passes options to each filter, returning the mapped results\n\n  var applyFilterChain = function applyFilterChain(key, value, utils) {\n    return new Promise(function (resolve, reject) {\n      // find matching filters for this key\n      var matchingFilters = filters.filter(function (f) {\n        return f.key === key;\n      }).map(function (f) {\n        return f.cb;\n      }); // resolve now\n\n      if (matchingFilters.length === 0) {\n        resolve(value);\n        return;\n      } // first filter to kick things of\n\n\n      var initialFilter = matchingFilters.shift(); // chain filters\n\n      matchingFilters.reduce( // loop over promises passing value to next promise\n      function (current, next) {\n        return current.then(function (value) {\n          return next(value, utils);\n        });\n      }, // call initial filter, will return a promise\n      initialFilter(value, utils) // all executed\n      ).then(function (value) {\n        return resolve(value);\n      }).catch(function (error) {\n        return reject(error);\n      });\n    });\n  };\n\n  var applyFilters = function applyFilters(key, value, utils) {\n    return filters.filter(function (f) {\n      return f.key === key;\n    }).map(function (f) {\n      return f.cb(value, utils);\n    });\n  }; // adds a new filter to the list\n\n\n  var addFilter = function addFilter(key, cb) {\n    return filters.push({\n      key: key,\n      cb: cb\n    });\n  };\n\n  var extendDefaultOptions = function extendDefaultOptions(additionalOptions) {\n    return Object.assign(defaultOptions, additionalOptions);\n  };\n\n  var getOptions = function getOptions() {\n    return Object.assign({}, defaultOptions);\n  };\n\n  var setOptions = function setOptions(opts) {\n    forin(opts, function (key, value) {\n      // key does not exist, so this option cannot be set\n      if (!defaultOptions[key]) {\n        return;\n      }\n\n      defaultOptions[key][0] = getValueByType(value, defaultOptions[key][0], defaultOptions[key][1]);\n    });\n  }; // default options on app\n\n\n  var defaultOptions = {\n    // the id to add to the root element\n    id: [null, Type.STRING],\n    // input field name to use\n    name: ['filepond', Type.STRING],\n    // disable the field\n    disabled: [false, Type.BOOLEAN],\n    // classname to put on wrapper\n    className: [null, Type.STRING],\n    // is the field required\n    required: [false, Type.BOOLEAN],\n    // Allow media capture when value is set\n    captureMethod: [null, Type.STRING],\n    // - \"camera\", \"microphone\" or \"camcorder\",\n    // - Does not work with multiple on apple devices\n    // - If set, acceptedFileTypes must be made to match with media wildcard \"image/*\", \"audio/*\" or \"video/*\"\n    // sync `acceptedFileTypes` property with `accept` attribute\n    allowSyncAcceptAttribute: [true, Type.BOOLEAN],\n    // Feature toggles\n    allowDrop: [true, Type.BOOLEAN],\n    // Allow dropping of files\n    allowBrowse: [true, Type.BOOLEAN],\n    // Allow browsing the file system\n    allowPaste: [true, Type.BOOLEAN],\n    // Allow pasting files\n    allowMultiple: [false, Type.BOOLEAN],\n    // Allow multiple files (disabled by default, as multiple attribute is also required on input to allow multiple)\n    allowReplace: [true, Type.BOOLEAN],\n    // Allow dropping a file on other file to replace it (only works when multiple is set to false)\n    allowRevert: [true, Type.BOOLEAN],\n    // Allows user to revert file upload\n    allowRemove: [true, Type.BOOLEAN],\n    // Allow user to remove a file\n    allowProcess: [true, Type.BOOLEAN],\n    // Allows user to process a file, when set to false, this removes the file upload button\n    allowReorder: [false, Type.BOOLEAN],\n    // Allow reordering of files\n    allowDirectoriesOnly: [false, Type.BOOLEAN],\n    // Allow only selecting directories with browse (no support for filtering dnd at this point)\n    // Try store file if `server` not set\n    storeAsFile: [false, Type.BOOLEAN],\n    // Revert mode\n    forceRevert: [false, Type.BOOLEAN],\n    // Set to 'force' to require the file to be reverted before removal\n    // Input requirements\n    maxFiles: [null, Type.INT],\n    // Max number of files\n    checkValidity: [false, Type.BOOLEAN],\n    // Enables custom validity messages\n    // Where to put file\n    itemInsertLocationFreedom: [true, Type.BOOLEAN],\n    // Set to false to always add items to begin or end of list\n    itemInsertLocation: ['before', Type.STRING],\n    // Default index in list to add items that have been dropped at the top of the list\n    itemInsertInterval: [75, Type.INT],\n    // Drag 'n Drop related\n    dropOnPage: [false, Type.BOOLEAN],\n    // Allow dropping of files anywhere on page (prevents browser from opening file if dropped outside of Up)\n    dropOnElement: [true, Type.BOOLEAN],\n    // Drop needs to happen on element (set to false to also load drops outside of Up)\n    dropValidation: [false, Type.BOOLEAN],\n    // Enable or disable validating files on drop\n    ignoredFiles: [['.ds_store', 'thumbs.db', 'desktop.ini'], Type.ARRAY],\n    // Upload related\n    instantUpload: [true, Type.BOOLEAN],\n    // Should upload files immediately on drop\n    maxParallelUploads: [2, Type.INT],\n    // Maximum files to upload in parallel\n    allowMinimumUploadDuration: [true, Type.BOOLEAN],\n    // if true uploads take at least 750 ms, this ensures the user sees the upload progress giving trust the upload actually happened\n    // Chunks\n    chunkUploads: [false, Type.BOOLEAN],\n    // Enable chunked uploads\n    chunkForce: [false, Type.BOOLEAN],\n    // Force use of chunk uploads even for files smaller than chunk size\n    chunkSize: [5000000, Type.INT],\n    // Size of chunks (5MB default)\n    chunkRetryDelays: [[500, 1000, 3000], Type.ARRAY],\n    // Amount of times to retry upload of a chunk when it fails\n    // The server api end points to use for uploading (see docs)\n    server: [null, Type.SERVER_API],\n    // File size calculations, can set to 1024, this is only used for display, properties use file size base 1000\n    fileSizeBase: [1000, Type.INT],\n    // Labels and status messages\n    labelFileSizeBytes: ['bytes', Type.STRING],\n    labelFileSizeKilobytes: ['KB', Type.STRING],\n    labelFileSizeMegabytes: ['MB', Type.STRING],\n    labelFileSizeGigabytes: ['GB', Type.STRING],\n    labelDecimalSeparator: [getDecimalSeparator(), Type.STRING],\n    // Default is locale separator\n    labelThousandsSeparator: [getThousandsSeparator(), Type.STRING],\n    // Default is locale separator\n    labelIdle: ['Drag & Drop your files or <span class=\"filepond--label-action\">Browse</span>', Type.STRING],\n    labelInvalidField: ['Field contains invalid files', Type.STRING],\n    labelFileWaitingForSize: ['Waiting for size', Type.STRING],\n    labelFileSizeNotAvailable: ['Size not available', Type.STRING],\n    labelFileCountSingular: ['file in list', Type.STRING],\n    labelFileCountPlural: ['files in list', Type.STRING],\n    labelFileLoading: ['Loading', Type.STRING],\n    labelFileAdded: ['Added', Type.STRING],\n    // assistive only\n    labelFileLoadError: ['Error during load', Type.STRING],\n    labelFileRemoved: ['Removed', Type.STRING],\n    // assistive only\n    labelFileRemoveError: ['Error during remove', Type.STRING],\n    labelFileProcessing: ['Uploading', Type.STRING],\n    labelFileProcessingComplete: ['Upload complete', Type.STRING],\n    labelFileProcessingAborted: ['Upload cancelled', Type.STRING],\n    labelFileProcessingError: ['Error during upload', Type.STRING],\n    labelFileProcessingRevertError: ['Error during revert', Type.STRING],\n    labelTapToCancel: ['tap to cancel', Type.STRING],\n    labelTapToRetry: ['tap to retry', Type.STRING],\n    labelTapToUndo: ['tap to undo', Type.STRING],\n    labelButtonRemoveItem: ['Remove', Type.STRING],\n    labelButtonAbortItemLoad: ['Abort', Type.STRING],\n    labelButtonRetryItemLoad: ['Retry', Type.STRING],\n    labelButtonAbortItemProcessing: ['Cancel', Type.STRING],\n    labelButtonUndoItemProcessing: ['Undo', Type.STRING],\n    labelButtonRetryItemProcessing: ['Retry', Type.STRING],\n    labelButtonProcessItem: ['Upload', Type.STRING],\n    // make sure width and height plus viewpox are even numbers so icons are nicely centered\n    iconRemove: ['<svg width=\"26\" height=\"26\" viewBox=\"0 0 26 26\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M11.586 13l-2.293 2.293a1 1 0 0 0 1.414 1.414L13 14.414l2.293 2.293a1 1 0 0 0 1.414-1.414L14.414 13l2.293-2.293a1 1 0 0 0-1.414-1.414L13 11.586l-2.293-2.293a1 1 0 0 0-1.414 1.414L11.586 13z\" fill=\"currentColor\" fill-rule=\"nonzero\"/></svg>', Type.STRING],\n    iconProcess: ['<svg width=\"26\" height=\"26\" viewBox=\"0 0 26 26\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M14 10.414v3.585a1 1 0 0 1-2 0v-3.585l-1.293 1.293a1 1 0 0 1-1.414-1.415l3-3a1 1 0 0 1 1.414 0l3 3a1 1 0 0 1-1.414 1.415L14 10.414zM9 18a1 1 0 0 1 0-2h8a1 1 0 0 1 0 2H9z\" fill=\"currentColor\" fill-rule=\"evenodd\"/></svg>', Type.STRING],\n    iconRetry: ['<svg width=\"26\" height=\"26\" viewBox=\"0 0 26 26\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M10.81 9.185l-.038.02A4.997 4.997 0 0 0 8 13.683a5 5 0 0 0 5 5 5 5 0 0 0 5-5 1 1 0 0 1 2 0A7 7 0 1 1 9.722 7.496l-.842-.21a.999.999 0 1 1 .484-1.94l3.23.806c.535.133.86.675.73 1.21l-.804 3.233a.997.997 0 0 1-1.21.73.997.997 0 0 1-.73-1.21l.23-.928v-.002z\" fill=\"currentColor\" fill-rule=\"nonzero\"/></svg>', Type.STRING],\n    iconUndo: ['<svg width=\"26\" height=\"26\" viewBox=\"0 0 26 26\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M9.185 10.81l.02-.038A4.997 4.997 0 0 1 13.683 8a5 5 0 0 1 5 5 5 5 0 0 1-5 5 1 1 0 0 0 0 2A7 7 0 1 0 7.496 9.722l-.21-.842a.999.999 0 1 0-1.94.484l.806 3.23c.133.535.675.86 1.21.73l3.233-.803a.997.997 0 0 0 .73-1.21.997.997 0 0 0-1.21-.73l-.928.23-.002-.001z\" fill=\"currentColor\" fill-rule=\"nonzero\"/></svg>', Type.STRING],\n    iconDone: ['<svg width=\"26\" height=\"26\" viewBox=\"0 0 26 26\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M18.293 9.293a1 1 0 0 1 1.414 1.414l-7.002 7a1 1 0 0 1-1.414 0l-3.998-4a1 1 0 1 1 1.414-1.414L12 15.586l6.294-6.293z\" fill=\"currentColor\" fill-rule=\"nonzero\"/></svg>', Type.STRING],\n    // event handlers\n    oninit: [null, Type.FUNCTION],\n    onwarning: [null, Type.FUNCTION],\n    onerror: [null, Type.FUNCTION],\n    onactivatefile: [null, Type.FUNCTION],\n    oninitfile: [null, Type.FUNCTION],\n    onaddfilestart: [null, Type.FUNCTION],\n    onaddfileprogress: [null, Type.FUNCTION],\n    onaddfile: [null, Type.FUNCTION],\n    onprocessfilestart: [null, Type.FUNCTION],\n    onprocessfileprogress: [null, Type.FUNCTION],\n    onprocessfileabort: [null, Type.FUNCTION],\n    onprocessfilerevert: [null, Type.FUNCTION],\n    onprocessfile: [null, Type.FUNCTION],\n    onprocessfiles: [null, Type.FUNCTION],\n    onremovefile: [null, Type.FUNCTION],\n    onpreparefile: [null, Type.FUNCTION],\n    onupdatefiles: [null, Type.FUNCTION],\n    onreorderfiles: [null, Type.FUNCTION],\n    // hooks\n    beforeDropFile: [null, Type.FUNCTION],\n    beforeAddFile: [null, Type.FUNCTION],\n    beforeRemoveFile: [null, Type.FUNCTION],\n    beforePrepareFile: [null, Type.FUNCTION],\n    // styles\n    stylePanelLayout: [null, Type.STRING],\n    // null 'integrated', 'compact', 'circle'\n    stylePanelAspectRatio: [null, Type.STRING],\n    // null or '3:2' or 1\n    styleItemPanelAspectRatio: [null, Type.STRING],\n    styleButtonRemoveItemPosition: ['left', Type.STRING],\n    styleButtonProcessItemPosition: ['right', Type.STRING],\n    styleLoadIndicatorPosition: ['right', Type.STRING],\n    styleProgressIndicatorPosition: ['right', Type.STRING],\n    styleButtonRemoveItemAlign: [false, Type.BOOLEAN],\n    // custom initial files array\n    files: [[], Type.ARRAY],\n    // show support by displaying credits\n    credits: [['https://pqina.nl/', 'Powered by PQINA'], Type.ARRAY]\n  };\n\n  var getItemByQuery = function getItemByQuery(items, query) {\n    // just return first index\n    if (isEmpty(query)) {\n      return items[0] || null;\n    } // query is index\n\n\n    if (isInt(query)) {\n      return items[query] || null;\n    } // if query is item, get the id\n\n\n    if (typeof query === 'object') {\n      query = query.id;\n    } // assume query is a string and return item by id\n\n\n    return items.find(function (item) {\n      return item.id === query;\n    }) || null;\n  };\n\n  var getNumericAspectRatioFromString = function getNumericAspectRatioFromString(aspectRatio) {\n    if (isEmpty(aspectRatio)) {\n      return aspectRatio;\n    }\n\n    if (/:/.test(aspectRatio)) {\n      var parts = aspectRatio.split(':');\n      return parts[1] / parts[0];\n    }\n\n    return parseFloat(aspectRatio);\n  };\n\n  var getActiveItems = function getActiveItems(items) {\n    return items.filter(function (item) {\n      return !item.archived;\n    });\n  };\n\n  var Status = {\n    EMPTY: 0,\n    IDLE: 1,\n    // waiting\n    ERROR: 2,\n    // a file is in error state\n    BUSY: 3,\n    // busy processing or loading\n    READY: 4 // all files uploaded\n\n  };\n  var res = null;\n\n  var canUpdateFileInput = function canUpdateFileInput() {\n    if (res === null) {\n      try {\n        var dataTransfer = new DataTransfer();\n        dataTransfer.items.add(new File(['hello world'], 'This_Works.txt'));\n        var el = document.createElement('input');\n        el.setAttribute('type', 'file');\n        el.files = dataTransfer.files;\n        res = el.files.length === 1;\n      } catch (err) {\n        res = false;\n      }\n    }\n\n    return res;\n  };\n\n  var ITEM_ERROR = [ItemStatus.LOAD_ERROR, ItemStatus.PROCESSING_ERROR, ItemStatus.PROCESSING_REVERT_ERROR];\n  var ITEM_BUSY = [ItemStatus.LOADING, ItemStatus.PROCESSING, ItemStatus.PROCESSING_QUEUED, ItemStatus.INIT];\n  var ITEM_READY = [ItemStatus.PROCESSING_COMPLETE];\n\n  var isItemInErrorState = function isItemInErrorState(item) {\n    return ITEM_ERROR.includes(item.status);\n  };\n\n  var isItemInBusyState = function isItemInBusyState(item) {\n    return ITEM_BUSY.includes(item.status);\n  };\n\n  var isItemInReadyState = function isItemInReadyState(item) {\n    return ITEM_READY.includes(item.status);\n  };\n\n  var isAsync = function isAsync(state) {\n    return isObject(state.options.server) && (isObject(state.options.server.process) || isFunction(state.options.server.process));\n  };\n\n  var queries = function queries(state) {\n    return {\n      GET_STATUS: function GET_STATUS() {\n        var items = getActiveItems(state.items);\n        var EMPTY = Status.EMPTY,\n            ERROR = Status.ERROR,\n            BUSY = Status.BUSY,\n            IDLE = Status.IDLE,\n            READY = Status.READY;\n        if (items.length === 0) return EMPTY;\n        if (items.some(isItemInErrorState)) return ERROR;\n        if (items.some(isItemInBusyState)) return BUSY;\n        if (items.some(isItemInReadyState)) return READY;\n        return IDLE;\n      },\n      GET_ITEM: function GET_ITEM(query) {\n        return getItemByQuery(state.items, query);\n      },\n      GET_ACTIVE_ITEM: function GET_ACTIVE_ITEM(query) {\n        return getItemByQuery(getActiveItems(state.items), query);\n      },\n      GET_ACTIVE_ITEMS: function GET_ACTIVE_ITEMS() {\n        return getActiveItems(state.items);\n      },\n      GET_ITEMS: function GET_ITEMS() {\n        return state.items;\n      },\n      GET_ITEM_NAME: function GET_ITEM_NAME(query) {\n        var item = getItemByQuery(state.items, query);\n        return item ? item.filename : null;\n      },\n      GET_ITEM_SIZE: function GET_ITEM_SIZE(query) {\n        var item = getItemByQuery(state.items, query);\n        return item ? item.fileSize : null;\n      },\n      GET_STYLES: function GET_STYLES() {\n        return Object.keys(state.options).filter(function (key) {\n          return /^style/.test(key);\n        }).map(function (option) {\n          return {\n            name: option,\n            value: state.options[option]\n          };\n        });\n      },\n      GET_PANEL_ASPECT_RATIO: function GET_PANEL_ASPECT_RATIO() {\n        var isShapeCircle = /circle/.test(state.options.stylePanelLayout);\n        var aspectRatio = isShapeCircle ? 1 : getNumericAspectRatioFromString(state.options.stylePanelAspectRatio);\n        return aspectRatio;\n      },\n      GET_ITEM_PANEL_ASPECT_RATIO: function GET_ITEM_PANEL_ASPECT_RATIO() {\n        return state.options.styleItemPanelAspectRatio;\n      },\n      GET_ITEMS_BY_STATUS: function GET_ITEMS_BY_STATUS(status) {\n        return getActiveItems(state.items).filter(function (item) {\n          return item.status === status;\n        });\n      },\n      GET_TOTAL_ITEMS: function GET_TOTAL_ITEMS() {\n        return getActiveItems(state.items).length;\n      },\n      SHOULD_UPDATE_FILE_INPUT: function SHOULD_UPDATE_FILE_INPUT() {\n        return state.options.storeAsFile && canUpdateFileInput() && !isAsync(state);\n      },\n      IS_ASYNC: function IS_ASYNC() {\n        return isAsync(state);\n      },\n      GET_FILE_SIZE_LABELS: function GET_FILE_SIZE_LABELS(query) {\n        return {\n          labelBytes: query('GET_LABEL_FILE_SIZE_BYTES') || undefined,\n          labelKilobytes: query('GET_LABEL_FILE_SIZE_KILOBYTES') || undefined,\n          labelMegabytes: query('GET_LABEL_FILE_SIZE_MEGABYTES') || undefined,\n          labelGigabytes: query('GET_LABEL_FILE_SIZE_GIGABYTES') || undefined\n        };\n      }\n    };\n  };\n\n  var hasRoomForItem = function hasRoomForItem(state) {\n    var count = getActiveItems(state.items).length; // if cannot have multiple items, to add one item it should currently not contain items\n\n    if (!state.options.allowMultiple) {\n      return count === 0;\n    } // if allows multiple items, we check if a max item count has been set, if not, there's no limit\n\n\n    var maxFileCount = state.options.maxFiles;\n\n    if (maxFileCount === null) {\n      return true;\n    } // we check if the current count is smaller than the max count, if so, another file can still be added\n\n\n    if (count < maxFileCount) {\n      return true;\n    } // no more room for another file\n\n\n    return false;\n  };\n\n  var limit = function limit(value, min, max) {\n    return Math.max(Math.min(max, value), min);\n  };\n\n  var arrayInsert = function arrayInsert(arr, index, item) {\n    return arr.splice(index, 0, item);\n  };\n\n  var insertItem = function insertItem(items, item, index) {\n    if (isEmpty(item)) {\n      return null;\n    } // if index is undefined, append\n\n\n    if (typeof index === 'undefined') {\n      items.push(item);\n      return item;\n    } // limit the index to the size of the items array\n\n\n    index = limit(index, 0, items.length); // add item to array\n\n    arrayInsert(items, index, item); // expose\n\n    return item;\n  };\n\n  var isBase64DataURI = function isBase64DataURI(str) {\n    return /^\\s*data:([a-z]+\\/[a-z0-9-+.]+(;[a-z-]+=[a-z0-9-]+)?)?(;base64)?,([a-z0-9!$&',()*+;=\\-._~:@\\/?%\\s]*)\\s*$/i.test(str);\n  };\n\n  var getFilenameFromURL = function getFilenameFromURL(url) {\n    return url.split('/').pop().split('?').shift();\n  };\n\n  var getExtensionFromFilename = function getExtensionFromFilename(name) {\n    return name.split('.').pop();\n  };\n\n  var guesstimateExtension = function guesstimateExtension(type) {\n    // if no extension supplied, exit here\n    if (typeof type !== 'string') {\n      return '';\n    } // get subtype\n\n\n    var subtype = type.split('/').pop(); // is svg subtype\n\n    if (/svg/.test(subtype)) {\n      return 'svg';\n    }\n\n    if (/zip|compressed/.test(subtype)) {\n      return 'zip';\n    }\n\n    if (/plain/.test(subtype)) {\n      return 'txt';\n    }\n\n    if (/msword/.test(subtype)) {\n      return 'doc';\n    } // if is valid subtype\n\n\n    if (/[a-z]+/.test(subtype)) {\n      // always use jpg extension\n      if (subtype === 'jpeg') {\n        return 'jpg';\n      } // return subtype\n\n\n      return subtype;\n    }\n\n    return '';\n  };\n\n  var leftPad = function leftPad(value) {\n    var padding = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : '';\n    return (padding + value).slice(-padding.length);\n  };\n\n  var getDateString = function getDateString() {\n    var date = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : new Date();\n    return date.getFullYear() + '-' + leftPad(date.getMonth() + 1, '00') + '-' + leftPad(date.getDate(), '00') + '_' + leftPad(date.getHours(), '00') + '-' + leftPad(date.getMinutes(), '00') + '-' + leftPad(date.getSeconds(), '00');\n  };\n\n  var getFileFromBlob = function getFileFromBlob(blob, filename) {\n    var type = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;\n    var extension = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : null;\n    var file = typeof type === 'string' ? blob.slice(0, blob.size, type) : blob.slice(0, blob.size, blob.type);\n    file.lastModifiedDate = new Date(); // copy relative path\n\n    if (blob._relativePath) file._relativePath = blob._relativePath; // if blob has name property, use as filename if no filename supplied\n\n    if (!isString(filename)) {\n      filename = getDateString();\n    } // if filename supplied but no extension and filename has extension\n\n\n    if (filename && extension === null && getExtensionFromFilename(filename)) {\n      file.name = filename;\n    } else {\n      extension = extension || guesstimateExtension(file.type);\n      file.name = filename + (extension ? '.' + extension : '');\n    }\n\n    return file;\n  };\n\n  var getBlobBuilder = function getBlobBuilder() {\n    return window.BlobBuilder = window.BlobBuilder || window.WebKitBlobBuilder || window.MozBlobBuilder || window.MSBlobBuilder;\n  };\n\n  var createBlob = function createBlob(arrayBuffer, mimeType) {\n    var BB = getBlobBuilder();\n\n    if (BB) {\n      var bb = new BB();\n      bb.append(arrayBuffer);\n      return bb.getBlob(mimeType);\n    }\n\n    return new Blob([arrayBuffer], {\n      type: mimeType\n    });\n  };\n\n  var getBlobFromByteStringWithMimeType = function getBlobFromByteStringWithMimeType(byteString, mimeType) {\n    var ab = new ArrayBuffer(byteString.length);\n    var ia = new Uint8Array(ab);\n\n    for (var i = 0; i < byteString.length; i++) {\n      ia[i] = byteString.charCodeAt(i);\n    }\n\n    return createBlob(ab, mimeType);\n  };\n\n  var getMimeTypeFromBase64DataURI = function getMimeTypeFromBase64DataURI(dataURI) {\n    return (/^data:(.+);/.exec(dataURI) || [])[1] || null;\n  };\n\n  var getBase64DataFromBase64DataURI = function getBase64DataFromBase64DataURI(dataURI) {\n    // get data part of string (remove data:image/jpeg...,)\n    var data = dataURI.split(',')[1]; // remove any whitespace as that causes InvalidCharacterError in IE\n\n    return data.replace(/\\s/g, '');\n  };\n\n  var getByteStringFromBase64DataURI = function getByteStringFromBase64DataURI(dataURI) {\n    return atob(getBase64DataFromBase64DataURI(dataURI));\n  };\n\n  var getBlobFromBase64DataURI = function getBlobFromBase64DataURI(dataURI) {\n    var mimeType = getMimeTypeFromBase64DataURI(dataURI);\n    var byteString = getByteStringFromBase64DataURI(dataURI);\n    return getBlobFromByteStringWithMimeType(byteString, mimeType);\n  };\n\n  var getFileFromBase64DataURI = function getFileFromBase64DataURI(dataURI, filename, extension) {\n    return getFileFromBlob(getBlobFromBase64DataURI(dataURI), filename, null, extension);\n  };\n\n  var getFileNameFromHeader = function getFileNameFromHeader(header) {\n    // test if is content disposition header, if not exit\n    if (!/^content-disposition:/i.test(header)) return null; // get filename parts\n\n    var matches = header.split(/filename=|filename\\*=.+''/).splice(1).map(function (name) {\n      return name.trim().replace(/^[\"']|[;\"']{0,2}$/g, '');\n    }).filter(function (name) {\n      return name.length;\n    });\n    return matches.length ? decodeURI(matches[matches.length - 1]) : null;\n  };\n\n  var getFileSizeFromHeader = function getFileSizeFromHeader(header) {\n    if (/content-length:/i.test(header)) {\n      var size = header.match(/[0-9]+/)[0];\n      return size ? parseInt(size, 10) : null;\n    }\n\n    return null;\n  };\n\n  var getTranfserIdFromHeader = function getTranfserIdFromHeader(header) {\n    if (/x-content-transfer-id:/i.test(header)) {\n      var id = (header.split(':')[1] || '').trim();\n      return id || null;\n    }\n\n    return null;\n  };\n\n  var getFileInfoFromHeaders = function getFileInfoFromHeaders(headers) {\n    var info = {\n      source: null,\n      name: null,\n      size: null\n    };\n    var rows = headers.split('\\n');\n    var _iteratorNormalCompletion = true;\n    var _didIteratorError = false;\n    var _iteratorError = undefined;\n\n    try {\n      for (var _iterator = rows[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n        var header = _step.value;\n        var name = getFileNameFromHeader(header);\n\n        if (name) {\n          info.name = name;\n          continue;\n        }\n\n        var size = getFileSizeFromHeader(header);\n\n        if (size) {\n          info.size = size;\n          continue;\n        }\n\n        var source = getTranfserIdFromHeader(header);\n\n        if (source) {\n          info.source = source;\n          continue;\n        }\n      }\n    } catch (err) {\n      _didIteratorError = true;\n      _iteratorError = err;\n    } finally {\n      try {\n        if (!_iteratorNormalCompletion && _iterator.return != null) {\n          _iterator.return();\n        }\n      } finally {\n        if (_didIteratorError) {\n          throw _iteratorError;\n        }\n      }\n    }\n\n    return info;\n  };\n\n  var createFileLoader = function createFileLoader(fetchFn) {\n    var state = {\n      source: null,\n      complete: false,\n      progress: 0,\n      size: null,\n      timestamp: null,\n      duration: 0,\n      request: null\n    };\n\n    var getProgress = function getProgress() {\n      return state.progress;\n    };\n\n    var abort = function abort() {\n      if (state.request && state.request.abort) {\n        state.request.abort();\n      }\n    }; // load source\n\n\n    var load = function load() {\n      // get quick reference\n      var source = state.source;\n      api.fire('init', source); // Load Files\n\n      if (source instanceof File) {\n        api.fire('load', source);\n      } else if (source instanceof Blob) {\n        // Load blobs, set default name to current date\n        api.fire('load', getFileFromBlob(source, source.name));\n      } else if (isBase64DataURI(source)) {\n        // Load base 64, set default name to current date\n        api.fire('load', getFileFromBase64DataURI(source));\n      } else {\n        // Deal as if is external URL, let's load it!\n        loadURL(source);\n      }\n    }; // loads a url\n\n\n    var loadURL = function loadURL(url) {\n      // is remote url and no fetch method supplied\n      if (!fetchFn) {\n        api.fire('error', {\n          type: 'error',\n          body: \"Can't load URL\",\n          code: 400\n        });\n        return;\n      } // set request start\n\n\n      state.timestamp = Date.now(); // load file\n\n      state.request = fetchFn(url, function (response) {\n        // update duration\n        state.duration = Date.now() - state.timestamp; // done!\n\n        state.complete = true; // turn blob response into a file\n\n        if (response instanceof Blob) {\n          response = getFileFromBlob(response, response.name || getFilenameFromURL(url));\n        }\n\n        api.fire('load', // if has received blob, we go with blob, if no response, we return null\n        response instanceof Blob ? response : response ? response.body : null);\n      }, function (error) {\n        api.fire('error', typeof error === 'string' ? {\n          type: 'error',\n          code: 0,\n          body: error\n        } : error);\n      }, function (computable, current, total) {\n        // collected some meta data already\n        if (total) {\n          state.size = total;\n        } // update duration\n\n\n        state.duration = Date.now() - state.timestamp; // if we can't compute progress, we're not going to fire progress events\n\n        if (!computable) {\n          state.progress = null;\n          return;\n        } // update progress percentage\n\n\n        state.progress = current / total; // expose\n\n        api.fire('progress', state.progress);\n      }, function () {\n        api.fire('abort');\n      }, function (response) {\n        var fileinfo = getFileInfoFromHeaders(typeof response === 'string' ? response : response.headers);\n        api.fire('meta', {\n          size: state.size || fileinfo.size,\n          filename: fileinfo.name,\n          source: fileinfo.source\n        });\n      });\n    };\n\n    var api = Object.assign({}, on(), {\n      setSource: function setSource(source) {\n        return state.source = source;\n      },\n      getProgress: getProgress,\n      // file load progress\n      abort: abort,\n      // abort file load\n      load: load // start load\n\n    });\n    return api;\n  };\n\n  var isGet = function isGet(method) {\n    return /GET|HEAD/.test(method);\n  };\n\n  var sendRequest = function sendRequest(data, url, options) {\n    var api = {\n      onheaders: function onheaders() {},\n      onprogress: function onprogress() {},\n      onload: function onload() {},\n      ontimeout: function ontimeout() {},\n      onerror: function onerror() {},\n      onabort: function onabort() {},\n      abort: function abort() {\n        aborted = true;\n        xhr.abort();\n      }\n    }; // timeout identifier, only used when timeout is defined\n\n    var aborted = false;\n    var headersReceived = false; // set default options\n\n    options = Object.assign({\n      method: 'POST',\n      headers: {},\n      withCredentials: false\n    }, options); // encode url\n\n    url = encodeURI(url); // if method is GET, add any received data to url\n\n    if (isGet(options.method) && data) {\n      url = '' + url + encodeURIComponent(typeof data === 'string' ? data : JSON.stringify(data));\n    } // create request\n\n\n    var xhr = new XMLHttpRequest(); // progress of load\n\n    var process = isGet(options.method) ? xhr : xhr.upload;\n\n    process.onprogress = function (e) {\n      // no progress event when aborted ( onprogress is called once after abort() )\n      if (aborted) {\n        return;\n      }\n\n      api.onprogress(e.lengthComputable, e.loaded, e.total);\n    }; // tries to get header info to the app as fast as possible\n\n\n    xhr.onreadystatechange = function () {\n      // not interesting in these states ('unsent' and 'openend' as they don't give us any additional info)\n      if (xhr.readyState < 2) {\n        return;\n      } // no server response\n\n\n      if (xhr.readyState === 4 && xhr.status === 0) {\n        return;\n      }\n\n      if (headersReceived) {\n        return;\n      }\n\n      headersReceived = true; // we've probably received some useful data in response headers\n\n      api.onheaders(xhr);\n    }; // load successful\n\n\n    xhr.onload = function () {\n      // is classified as valid response\n      if (xhr.status >= 200 && xhr.status < 300) {\n        api.onload(xhr);\n      } else {\n        api.onerror(xhr);\n      }\n    }; // error during load\n\n\n    xhr.onerror = function () {\n      return api.onerror(xhr);\n    }; // request aborted\n\n\n    xhr.onabort = function () {\n      aborted = true;\n      api.onabort();\n    }; // request timeout\n\n\n    xhr.ontimeout = function () {\n      return api.ontimeout(xhr);\n    }; // open up open up!\n\n\n    xhr.open(options.method, url, true); // set timeout if defined (do it after open so IE11 plays ball)\n\n    if (isInt(options.timeout)) {\n      xhr.timeout = options.timeout;\n    } // add headers\n\n\n    Object.keys(options.headers).forEach(function (key) {\n      var value = unescape(encodeURIComponent(options.headers[key]));\n      xhr.setRequestHeader(key, value);\n    }); // set type of response\n\n    if (options.responseType) {\n      xhr.responseType = options.responseType;\n    } // set credentials\n\n\n    if (options.withCredentials) {\n      xhr.withCredentials = true;\n    } // let's send our data\n\n\n    xhr.send(data);\n    return api;\n  };\n\n  var createResponse = function createResponse(type, code, body, headers) {\n    return {\n      type: type,\n      code: code,\n      body: body,\n      headers: headers\n    };\n  };\n\n  var createTimeoutResponse = function createTimeoutResponse(cb) {\n    return function (xhr) {\n      cb(createResponse('error', 0, 'Timeout', xhr.getAllResponseHeaders()));\n    };\n  };\n\n  var hasQS = function hasQS(str) {\n    return /\\?/.test(str);\n  };\n\n  var buildURL = function buildURL() {\n    var url = '';\n\n    for (var _len = arguments.length, parts = new Array(_len), _key = 0; _key < _len; _key++) {\n      parts[_key] = arguments[_key];\n    }\n\n    parts.forEach(function (part) {\n      url += hasQS(url) && hasQS(part) ? part.replace(/\\?/, '&') : part;\n    });\n    return url;\n  };\n\n  var createFetchFunction = function createFetchFunction() {\n    var apiUrl = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '';\n    var action = arguments.length > 1 ? arguments[1] : undefined; // custom handler (should also handle file, load, error, progress and abort)\n\n    if (typeof action === 'function') {\n      return action;\n    } // no action supplied\n\n\n    if (!action || !isString(action.url)) {\n      return null;\n    } // set onload hanlder\n\n\n    var onload = action.onload || function (res) {\n      return res;\n    };\n\n    var onerror = action.onerror || function (res) {\n      return null;\n    }; // internal handler\n\n\n    return function (url, load, error, progress, abort, headers) {\n      // do local or remote request based on if the url is external\n      var request = sendRequest(url, buildURL(apiUrl, action.url), Object.assign({}, action, {\n        responseType: 'blob'\n      }));\n\n      request.onload = function (xhr) {\n        // get headers\n        var headers = xhr.getAllResponseHeaders(); // get filename\n\n        var filename = getFileInfoFromHeaders(headers).name || getFilenameFromURL(url); // create response\n\n        load(createResponse('load', xhr.status, action.method === 'HEAD' ? null : getFileFromBlob(onload(xhr.response), filename), headers));\n      };\n\n      request.onerror = function (xhr) {\n        error(createResponse('error', xhr.status, onerror(xhr.response) || xhr.statusText, xhr.getAllResponseHeaders()));\n      };\n\n      request.onheaders = function (xhr) {\n        headers(createResponse('headers', xhr.status, null, xhr.getAllResponseHeaders()));\n      };\n\n      request.ontimeout = createTimeoutResponse(error);\n      request.onprogress = progress;\n      request.onabort = abort; // should return request\n\n      return request;\n    };\n  };\n\n  var ChunkStatus = {\n    QUEUED: 0,\n    COMPLETE: 1,\n    PROCESSING: 2,\n    ERROR: 3,\n    WAITING: 4\n  };\n  /*\n                                                     function signature:\n                                                       (file, metadata, load, error, progress, abort, transfer, options) => {\n                                                         return {\n                                                         abort:() => {}\n                                                       }\n                                                     }\n                                                     */\n  // apiUrl, action, name, file, metadata, load, error, progress, abort, transfer, options\n\n  var processFileChunked = function processFileChunked(apiUrl, action, name, file, metadata, load, error, progress, abort, transfer, options) {\n    // all chunks\n    var chunks = [];\n    var chunkTransferId = options.chunkTransferId,\n        chunkServer = options.chunkServer,\n        chunkSize = options.chunkSize,\n        chunkRetryDelays = options.chunkRetryDelays; // default state\n\n    var state = {\n      serverId: chunkTransferId,\n      aborted: false\n    }; // set onload handlers\n\n    var ondata = action.ondata || function (fd) {\n      return fd;\n    };\n\n    var onload = action.onload || function (xhr, method) {\n      return method === 'HEAD' ? xhr.getResponseHeader('Upload-Offset') : xhr.response;\n    };\n\n    var onerror = action.onerror || function (res) {\n      return null;\n    }; // create server hook\n\n\n    var requestTransferId = function requestTransferId(cb) {\n      var formData = new FormData(); // add metadata under same name\n\n      if (isObject(metadata)) formData.append(name, JSON.stringify(metadata));\n      var headers = typeof action.headers === 'function' ? action.headers(file, metadata) : Object.assign({}, action.headers, {\n        'Upload-Length': file.size\n      });\n      var requestParams = Object.assign({}, action, {\n        headers: headers\n      }); // send request object\n\n      var request = sendRequest(ondata(formData), buildURL(apiUrl, action.url), requestParams);\n\n      request.onload = function (xhr) {\n        return cb(onload(xhr, requestParams.method));\n      };\n\n      request.onerror = function (xhr) {\n        return error(createResponse('error', xhr.status, onerror(xhr.response) || xhr.statusText, xhr.getAllResponseHeaders()));\n      };\n\n      request.ontimeout = createTimeoutResponse(error);\n    };\n\n    var requestTransferOffset = function requestTransferOffset(cb) {\n      var requestUrl = buildURL(apiUrl, chunkServer.url, state.serverId);\n      var headers = typeof action.headers === 'function' ? action.headers(state.serverId) : Object.assign({}, action.headers);\n      var requestParams = {\n        headers: headers,\n        method: 'HEAD'\n      };\n      var request = sendRequest(null, requestUrl, requestParams);\n\n      request.onload = function (xhr) {\n        return cb(onload(xhr, requestParams.method));\n      };\n\n      request.onerror = function (xhr) {\n        return error(createResponse('error', xhr.status, onerror(xhr.response) || xhr.statusText, xhr.getAllResponseHeaders()));\n      };\n\n      request.ontimeout = createTimeoutResponse(error);\n    }; // create chunks\n\n\n    var lastChunkIndex = Math.floor(file.size / chunkSize);\n\n    for (var i = 0; i <= lastChunkIndex; i++) {\n      var offset = i * chunkSize;\n      var data = file.slice(offset, offset + chunkSize, 'application/offset+octet-stream');\n      chunks[i] = {\n        index: i,\n        size: data.size,\n        offset: offset,\n        data: data,\n        file: file,\n        progress: 0,\n        retries: _toConsumableArray(chunkRetryDelays),\n        status: ChunkStatus.QUEUED,\n        error: null,\n        request: null,\n        timeout: null\n      };\n    }\n\n    var completeProcessingChunks = function completeProcessingChunks() {\n      return load(state.serverId);\n    };\n\n    var canProcessChunk = function canProcessChunk(chunk) {\n      return chunk.status === ChunkStatus.QUEUED || chunk.status === ChunkStatus.ERROR;\n    };\n\n    var processChunk = function processChunk(chunk) {\n      // processing is paused, wait here\n      if (state.aborted) return; // get next chunk to process\n\n      chunk = chunk || chunks.find(canProcessChunk); // no more chunks to process\n\n      if (!chunk) {\n        // all done?\n        if (chunks.every(function (chunk) {\n          return chunk.status === ChunkStatus.COMPLETE;\n        })) {\n          completeProcessingChunks();\n        } // no chunk to handle\n\n\n        return;\n      } // now processing this chunk\n\n\n      chunk.status = ChunkStatus.PROCESSING;\n      chunk.progress = null; // allow parsing of formdata\n\n      var ondata = chunkServer.ondata || function (fd) {\n        return fd;\n      };\n\n      var onerror = chunkServer.onerror || function (res) {\n        return null;\n      }; // send request object\n\n\n      var requestUrl = buildURL(apiUrl, chunkServer.url, state.serverId);\n      var headers = typeof chunkServer.headers === 'function' ? chunkServer.headers(chunk) : Object.assign({}, chunkServer.headers, {\n        'Content-Type': 'application/offset+octet-stream',\n        'Upload-Offset': chunk.offset,\n        'Upload-Length': file.size,\n        'Upload-Name': file.name\n      });\n      var request = chunk.request = sendRequest(ondata(chunk.data), requestUrl, Object.assign({}, chunkServer, {\n        headers: headers\n      }));\n\n      request.onload = function () {\n        // done!\n        chunk.status = ChunkStatus.COMPLETE; // remove request reference\n\n        chunk.request = null; // start processing more chunks\n\n        processChunks();\n      };\n\n      request.onprogress = function (lengthComputable, loaded, total) {\n        chunk.progress = lengthComputable ? loaded : null;\n        updateTotalProgress();\n      };\n\n      request.onerror = function (xhr) {\n        chunk.status = ChunkStatus.ERROR;\n        chunk.request = null;\n        chunk.error = onerror(xhr.response) || xhr.statusText;\n\n        if (!retryProcessChunk(chunk)) {\n          error(createResponse('error', xhr.status, onerror(xhr.response) || xhr.statusText, xhr.getAllResponseHeaders()));\n        }\n      };\n\n      request.ontimeout = function (xhr) {\n        chunk.status = ChunkStatus.ERROR;\n        chunk.request = null;\n\n        if (!retryProcessChunk(chunk)) {\n          createTimeoutResponse(error)(xhr);\n        }\n      };\n\n      request.onabort = function () {\n        chunk.status = ChunkStatus.QUEUED;\n        chunk.request = null;\n        abort();\n      };\n    };\n\n    var retryProcessChunk = function retryProcessChunk(chunk) {\n      // no more retries left\n      if (chunk.retries.length === 0) return false; // new retry\n\n      chunk.status = ChunkStatus.WAITING;\n      clearTimeout(chunk.timeout);\n      chunk.timeout = setTimeout(function () {\n        processChunk(chunk);\n      }, chunk.retries.shift()); // we're going to retry\n\n      return true;\n    };\n\n    var updateTotalProgress = function updateTotalProgress() {\n      // calculate total progress fraction\n      var totalBytesTransfered = chunks.reduce(function (p, chunk) {\n        if (p === null || chunk.progress === null) return null;\n        return p + chunk.progress;\n      }, 0); // can't compute progress\n\n      if (totalBytesTransfered === null) return progress(false, 0, 0); // calculate progress values\n\n      var totalSize = chunks.reduce(function (total, chunk) {\n        return total + chunk.size;\n      }, 0); // can update progress indicator\n\n      progress(true, totalBytesTransfered, totalSize);\n    }; // process new chunks\n\n\n    var processChunks = function processChunks() {\n      var totalProcessing = chunks.filter(function (chunk) {\n        return chunk.status === ChunkStatus.PROCESSING;\n      }).length;\n      if (totalProcessing >= 1) return;\n      processChunk();\n    };\n\n    var abortChunks = function abortChunks() {\n      chunks.forEach(function (chunk) {\n        clearTimeout(chunk.timeout);\n\n        if (chunk.request) {\n          chunk.request.abort();\n        }\n      });\n    }; // let's go!\n\n\n    if (!state.serverId) {\n      requestTransferId(function (serverId) {\n        // stop here if aborted, might have happened in between request and callback\n        if (state.aborted) return; // pass back to item so we can use it if something goes wrong\n\n        transfer(serverId); // store internally\n\n        state.serverId = serverId;\n        processChunks();\n      });\n    } else {\n      requestTransferOffset(function (offset) {\n        // stop here if aborted, might have happened in between request and callback\n        if (state.aborted) return; // mark chunks with lower offset as complete\n\n        chunks.filter(function (chunk) {\n          return chunk.offset < offset;\n        }).forEach(function (chunk) {\n          chunk.status = ChunkStatus.COMPLETE;\n          chunk.progress = chunk.size;\n        }); // continue processing\n\n        processChunks();\n      });\n    }\n\n    return {\n      abort: function abort() {\n        state.aborted = true;\n        abortChunks();\n      }\n    };\n  };\n  /*\n                                                             function signature:\n                                                               (file, metadata, load, error, progress, abort) => {\n                                                                 return {\n                                                                 abort:() => {}\n                                                               }\n                                                             }\n                                                             */\n\n\n  var createFileProcessorFunction = function createFileProcessorFunction(apiUrl, action, name, options) {\n    return function (file, metadata, load, error, progress, abort, transfer) {\n      // no file received\n      if (!file) return; // if was passed a file, and we can chunk it, exit here\n\n      var canChunkUpload = options.chunkUploads;\n      var shouldChunkUpload = canChunkUpload && file.size > options.chunkSize;\n      var willChunkUpload = canChunkUpload && (shouldChunkUpload || options.chunkForce);\n      if (file instanceof Blob && willChunkUpload) return processFileChunked(apiUrl, action, name, file, metadata, load, error, progress, abort, transfer, options); // set handlers\n\n      var ondata = action.ondata || function (fd) {\n        return fd;\n      };\n\n      var onload = action.onload || function (res) {\n        return res;\n      };\n\n      var onerror = action.onerror || function (res) {\n        return null;\n      };\n\n      var headers = typeof action.headers === 'function' ? action.headers(file, metadata) || {} : Object.assign({}, action.headers);\n      var requestParams = Object.assign({}, action, {\n        headers: headers\n      }); // create formdata object\n\n      var formData = new FormData(); // add metadata under same name\n\n      if (isObject(metadata)) {\n        formData.append(name, JSON.stringify(metadata));\n      } // Turn into an array of objects so no matter what the input, we can handle it the same way\n\n\n      (file instanceof Blob ? [{\n        name: null,\n        file: file\n      }] : file).forEach(function (item) {\n        formData.append(name, item.file, item.name === null ? item.file.name : '' + item.name + item.file.name);\n      }); // send request object\n\n      var request = sendRequest(ondata(formData), buildURL(apiUrl, action.url), requestParams);\n\n      request.onload = function (xhr) {\n        load(createResponse('load', xhr.status, onload(xhr.response), xhr.getAllResponseHeaders()));\n      };\n\n      request.onerror = function (xhr) {\n        error(createResponse('error', xhr.status, onerror(xhr.response) || xhr.statusText, xhr.getAllResponseHeaders()));\n      };\n\n      request.ontimeout = createTimeoutResponse(error);\n      request.onprogress = progress;\n      request.onabort = abort; // should return request\n\n      return request;\n    };\n  };\n\n  var createProcessorFunction = function createProcessorFunction() {\n    var apiUrl = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '';\n    var action = arguments.length > 1 ? arguments[1] : undefined;\n    var name = arguments.length > 2 ? arguments[2] : undefined;\n    var options = arguments.length > 3 ? arguments[3] : undefined; // custom handler (should also handle file, load, error, progress and abort)\n\n    if (typeof action === 'function') return function () {\n      for (var _len = arguments.length, params = new Array(_len), _key = 0; _key < _len; _key++) {\n        params[_key] = arguments[_key];\n      }\n\n      return action.apply(void 0, [name].concat(params, [options]));\n    }; // no action supplied\n\n    if (!action || !isString(action.url)) return null; // internal handler\n\n    return createFileProcessorFunction(apiUrl, action, name, options);\n  };\n  /*\n                                                    function signature:\n                                                    (uniqueFileId, load, error) => { }\n                                                    */\n\n\n  var createRevertFunction = function createRevertFunction() {\n    var apiUrl = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '';\n    var action = arguments.length > 1 ? arguments[1] : undefined; // is custom implementation\n\n    if (typeof action === 'function') {\n      return action;\n    } // no action supplied, return stub function, interface will work, but file won't be removed\n\n\n    if (!action || !isString(action.url)) {\n      return function (uniqueFileId, load) {\n        return load();\n      };\n    } // set onload hanlder\n\n\n    var onload = action.onload || function (res) {\n      return res;\n    };\n\n    var onerror = action.onerror || function (res) {\n      return null;\n    }; // internal implementation\n\n\n    return function (uniqueFileId, load, error) {\n      var request = sendRequest(uniqueFileId, apiUrl + action.url, action // contains method, headers and withCredentials properties\n      );\n\n      request.onload = function (xhr) {\n        load(createResponse('load', xhr.status, onload(xhr.response), xhr.getAllResponseHeaders()));\n      };\n\n      request.onerror = function (xhr) {\n        error(createResponse('error', xhr.status, onerror(xhr.response) || xhr.statusText, xhr.getAllResponseHeaders()));\n      };\n\n      request.ontimeout = createTimeoutResponse(error);\n      return request;\n    };\n  };\n\n  var getRandomNumber = function getRandomNumber() {\n    var min = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;\n    var max = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 1;\n    return min + Math.random() * (max - min);\n  };\n\n  var createPerceivedPerformanceUpdater = function createPerceivedPerformanceUpdater(cb) {\n    var duration = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 1000;\n    var offset = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 0;\n    var tickMin = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 25;\n    var tickMax = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : 250;\n    var timeout = null;\n    var start = Date.now();\n\n    var tick = function tick() {\n      var runtime = Date.now() - start;\n      var delay = getRandomNumber(tickMin, tickMax);\n\n      if (runtime + delay > duration) {\n        delay = runtime + delay - duration;\n      }\n\n      var progress = runtime / duration;\n\n      if (progress >= 1 || document.hidden) {\n        cb(1);\n        return;\n      }\n\n      cb(progress);\n      timeout = setTimeout(tick, delay);\n    };\n\n    if (duration > 0) tick();\n    return {\n      clear: function clear() {\n        clearTimeout(timeout);\n      }\n    };\n  };\n\n  var createFileProcessor = function createFileProcessor(processFn, options) {\n    var state = {\n      complete: false,\n      perceivedProgress: 0,\n      perceivedPerformanceUpdater: null,\n      progress: null,\n      timestamp: null,\n      perceivedDuration: 0,\n      duration: 0,\n      request: null,\n      response: null\n    };\n    var allowMinimumUploadDuration = options.allowMinimumUploadDuration;\n\n    var process = function process(file, metadata) {\n      var progressFn = function progressFn() {\n        // we've not yet started the real download, stop here\n        // the request might not go through, for instance, there might be some server trouble\n        // if state.progress is null, the server does not allow computing progress and we show the spinner instead\n        if (state.duration === 0 || state.progress === null) return; // as we're now processing, fire the progress event\n\n        api.fire('progress', api.getProgress());\n      };\n\n      var completeFn = function completeFn() {\n        state.complete = true;\n        api.fire('load-perceived', state.response.body);\n      }; // let's start processing\n\n\n      api.fire('start'); // set request start\n\n      state.timestamp = Date.now(); // create perceived performance progress indicator\n\n      state.perceivedPerformanceUpdater = createPerceivedPerformanceUpdater(function (progress) {\n        state.perceivedProgress = progress;\n        state.perceivedDuration = Date.now() - state.timestamp;\n        progressFn(); // if fake progress is done, and a response has been received,\n        // and we've not yet called the complete method\n\n        if (state.response && state.perceivedProgress === 1 && !state.complete) {\n          // we done!\n          completeFn();\n        }\n      }, // random delay as in a list of files you start noticing\n      // files uploading at the exact same speed\n      allowMinimumUploadDuration ? getRandomNumber(750, 1500) : 0); // remember request so we can abort it later\n\n      state.request = processFn( // the file to process\n      file, // the metadata to send along\n      metadata, // callbacks (load, error, progress, abort, transfer)\n      // load expects the body to be a server id if\n      // you want to make use of revert\n      function (response) {\n        // we put the response in state so we can access\n        // it outside of this method\n        state.response = isObject(response) ? response : {\n          type: 'load',\n          code: 200,\n          body: '' + response,\n          headers: {}\n        }; // update duration\n\n        state.duration = Date.now() - state.timestamp; // force progress to 1 as we're now done\n\n        state.progress = 1; // actual load is done let's share results\n\n        api.fire('load', state.response.body); // we are really done\n        // if perceived progress is 1 ( wait for perceived progress to complete )\n        // or if server does not support progress ( null )\n\n        if (!allowMinimumUploadDuration || allowMinimumUploadDuration && state.perceivedProgress === 1) {\n          completeFn();\n        }\n      }, // error is expected to be an object with type, code, body\n      function (error) {\n        // cancel updater\n        state.perceivedPerformanceUpdater.clear(); // update others about this error\n\n        api.fire('error', isObject(error) ? error : {\n          type: 'error',\n          code: 0,\n          body: '' + error\n        });\n      }, // actual processing progress\n      function (computable, current, total) {\n        // update actual duration\n        state.duration = Date.now() - state.timestamp; // update actual progress\n\n        state.progress = computable ? current / total : null;\n        progressFn();\n      }, // abort does not expect a value\n      function () {\n        // stop updater\n        state.perceivedPerformanceUpdater.clear(); // fire the abort event so we can switch visuals\n\n        api.fire('abort', state.response ? state.response.body : null);\n      }, // register the id for this transfer\n      function (transferId) {\n        api.fire('transfer', transferId);\n      });\n    };\n\n    var abort = function abort() {\n      // no request running, can't abort\n      if (!state.request) return; // stop updater\n\n      state.perceivedPerformanceUpdater.clear(); // abort actual request\n\n      if (state.request.abort) state.request.abort(); // if has response object, we've completed the request\n\n      state.complete = true;\n    };\n\n    var reset = function reset() {\n      abort();\n      state.complete = false;\n      state.perceivedProgress = 0;\n      state.progress = 0;\n      state.timestamp = null;\n      state.perceivedDuration = 0;\n      state.duration = 0;\n      state.request = null;\n      state.response = null;\n    };\n\n    var getProgress = allowMinimumUploadDuration ? function () {\n      return state.progress ? Math.min(state.progress, state.perceivedProgress) : null;\n    } : function () {\n      return state.progress || null;\n    };\n    var getDuration = allowMinimumUploadDuration ? function () {\n      return Math.min(state.duration, state.perceivedDuration);\n    } : function () {\n      return state.duration;\n    };\n    var api = Object.assign({}, on(), {\n      process: process,\n      // start processing file\n      abort: abort,\n      // abort active process request\n      getProgress: getProgress,\n      getDuration: getDuration,\n      reset: reset\n    });\n    return api;\n  };\n\n  var getFilenameWithoutExtension = function getFilenameWithoutExtension(name) {\n    return name.substr(0, name.lastIndexOf('.')) || name;\n  };\n\n  var createFileStub = function createFileStub(source) {\n    var data = [source.name, source.size, source.type]; // is blob or base64, then we need to set the name\n\n    if (source instanceof Blob || isBase64DataURI(source)) {\n      data[0] = source.name || getDateString();\n    } else if (isBase64DataURI(source)) {\n      // if is base64 data uri we need to determine the average size and type\n      data[1] = source.length;\n      data[2] = getMimeTypeFromBase64DataURI(source);\n    } else if (isString(source)) {\n      // url\n      data[0] = getFilenameFromURL(source);\n      data[1] = 0;\n      data[2] = 'application/octet-stream';\n    }\n\n    return {\n      name: data[0],\n      size: data[1],\n      type: data[2]\n    };\n  };\n\n  var isFile = function isFile(value) {\n    return !!(value instanceof File || value instanceof Blob && value.name);\n  };\n\n  var deepCloneObject = function deepCloneObject(src) {\n    if (!isObject(src)) return src;\n    var target = isArray(src) ? [] : {};\n\n    for (var key in src) {\n      if (!src.hasOwnProperty(key)) continue;\n      var v = src[key];\n      target[key] = v && isObject(v) ? deepCloneObject(v) : v;\n    }\n\n    return target;\n  };\n\n  var createItem = function createItem() {\n    var origin = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : null;\n    var serverFileReference = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;\n    var file = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null; // unique id for this item, is used to identify the item across views\n\n    var id = getUniqueId();\n    /**\n     * Internal item state\n     */\n\n    var state = {\n      // is archived\n      archived: false,\n      // if is frozen, no longer fires events\n      frozen: false,\n      // removed from view\n      released: false,\n      // original source\n      source: null,\n      // file model reference\n      file: file,\n      // id of file on server\n      serverFileReference: serverFileReference,\n      // id of file transfer on server\n      transferId: null,\n      // is aborted\n      processingAborted: false,\n      // current item status\n      status: serverFileReference ? ItemStatus.PROCESSING_COMPLETE : ItemStatus.INIT,\n      // active processes\n      activeLoader: null,\n      activeProcessor: null\n    }; // callback used when abort processing is called to link back to the resolve method\n\n    var abortProcessingRequestComplete = null;\n    /**\n     * Externally added item metadata\n     */\n\n    var metadata = {}; // item data\n\n    var setStatus = function setStatus(status) {\n      return state.status = status;\n    }; // fire event unless the item has been archived\n\n\n    var fire = function fire(event) {\n      if (state.released || state.frozen) return;\n\n      for (var _len = arguments.length, params = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n        params[_key - 1] = arguments[_key];\n      }\n\n      api.fire.apply(api, [event].concat(params));\n    }; // file data\n\n\n    var getFileExtension = function getFileExtension() {\n      return getExtensionFromFilename(state.file.name);\n    };\n\n    var getFileType = function getFileType() {\n      return state.file.type;\n    };\n\n    var getFileSize = function getFileSize() {\n      return state.file.size;\n    };\n\n    var getFile = function getFile() {\n      return state.file;\n    }; //\n    // logic to load a file\n    //\n\n\n    var load = function load(source, loader, onload) {\n      // remember the original item source\n      state.source = source; // source is known\n\n      api.fireSync('init'); // file stub is already there\n\n      if (state.file) {\n        api.fireSync('load-skip');\n        return;\n      } // set a stub file object while loading the actual data\n\n\n      state.file = createFileStub(source); // starts loading\n\n      loader.on('init', function () {\n        fire('load-init');\n      }); // we'eve received a size indication, let's update the stub\n\n      loader.on('meta', function (meta) {\n        // set size of file stub\n        state.file.size = meta.size; // set name of file stub\n\n        state.file.filename = meta.filename; // if has received source, we done\n\n        if (meta.source) {\n          origin = FileOrigin.LIMBO;\n          state.serverFileReference = meta.source;\n          state.status = ItemStatus.PROCESSING_COMPLETE;\n        } // size has been updated\n\n\n        fire('load-meta');\n      }); // the file is now loading we need to update the progress indicators\n\n      loader.on('progress', function (progress) {\n        setStatus(ItemStatus.LOADING);\n        fire('load-progress', progress);\n      }); // an error was thrown while loading the file, we need to switch to error state\n\n      loader.on('error', function (error) {\n        setStatus(ItemStatus.LOAD_ERROR);\n        fire('load-request-error', error);\n      }); // user or another process aborted the file load (cannot retry)\n\n      loader.on('abort', function () {\n        setStatus(ItemStatus.INIT);\n        fire('load-abort');\n      }); // done loading\n\n      loader.on('load', function (file) {\n        // as we've now loaded the file the loader is no longer required\n        state.activeLoader = null; // called when file has loaded succesfully\n\n        var success = function success(result) {\n          // set (possibly) transformed file\n          state.file = isFile(result) ? result : state.file; // file received\n\n          if (origin === FileOrigin.LIMBO && state.serverFileReference) {\n            setStatus(ItemStatus.PROCESSING_COMPLETE);\n          } else {\n            setStatus(ItemStatus.IDLE);\n          }\n\n          fire('load');\n        };\n\n        var error = function error(result) {\n          // set original file\n          state.file = file;\n          fire('load-meta');\n          setStatus(ItemStatus.LOAD_ERROR);\n          fire('load-file-error', result);\n        }; // if we already have a server file reference, we don't need to call the onload method\n\n\n        if (state.serverFileReference) {\n          success(file);\n          return;\n        } // no server id, let's give this file the full treatment\n\n\n        onload(file, success, error);\n      }); // set loader source data\n\n      loader.setSource(source); // set as active loader\n\n      state.activeLoader = loader; // load the source data\n\n      loader.load();\n    };\n\n    var retryLoad = function retryLoad() {\n      if (!state.activeLoader) {\n        return;\n      }\n\n      state.activeLoader.load();\n    };\n\n    var abortLoad = function abortLoad() {\n      if (state.activeLoader) {\n        state.activeLoader.abort();\n        return;\n      }\n\n      setStatus(ItemStatus.INIT);\n      fire('load-abort');\n    }; //\n    // logic to process a file\n    //\n\n\n    var process = function process(processor, onprocess) {\n      // processing was aborted\n      if (state.processingAborted) {\n        state.processingAborted = false;\n        return;\n      } // now processing\n\n\n      setStatus(ItemStatus.PROCESSING); // reset abort callback\n\n      abortProcessingRequestComplete = null; // if no file loaded we'll wait for the load event\n\n      if (!(state.file instanceof Blob)) {\n        api.on('load', function () {\n          process(processor, onprocess);\n        });\n        return;\n      } // setup processor\n\n\n      processor.on('load', function (serverFileReference) {\n        // need this id to be able to revert the upload\n        state.transferId = null;\n        state.serverFileReference = serverFileReference;\n      }); // register transfer id\n\n      processor.on('transfer', function (transferId) {\n        // need this id to be able to revert the upload\n        state.transferId = transferId;\n      });\n      processor.on('load-perceived', function (serverFileReference) {\n        // no longer required\n        state.activeProcessor = null; // need this id to be able to rever the upload\n\n        state.transferId = null;\n        state.serverFileReference = serverFileReference;\n        setStatus(ItemStatus.PROCESSING_COMPLETE);\n        fire('process-complete', serverFileReference);\n      });\n      processor.on('start', function () {\n        fire('process-start');\n      });\n      processor.on('error', function (error) {\n        state.activeProcessor = null;\n        setStatus(ItemStatus.PROCESSING_ERROR);\n        fire('process-error', error);\n      });\n      processor.on('abort', function (serverFileReference) {\n        state.activeProcessor = null; // if file was uploaded but processing was cancelled during perceived processor time store file reference\n\n        state.serverFileReference = serverFileReference;\n        setStatus(ItemStatus.IDLE);\n        fire('process-abort'); // has timeout so doesn't interfere with remove action\n\n        if (abortProcessingRequestComplete) {\n          abortProcessingRequestComplete();\n        }\n      });\n      processor.on('progress', function (progress) {\n        fire('process-progress', progress);\n      }); // when successfully transformed\n\n      var success = function success(file) {\n        // if was archived in the mean time, don't process\n        if (state.archived) return; // process file!\n\n        processor.process(file, Object.assign({}, metadata));\n      }; // something went wrong during transform phase\n\n\n      var error = console.error; // start processing the file\n\n      onprocess(state.file, success, error); // set as active processor\n\n      state.activeProcessor = processor;\n    };\n\n    var requestProcessing = function requestProcessing() {\n      state.processingAborted = false;\n      setStatus(ItemStatus.PROCESSING_QUEUED);\n    };\n\n    var abortProcessing = function abortProcessing() {\n      return new Promise(function (resolve) {\n        if (!state.activeProcessor) {\n          state.processingAborted = true;\n          setStatus(ItemStatus.IDLE);\n          fire('process-abort');\n          resolve();\n          return;\n        }\n\n        abortProcessingRequestComplete = function abortProcessingRequestComplete() {\n          resolve();\n        };\n\n        state.activeProcessor.abort();\n      });\n    }; //\n    // logic to revert a processed file\n    //\n\n\n    var revert = function revert(revertFileUpload, forceRevert) {\n      return new Promise(function (resolve, reject) {\n        // a completed upload will have a serverFileReference, a failed chunked upload where\n        // getting a serverId succeeded but >=0 chunks have been uploaded will have transferId set\n        var serverTransferId = state.serverFileReference !== null ? state.serverFileReference : state.transferId; // cannot revert without a server id for this process\n\n        if (serverTransferId === null) {\n          resolve();\n          return;\n        } // revert the upload (fire and forget)\n\n\n        revertFileUpload(serverTransferId, function () {\n          // reset file server id and transfer id as now it's not available on the server\n          state.serverFileReference = null;\n          state.transferId = null;\n          resolve();\n        }, function (error) {\n          // don't set error state when reverting is optional, it will always resolve\n          if (!forceRevert) {\n            resolve();\n            return;\n          } // oh no errors\n\n\n          setStatus(ItemStatus.PROCESSING_REVERT_ERROR);\n          fire('process-revert-error');\n          reject(error);\n        }); // fire event\n\n        setStatus(ItemStatus.IDLE);\n        fire('process-revert');\n      });\n    }; // exposed methods\n\n\n    var _setMetadata = function setMetadata(key, value, silent) {\n      var keys = key.split('.');\n      var root = keys[0];\n      var last = keys.pop();\n      var data = metadata;\n      keys.forEach(function (key) {\n        return data = data[key];\n      }); // compare old value against new value, if they're the same, we're not updating\n\n      if (JSON.stringify(data[last]) === JSON.stringify(value)) return; // update value\n\n      data[last] = value; // fire update\n\n      fire('metadata-update', {\n        key: root,\n        value: metadata[root],\n        silent: silent\n      });\n    };\n\n    var getMetadata = function getMetadata(key) {\n      return deepCloneObject(key ? metadata[key] : metadata);\n    };\n\n    var api = Object.assign({\n      id: {\n        get: function get() {\n          return id;\n        }\n      },\n      origin: {\n        get: function get() {\n          return origin;\n        },\n        set: function set(value) {\n          return origin = value;\n        }\n      },\n      serverId: {\n        get: function get() {\n          return state.serverFileReference;\n        }\n      },\n      transferId: {\n        get: function get() {\n          return state.transferId;\n        }\n      },\n      status: {\n        get: function get() {\n          return state.status;\n        }\n      },\n      filename: {\n        get: function get() {\n          return state.file.name;\n        }\n      },\n      filenameWithoutExtension: {\n        get: function get() {\n          return getFilenameWithoutExtension(state.file.name);\n        }\n      },\n      fileExtension: {\n        get: getFileExtension\n      },\n      fileType: {\n        get: getFileType\n      },\n      fileSize: {\n        get: getFileSize\n      },\n      file: {\n        get: getFile\n      },\n      relativePath: {\n        get: function get() {\n          return state.file._relativePath;\n        }\n      },\n      source: {\n        get: function get() {\n          return state.source;\n        }\n      },\n      getMetadata: getMetadata,\n      setMetadata: function setMetadata(key, value, silent) {\n        if (isObject(key)) {\n          var data = key;\n          Object.keys(data).forEach(function (key) {\n            _setMetadata(key, data[key], value);\n          });\n          return key;\n        }\n\n        _setMetadata(key, value, silent);\n\n        return value;\n      },\n      extend: function extend(name, handler) {\n        return itemAPI[name] = handler;\n      },\n      abortLoad: abortLoad,\n      retryLoad: retryLoad,\n      requestProcessing: requestProcessing,\n      abortProcessing: abortProcessing,\n      load: load,\n      process: process,\n      revert: revert\n    }, on(), {\n      freeze: function freeze() {\n        return state.frozen = true;\n      },\n      release: function release() {\n        return state.released = true;\n      },\n      released: {\n        get: function get() {\n          return state.released;\n        }\n      },\n      archive: function archive() {\n        return state.archived = true;\n      },\n      archived: {\n        get: function get() {\n          return state.archived;\n        }\n      }\n    }); // create it here instead of returning it instantly so we can extend it later\n\n    var itemAPI = createObject(api);\n    return itemAPI;\n  };\n\n  var getItemIndexByQuery = function getItemIndexByQuery(items, query) {\n    // just return first index\n    if (isEmpty(query)) {\n      return 0;\n    } // invalid queries\n\n\n    if (!isString(query)) {\n      return -1;\n    } // return item by id (or -1 if not found)\n\n\n    return items.findIndex(function (item) {\n      return item.id === query;\n    });\n  };\n\n  var getItemById = function getItemById(items, itemId) {\n    var index = getItemIndexByQuery(items, itemId);\n\n    if (index < 0) {\n      return;\n    }\n\n    return items[index] || null;\n  };\n\n  var fetchBlob = function fetchBlob(url, load, error, progress, abort, headers) {\n    var request = sendRequest(null, url, {\n      method: 'GET',\n      responseType: 'blob'\n    });\n\n    request.onload = function (xhr) {\n      // get headers\n      var headers = xhr.getAllResponseHeaders(); // get filename\n\n      var filename = getFileInfoFromHeaders(headers).name || getFilenameFromURL(url); // create response\n\n      load(createResponse('load', xhr.status, getFileFromBlob(xhr.response, filename), headers));\n    };\n\n    request.onerror = function (xhr) {\n      error(createResponse('error', xhr.status, xhr.statusText, xhr.getAllResponseHeaders()));\n    };\n\n    request.onheaders = function (xhr) {\n      headers(createResponse('headers', xhr.status, null, xhr.getAllResponseHeaders()));\n    };\n\n    request.ontimeout = createTimeoutResponse(error);\n    request.onprogress = progress;\n    request.onabort = abort; // should return request\n\n    return request;\n  };\n\n  var getDomainFromURL = function getDomainFromURL(url) {\n    if (url.indexOf('//') === 0) {\n      url = location.protocol + url;\n    }\n\n    return url.toLowerCase().replace('blob:', '').replace(/([a-z])?:\\/\\//, '$1').split('/')[0];\n  };\n\n  var isExternalURL = function isExternalURL(url) {\n    return (url.indexOf(':') > -1 || url.indexOf('//') > -1) && getDomainFromURL(location.href) !== getDomainFromURL(url);\n  };\n\n  var dynamicLabel = function dynamicLabel(label) {\n    return function () {\n      return isFunction(label) ? label.apply(void 0, arguments) : label;\n    };\n  };\n\n  var isMockItem = function isMockItem(item) {\n    return !isFile(item.file);\n  };\n\n  var listUpdated = function listUpdated(dispatch, state) {\n    clearTimeout(state.listUpdateTimeout);\n    state.listUpdateTimeout = setTimeout(function () {\n      dispatch('DID_UPDATE_ITEMS', {\n        items: getActiveItems(state.items)\n      });\n    }, 0);\n  };\n\n  var optionalPromise = function optionalPromise(fn) {\n    for (var _len = arguments.length, params = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n      params[_key - 1] = arguments[_key];\n    }\n\n    return new Promise(function (resolve) {\n      if (!fn) {\n        return resolve(true);\n      }\n\n      var result = fn.apply(void 0, params);\n\n      if (result == null) {\n        return resolve(true);\n      }\n\n      if (typeof result === 'boolean') {\n        return resolve(result);\n      }\n\n      if (typeof result.then === 'function') {\n        result.then(resolve);\n      }\n    });\n  };\n\n  var sortItems = function sortItems(state, compare) {\n    state.items.sort(function (a, b) {\n      return compare(createItemAPI(a), createItemAPI(b));\n    });\n  }; // returns item based on state\n\n\n  var getItemByQueryFromState = function getItemByQueryFromState(state, itemHandler) {\n    return function () {\n      var _ref = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n      var query = _ref.query,\n          _ref$success = _ref.success,\n          success = _ref$success === void 0 ? function () {} : _ref$success,\n          _ref$failure = _ref.failure,\n          failure = _ref$failure === void 0 ? function () {} : _ref$failure,\n          options = _objectWithoutProperties(_ref, ['query', 'success', 'failure']);\n\n      var item = getItemByQuery(state.items, query);\n\n      if (!item) {\n        failure({\n          error: createResponse('error', 0, 'Item not found'),\n          file: null\n        });\n        return;\n      }\n\n      itemHandler(item, success, failure, options || {});\n    };\n  };\n\n  var actions = function actions(dispatch, query, state) {\n    return {\n      /**\n       * Aborts all ongoing processes\n       */\n      ABORT_ALL: function ABORT_ALL() {\n        getActiveItems(state.items).forEach(function (item) {\n          item.freeze();\n          item.abortLoad();\n          item.abortProcessing();\n        });\n      },\n\n      /**\n       * Sets initial files\n       */\n      DID_SET_FILES: function DID_SET_FILES(_ref2) {\n        var _ref2$value = _ref2.value,\n            value = _ref2$value === void 0 ? [] : _ref2$value; // map values to file objects\n\n        var files = value.map(function (file) {\n          return {\n            source: file.source ? file.source : file,\n            options: file.options\n          };\n        }); // loop over files, if file is in list, leave it be, if not, remove\n        // test if items should be moved\n\n        var activeItems = getActiveItems(state.items);\n        activeItems.forEach(function (item) {\n          // if item not is in new value, remove\n          if (!files.find(function (file) {\n            return file.source === item.source || file.source === item.file;\n          })) {\n            dispatch('REMOVE_ITEM', {\n              query: item,\n              remove: false\n            });\n          }\n        }); // add new files\n\n        activeItems = getActiveItems(state.items);\n        files.forEach(function (file, index) {\n          // if file is already in list\n          if (activeItems.find(function (item) {\n            return item.source === file.source || item.file === file.source;\n          })) return; // not in list, add\n\n          dispatch('ADD_ITEM', Object.assign({}, file, {\n            interactionMethod: InteractionMethod.NONE,\n            index: index\n          }));\n        });\n      },\n      DID_UPDATE_ITEM_METADATA: function DID_UPDATE_ITEM_METADATA(_ref3) {\n        var id = _ref3.id,\n            action = _ref3.action,\n            change = _ref3.change; // don't do anything\n\n        if (change.silent) return; // if is called multiple times in close succession we combined all calls together to save resources\n\n        clearTimeout(state.itemUpdateTimeout);\n        state.itemUpdateTimeout = setTimeout(function () {\n          var item = getItemById(state.items, id); // only revert and attempt to upload when we're uploading to a server\n\n          if (!query('IS_ASYNC')) {\n            // should we update the output data\n            applyFilterChain('SHOULD_PREPARE_OUTPUT', false, {\n              item: item,\n              query: query,\n              action: action,\n              change: change\n            }).then(function (shouldPrepareOutput) {\n              // plugins determined the output data should be prepared (or not), can be adjusted with beforePrepareOutput hook\n              var beforePrepareFile = query('GET_BEFORE_PREPARE_FILE');\n              if (beforePrepareFile) shouldPrepareOutput = beforePrepareFile(item, shouldPrepareOutput);\n              if (!shouldPrepareOutput) return;\n              dispatch('REQUEST_PREPARE_OUTPUT', {\n                query: id,\n                item: item,\n                success: function success(file) {\n                  dispatch('DID_PREPARE_OUTPUT', {\n                    id: id,\n                    file: file\n                  });\n                }\n              }, true);\n            });\n            return;\n          } // if is local item we need to enable upload button so change can be propagated to server\n\n\n          if (item.origin === FileOrigin.LOCAL) {\n            dispatch('DID_LOAD_ITEM', {\n              id: item.id,\n              error: null,\n              serverFileReference: item.source\n            });\n          } // for async scenarios\n\n\n          var upload = function upload() {\n            // we push this forward a bit so the interface is updated correctly\n            setTimeout(function () {\n              dispatch('REQUEST_ITEM_PROCESSING', {\n                query: id\n              });\n            }, 32);\n          };\n\n          var revert = function revert(doUpload) {\n            item.revert(createRevertFunction(state.options.server.url, state.options.server.revert), query('GET_FORCE_REVERT')).then(doUpload ? upload : function () {}).catch(function () {});\n          };\n\n          var abort = function abort(doUpload) {\n            item.abortProcessing().then(doUpload ? upload : function () {});\n          }; // if we should re-upload the file immediately\n\n\n          if (item.status === ItemStatus.PROCESSING_COMPLETE) {\n            return revert(state.options.instantUpload);\n          } // if currently uploading, cancel upload\n\n\n          if (item.status === ItemStatus.PROCESSING) {\n            return abort(state.options.instantUpload);\n          }\n\n          if (state.options.instantUpload) {\n            upload();\n          }\n        }, 0);\n      },\n      MOVE_ITEM: function MOVE_ITEM(_ref4) {\n        var query = _ref4.query,\n            index = _ref4.index;\n        var item = getItemByQuery(state.items, query);\n        if (!item) return;\n        var currentIndex = state.items.indexOf(item);\n        index = limit(index, 0, state.items.length - 1);\n        if (currentIndex === index) return;\n        state.items.splice(index, 0, state.items.splice(currentIndex, 1)[0]);\n      },\n      SORT: function SORT(_ref5) {\n        var compare = _ref5.compare;\n        sortItems(state, compare);\n        dispatch('DID_SORT_ITEMS', {\n          items: query('GET_ACTIVE_ITEMS')\n        });\n      },\n      ADD_ITEMS: function ADD_ITEMS(_ref6) {\n        var items = _ref6.items,\n            index = _ref6.index,\n            interactionMethod = _ref6.interactionMethod,\n            _ref6$success = _ref6.success,\n            success = _ref6$success === void 0 ? function () {} : _ref6$success,\n            _ref6$failure = _ref6.failure,\n            failure = _ref6$failure === void 0 ? function () {} : _ref6$failure;\n        var currentIndex = index;\n\n        if (index === -1 || typeof index === 'undefined') {\n          var insertLocation = query('GET_ITEM_INSERT_LOCATION');\n          var totalItems = query('GET_TOTAL_ITEMS');\n          currentIndex = insertLocation === 'before' ? 0 : totalItems;\n        }\n\n        var ignoredFiles = query('GET_IGNORED_FILES');\n\n        var isValidFile = function isValidFile(source) {\n          return isFile(source) ? !ignoredFiles.includes(source.name.toLowerCase()) : !isEmpty(source);\n        };\n\n        var validItems = items.filter(isValidFile);\n        var promises = validItems.map(function (source) {\n          return new Promise(function (resolve, reject) {\n            dispatch('ADD_ITEM', {\n              interactionMethod: interactionMethod,\n              source: source.source || source,\n              success: resolve,\n              failure: reject,\n              index: currentIndex++,\n              options: source.options || {}\n            });\n          });\n        });\n        Promise.all(promises).then(success).catch(failure);\n      },\n\n      /**\n       * @param source\n       * @param index\n       * @param interactionMethod\n       */\n      ADD_ITEM: function ADD_ITEM(_ref7) {\n        var source = _ref7.source,\n            _ref7$index = _ref7.index,\n            index = _ref7$index === void 0 ? -1 : _ref7$index,\n            interactionMethod = _ref7.interactionMethod,\n            _ref7$success = _ref7.success,\n            success = _ref7$success === void 0 ? function () {} : _ref7$success,\n            _ref7$failure = _ref7.failure,\n            failure = _ref7$failure === void 0 ? function () {} : _ref7$failure,\n            _ref7$options = _ref7.options,\n            options = _ref7$options === void 0 ? {} : _ref7$options; // if no source supplied\n\n        if (isEmpty(source)) {\n          failure({\n            error: createResponse('error', 0, 'No source'),\n            file: null\n          });\n          return;\n        } // filter out invalid file items, used to filter dropped directory contents\n\n\n        if (isFile(source) && state.options.ignoredFiles.includes(source.name.toLowerCase())) {\n          // fail silently\n          return;\n        } // test if there's still room in the list of files\n\n\n        if (!hasRoomForItem(state)) {\n          // if multiple allowed, we can't replace\n          // or if only a single item is allowed but we're not allowed to replace it we exit\n          if (state.options.allowMultiple || !state.options.allowMultiple && !state.options.allowReplace) {\n            var error = createResponse('warning', 0, 'Max files');\n            dispatch('DID_THROW_MAX_FILES', {\n              source: source,\n              error: error\n            });\n            failure({\n              error: error,\n              file: null\n            });\n            return;\n          } // let's replace the item\n          // id of first item we're about to remove\n\n\n          var _item = getActiveItems(state.items)[0]; // if has been processed remove it from the server as well\n\n          if (_item.status === ItemStatus.PROCESSING_COMPLETE || _item.status === ItemStatus.PROCESSING_REVERT_ERROR) {\n            var forceRevert = query('GET_FORCE_REVERT');\n\n            _item.revert(createRevertFunction(state.options.server.url, state.options.server.revert), forceRevert).then(function () {\n              if (!forceRevert) return; // try to add now\n\n              dispatch('ADD_ITEM', {\n                source: source,\n                index: index,\n                interactionMethod: interactionMethod,\n                success: success,\n                failure: failure,\n                options: options\n              });\n            }).catch(function () {}); // no need to handle this catch state for now\n\n\n            if (forceRevert) return;\n          } // remove first item as it will be replaced by this item\n\n\n          dispatch('REMOVE_ITEM', {\n            query: _item.id\n          });\n        } // where did the file originate\n\n\n        var origin = options.type === 'local' ? FileOrigin.LOCAL : options.type === 'limbo' ? FileOrigin.LIMBO : FileOrigin.INPUT; // create a new blank item\n\n        var item = createItem( // where did this file come from\n        origin, // an input file never has a server file reference\n        origin === FileOrigin.INPUT ? null : source, // file mock data, if defined\n        options.file); // set initial meta data\n\n        Object.keys(options.metadata || {}).forEach(function (key) {\n          item.setMetadata(key, options.metadata[key]);\n        }); // created the item, let plugins add methods\n\n        applyFilters('DID_CREATE_ITEM', item, {\n          query: query,\n          dispatch: dispatch\n        }); // where to insert new items\n\n        var itemInsertLocation = query('GET_ITEM_INSERT_LOCATION'); // adjust index if is not allowed to pick location\n\n        if (!state.options.itemInsertLocationFreedom) {\n          index = itemInsertLocation === 'before' ? -1 : state.items.length;\n        } // add item to list\n\n\n        insertItem(state.items, item, index); // sort items in list\n\n        if (isFunction(itemInsertLocation) && source) {\n          sortItems(state, itemInsertLocation);\n        } // get a quick reference to the item id\n\n\n        var id = item.id; // observe item events\n\n        item.on('init', function () {\n          dispatch('DID_INIT_ITEM', {\n            id: id\n          });\n        });\n        item.on('load-init', function () {\n          dispatch('DID_START_ITEM_LOAD', {\n            id: id\n          });\n        });\n        item.on('load-meta', function () {\n          dispatch('DID_UPDATE_ITEM_META', {\n            id: id\n          });\n        });\n        item.on('load-progress', function (progress) {\n          dispatch('DID_UPDATE_ITEM_LOAD_PROGRESS', {\n            id: id,\n            progress: progress\n          });\n        });\n        item.on('load-request-error', function (error) {\n          var mainStatus = dynamicLabel(state.options.labelFileLoadError)(error); // is client error, no way to recover\n\n          if (error.code >= 400 && error.code < 500) {\n            dispatch('DID_THROW_ITEM_INVALID', {\n              id: id,\n              error: error,\n              status: {\n                main: mainStatus,\n                sub: error.code + ' (' + error.body + ')'\n              }\n            }); // reject the file so can be dealt with through API\n\n            failure({\n              error: error,\n              file: createItemAPI(item)\n            });\n            return;\n          } // is possible server error, so might be possible to retry\n\n\n          dispatch('DID_THROW_ITEM_LOAD_ERROR', {\n            id: id,\n            error: error,\n            status: {\n              main: mainStatus,\n              sub: state.options.labelTapToRetry\n            }\n          });\n        });\n        item.on('load-file-error', function (error) {\n          dispatch('DID_THROW_ITEM_INVALID', {\n            id: id,\n            error: error.status,\n            status: error.status\n          });\n          failure({\n            error: error.status,\n            file: createItemAPI(item)\n          });\n        });\n        item.on('load-abort', function () {\n          dispatch('REMOVE_ITEM', {\n            query: id\n          });\n        });\n        item.on('load-skip', function () {\n          dispatch('COMPLETE_LOAD_ITEM', {\n            query: id,\n            item: item,\n            data: {\n              source: source,\n              success: success\n            }\n          });\n        });\n        item.on('load', function () {\n          var handleAdd = function handleAdd(shouldAdd) {\n            // no should not add this file\n            if (!shouldAdd) {\n              dispatch('REMOVE_ITEM', {\n                query: id\n              });\n              return;\n            } // now interested in metadata updates\n\n\n            item.on('metadata-update', function (change) {\n              dispatch('DID_UPDATE_ITEM_METADATA', {\n                id: id,\n                change: change\n              });\n            }); // let plugins decide if the output data should be prepared at this point\n            // means we'll do this and wait for idle state\n\n            applyFilterChain('SHOULD_PREPARE_OUTPUT', false, {\n              item: item,\n              query: query\n            }).then(function (shouldPrepareOutput) {\n              // plugins determined the output data should be prepared (or not), can be adjusted with beforePrepareOutput hook\n              var beforePrepareFile = query('GET_BEFORE_PREPARE_FILE');\n              if (beforePrepareFile) shouldPrepareOutput = beforePrepareFile(item, shouldPrepareOutput);\n\n              var loadComplete = function loadComplete() {\n                dispatch('COMPLETE_LOAD_ITEM', {\n                  query: id,\n                  item: item,\n                  data: {\n                    source: source,\n                    success: success\n                  }\n                });\n                listUpdated(dispatch, state);\n              }; // exit\n\n\n              if (shouldPrepareOutput) {\n                // wait for idle state and then run PREPARE_OUTPUT\n                dispatch('REQUEST_PREPARE_OUTPUT', {\n                  query: id,\n                  item: item,\n                  success: function success(file) {\n                    dispatch('DID_PREPARE_OUTPUT', {\n                      id: id,\n                      file: file\n                    });\n                    loadComplete();\n                  }\n                }, true);\n                return;\n              }\n\n              loadComplete();\n            });\n          }; // item loaded, allow plugins to\n          // - read data (quickly)\n          // - add metadata\n\n\n          applyFilterChain('DID_LOAD_ITEM', item, {\n            query: query,\n            dispatch: dispatch\n          }).then(function () {\n            optionalPromise(query('GET_BEFORE_ADD_FILE'), createItemAPI(item)).then(handleAdd);\n          }).catch(function (e) {\n            if (!e || !e.error || !e.status) return handleAdd(false);\n            dispatch('DID_THROW_ITEM_INVALID', {\n              id: id,\n              error: e.error,\n              status: e.status\n            });\n          });\n        });\n        item.on('process-start', function () {\n          dispatch('DID_START_ITEM_PROCESSING', {\n            id: id\n          });\n        });\n        item.on('process-progress', function (progress) {\n          dispatch('DID_UPDATE_ITEM_PROCESS_PROGRESS', {\n            id: id,\n            progress: progress\n          });\n        });\n        item.on('process-error', function (error) {\n          dispatch('DID_THROW_ITEM_PROCESSING_ERROR', {\n            id: id,\n            error: error,\n            status: {\n              main: dynamicLabel(state.options.labelFileProcessingError)(error),\n              sub: state.options.labelTapToRetry\n            }\n          });\n        });\n        item.on('process-revert-error', function (error) {\n          dispatch('DID_THROW_ITEM_PROCESSING_REVERT_ERROR', {\n            id: id,\n            error: error,\n            status: {\n              main: dynamicLabel(state.options.labelFileProcessingRevertError)(error),\n              sub: state.options.labelTapToRetry\n            }\n          });\n        });\n        item.on('process-complete', function (serverFileReference) {\n          dispatch('DID_COMPLETE_ITEM_PROCESSING', {\n            id: id,\n            error: null,\n            serverFileReference: serverFileReference\n          });\n          dispatch('DID_DEFINE_VALUE', {\n            id: id,\n            value: serverFileReference\n          });\n        });\n        item.on('process-abort', function () {\n          dispatch('DID_ABORT_ITEM_PROCESSING', {\n            id: id\n          });\n        });\n        item.on('process-revert', function () {\n          dispatch('DID_REVERT_ITEM_PROCESSING', {\n            id: id\n          });\n          dispatch('DID_DEFINE_VALUE', {\n            id: id,\n            value: null\n          });\n        }); // let view know the item has been inserted\n\n        dispatch('DID_ADD_ITEM', {\n          id: id,\n          index: index,\n          interactionMethod: interactionMethod\n        });\n        listUpdated(dispatch, state); // start loading the source\n\n        var _ref8 = state.options.server || {},\n            url = _ref8.url,\n            load = _ref8.load,\n            restore = _ref8.restore,\n            fetch = _ref8.fetch;\n\n        item.load(source, // this creates a function that loads the file based on the type of file (string, base64, blob, file) and location of file (local, remote, limbo)\n        createFileLoader(origin === FileOrigin.INPUT ? // input, if is remote, see if should use custom fetch, else use default fetchBlob\n        isString(source) && isExternalURL(source) ? fetch ? createFetchFunction(url, fetch) : fetchBlob // remote url\n        : fetchBlob // try to fetch url\n        : // limbo or local\n        origin === FileOrigin.LIMBO ? createFetchFunction(url, restore) // limbo\n        : createFetchFunction(url, load) // local\n        ), // called when the file is loaded so it can be piped through the filters\n        function (file, success, error) {\n          // let's process the file\n          applyFilterChain('LOAD_FILE', file, {\n            query: query\n          }).then(success).catch(error);\n        });\n      },\n      REQUEST_PREPARE_OUTPUT: function REQUEST_PREPARE_OUTPUT(_ref9) {\n        var item = _ref9.item,\n            success = _ref9.success,\n            _ref9$failure = _ref9.failure,\n            failure = _ref9$failure === void 0 ? function () {} : _ref9$failure; // error response if item archived\n\n        var err = {\n          error: createResponse('error', 0, 'Item not found'),\n          file: null\n        }; // don't handle archived items, an item could have been archived (load aborted) while waiting to be prepared\n\n        if (item.archived) return failure(err); // allow plugins to alter the file data\n\n        applyFilterChain('PREPARE_OUTPUT', item.file, {\n          query: query,\n          item: item\n        }).then(function (result) {\n          applyFilterChain('COMPLETE_PREPARE_OUTPUT', result, {\n            query: query,\n            item: item\n          }).then(function (result) {\n            // don't handle archived items, an item could have been archived (load aborted) while being prepared\n            if (item.archived) return failure(err); // we done!\n\n            success(result);\n          });\n        });\n      },\n      COMPLETE_LOAD_ITEM: function COMPLETE_LOAD_ITEM(_ref10) {\n        var item = _ref10.item,\n            data = _ref10.data;\n        var success = data.success,\n            source = data.source; // sort items in list\n\n        var itemInsertLocation = query('GET_ITEM_INSERT_LOCATION');\n\n        if (isFunction(itemInsertLocation) && source) {\n          sortItems(state, itemInsertLocation);\n        } // let interface know the item has loaded\n\n\n        dispatch('DID_LOAD_ITEM', {\n          id: item.id,\n          error: null,\n          serverFileReference: item.origin === FileOrigin.INPUT ? null : source\n        }); // item has been successfully loaded and added to the\n        // list of items so can now be safely returned for use\n\n        success(createItemAPI(item)); // if this is a local server file we need to show a different state\n\n        if (item.origin === FileOrigin.LOCAL) {\n          dispatch('DID_LOAD_LOCAL_ITEM', {\n            id: item.id\n          });\n          return;\n        } // if is a temp server file we prevent async upload call here (as the file is already on the server)\n\n\n        if (item.origin === FileOrigin.LIMBO) {\n          dispatch('DID_COMPLETE_ITEM_PROCESSING', {\n            id: item.id,\n            error: null,\n            serverFileReference: source\n          });\n          dispatch('DID_DEFINE_VALUE', {\n            id: item.id,\n            value: item.serverId || source\n          });\n          return;\n        } // id we are allowed to upload the file immediately, lets do it\n\n\n        if (query('IS_ASYNC') && state.options.instantUpload) {\n          dispatch('REQUEST_ITEM_PROCESSING', {\n            query: item.id\n          });\n        }\n      },\n      RETRY_ITEM_LOAD: getItemByQueryFromState(state, function (item) {\n        // try loading the source one more time\n        item.retryLoad();\n      }),\n      REQUEST_ITEM_PREPARE: getItemByQueryFromState(state, function (item, _success, failure) {\n        dispatch('REQUEST_PREPARE_OUTPUT', {\n          query: item.id,\n          item: item,\n          success: function success(file) {\n            dispatch('DID_PREPARE_OUTPUT', {\n              id: item.id,\n              file: file\n            });\n\n            _success({\n              file: item,\n              output: file\n            });\n          },\n          failure: failure\n        }, true);\n      }),\n      REQUEST_ITEM_PROCESSING: getItemByQueryFromState(state, function (item, success, failure) {\n        // cannot be queued (or is already queued)\n        var itemCanBeQueuedForProcessing = // waiting for something\n        item.status === ItemStatus.IDLE || // processing went wrong earlier\n        item.status === ItemStatus.PROCESSING_ERROR; // not ready to be processed\n\n        if (!itemCanBeQueuedForProcessing) {\n          var processNow = function processNow() {\n            return dispatch('REQUEST_ITEM_PROCESSING', {\n              query: item,\n              success: success,\n              failure: failure\n            });\n          };\n\n          var process = function process() {\n            return document.hidden ? processNow() : setTimeout(processNow, 32);\n          }; // if already done processing or tried to revert but didn't work, try again\n\n\n          if (item.status === ItemStatus.PROCESSING_COMPLETE || item.status === ItemStatus.PROCESSING_REVERT_ERROR) {\n            item.revert(createRevertFunction(state.options.server.url, state.options.server.revert), query('GET_FORCE_REVERT')).then(process).catch(function () {}); // don't continue with processing if something went wrong\n          } else if (item.status === ItemStatus.PROCESSING) {\n            item.abortProcessing().then(process);\n          }\n\n          return;\n        } // already queued for processing\n\n\n        if (item.status === ItemStatus.PROCESSING_QUEUED) return;\n        item.requestProcessing();\n        dispatch('DID_REQUEST_ITEM_PROCESSING', {\n          id: item.id\n        });\n        dispatch('PROCESS_ITEM', {\n          query: item,\n          success: success,\n          failure: failure\n        }, true);\n      }),\n      PROCESS_ITEM: getItemByQueryFromState(state, function (item, success, failure) {\n        var maxParallelUploads = query('GET_MAX_PARALLEL_UPLOADS');\n        var totalCurrentUploads = query('GET_ITEMS_BY_STATUS', ItemStatus.PROCESSING).length; // queue and wait till queue is freed up\n\n        if (totalCurrentUploads === maxParallelUploads) {\n          // queue for later processing\n          state.processingQueue.push({\n            id: item.id,\n            success: success,\n            failure: failure\n          }); // stop it!\n\n          return;\n        } // if was not queued or is already processing exit here\n\n\n        if (item.status === ItemStatus.PROCESSING) return;\n\n        var processNext = function processNext() {\n          // process queueud items\n          var queueEntry = state.processingQueue.shift(); // no items left\n\n          if (!queueEntry) return; // get item reference\n\n          var id = queueEntry.id,\n              success = queueEntry.success,\n              failure = queueEntry.failure;\n          var itemReference = getItemByQuery(state.items, id); // if item was archived while in queue, jump to next\n\n          if (!itemReference || itemReference.archived) {\n            processNext();\n            return;\n          } // process queued item\n\n\n          dispatch('PROCESS_ITEM', {\n            query: id,\n            success: success,\n            failure: failure\n          }, true);\n        }; // we done function\n\n\n        item.onOnce('process-complete', function () {\n          success(createItemAPI(item));\n          processNext(); // if origin is local, and we're instant uploading, trigger remove of original\n          // as revert will remove file from list\n\n          var server = state.options.server;\n          var instantUpload = state.options.instantUpload;\n\n          if (instantUpload && item.origin === FileOrigin.LOCAL && isFunction(server.remove)) {\n            var noop = function noop() {};\n\n            item.origin = FileOrigin.LIMBO;\n            state.options.server.remove(item.source, noop, noop);\n          } // All items processed? No errors?\n\n\n          var allItemsProcessed = query('GET_ITEMS_BY_STATUS', ItemStatus.PROCESSING_COMPLETE).length === state.items.length;\n\n          if (allItemsProcessed) {\n            dispatch('DID_COMPLETE_ITEM_PROCESSING_ALL');\n          }\n        }); // we error function\n\n        item.onOnce('process-error', function (error) {\n          failure({\n            error: error,\n            file: createItemAPI(item)\n          });\n          processNext();\n        }); // start file processing\n\n        var options = state.options;\n        item.process(createFileProcessor(createProcessorFunction(options.server.url, options.server.process, options.name, {\n          chunkTransferId: item.transferId,\n          chunkServer: options.server.patch,\n          chunkUploads: options.chunkUploads,\n          chunkForce: options.chunkForce,\n          chunkSize: options.chunkSize,\n          chunkRetryDelays: options.chunkRetryDelays\n        }), {\n          allowMinimumUploadDuration: query('GET_ALLOW_MINIMUM_UPLOAD_DURATION')\n        }), // called when the file is about to be processed so it can be piped through the transform filters\n        function (file, success, error) {\n          // allow plugins to alter the file data\n          applyFilterChain('PREPARE_OUTPUT', file, {\n            query: query,\n            item: item\n          }).then(function (file) {\n            dispatch('DID_PREPARE_OUTPUT', {\n              id: item.id,\n              file: file\n            });\n            success(file);\n          }).catch(error);\n        });\n      }),\n      RETRY_ITEM_PROCESSING: getItemByQueryFromState(state, function (item) {\n        dispatch('REQUEST_ITEM_PROCESSING', {\n          query: item\n        });\n      }),\n      REQUEST_REMOVE_ITEM: getItemByQueryFromState(state, function (item) {\n        optionalPromise(query('GET_BEFORE_REMOVE_FILE'), createItemAPI(item)).then(function (shouldRemove) {\n          if (!shouldRemove) {\n            return;\n          }\n\n          dispatch('REMOVE_ITEM', {\n            query: item\n          });\n        });\n      }),\n      RELEASE_ITEM: getItemByQueryFromState(state, function (item) {\n        item.release();\n      }),\n      REMOVE_ITEM: getItemByQueryFromState(state, function (item, success, failure, options) {\n        var removeFromView = function removeFromView() {\n          // get id reference\n          var id = item.id; // archive the item, this does not remove it from the list\n\n          getItemById(state.items, id).archive(); // tell the view the item has been removed\n\n          dispatch('DID_REMOVE_ITEM', {\n            error: null,\n            id: id,\n            item: item\n          }); // now the list has been modified\n\n          listUpdated(dispatch, state); // correctly removed\n\n          success(createItemAPI(item));\n        }; // if this is a local file and the `server.remove` function has been configured,\n        // send source there so dev can remove file from server\n\n\n        var server = state.options.server;\n\n        if (item.origin === FileOrigin.LOCAL && server && isFunction(server.remove) && options.remove !== false) {\n          dispatch('DID_START_ITEM_REMOVE', {\n            id: item.id\n          });\n          server.remove(item.source, function () {\n            return removeFromView();\n          }, function (status) {\n            dispatch('DID_THROW_ITEM_REMOVE_ERROR', {\n              id: item.id,\n              error: createResponse('error', 0, status, null),\n              status: {\n                main: dynamicLabel(state.options.labelFileRemoveError)(status),\n                sub: state.options.labelTapToRetry\n              }\n            });\n          });\n        } else {\n          // if is requesting revert and can revert need to call revert handler (not calling request_ because that would also trigger beforeRemoveHook)\n          if (options.revert && item.origin !== FileOrigin.LOCAL && item.serverId !== null || // if chunked uploads are enabled and we're uploading in chunks for this specific file\n          // or if the file isn't big enough for chunked uploads but chunkForce is set then call\n          // revert before removing from the view...\n          state.options.chunkUploads && item.file.size > state.options.chunkSize || state.options.chunkUploads && state.options.chunkForce) {\n            item.revert(createRevertFunction(state.options.server.url, state.options.server.revert), query('GET_FORCE_REVERT'));\n          } // can now safely remove from view\n\n\n          removeFromView();\n        }\n      }),\n      ABORT_ITEM_LOAD: getItemByQueryFromState(state, function (item) {\n        item.abortLoad();\n      }),\n      ABORT_ITEM_PROCESSING: getItemByQueryFromState(state, function (item) {\n        // test if is already processed\n        if (item.serverId) {\n          dispatch('REVERT_ITEM_PROCESSING', {\n            id: item.id\n          });\n          return;\n        } // abort\n\n\n        item.abortProcessing().then(function () {\n          var shouldRemove = state.options.instantUpload;\n\n          if (shouldRemove) {\n            dispatch('REMOVE_ITEM', {\n              query: item.id\n            });\n          }\n        });\n      }),\n      REQUEST_REVERT_ITEM_PROCESSING: getItemByQueryFromState(state, function (item) {\n        // not instant uploading, revert immediately\n        if (!state.options.instantUpload) {\n          dispatch('REVERT_ITEM_PROCESSING', {\n            query: item\n          });\n          return;\n        } // if we're instant uploading the file will also be removed if we revert,\n        // so if a before remove file hook is defined we need to run it now\n\n\n        var handleRevert = function handleRevert(shouldRevert) {\n          if (!shouldRevert) return;\n          dispatch('REVERT_ITEM_PROCESSING', {\n            query: item\n          });\n        };\n\n        var fn = query('GET_BEFORE_REMOVE_FILE');\n\n        if (!fn) {\n          return handleRevert(true);\n        }\n\n        var requestRemoveResult = fn(createItemAPI(item));\n\n        if (requestRemoveResult == null) {\n          // undefined or null\n          return handleRevert(true);\n        }\n\n        if (typeof requestRemoveResult === 'boolean') {\n          return handleRevert(requestRemoveResult);\n        }\n\n        if (typeof requestRemoveResult.then === 'function') {\n          requestRemoveResult.then(handleRevert);\n        }\n      }),\n      REVERT_ITEM_PROCESSING: getItemByQueryFromState(state, function (item) {\n        item.revert(createRevertFunction(state.options.server.url, state.options.server.revert), query('GET_FORCE_REVERT')).then(function () {\n          var shouldRemove = state.options.instantUpload || isMockItem(item);\n\n          if (shouldRemove) {\n            dispatch('REMOVE_ITEM', {\n              query: item.id\n            });\n          }\n        }).catch(function () {});\n      }),\n      SET_OPTIONS: function SET_OPTIONS(_ref11) {\n        var options = _ref11.options; // get all keys passed\n\n        var optionKeys = Object.keys(options); // get prioritized keyed to include (remove once not in options object)\n\n        var prioritizedOptionKeys = PrioritizedOptions.filter(function (key) {\n          return optionKeys.includes(key);\n        }); // order the keys, prioritized first, then rest\n\n        var orderedOptionKeys = [].concat(_toConsumableArray(prioritizedOptionKeys), _toConsumableArray(Object.keys(options).filter(function (key) {\n          return !prioritizedOptionKeys.includes(key);\n        }))); // dispatch set event for each option\n\n        orderedOptionKeys.forEach(function (key) {\n          dispatch('SET_' + fromCamels(key, '_').toUpperCase(), {\n            value: options[key]\n          });\n        });\n      }\n    };\n  };\n\n  var PrioritizedOptions = ['server'];\n\n  var formatFilename = function formatFilename(name) {\n    return name;\n  };\n\n  var createElement$1 = function createElement(tagName) {\n    return document.createElement(tagName);\n  };\n\n  var text = function text(node, value) {\n    var textNode = node.childNodes[0];\n\n    if (!textNode) {\n      textNode = document.createTextNode(value);\n      node.appendChild(textNode);\n    } else if (value !== textNode.nodeValue) {\n      textNode.nodeValue = value;\n    }\n  };\n\n  var polarToCartesian = function polarToCartesian(centerX, centerY, radius, angleInDegrees) {\n    var angleInRadians = (angleInDegrees % 360 - 90) * Math.PI / 180.0;\n    return {\n      x: centerX + radius * Math.cos(angleInRadians),\n      y: centerY + radius * Math.sin(angleInRadians)\n    };\n  };\n\n  var describeArc = function describeArc(x, y, radius, startAngle, endAngle, arcSweep) {\n    var start = polarToCartesian(x, y, radius, endAngle);\n    var end = polarToCartesian(x, y, radius, startAngle);\n    return ['M', start.x, start.y, 'A', radius, radius, 0, arcSweep, 0, end.x, end.y].join(' ');\n  };\n\n  var percentageArc = function percentageArc(x, y, radius, from, to) {\n    var arcSweep = 1;\n\n    if (to > from && to - from <= 0.5) {\n      arcSweep = 0;\n    }\n\n    if (from > to && from - to >= 0.5) {\n      arcSweep = 0;\n    }\n\n    return describeArc(x, y, radius, Math.min(0.9999, from) * 360, Math.min(0.9999, to) * 360, arcSweep);\n  };\n\n  var create = function create(_ref) {\n    var root = _ref.root,\n        props = _ref.props; // start at 0\n\n    props.spin = false;\n    props.progress = 0;\n    props.opacity = 0; // svg\n\n    var svg = createElement('svg');\n    root.ref.path = createElement('path', {\n      'stroke-width': 2,\n      'stroke-linecap': 'round'\n    });\n    svg.appendChild(root.ref.path);\n    root.ref.svg = svg;\n    root.appendChild(svg);\n  };\n\n  var write = function write(_ref2) {\n    var root = _ref2.root,\n        props = _ref2.props;\n\n    if (props.opacity === 0) {\n      return;\n    }\n\n    if (props.align) {\n      root.element.dataset.align = props.align;\n    } // get width of stroke\n\n\n    var ringStrokeWidth = parseInt(attr(root.ref.path, 'stroke-width'), 10); // calculate size of ring\n\n    var size = root.rect.element.width * 0.5; // ring state\n\n    var ringFrom = 0;\n    var ringTo = 0; // now in busy mode\n\n    if (props.spin) {\n      ringFrom = 0;\n      ringTo = 0.5;\n    } else {\n      ringFrom = 0;\n      ringTo = props.progress;\n    } // get arc path\n\n\n    var coordinates = percentageArc(size, size, size - ringStrokeWidth, ringFrom, ringTo); // update progress bar\n\n    attr(root.ref.path, 'd', coordinates); // hide while contains 0 value\n\n    attr(root.ref.path, 'stroke-opacity', props.spin || props.progress > 0 ? 1 : 0);\n  };\n\n  var progressIndicator = createView({\n    tag: 'div',\n    name: 'progress-indicator',\n    ignoreRectUpdate: true,\n    ignoreRect: true,\n    create: create,\n    write: write,\n    mixins: {\n      apis: ['progress', 'spin', 'align'],\n      styles: ['opacity'],\n      animations: {\n        opacity: {\n          type: 'tween',\n          duration: 500\n        },\n        progress: {\n          type: 'spring',\n          stiffness: 0.95,\n          damping: 0.65,\n          mass: 10\n        }\n      }\n    }\n  });\n\n  var create$1 = function create(_ref) {\n    var root = _ref.root,\n        props = _ref.props;\n    root.element.innerHTML = (props.icon || '') + ('<span>' + props.label + '</span>');\n    props.isDisabled = false;\n  };\n\n  var write$1 = function write(_ref2) {\n    var root = _ref2.root,\n        props = _ref2.props;\n    var isDisabled = props.isDisabled;\n    var shouldDisable = root.query('GET_DISABLED') || props.opacity === 0;\n\n    if (shouldDisable && !isDisabled) {\n      props.isDisabled = true;\n      attr(root.element, 'disabled', 'disabled');\n    } else if (!shouldDisable && isDisabled) {\n      props.isDisabled = false;\n      root.element.removeAttribute('disabled');\n    }\n  };\n\n  var fileActionButton = createView({\n    tag: 'button',\n    attributes: {\n      type: 'button'\n    },\n    ignoreRect: true,\n    ignoreRectUpdate: true,\n    name: 'file-action-button',\n    mixins: {\n      apis: ['label'],\n      styles: ['translateX', 'translateY', 'scaleX', 'scaleY', 'opacity'],\n      animations: {\n        scaleX: 'spring',\n        scaleY: 'spring',\n        translateX: 'spring',\n        translateY: 'spring',\n        opacity: {\n          type: 'tween',\n          duration: 250\n        }\n      },\n      listeners: true\n    },\n    create: create$1,\n    write: write$1\n  });\n\n  var toNaturalFileSize = function toNaturalFileSize(bytes) {\n    var decimalSeparator = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : '.';\n    var base = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 1000;\n    var options = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {};\n    var _options$labelBytes = options.labelBytes,\n        labelBytes = _options$labelBytes === void 0 ? 'bytes' : _options$labelBytes,\n        _options$labelKilobyt = options.labelKilobytes,\n        labelKilobytes = _options$labelKilobyt === void 0 ? 'KB' : _options$labelKilobyt,\n        _options$labelMegabyt = options.labelMegabytes,\n        labelMegabytes = _options$labelMegabyt === void 0 ? 'MB' : _options$labelMegabyt,\n        _options$labelGigabyt = options.labelGigabytes,\n        labelGigabytes = _options$labelGigabyt === void 0 ? 'GB' : _options$labelGigabyt; // no negative byte sizes\n\n    bytes = Math.round(Math.abs(bytes));\n    var KB = base;\n    var MB = base * base;\n    var GB = base * base * base; // just bytes\n\n    if (bytes < KB) {\n      return bytes + ' ' + labelBytes;\n    } // kilobytes\n\n\n    if (bytes < MB) {\n      return Math.floor(bytes / KB) + ' ' + labelKilobytes;\n    } // megabytes\n\n\n    if (bytes < GB) {\n      return removeDecimalsWhenZero(bytes / MB, 1, decimalSeparator) + ' ' + labelMegabytes;\n    } // gigabytes\n\n\n    return removeDecimalsWhenZero(bytes / GB, 2, decimalSeparator) + ' ' + labelGigabytes;\n  };\n\n  var removeDecimalsWhenZero = function removeDecimalsWhenZero(value, decimalCount, separator) {\n    return value.toFixed(decimalCount).split('.').filter(function (part) {\n      return part !== '0';\n    }).join(separator);\n  };\n\n  var create$2 = function create(_ref) {\n    var root = _ref.root,\n        props = _ref.props; // filename\n\n    var fileName = createElement$1('span');\n    fileName.className = 'filepond--file-info-main'; // hide for screenreaders\n    // the file is contained in a fieldset with legend that contains the filename\n    // no need to read it twice\n\n    attr(fileName, 'aria-hidden', 'true');\n    root.appendChild(fileName);\n    root.ref.fileName = fileName; // filesize\n\n    var fileSize = createElement$1('span');\n    fileSize.className = 'filepond--file-info-sub';\n    root.appendChild(fileSize);\n    root.ref.fileSize = fileSize; // set initial values\n\n    text(fileSize, root.query('GET_LABEL_FILE_WAITING_FOR_SIZE'));\n    text(fileName, formatFilename(root.query('GET_ITEM_NAME', props.id)));\n  };\n\n  var updateFile = function updateFile(_ref2) {\n    var root = _ref2.root,\n        props = _ref2.props;\n    text(root.ref.fileSize, toNaturalFileSize(root.query('GET_ITEM_SIZE', props.id), '.', root.query('GET_FILE_SIZE_BASE'), root.query('GET_FILE_SIZE_LABELS', root.query)));\n    text(root.ref.fileName, formatFilename(root.query('GET_ITEM_NAME', props.id)));\n  };\n\n  var updateFileSizeOnError = function updateFileSizeOnError(_ref3) {\n    var root = _ref3.root,\n        props = _ref3.props; // if size is available don't fallback to unknown size message\n\n    if (isInt(root.query('GET_ITEM_SIZE', props.id))) {\n      updateFile({\n        root: root,\n        props: props\n      });\n      return;\n    }\n\n    text(root.ref.fileSize, root.query('GET_LABEL_FILE_SIZE_NOT_AVAILABLE'));\n  };\n\n  var fileInfo = createView({\n    name: 'file-info',\n    ignoreRect: true,\n    ignoreRectUpdate: true,\n    write: createRoute({\n      DID_LOAD_ITEM: updateFile,\n      DID_UPDATE_ITEM_META: updateFile,\n      DID_THROW_ITEM_LOAD_ERROR: updateFileSizeOnError,\n      DID_THROW_ITEM_INVALID: updateFileSizeOnError\n    }),\n    didCreateView: function didCreateView(root) {\n      applyFilters('CREATE_VIEW', Object.assign({}, root, {\n        view: root\n      }));\n    },\n    create: create$2,\n    mixins: {\n      styles: ['translateX', 'translateY'],\n      animations: {\n        translateX: 'spring',\n        translateY: 'spring'\n      }\n    }\n  });\n\n  var toPercentage = function toPercentage(value) {\n    return Math.round(value * 100);\n  };\n\n  var create$3 = function create(_ref) {\n    var root = _ref.root; // main status\n\n    var main = createElement$1('span');\n    main.className = 'filepond--file-status-main';\n    root.appendChild(main);\n    root.ref.main = main; // sub status\n\n    var sub = createElement$1('span');\n    sub.className = 'filepond--file-status-sub';\n    root.appendChild(sub);\n    root.ref.sub = sub;\n    didSetItemLoadProgress({\n      root: root,\n      action: {\n        progress: null\n      }\n    });\n  };\n\n  var didSetItemLoadProgress = function didSetItemLoadProgress(_ref2) {\n    var root = _ref2.root,\n        action = _ref2.action;\n    var title = action.progress === null ? root.query('GET_LABEL_FILE_LOADING') : root.query('GET_LABEL_FILE_LOADING') + ' ' + toPercentage(action.progress) + '%';\n    text(root.ref.main, title);\n    text(root.ref.sub, root.query('GET_LABEL_TAP_TO_CANCEL'));\n  };\n\n  var didSetItemProcessProgress = function didSetItemProcessProgress(_ref3) {\n    var root = _ref3.root,\n        action = _ref3.action;\n    var title = action.progress === null ? root.query('GET_LABEL_FILE_PROCESSING') : root.query('GET_LABEL_FILE_PROCESSING') + ' ' + toPercentage(action.progress) + '%';\n    text(root.ref.main, title);\n    text(root.ref.sub, root.query('GET_LABEL_TAP_TO_CANCEL'));\n  };\n\n  var didRequestItemProcessing = function didRequestItemProcessing(_ref4) {\n    var root = _ref4.root;\n    text(root.ref.main, root.query('GET_LABEL_FILE_PROCESSING'));\n    text(root.ref.sub, root.query('GET_LABEL_TAP_TO_CANCEL'));\n  };\n\n  var didAbortItemProcessing = function didAbortItemProcessing(_ref5) {\n    var root = _ref5.root;\n    text(root.ref.main, root.query('GET_LABEL_FILE_PROCESSING_ABORTED'));\n    text(root.ref.sub, root.query('GET_LABEL_TAP_TO_RETRY'));\n  };\n\n  var didCompleteItemProcessing = function didCompleteItemProcessing(_ref6) {\n    var root = _ref6.root;\n    text(root.ref.main, root.query('GET_LABEL_FILE_PROCESSING_COMPLETE'));\n    text(root.ref.sub, root.query('GET_LABEL_TAP_TO_UNDO'));\n  };\n\n  var clear = function clear(_ref7) {\n    var root = _ref7.root;\n    text(root.ref.main, '');\n    text(root.ref.sub, '');\n  };\n\n  var error = function error(_ref8) {\n    var root = _ref8.root,\n        action = _ref8.action;\n    text(root.ref.main, action.status.main);\n    text(root.ref.sub, action.status.sub);\n  };\n\n  var fileStatus = createView({\n    name: 'file-status',\n    ignoreRect: true,\n    ignoreRectUpdate: true,\n    write: createRoute({\n      DID_LOAD_ITEM: clear,\n      DID_REVERT_ITEM_PROCESSING: clear,\n      DID_REQUEST_ITEM_PROCESSING: didRequestItemProcessing,\n      DID_ABORT_ITEM_PROCESSING: didAbortItemProcessing,\n      DID_COMPLETE_ITEM_PROCESSING: didCompleteItemProcessing,\n      DID_UPDATE_ITEM_PROCESS_PROGRESS: didSetItemProcessProgress,\n      DID_UPDATE_ITEM_LOAD_PROGRESS: didSetItemLoadProgress,\n      DID_THROW_ITEM_LOAD_ERROR: error,\n      DID_THROW_ITEM_INVALID: error,\n      DID_THROW_ITEM_PROCESSING_ERROR: error,\n      DID_THROW_ITEM_PROCESSING_REVERT_ERROR: error,\n      DID_THROW_ITEM_REMOVE_ERROR: error\n    }),\n    didCreateView: function didCreateView(root) {\n      applyFilters('CREATE_VIEW', Object.assign({}, root, {\n        view: root\n      }));\n    },\n    create: create$3,\n    mixins: {\n      styles: ['translateX', 'translateY', 'opacity'],\n      animations: {\n        opacity: {\n          type: 'tween',\n          duration: 250\n        },\n        translateX: 'spring',\n        translateY: 'spring'\n      }\n    }\n  });\n  /**\n   * Button definitions for the file view\n   */\n\n  var Buttons = {\n    AbortItemLoad: {\n      label: 'GET_LABEL_BUTTON_ABORT_ITEM_LOAD',\n      action: 'ABORT_ITEM_LOAD',\n      className: 'filepond--action-abort-item-load',\n      align: 'LOAD_INDICATOR_POSITION' // right\n\n    },\n    RetryItemLoad: {\n      label: 'GET_LABEL_BUTTON_RETRY_ITEM_LOAD',\n      action: 'RETRY_ITEM_LOAD',\n      icon: 'GET_ICON_RETRY',\n      className: 'filepond--action-retry-item-load',\n      align: 'BUTTON_PROCESS_ITEM_POSITION' // right\n\n    },\n    RemoveItem: {\n      label: 'GET_LABEL_BUTTON_REMOVE_ITEM',\n      action: 'REQUEST_REMOVE_ITEM',\n      icon: 'GET_ICON_REMOVE',\n      className: 'filepond--action-remove-item',\n      align: 'BUTTON_REMOVE_ITEM_POSITION' // left\n\n    },\n    ProcessItem: {\n      label: 'GET_LABEL_BUTTON_PROCESS_ITEM',\n      action: 'REQUEST_ITEM_PROCESSING',\n      icon: 'GET_ICON_PROCESS',\n      className: 'filepond--action-process-item',\n      align: 'BUTTON_PROCESS_ITEM_POSITION' // right\n\n    },\n    AbortItemProcessing: {\n      label: 'GET_LABEL_BUTTON_ABORT_ITEM_PROCESSING',\n      action: 'ABORT_ITEM_PROCESSING',\n      className: 'filepond--action-abort-item-processing',\n      align: 'BUTTON_PROCESS_ITEM_POSITION' // right\n\n    },\n    RetryItemProcessing: {\n      label: 'GET_LABEL_BUTTON_RETRY_ITEM_PROCESSING',\n      action: 'RETRY_ITEM_PROCESSING',\n      icon: 'GET_ICON_RETRY',\n      className: 'filepond--action-retry-item-processing',\n      align: 'BUTTON_PROCESS_ITEM_POSITION' // right\n\n    },\n    RevertItemProcessing: {\n      label: 'GET_LABEL_BUTTON_UNDO_ITEM_PROCESSING',\n      action: 'REQUEST_REVERT_ITEM_PROCESSING',\n      icon: 'GET_ICON_UNDO',\n      className: 'filepond--action-revert-item-processing',\n      align: 'BUTTON_PROCESS_ITEM_POSITION' // right\n\n    }\n  }; // make a list of buttons, we can then remove buttons from this list if they're disabled\n\n  var ButtonKeys = [];\n  forin(Buttons, function (key) {\n    ButtonKeys.push(key);\n  });\n\n  var calculateFileInfoOffset = function calculateFileInfoOffset(root) {\n    if (getRemoveIndicatorAligment(root) === 'right') return 0;\n    var buttonRect = root.ref.buttonRemoveItem.rect.element;\n    return buttonRect.hidden ? null : buttonRect.width + buttonRect.left;\n  };\n\n  var calculateButtonWidth = function calculateButtonWidth(root) {\n    var buttonRect = root.ref.buttonAbortItemLoad.rect.element;\n    return buttonRect.width;\n  }; // Force on full pixels so text stays crips\n\n\n  var calculateFileVerticalCenterOffset = function calculateFileVerticalCenterOffset(root) {\n    return Math.floor(root.ref.buttonRemoveItem.rect.element.height / 4);\n  };\n\n  var calculateFileHorizontalCenterOffset = function calculateFileHorizontalCenterOffset(root) {\n    return Math.floor(root.ref.buttonRemoveItem.rect.element.left / 2);\n  };\n\n  var getLoadIndicatorAlignment = function getLoadIndicatorAlignment(root) {\n    return root.query('GET_STYLE_LOAD_INDICATOR_POSITION');\n  };\n\n  var getProcessIndicatorAlignment = function getProcessIndicatorAlignment(root) {\n    return root.query('GET_STYLE_PROGRESS_INDICATOR_POSITION');\n  };\n\n  var getRemoveIndicatorAligment = function getRemoveIndicatorAligment(root) {\n    return root.query('GET_STYLE_BUTTON_REMOVE_ITEM_POSITION');\n  };\n\n  var DefaultStyle = {\n    buttonAbortItemLoad: {\n      opacity: 0\n    },\n    buttonRetryItemLoad: {\n      opacity: 0\n    },\n    buttonRemoveItem: {\n      opacity: 0\n    },\n    buttonProcessItem: {\n      opacity: 0\n    },\n    buttonAbortItemProcessing: {\n      opacity: 0\n    },\n    buttonRetryItemProcessing: {\n      opacity: 0\n    },\n    buttonRevertItemProcessing: {\n      opacity: 0\n    },\n    loadProgressIndicator: {\n      opacity: 0,\n      align: getLoadIndicatorAlignment\n    },\n    processProgressIndicator: {\n      opacity: 0,\n      align: getProcessIndicatorAlignment\n    },\n    processingCompleteIndicator: {\n      opacity: 0,\n      scaleX: 0.75,\n      scaleY: 0.75\n    },\n    info: {\n      translateX: 0,\n      translateY: 0,\n      opacity: 0\n    },\n    status: {\n      translateX: 0,\n      translateY: 0,\n      opacity: 0\n    }\n  };\n  var IdleStyle = {\n    buttonRemoveItem: {\n      opacity: 1\n    },\n    buttonProcessItem: {\n      opacity: 1\n    },\n    info: {\n      translateX: calculateFileInfoOffset\n    },\n    status: {\n      translateX: calculateFileInfoOffset\n    }\n  };\n  var ProcessingStyle = {\n    buttonAbortItemProcessing: {\n      opacity: 1\n    },\n    processProgressIndicator: {\n      opacity: 1\n    },\n    status: {\n      opacity: 1\n    }\n  };\n  var StyleMap = {\n    DID_THROW_ITEM_INVALID: {\n      buttonRemoveItem: {\n        opacity: 1\n      },\n      info: {\n        translateX: calculateFileInfoOffset\n      },\n      status: {\n        translateX: calculateFileInfoOffset,\n        opacity: 1\n      }\n    },\n    DID_START_ITEM_LOAD: {\n      buttonAbortItemLoad: {\n        opacity: 1\n      },\n      loadProgressIndicator: {\n        opacity: 1\n      },\n      status: {\n        opacity: 1\n      }\n    },\n    DID_THROW_ITEM_LOAD_ERROR: {\n      buttonRetryItemLoad: {\n        opacity: 1\n      },\n      buttonRemoveItem: {\n        opacity: 1\n      },\n      info: {\n        translateX: calculateFileInfoOffset\n      },\n      status: {\n        opacity: 1\n      }\n    },\n    DID_START_ITEM_REMOVE: {\n      processProgressIndicator: {\n        opacity: 1,\n        align: getRemoveIndicatorAligment\n      },\n      info: {\n        translateX: calculateFileInfoOffset\n      },\n      status: {\n        opacity: 0\n      }\n    },\n    DID_THROW_ITEM_REMOVE_ERROR: {\n      processProgressIndicator: {\n        opacity: 0,\n        align: getRemoveIndicatorAligment\n      },\n      buttonRemoveItem: {\n        opacity: 1\n      },\n      info: {\n        translateX: calculateFileInfoOffset\n      },\n      status: {\n        opacity: 1,\n        translateX: calculateFileInfoOffset\n      }\n    },\n    DID_LOAD_ITEM: IdleStyle,\n    DID_LOAD_LOCAL_ITEM: {\n      buttonRemoveItem: {\n        opacity: 1\n      },\n      info: {\n        translateX: calculateFileInfoOffset\n      },\n      status: {\n        translateX: calculateFileInfoOffset\n      }\n    },\n    DID_START_ITEM_PROCESSING: ProcessingStyle,\n    DID_REQUEST_ITEM_PROCESSING: ProcessingStyle,\n    DID_UPDATE_ITEM_PROCESS_PROGRESS: ProcessingStyle,\n    DID_COMPLETE_ITEM_PROCESSING: {\n      buttonRevertItemProcessing: {\n        opacity: 1\n      },\n      info: {\n        opacity: 1\n      },\n      status: {\n        opacity: 1\n      }\n    },\n    DID_THROW_ITEM_PROCESSING_ERROR: {\n      buttonRemoveItem: {\n        opacity: 1\n      },\n      buttonRetryItemProcessing: {\n        opacity: 1\n      },\n      status: {\n        opacity: 1\n      },\n      info: {\n        translateX: calculateFileInfoOffset\n      }\n    },\n    DID_THROW_ITEM_PROCESSING_REVERT_ERROR: {\n      buttonRevertItemProcessing: {\n        opacity: 1\n      },\n      status: {\n        opacity: 1\n      },\n      info: {\n        opacity: 1\n      }\n    },\n    DID_ABORT_ITEM_PROCESSING: {\n      buttonRemoveItem: {\n        opacity: 1\n      },\n      buttonProcessItem: {\n        opacity: 1\n      },\n      info: {\n        translateX: calculateFileInfoOffset\n      },\n      status: {\n        opacity: 1\n      }\n    },\n    DID_REVERT_ITEM_PROCESSING: IdleStyle\n  }; // complete indicator view\n\n  var processingCompleteIndicatorView = createView({\n    create: function create(_ref) {\n      var root = _ref.root;\n      root.element.innerHTML = root.query('GET_ICON_DONE');\n    },\n    name: 'processing-complete-indicator',\n    ignoreRect: true,\n    mixins: {\n      styles: ['scaleX', 'scaleY', 'opacity'],\n      animations: {\n        scaleX: 'spring',\n        scaleY: 'spring',\n        opacity: {\n          type: 'tween',\n          duration: 250\n        }\n      }\n    }\n  });\n  /**\n   * Creates the file view\n   */\n\n  var create$4 = function create(_ref2) {\n    var root = _ref2.root,\n        props = _ref2.props; // copy Buttons object\n\n    var LocalButtons = Object.keys(Buttons).reduce(function (prev, curr) {\n      prev[curr] = Object.assign({}, Buttons[curr]);\n      return prev;\n    }, {});\n    var id = props.id; // allow reverting upload\n\n    var allowRevert = root.query('GET_ALLOW_REVERT'); // allow remove file\n\n    var allowRemove = root.query('GET_ALLOW_REMOVE'); // allow processing upload\n\n    var allowProcess = root.query('GET_ALLOW_PROCESS'); // is instant uploading, need this to determine the icon of the undo button\n\n    var instantUpload = root.query('GET_INSTANT_UPLOAD'); // is async set up\n\n    var isAsync = root.query('IS_ASYNC'); // should align remove item buttons\n\n    var alignRemoveItemButton = root.query('GET_STYLE_BUTTON_REMOVE_ITEM_ALIGN'); // enabled buttons array\n\n    var buttonFilter;\n\n    if (isAsync) {\n      if (allowProcess && !allowRevert) {\n        // only remove revert button\n        buttonFilter = function buttonFilter(key) {\n          return !/RevertItemProcessing/.test(key);\n        };\n      } else if (!allowProcess && allowRevert) {\n        // only remove process button\n        buttonFilter = function buttonFilter(key) {\n          return !/ProcessItem|RetryItemProcessing|AbortItemProcessing/.test(key);\n        };\n      } else if (!allowProcess && !allowRevert) {\n        // remove all process buttons\n        buttonFilter = function buttonFilter(key) {\n          return !/Process/.test(key);\n        };\n      }\n    } else {\n      // no process controls available\n      buttonFilter = function buttonFilter(key) {\n        return !/Process/.test(key);\n      };\n    }\n\n    var enabledButtons = buttonFilter ? ButtonKeys.filter(buttonFilter) : ButtonKeys.concat(); // update icon and label for revert button when instant uploading\n\n    if (instantUpload && allowRevert) {\n      LocalButtons['RevertItemProcessing'].label = 'GET_LABEL_BUTTON_REMOVE_ITEM';\n      LocalButtons['RevertItemProcessing'].icon = 'GET_ICON_REMOVE';\n    } // remove last button (revert) if not allowed\n\n\n    if (isAsync && !allowRevert) {\n      var map = StyleMap['DID_COMPLETE_ITEM_PROCESSING'];\n      map.info.translateX = calculateFileHorizontalCenterOffset;\n      map.info.translateY = calculateFileVerticalCenterOffset;\n      map.status.translateY = calculateFileVerticalCenterOffset;\n      map.processingCompleteIndicator = {\n        opacity: 1,\n        scaleX: 1,\n        scaleY: 1\n      };\n    } // should align center\n\n\n    if (isAsync && !allowProcess) {\n      ['DID_START_ITEM_PROCESSING', 'DID_REQUEST_ITEM_PROCESSING', 'DID_UPDATE_ITEM_PROCESS_PROGRESS', 'DID_THROW_ITEM_PROCESSING_ERROR'].forEach(function (key) {\n        StyleMap[key].status.translateY = calculateFileVerticalCenterOffset;\n      });\n      StyleMap['DID_THROW_ITEM_PROCESSING_ERROR'].status.translateX = calculateButtonWidth;\n    } // move remove button to right\n\n\n    if (alignRemoveItemButton && allowRevert) {\n      LocalButtons['RevertItemProcessing'].align = 'BUTTON_REMOVE_ITEM_POSITION';\n      var _map = StyleMap['DID_COMPLETE_ITEM_PROCESSING'];\n      _map.info.translateX = calculateFileInfoOffset;\n      _map.status.translateY = calculateFileVerticalCenterOffset;\n      _map.processingCompleteIndicator = {\n        opacity: 1,\n        scaleX: 1,\n        scaleY: 1\n      };\n    } // show/hide RemoveItem button\n\n\n    if (!allowRemove) {\n      LocalButtons['RemoveItem'].disabled = true;\n    } // create the button views\n\n\n    forin(LocalButtons, function (key, definition) {\n      // create button\n      var buttonView = root.createChildView(fileActionButton, {\n        label: root.query(definition.label),\n        icon: root.query(definition.icon),\n        opacity: 0\n      }); // should be appended?\n\n      if (enabledButtons.includes(key)) {\n        root.appendChildView(buttonView);\n      } // toggle\n\n\n      if (definition.disabled) {\n        buttonView.element.setAttribute('disabled', 'disabled');\n        buttonView.element.setAttribute('hidden', 'hidden');\n      } // add position attribute\n\n\n      buttonView.element.dataset.align = root.query('GET_STYLE_' + definition.align); // add class\n\n      buttonView.element.classList.add(definition.className); // handle interactions\n\n      buttonView.on('click', function (e) {\n        e.stopPropagation();\n        if (definition.disabled) return;\n        root.dispatch(definition.action, {\n          query: id\n        });\n      }); // set reference\n\n      root.ref['button' + key] = buttonView;\n    }); // checkmark\n\n    root.ref.processingCompleteIndicator = root.appendChildView(root.createChildView(processingCompleteIndicatorView));\n    root.ref.processingCompleteIndicator.element.dataset.align = root.query('GET_STYLE_BUTTON_PROCESS_ITEM_POSITION'); // create file info view\n\n    root.ref.info = root.appendChildView(root.createChildView(fileInfo, {\n      id: id\n    })); // create file status view\n\n    root.ref.status = root.appendChildView(root.createChildView(fileStatus, {\n      id: id\n    })); // add progress indicators\n\n    var loadIndicatorView = root.appendChildView(root.createChildView(progressIndicator, {\n      opacity: 0,\n      align: root.query('GET_STYLE_LOAD_INDICATOR_POSITION')\n    }));\n    loadIndicatorView.element.classList.add('filepond--load-indicator');\n    root.ref.loadProgressIndicator = loadIndicatorView;\n    var progressIndicatorView = root.appendChildView(root.createChildView(progressIndicator, {\n      opacity: 0,\n      align: root.query('GET_STYLE_PROGRESS_INDICATOR_POSITION')\n    }));\n    progressIndicatorView.element.classList.add('filepond--process-indicator');\n    root.ref.processProgressIndicator = progressIndicatorView; // current active styles\n\n    root.ref.activeStyles = [];\n  };\n\n  var write$2 = function write(_ref3) {\n    var root = _ref3.root,\n        actions = _ref3.actions,\n        props = _ref3.props; // route actions\n\n    route({\n      root: root,\n      actions: actions,\n      props: props\n    }); // select last state change action\n\n    var action = actions.concat().filter(function (action) {\n      return /^DID_/.test(action.type);\n    }).reverse().find(function (action) {\n      return StyleMap[action.type];\n    }); // a new action happened, let's get the matching styles\n\n    if (action) {\n      // define new active styles\n      root.ref.activeStyles = [];\n      var stylesToApply = StyleMap[action.type];\n      forin(DefaultStyle, function (name, defaultStyles) {\n        // get reference to control\n        var control = root.ref[name]; // loop over all styles for this control\n\n        forin(defaultStyles, function (key, defaultValue) {\n          var value = stylesToApply[name] && typeof stylesToApply[name][key] !== 'undefined' ? stylesToApply[name][key] : defaultValue;\n          root.ref.activeStyles.push({\n            control: control,\n            key: key,\n            value: value\n          });\n        });\n      });\n    } // apply active styles to element\n\n\n    root.ref.activeStyles.forEach(function (_ref4) {\n      var control = _ref4.control,\n          key = _ref4.key,\n          value = _ref4.value;\n      control[key] = typeof value === 'function' ? value(root) : value;\n    });\n  };\n\n  var route = createRoute({\n    DID_SET_LABEL_BUTTON_ABORT_ITEM_PROCESSING: function DID_SET_LABEL_BUTTON_ABORT_ITEM_PROCESSING(_ref5) {\n      var root = _ref5.root,\n          action = _ref5.action;\n      root.ref.buttonAbortItemProcessing.label = action.value;\n    },\n    DID_SET_LABEL_BUTTON_ABORT_ITEM_LOAD: function DID_SET_LABEL_BUTTON_ABORT_ITEM_LOAD(_ref6) {\n      var root = _ref6.root,\n          action = _ref6.action;\n      root.ref.buttonAbortItemLoad.label = action.value;\n    },\n    DID_SET_LABEL_BUTTON_ABORT_ITEM_REMOVAL: function DID_SET_LABEL_BUTTON_ABORT_ITEM_REMOVAL(_ref7) {\n      var root = _ref7.root,\n          action = _ref7.action;\n      root.ref.buttonAbortItemRemoval.label = action.value;\n    },\n    DID_REQUEST_ITEM_PROCESSING: function DID_REQUEST_ITEM_PROCESSING(_ref8) {\n      var root = _ref8.root;\n      root.ref.processProgressIndicator.spin = true;\n      root.ref.processProgressIndicator.progress = 0;\n    },\n    DID_START_ITEM_LOAD: function DID_START_ITEM_LOAD(_ref9) {\n      var root = _ref9.root;\n      root.ref.loadProgressIndicator.spin = true;\n      root.ref.loadProgressIndicator.progress = 0;\n    },\n    DID_START_ITEM_REMOVE: function DID_START_ITEM_REMOVE(_ref10) {\n      var root = _ref10.root;\n      root.ref.processProgressIndicator.spin = true;\n      root.ref.processProgressIndicator.progress = 0;\n    },\n    DID_UPDATE_ITEM_LOAD_PROGRESS: function DID_UPDATE_ITEM_LOAD_PROGRESS(_ref11) {\n      var root = _ref11.root,\n          action = _ref11.action;\n      root.ref.loadProgressIndicator.spin = false;\n      root.ref.loadProgressIndicator.progress = action.progress;\n    },\n    DID_UPDATE_ITEM_PROCESS_PROGRESS: function DID_UPDATE_ITEM_PROCESS_PROGRESS(_ref12) {\n      var root = _ref12.root,\n          action = _ref12.action;\n      root.ref.processProgressIndicator.spin = false;\n      root.ref.processProgressIndicator.progress = action.progress;\n    }\n  });\n  var file = createView({\n    create: create$4,\n    write: write$2,\n    didCreateView: function didCreateView(root) {\n      applyFilters('CREATE_VIEW', Object.assign({}, root, {\n        view: root\n      }));\n    },\n    name: 'file'\n  });\n  /**\n   * Creates the file view\n   */\n\n  var create$5 = function create(_ref) {\n    var root = _ref.root,\n        props = _ref.props; // filename\n\n    root.ref.fileName = createElement$1('legend');\n    root.appendChild(root.ref.fileName); // file appended\n\n    root.ref.file = root.appendChildView(root.createChildView(file, {\n      id: props.id\n    })); // data has moved to data.js\n\n    root.ref.data = false;\n  };\n  /**\n   * Data storage\n   */\n\n\n  var didLoadItem = function didLoadItem(_ref2) {\n    var root = _ref2.root,\n        props = _ref2.props; // updates the legend of the fieldset so screenreaders can better group buttons\n\n    text(root.ref.fileName, formatFilename(root.query('GET_ITEM_NAME', props.id)));\n  };\n\n  var fileWrapper = createView({\n    create: create$5,\n    ignoreRect: true,\n    write: createRoute({\n      DID_LOAD_ITEM: didLoadItem\n    }),\n    didCreateView: function didCreateView(root) {\n      applyFilters('CREATE_VIEW', Object.assign({}, root, {\n        view: root\n      }));\n    },\n    tag: 'fieldset',\n    name: 'file-wrapper'\n  });\n  var PANEL_SPRING_PROPS = {\n    type: 'spring',\n    damping: 0.6,\n    mass: 7\n  };\n\n  var create$6 = function create(_ref) {\n    var root = _ref.root,\n        props = _ref.props;\n    [{\n      name: 'top'\n    }, {\n      name: 'center',\n      props: {\n        translateY: null,\n        scaleY: null\n      },\n      mixins: {\n        animations: {\n          scaleY: PANEL_SPRING_PROPS\n        },\n        styles: ['translateY', 'scaleY']\n      }\n    }, {\n      name: 'bottom',\n      props: {\n        translateY: null\n      },\n      mixins: {\n        animations: {\n          translateY: PANEL_SPRING_PROPS\n        },\n        styles: ['translateY']\n      }\n    }].forEach(function (section) {\n      createSection(root, section, props.name);\n    });\n    root.element.classList.add('filepond--' + props.name);\n    root.ref.scalable = null;\n  };\n\n  var createSection = function createSection(root, section, className) {\n    var viewConstructor = createView({\n      name: 'panel-' + section.name + ' filepond--' + className,\n      mixins: section.mixins,\n      ignoreRectUpdate: true\n    });\n    var view = root.createChildView(viewConstructor, section.props);\n    root.ref[section.name] = root.appendChildView(view);\n  };\n\n  var write$3 = function write(_ref2) {\n    var root = _ref2.root,\n        props = _ref2.props; // update scalable state\n\n    if (root.ref.scalable === null || props.scalable !== root.ref.scalable) {\n      root.ref.scalable = isBoolean(props.scalable) ? props.scalable : true;\n      root.element.dataset.scalable = root.ref.scalable;\n    } // no height, can't set\n\n\n    if (!props.height) return; // get child rects\n\n    var topRect = root.ref.top.rect.element;\n    var bottomRect = root.ref.bottom.rect.element; // make sure height never is smaller than bottom and top seciton heights combined (will probably never happen, but who knows)\n\n    var height = Math.max(topRect.height + bottomRect.height, props.height); // offset center part\n\n    root.ref.center.translateY = topRect.height; // scale center part\n    // use math ceil to prevent transparent lines because of rounding errors\n\n    root.ref.center.scaleY = (height - topRect.height - bottomRect.height) / 100; // offset bottom part\n\n    root.ref.bottom.translateY = height - bottomRect.height;\n  };\n\n  var panel = createView({\n    name: 'panel',\n    read: function read(_ref3) {\n      var root = _ref3.root,\n          props = _ref3.props;\n      return props.heightCurrent = root.ref.bottom.translateY;\n    },\n    write: write$3,\n    create: create$6,\n    ignoreRect: true,\n    mixins: {\n      apis: ['height', 'heightCurrent', 'scalable']\n    }\n  });\n\n  var createDragHelper = function createDragHelper(items) {\n    var itemIds = items.map(function (item) {\n      return item.id;\n    });\n    var prevIndex = undefined;\n    return {\n      setIndex: function setIndex(index) {\n        prevIndex = index;\n      },\n      getIndex: function getIndex() {\n        return prevIndex;\n      },\n      getItemIndex: function getItemIndex(item) {\n        return itemIds.indexOf(item.id);\n      }\n    };\n  };\n\n  var ITEM_TRANSLATE_SPRING = {\n    type: 'spring',\n    stiffness: 0.75,\n    damping: 0.45,\n    mass: 10\n  };\n  var ITEM_SCALE_SPRING = 'spring';\n  var StateMap = {\n    DID_START_ITEM_LOAD: 'busy',\n    DID_UPDATE_ITEM_LOAD_PROGRESS: 'loading',\n    DID_THROW_ITEM_INVALID: 'load-invalid',\n    DID_THROW_ITEM_LOAD_ERROR: 'load-error',\n    DID_LOAD_ITEM: 'idle',\n    DID_THROW_ITEM_REMOVE_ERROR: 'remove-error',\n    DID_START_ITEM_REMOVE: 'busy',\n    DID_START_ITEM_PROCESSING: 'busy processing',\n    DID_REQUEST_ITEM_PROCESSING: 'busy processing',\n    DID_UPDATE_ITEM_PROCESS_PROGRESS: 'processing',\n    DID_COMPLETE_ITEM_PROCESSING: 'processing-complete',\n    DID_THROW_ITEM_PROCESSING_ERROR: 'processing-error',\n    DID_THROW_ITEM_PROCESSING_REVERT_ERROR: 'processing-revert-error',\n    DID_ABORT_ITEM_PROCESSING: 'cancelled',\n    DID_REVERT_ITEM_PROCESSING: 'idle'\n  };\n  /**\n   * Creates the file view\n   */\n\n  var create$7 = function create(_ref) {\n    var root = _ref.root,\n        props = _ref.props; // select\n\n    root.ref.handleClick = function (e) {\n      return root.dispatch('DID_ACTIVATE_ITEM', {\n        id: props.id\n      });\n    }; // set id\n\n\n    root.element.id = 'filepond--item-' + props.id;\n    root.element.addEventListener('click', root.ref.handleClick); // file view\n\n    root.ref.container = root.appendChildView(root.createChildView(fileWrapper, {\n      id: props.id\n    })); // file panel\n\n    root.ref.panel = root.appendChildView(root.createChildView(panel, {\n      name: 'item-panel'\n    })); // default start height\n\n    root.ref.panel.height = null; // by default not marked for removal\n\n    props.markedForRemoval = false; // if not allowed to reorder file items, exit here\n\n    if (!root.query('GET_ALLOW_REORDER')) return; // set to idle so shows grab cursor\n\n    root.element.dataset.dragState = 'idle';\n\n    var grab = function grab(e) {\n      if (!e.isPrimary) return;\n      var removedActivateListener = false;\n      var origin = {\n        x: e.pageX,\n        y: e.pageY\n      };\n      props.dragOrigin = {\n        x: root.translateX,\n        y: root.translateY\n      };\n      props.dragCenter = {\n        x: e.offsetX,\n        y: e.offsetY\n      };\n      var dragState = createDragHelper(root.query('GET_ACTIVE_ITEMS'));\n      root.dispatch('DID_GRAB_ITEM', {\n        id: props.id,\n        dragState: dragState\n      });\n\n      var drag = function drag(e) {\n        if (!e.isPrimary) return;\n        e.stopPropagation();\n        e.preventDefault();\n        props.dragOffset = {\n          x: e.pageX - origin.x,\n          y: e.pageY - origin.y\n        }; // if dragged stop listening to clicks, will re-add when done dragging\n\n        var dist = props.dragOffset.x * props.dragOffset.x + props.dragOffset.y * props.dragOffset.y;\n\n        if (dist > 16 && !removedActivateListener) {\n          removedActivateListener = true;\n          root.element.removeEventListener('click', root.ref.handleClick);\n        }\n\n        root.dispatch('DID_DRAG_ITEM', {\n          id: props.id,\n          dragState: dragState\n        });\n      };\n\n      var drop = function drop(e) {\n        if (!e.isPrimary) return;\n        document.removeEventListener('pointermove', drag);\n        document.removeEventListener('pointerup', drop);\n        props.dragOffset = {\n          x: e.pageX - origin.x,\n          y: e.pageY - origin.y\n        };\n        root.dispatch('DID_DROP_ITEM', {\n          id: props.id,\n          dragState: dragState\n        }); // start listening to clicks again\n\n        if (removedActivateListener) {\n          setTimeout(function () {\n            return root.element.addEventListener('click', root.ref.handleClick);\n          }, 0);\n        }\n      };\n\n      document.addEventListener('pointermove', drag);\n      document.addEventListener('pointerup', drop);\n    };\n\n    root.element.addEventListener('pointerdown', grab);\n  };\n\n  var route$1 = createRoute({\n    DID_UPDATE_PANEL_HEIGHT: function DID_UPDATE_PANEL_HEIGHT(_ref2) {\n      var root = _ref2.root,\n          action = _ref2.action;\n      root.height = action.height;\n    }\n  });\n  var write$4 = createRoute({\n    DID_GRAB_ITEM: function DID_GRAB_ITEM(_ref3) {\n      var root = _ref3.root,\n          props = _ref3.props;\n      props.dragOrigin = {\n        x: root.translateX,\n        y: root.translateY\n      };\n    },\n    DID_DRAG_ITEM: function DID_DRAG_ITEM(_ref4) {\n      var root = _ref4.root;\n      root.element.dataset.dragState = 'drag';\n    },\n    DID_DROP_ITEM: function DID_DROP_ITEM(_ref5) {\n      var root = _ref5.root,\n          props = _ref5.props;\n      props.dragOffset = null;\n      props.dragOrigin = null;\n      root.element.dataset.dragState = 'drop';\n    }\n  }, function (_ref6) {\n    var root = _ref6.root,\n        actions = _ref6.actions,\n        props = _ref6.props,\n        shouldOptimize = _ref6.shouldOptimize;\n\n    if (root.element.dataset.dragState === 'drop') {\n      if (root.scaleX <= 1) {\n        root.element.dataset.dragState = 'idle';\n      }\n    } // select last state change action\n\n\n    var action = actions.concat().filter(function (action) {\n      return /^DID_/.test(action.type);\n    }).reverse().find(function (action) {\n      return StateMap[action.type];\n    }); // no need to set same state twice\n\n    if (action && action.type !== props.currentState) {\n      // set current state\n      props.currentState = action.type; // set state\n\n      root.element.dataset.filepondItemState = StateMap[props.currentState] || '';\n    } // route actions\n\n\n    var aspectRatio = root.query('GET_ITEM_PANEL_ASPECT_RATIO') || root.query('GET_PANEL_ASPECT_RATIO');\n\n    if (!aspectRatio) {\n      route$1({\n        root: root,\n        actions: actions,\n        props: props\n      });\n\n      if (!root.height && root.ref.container.rect.element.height > 0) {\n        root.height = root.ref.container.rect.element.height;\n      }\n    } else if (!shouldOptimize) {\n      root.height = root.rect.element.width * aspectRatio;\n    } // sync panel height with item height\n\n\n    if (shouldOptimize) {\n      root.ref.panel.height = null;\n    }\n\n    root.ref.panel.height = root.height;\n  });\n  var item = createView({\n    create: create$7,\n    write: write$4,\n    destroy: function destroy(_ref7) {\n      var root = _ref7.root,\n          props = _ref7.props;\n      root.element.removeEventListener('click', root.ref.handleClick);\n      root.dispatch('RELEASE_ITEM', {\n        query: props.id\n      });\n    },\n    tag: 'li',\n    name: 'item',\n    mixins: {\n      apis: ['id', 'interactionMethod', 'markedForRemoval', 'spawnDate', 'dragCenter', 'dragOrigin', 'dragOffset'],\n      styles: ['translateX', 'translateY', 'scaleX', 'scaleY', 'opacity', 'height'],\n      animations: {\n        scaleX: ITEM_SCALE_SPRING,\n        scaleY: ITEM_SCALE_SPRING,\n        translateX: ITEM_TRANSLATE_SPRING,\n        translateY: ITEM_TRANSLATE_SPRING,\n        opacity: {\n          type: 'tween',\n          duration: 150\n        }\n      }\n    }\n  });\n\n  var getItemsPerRow = function (horizontalSpace, itemWidth) {\n    // add one pixel leeway, when using percentages for item width total items can be 1.99 per row\n    return Math.max(1, Math.floor((horizontalSpace + 1) / itemWidth));\n  };\n\n  var getItemIndexByPosition = function getItemIndexByPosition(view, children, positionInView) {\n    if (!positionInView) return;\n    var horizontalSpace = view.rect.element.width; // const children = view.childViews;\n\n    var l = children.length;\n    var last = null; // -1, don't move items to accomodate (either add to top or bottom)\n\n    if (l === 0 || positionInView.top < children[0].rect.element.top) return -1; // let's get the item width\n\n    var item = children[0];\n    var itemRect = item.rect.element;\n    var itemHorizontalMargin = itemRect.marginLeft + itemRect.marginRight;\n    var itemWidth = itemRect.width + itemHorizontalMargin;\n    var itemsPerRow = getItemsPerRow(horizontalSpace, itemWidth); // stack\n\n    if (itemsPerRow === 1) {\n      for (var index = 0; index < l; index++) {\n        var child = children[index];\n        var childMid = child.rect.outer.top + child.rect.element.height * 0.5;\n\n        if (positionInView.top < childMid) {\n          return index;\n        }\n      }\n\n      return l;\n    } // grid\n\n\n    var itemVerticalMargin = itemRect.marginTop + itemRect.marginBottom;\n    var itemHeight = itemRect.height + itemVerticalMargin;\n\n    for (var _index = 0; _index < l; _index++) {\n      var indexX = _index % itemsPerRow;\n      var indexY = Math.floor(_index / itemsPerRow);\n      var offsetX = indexX * itemWidth;\n      var offsetY = indexY * itemHeight;\n      var itemTop = offsetY - itemRect.marginTop;\n      var itemRight = offsetX + itemWidth;\n      var itemBottom = offsetY + itemHeight + itemRect.marginBottom;\n\n      if (positionInView.top < itemBottom && positionInView.top > itemTop) {\n        if (positionInView.left < itemRight) {\n          return _index;\n        } else if (_index !== l - 1) {\n          last = _index;\n        } else {\n          last = null;\n        }\n      }\n    }\n\n    if (last !== null) {\n      return last;\n    }\n\n    return l;\n  };\n\n  var dropAreaDimensions = {\n    height: 0,\n    width: 0,\n\n    get getHeight() {\n      return this.height;\n    },\n\n    set setHeight(val) {\n      if (this.height === 0 || val === 0) this.height = val;\n    },\n\n    get getWidth() {\n      return this.width;\n    },\n\n    set setWidth(val) {\n      if (this.width === 0 || val === 0) this.width = val;\n    },\n\n    setDimensions: function setDimensions(height, width) {\n      if (this.height === 0 || height === 0) this.height = height;\n      if (this.width === 0 || width === 0) this.width = width;\n    }\n  };\n\n  var create$8 = function create(_ref) {\n    var root = _ref.root; // need to set role to list as otherwise it won't be read as a list by VoiceOver\n\n    attr(root.element, 'role', 'list');\n    root.ref.lastItemSpanwDate = Date.now();\n  };\n  /**\n   * Inserts a new item\n   * @param root\n   * @param action\n   */\n\n\n  var addItemView = function addItemView(_ref2) {\n    var root = _ref2.root,\n        action = _ref2.action;\n    var id = action.id,\n        index = action.index,\n        interactionMethod = action.interactionMethod;\n    root.ref.addIndex = index;\n    var now = Date.now();\n    var spawnDate = now;\n    var opacity = 1;\n\n    if (interactionMethod !== InteractionMethod.NONE) {\n      opacity = 0;\n      var cooldown = root.query('GET_ITEM_INSERT_INTERVAL');\n      var dist = now - root.ref.lastItemSpanwDate;\n      spawnDate = dist < cooldown ? now + (cooldown - dist) : now;\n    }\n\n    root.ref.lastItemSpanwDate = spawnDate;\n    root.appendChildView(root.createChildView( // view type\n    item, // props\n    {\n      spawnDate: spawnDate,\n      id: id,\n      opacity: opacity,\n      interactionMethod: interactionMethod\n    }), index);\n  };\n\n  var moveItem = function moveItem(item, x, y) {\n    var vx = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 0;\n    var vy = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : 1; // set to null to remove animation while dragging\n\n    if (item.dragOffset) {\n      item.translateX = null;\n      item.translateY = null;\n      item.translateX = item.dragOrigin.x + item.dragOffset.x;\n      item.translateY = item.dragOrigin.y + item.dragOffset.y;\n      item.scaleX = 1.025;\n      item.scaleY = 1.025;\n    } else {\n      item.translateX = x;\n      item.translateY = y;\n\n      if (Date.now() > item.spawnDate) {\n        // reveal element\n        if (item.opacity === 0) {\n          introItemView(item, x, y, vx, vy);\n        } // make sure is default scale every frame\n\n\n        item.scaleX = 1;\n        item.scaleY = 1;\n        item.opacity = 1;\n      }\n    }\n  };\n\n  var introItemView = function introItemView(item, x, y, vx, vy) {\n    if (item.interactionMethod === InteractionMethod.NONE) {\n      item.translateX = null;\n      item.translateX = x;\n      item.translateY = null;\n      item.translateY = y;\n    } else if (item.interactionMethod === InteractionMethod.DROP) {\n      item.translateX = null;\n      item.translateX = x - vx * 20;\n      item.translateY = null;\n      item.translateY = y - vy * 10;\n      item.scaleX = 0.8;\n      item.scaleY = 0.8;\n    } else if (item.interactionMethod === InteractionMethod.BROWSE) {\n      item.translateY = null;\n      item.translateY = y - 30;\n    } else if (item.interactionMethod === InteractionMethod.API) {\n      item.translateX = null;\n      item.translateX = x - 30;\n      item.translateY = null;\n    }\n  };\n  /**\n   * Removes an existing item\n   * @param root\n   * @param action\n   */\n\n\n  var removeItemView = function removeItemView(_ref3) {\n    var root = _ref3.root,\n        action = _ref3.action;\n    var id = action.id; // get the view matching the given id\n\n    var view = root.childViews.find(function (child) {\n      return child.id === id;\n    }); // if no view found, exit\n\n    if (!view) {\n      return;\n    } // animate view out of view\n\n\n    view.scaleX = 0.9;\n    view.scaleY = 0.9;\n    view.opacity = 0; // mark for removal\n\n    view.markedForRemoval = true;\n  };\n\n  var getItemHeight = function getItemHeight(child) {\n    return child.rect.element.height + child.rect.element.marginBottom * 0.5 + child.rect.element.marginTop * 0.5;\n  };\n\n  var getItemWidth = function getItemWidth(child) {\n    return child.rect.element.width + child.rect.element.marginLeft * 0.5 + child.rect.element.marginRight * 0.5;\n  };\n\n  var dragItem = function dragItem(_ref4) {\n    var root = _ref4.root,\n        action = _ref4.action;\n    var id = action.id,\n        dragState = action.dragState; // reference to item\n\n    var item = root.query('GET_ITEM', {\n      id: id\n    }); // get the view matching the given id\n\n    var view = root.childViews.find(function (child) {\n      return child.id === id;\n    });\n    var numItems = root.childViews.length;\n    var oldIndex = dragState.getItemIndex(item); // if no view found, exit\n\n    if (!view) return;\n    var dragPosition = {\n      x: view.dragOrigin.x + view.dragOffset.x + view.dragCenter.x,\n      y: view.dragOrigin.y + view.dragOffset.y + view.dragCenter.y\n    }; // get drag area dimensions\n\n    var dragHeight = getItemHeight(view);\n    var dragWidth = getItemWidth(view); // get rows and columns (There will always be at least one row and one column if a file is present)\n\n    var cols = Math.floor(root.rect.outer.width / dragWidth);\n    if (cols > numItems) cols = numItems; // rows are used to find when we have left the preview area bounding box\n\n    var rows = Math.floor(numItems / cols + 1);\n    dropAreaDimensions.setHeight = dragHeight * rows;\n    dropAreaDimensions.setWidth = dragWidth * cols; // get new index of dragged item\n\n    var location = {\n      y: Math.floor(dragPosition.y / dragHeight),\n      x: Math.floor(dragPosition.x / dragWidth),\n      getGridIndex: function getGridIndex() {\n        if (dragPosition.y > dropAreaDimensions.getHeight || dragPosition.y < 0 || dragPosition.x > dropAreaDimensions.getWidth || dragPosition.x < 0) return oldIndex;\n        return this.y * cols + this.x;\n      },\n      getColIndex: function getColIndex() {\n        var items = root.query('GET_ACTIVE_ITEMS');\n        var visibleChildren = root.childViews.filter(function (child) {\n          return child.rect.element.height;\n        });\n        var children = items.map(function (item) {\n          return visibleChildren.find(function (childView) {\n            return childView.id === item.id;\n          });\n        });\n        var currentIndex = children.findIndex(function (child) {\n          return child === view;\n        });\n        var dragHeight = getItemHeight(view);\n        var l = children.length;\n        var idx = l;\n        var childHeight = 0;\n        var childBottom = 0;\n        var childTop = 0;\n\n        for (var i = 0; i < l; i++) {\n          childHeight = getItemHeight(children[i]);\n          childTop = childBottom;\n          childBottom = childTop + childHeight;\n\n          if (dragPosition.y < childBottom) {\n            if (currentIndex > i) {\n              if (dragPosition.y < childTop + dragHeight) {\n                idx = i;\n                break;\n              }\n\n              continue;\n            }\n\n            idx = i;\n            break;\n          }\n        }\n\n        return idx;\n      }\n    }; // get new index\n\n    var index = cols > 1 ? location.getGridIndex() : location.getColIndex();\n    root.dispatch('MOVE_ITEM', {\n      query: view,\n      index: index\n    }); // if the index of the item changed, dispatch reorder action\n\n    var currentIndex = dragState.getIndex();\n\n    if (currentIndex === undefined || currentIndex !== index) {\n      dragState.setIndex(index);\n      if (currentIndex === undefined) return;\n      root.dispatch('DID_REORDER_ITEMS', {\n        items: root.query('GET_ACTIVE_ITEMS'),\n        origin: oldIndex,\n        target: index\n      });\n    }\n  };\n  /**\n   * Setup action routes\n   */\n\n\n  var route$2 = createRoute({\n    DID_ADD_ITEM: addItemView,\n    DID_REMOVE_ITEM: removeItemView,\n    DID_DRAG_ITEM: dragItem\n  });\n  /**\n   * Write to view\n   * @param root\n   * @param actions\n   * @param props\n   */\n\n  var write$5 = function write(_ref5) {\n    var root = _ref5.root,\n        props = _ref5.props,\n        actions = _ref5.actions,\n        shouldOptimize = _ref5.shouldOptimize; // route actions\n\n    route$2({\n      root: root,\n      props: props,\n      actions: actions\n    });\n    var dragCoordinates = props.dragCoordinates; // available space on horizontal axis\n\n    var horizontalSpace = root.rect.element.width; // only draw children that have dimensions\n\n    var visibleChildren = root.childViews.filter(function (child) {\n      return child.rect.element.height;\n    }); // sort based on current active items\n\n    var children = root.query('GET_ACTIVE_ITEMS').map(function (item) {\n      return visibleChildren.find(function (child) {\n        return child.id === item.id;\n      });\n    }).filter(function (item) {\n      return item;\n    }); // get index\n\n    var dragIndex = dragCoordinates ? getItemIndexByPosition(root, children, dragCoordinates) : null; // add index is used to reserve the dropped/added item index till the actual item is rendered\n\n    var addIndex = root.ref.addIndex || null; // add index no longer needed till possibly next draw\n\n    root.ref.addIndex = null;\n    var dragIndexOffset = 0;\n    var removeIndexOffset = 0;\n    var addIndexOffset = 0;\n    if (children.length === 0) return;\n    var childRect = children[0].rect.element;\n    var itemVerticalMargin = childRect.marginTop + childRect.marginBottom;\n    var itemHorizontalMargin = childRect.marginLeft + childRect.marginRight;\n    var itemWidth = childRect.width + itemHorizontalMargin;\n    var itemHeight = childRect.height + itemVerticalMargin;\n    var itemsPerRow = getItemsPerRow(horizontalSpace, itemWidth); // stack\n\n    if (itemsPerRow === 1) {\n      var offsetY = 0;\n      var dragOffset = 0;\n      children.forEach(function (child, index) {\n        if (dragIndex) {\n          var dist = index - dragIndex;\n\n          if (dist === -2) {\n            dragOffset = -itemVerticalMargin * 0.25;\n          } else if (dist === -1) {\n            dragOffset = -itemVerticalMargin * 0.75;\n          } else if (dist === 0) {\n            dragOffset = itemVerticalMargin * 0.75;\n          } else if (dist === 1) {\n            dragOffset = itemVerticalMargin * 0.25;\n          } else {\n            dragOffset = 0;\n          }\n        }\n\n        if (shouldOptimize) {\n          child.translateX = null;\n          child.translateY = null;\n        }\n\n        if (!child.markedForRemoval) {\n          moveItem(child, 0, offsetY + dragOffset);\n        }\n\n        var itemHeight = child.rect.element.height + itemVerticalMargin;\n        var visualHeight = itemHeight * (child.markedForRemoval ? child.opacity : 1);\n        offsetY += visualHeight;\n      });\n    } // grid\n    else {\n        var prevX = 0;\n        var prevY = 0;\n        children.forEach(function (child, index) {\n          if (index === dragIndex) {\n            dragIndexOffset = 1;\n          }\n\n          if (index === addIndex) {\n            addIndexOffset += 1;\n          }\n\n          if (child.markedForRemoval && child.opacity < 0.5) {\n            removeIndexOffset -= 1;\n          }\n\n          var visualIndex = index + addIndexOffset + dragIndexOffset + removeIndexOffset;\n          var indexX = visualIndex % itemsPerRow;\n          var indexY = Math.floor(visualIndex / itemsPerRow);\n          var offsetX = indexX * itemWidth;\n          var offsetY = indexY * itemHeight;\n          var vectorX = Math.sign(offsetX - prevX);\n          var vectorY = Math.sign(offsetY - prevY);\n          prevX = offsetX;\n          prevY = offsetY;\n          if (child.markedForRemoval) return;\n\n          if (shouldOptimize) {\n            child.translateX = null;\n            child.translateY = null;\n          }\n\n          moveItem(child, offsetX, offsetY, vectorX, vectorY);\n        });\n      }\n  };\n  /**\n   * Filters actions that are meant specifically for a certain child of the list\n   * @param child\n   * @param actions\n   */\n\n\n  var filterSetItemActions = function filterSetItemActions(child, actions) {\n    return actions.filter(function (action) {\n      // if action has an id, filter out actions that don't have this child id\n      if (action.data && action.data.id) {\n        return child.id === action.data.id;\n      } // allow all other actions\n\n\n      return true;\n    });\n  };\n\n  var list = createView({\n    create: create$8,\n    write: write$5,\n    tag: 'ul',\n    name: 'list',\n    didWriteView: function didWriteView(_ref6) {\n      var root = _ref6.root;\n      root.childViews.filter(function (view) {\n        return view.markedForRemoval && view.opacity === 0 && view.resting;\n      }).forEach(function (view) {\n        view._destroy();\n\n        root.removeChildView(view);\n      });\n    },\n    filterFrameActionsForChild: filterSetItemActions,\n    mixins: {\n      apis: ['dragCoordinates']\n    }\n  });\n\n  var create$9 = function create(_ref) {\n    var root = _ref.root,\n        props = _ref.props;\n    root.ref.list = root.appendChildView(root.createChildView(list));\n    props.dragCoordinates = null;\n    props.overflowing = false;\n  };\n\n  var storeDragCoordinates = function storeDragCoordinates(_ref2) {\n    var root = _ref2.root,\n        props = _ref2.props,\n        action = _ref2.action;\n    if (!root.query('GET_ITEM_INSERT_LOCATION_FREEDOM')) return;\n    props.dragCoordinates = {\n      left: action.position.scopeLeft - root.ref.list.rect.element.left,\n      top: action.position.scopeTop - (root.rect.outer.top + root.rect.element.marginTop + root.rect.element.scrollTop)\n    };\n  };\n\n  var clearDragCoordinates = function clearDragCoordinates(_ref3) {\n    var props = _ref3.props;\n    props.dragCoordinates = null;\n  };\n\n  var route$3 = createRoute({\n    DID_DRAG: storeDragCoordinates,\n    DID_END_DRAG: clearDragCoordinates\n  });\n\n  var write$6 = function write(_ref4) {\n    var root = _ref4.root,\n        props = _ref4.props,\n        actions = _ref4.actions; // route actions\n\n    route$3({\n      root: root,\n      props: props,\n      actions: actions\n    }); // current drag position\n\n    root.ref.list.dragCoordinates = props.dragCoordinates; // if currently overflowing but no longer received overflow\n\n    if (props.overflowing && !props.overflow) {\n      props.overflowing = false; // reset overflow state\n\n      root.element.dataset.state = '';\n      root.height = null;\n    } // if is not overflowing currently but does receive overflow value\n\n\n    if (props.overflow) {\n      var newHeight = Math.round(props.overflow);\n\n      if (newHeight !== root.height) {\n        props.overflowing = true;\n        root.element.dataset.state = 'overflow';\n        root.height = newHeight;\n      }\n    }\n  };\n\n  var listScroller = createView({\n    create: create$9,\n    write: write$6,\n    name: 'list-scroller',\n    mixins: {\n      apis: ['overflow', 'dragCoordinates'],\n      styles: ['height', 'translateY'],\n      animations: {\n        translateY: 'spring'\n      }\n    }\n  });\n\n  var attrToggle = function attrToggle(element, name, state) {\n    var enabledValue = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : '';\n\n    if (state) {\n      attr(element, name, enabledValue);\n    } else {\n      element.removeAttribute(name);\n    }\n  };\n\n  var resetFileInput = function resetFileInput(input) {\n    // no value, no need to reset\n    if (!input || input.value === '') {\n      return;\n    }\n\n    try {\n      // for modern browsers\n      input.value = '';\n    } catch (err) {} // for IE10\n\n\n    if (input.value) {\n      // quickly append input to temp form and reset form\n      var form = createElement$1('form');\n      var parentNode = input.parentNode;\n      var ref = input.nextSibling;\n      form.appendChild(input);\n      form.reset(); // re-inject input where it originally was\n\n      if (ref) {\n        parentNode.insertBefore(input, ref);\n      } else {\n        parentNode.appendChild(input);\n      }\n    }\n  };\n\n  var create$a = function create(_ref) {\n    var root = _ref.root,\n        props = _ref.props; // set id so can be referenced from outside labels\n\n    root.element.id = 'filepond--browser-' + props.id; // set name of element (is removed when a value is set)\n\n    attr(root.element, 'name', root.query('GET_NAME')); // we have to link this element to the status element\n\n    attr(root.element, 'aria-controls', 'filepond--assistant-' + props.id); // set label, we use labelled by as otherwise the screenreader does not read the \"browse\" text in the label (as it has tabindex: 0)\n\n    attr(root.element, 'aria-labelledby', 'filepond--drop-label-' + props.id); // set configurable props\n\n    setAcceptedFileTypes({\n      root: root,\n      action: {\n        value: root.query('GET_ACCEPTED_FILE_TYPES')\n      }\n    });\n    toggleAllowMultiple({\n      root: root,\n      action: {\n        value: root.query('GET_ALLOW_MULTIPLE')\n      }\n    });\n    toggleDirectoryFilter({\n      root: root,\n      action: {\n        value: root.query('GET_ALLOW_DIRECTORIES_ONLY')\n      }\n    });\n    toggleDisabled({\n      root: root\n    });\n    toggleRequired({\n      root: root,\n      action: {\n        value: root.query('GET_REQUIRED')\n      }\n    });\n    setCaptureMethod({\n      root: root,\n      action: {\n        value: root.query('GET_CAPTURE_METHOD')\n      }\n    }); // handle changes to the input field\n\n    root.ref.handleChange = function (e) {\n      if (!root.element.value) {\n        return;\n      } // extract files and move value of webkitRelativePath path to _relativePath\n\n\n      var files = Array.from(root.element.files).map(function (file) {\n        file._relativePath = file.webkitRelativePath;\n        return file;\n      }); // we add a little delay so the OS file select window can move out of the way before we add our file\n\n      setTimeout(function () {\n        // load files\n        props.onload(files); // reset input, it's just for exposing a method to drop files, should not retain any state\n\n        resetFileInput(root.element);\n      }, 250);\n    };\n\n    root.element.addEventListener('change', root.ref.handleChange);\n  };\n\n  var setAcceptedFileTypes = function setAcceptedFileTypes(_ref2) {\n    var root = _ref2.root,\n        action = _ref2.action;\n    if (!root.query('GET_ALLOW_SYNC_ACCEPT_ATTRIBUTE')) return;\n    attrToggle(root.element, 'accept', !!action.value, action.value ? action.value.join(',') : '');\n  };\n\n  var toggleAllowMultiple = function toggleAllowMultiple(_ref3) {\n    var root = _ref3.root,\n        action = _ref3.action;\n    attrToggle(root.element, 'multiple', action.value);\n  };\n\n  var toggleDirectoryFilter = function toggleDirectoryFilter(_ref4) {\n    var root = _ref4.root,\n        action = _ref4.action;\n    attrToggle(root.element, 'webkitdirectory', action.value);\n  };\n\n  var toggleDisabled = function toggleDisabled(_ref5) {\n    var root = _ref5.root;\n    var isDisabled = root.query('GET_DISABLED');\n    var doesAllowBrowse = root.query('GET_ALLOW_BROWSE');\n    var disableField = isDisabled || !doesAllowBrowse;\n    attrToggle(root.element, 'disabled', disableField);\n  };\n\n  var toggleRequired = function toggleRequired(_ref6) {\n    var root = _ref6.root,\n        action = _ref6.action; // want to remove required, always possible\n\n    if (!action.value) {\n      attrToggle(root.element, 'required', false);\n    } // if want to make required, only possible when zero items\n    else if (root.query('GET_TOTAL_ITEMS') === 0) {\n        attrToggle(root.element, 'required', true);\n      }\n  };\n\n  var setCaptureMethod = function setCaptureMethod(_ref7) {\n    var root = _ref7.root,\n        action = _ref7.action;\n    attrToggle(root.element, 'capture', !!action.value, action.value === true ? '' : action.value);\n  };\n\n  var updateRequiredStatus = function updateRequiredStatus(_ref8) {\n    var root = _ref8.root;\n    var element = root.element; // always remove the required attribute when more than zero items\n\n    if (root.query('GET_TOTAL_ITEMS') > 0) {\n      attrToggle(element, 'required', false);\n      attrToggle(element, 'name', false);\n    } else {\n      // add name attribute\n      attrToggle(element, 'name', true, root.query('GET_NAME')); // remove any validation messages\n\n      var shouldCheckValidity = root.query('GET_CHECK_VALIDITY');\n\n      if (shouldCheckValidity) {\n        element.setCustomValidity('');\n      } // we only add required if the field has been deemed required\n\n\n      if (root.query('GET_REQUIRED')) {\n        attrToggle(element, 'required', true);\n      }\n    }\n  };\n\n  var updateFieldValidityStatus = function updateFieldValidityStatus(_ref9) {\n    var root = _ref9.root;\n    var shouldCheckValidity = root.query('GET_CHECK_VALIDITY');\n    if (!shouldCheckValidity) return;\n    root.element.setCustomValidity(root.query('GET_LABEL_INVALID_FIELD'));\n  };\n\n  var browser = createView({\n    tag: 'input',\n    name: 'browser',\n    ignoreRect: true,\n    ignoreRectUpdate: true,\n    attributes: {\n      type: 'file'\n    },\n    create: create$a,\n    destroy: function destroy(_ref10) {\n      var root = _ref10.root;\n      root.element.removeEventListener('change', root.ref.handleChange);\n    },\n    write: createRoute({\n      DID_LOAD_ITEM: updateRequiredStatus,\n      DID_REMOVE_ITEM: updateRequiredStatus,\n      DID_THROW_ITEM_INVALID: updateFieldValidityStatus,\n      DID_SET_DISABLED: toggleDisabled,\n      DID_SET_ALLOW_BROWSE: toggleDisabled,\n      DID_SET_ALLOW_DIRECTORIES_ONLY: toggleDirectoryFilter,\n      DID_SET_ALLOW_MULTIPLE: toggleAllowMultiple,\n      DID_SET_ACCEPTED_FILE_TYPES: setAcceptedFileTypes,\n      DID_SET_CAPTURE_METHOD: setCaptureMethod,\n      DID_SET_REQUIRED: toggleRequired\n    })\n  });\n  var Key = {\n    ENTER: 13,\n    SPACE: 32\n  };\n\n  var create$b = function create(_ref) {\n    var root = _ref.root,\n        props = _ref.props; // create the label and link it to the file browser\n\n    var label = createElement$1('label');\n    attr(label, 'for', 'filepond--browser-' + props.id); // use for labeling file input (aria-labelledby on file input)\n\n    attr(label, 'id', 'filepond--drop-label-' + props.id); // hide the label for screenreaders, the input element will read the contents of the label when it's focussed. If we don't set aria-hidden the screenreader will also navigate the contents of the label separately from the input.\n\n    attr(label, 'aria-hidden', 'true'); // handle keys\n\n    root.ref.handleKeyDown = function (e) {\n      var isActivationKey = e.keyCode === Key.ENTER || e.keyCode === Key.SPACE;\n      if (!isActivationKey) return; // stops from triggering the element a second time\n\n      e.preventDefault(); // click link (will then in turn activate file input)\n\n      root.ref.label.click();\n    };\n\n    root.ref.handleClick = function (e) {\n      var isLabelClick = e.target === label || label.contains(e.target); // don't want to click twice\n\n      if (isLabelClick) return; // click link (will then in turn activate file input)\n\n      root.ref.label.click();\n    }; // attach events\n\n\n    label.addEventListener('keydown', root.ref.handleKeyDown);\n    root.element.addEventListener('click', root.ref.handleClick); // update\n\n    updateLabelValue(label, props.caption); // add!\n\n    root.appendChild(label);\n    root.ref.label = label;\n  };\n\n  var updateLabelValue = function updateLabelValue(label, value) {\n    label.innerHTML = value;\n    var clickable = label.querySelector('.filepond--label-action');\n\n    if (clickable) {\n      attr(clickable, 'tabindex', '0');\n    }\n\n    return value;\n  };\n\n  var dropLabel = createView({\n    name: 'drop-label',\n    ignoreRect: true,\n    create: create$b,\n    destroy: function destroy(_ref2) {\n      var root = _ref2.root;\n      root.ref.label.addEventListener('keydown', root.ref.handleKeyDown);\n      root.element.removeEventListener('click', root.ref.handleClick);\n    },\n    write: createRoute({\n      DID_SET_LABEL_IDLE: function DID_SET_LABEL_IDLE(_ref3) {\n        var root = _ref3.root,\n            action = _ref3.action;\n        updateLabelValue(root.ref.label, action.value);\n      }\n    }),\n    mixins: {\n      styles: ['opacity', 'translateX', 'translateY'],\n      animations: {\n        opacity: {\n          type: 'tween',\n          duration: 150\n        },\n        translateX: 'spring',\n        translateY: 'spring'\n      }\n    }\n  });\n  var blob = createView({\n    name: 'drip-blob',\n    ignoreRect: true,\n    mixins: {\n      styles: ['translateX', 'translateY', 'scaleX', 'scaleY', 'opacity'],\n      animations: {\n        scaleX: 'spring',\n        scaleY: 'spring',\n        translateX: 'spring',\n        translateY: 'spring',\n        opacity: {\n          type: 'tween',\n          duration: 250\n        }\n      }\n    }\n  });\n\n  var addBlob = function addBlob(_ref) {\n    var root = _ref.root;\n    var centerX = root.rect.element.width * 0.5;\n    var centerY = root.rect.element.height * 0.5;\n    root.ref.blob = root.appendChildView(root.createChildView(blob, {\n      opacity: 0,\n      scaleX: 2.5,\n      scaleY: 2.5,\n      translateX: centerX,\n      translateY: centerY\n    }));\n  };\n\n  var moveBlob = function moveBlob(_ref2) {\n    var root = _ref2.root,\n        action = _ref2.action;\n\n    if (!root.ref.blob) {\n      addBlob({\n        root: root\n      });\n      return;\n    }\n\n    root.ref.blob.translateX = action.position.scopeLeft;\n    root.ref.blob.translateY = action.position.scopeTop;\n    root.ref.blob.scaleX = 1;\n    root.ref.blob.scaleY = 1;\n    root.ref.blob.opacity = 1;\n  };\n\n  var hideBlob = function hideBlob(_ref3) {\n    var root = _ref3.root;\n\n    if (!root.ref.blob) {\n      return;\n    }\n\n    root.ref.blob.opacity = 0;\n  };\n\n  var explodeBlob = function explodeBlob(_ref4) {\n    var root = _ref4.root;\n\n    if (!root.ref.blob) {\n      return;\n    }\n\n    root.ref.blob.scaleX = 2.5;\n    root.ref.blob.scaleY = 2.5;\n    root.ref.blob.opacity = 0;\n  };\n\n  var write$7 = function write(_ref5) {\n    var root = _ref5.root,\n        props = _ref5.props,\n        actions = _ref5.actions;\n    route$4({\n      root: root,\n      props: props,\n      actions: actions\n    });\n    var blob = root.ref.blob;\n\n    if (actions.length === 0 && blob && blob.opacity === 0) {\n      root.removeChildView(blob);\n      root.ref.blob = null;\n    }\n  };\n\n  var route$4 = createRoute({\n    DID_DRAG: moveBlob,\n    DID_DROP: explodeBlob,\n    DID_END_DRAG: hideBlob\n  });\n  var drip = createView({\n    ignoreRect: true,\n    ignoreRectUpdate: true,\n    name: 'drip',\n    write: write$7\n  });\n\n  var setInputFiles = function setInputFiles(element, files) {\n    try {\n      // Create a DataTransfer instance and add a newly created file\n      var dataTransfer = new DataTransfer();\n      files.forEach(function (file) {\n        if (file instanceof File) {\n          dataTransfer.items.add(file);\n        } else {\n          dataTransfer.items.add(new File([file], file.name, {\n            type: file.type\n          }));\n        }\n      }); // Assign the DataTransfer files list to the file input\n\n      element.files = dataTransfer.files;\n    } catch (err) {\n      return false;\n    }\n\n    return true;\n  };\n\n  var create$c = function create(_ref) {\n    var root = _ref.root;\n    return root.ref.fields = {};\n  };\n\n  var getField = function getField(root, id) {\n    return root.ref.fields[id];\n  };\n\n  var syncFieldPositionsWithItems = function syncFieldPositionsWithItems(root) {\n    root.query('GET_ACTIVE_ITEMS').forEach(function (item) {\n      if (!root.ref.fields[item.id]) return;\n      root.element.appendChild(root.ref.fields[item.id]);\n    });\n  };\n\n  var didReorderItems = function didReorderItems(_ref2) {\n    var root = _ref2.root;\n    return syncFieldPositionsWithItems(root);\n  };\n\n  var didAddItem = function didAddItem(_ref3) {\n    var root = _ref3.root,\n        action = _ref3.action;\n    var fileItem = root.query('GET_ITEM', action.id);\n    var isLocalFile = fileItem.origin === FileOrigin.LOCAL;\n    var shouldUseFileInput = !isLocalFile && root.query('SHOULD_UPDATE_FILE_INPUT');\n    var dataContainer = createElement$1('input');\n    dataContainer.type = shouldUseFileInput ? 'file' : 'hidden';\n    dataContainer.name = root.query('GET_NAME');\n    dataContainer.disabled = root.query('GET_DISABLED');\n    root.ref.fields[action.id] = dataContainer;\n    syncFieldPositionsWithItems(root);\n  };\n\n  var didLoadItem$1 = function didLoadItem(_ref4) {\n    var root = _ref4.root,\n        action = _ref4.action;\n    var field = getField(root, action.id);\n    if (!field) return; // store server ref in hidden input\n\n    if (action.serverFileReference !== null) field.value = action.serverFileReference; // store file item in file input\n\n    if (!root.query('SHOULD_UPDATE_FILE_INPUT')) return;\n    var fileItem = root.query('GET_ITEM', action.id);\n    setInputFiles(field, [fileItem.file]);\n  };\n\n  var didPrepareOutput = function didPrepareOutput(_ref5) {\n    var root = _ref5.root,\n        action = _ref5.action; // this timeout pushes the handler after 'load'\n\n    if (!root.query('SHOULD_UPDATE_FILE_INPUT')) return;\n    setTimeout(function () {\n      var field = getField(root, action.id);\n      if (!field) return;\n      setInputFiles(field, [action.file]);\n    }, 0);\n  };\n\n  var didSetDisabled = function didSetDisabled(_ref6) {\n    var root = _ref6.root;\n    root.element.disabled = root.query('GET_DISABLED');\n  };\n\n  var didRemoveItem = function didRemoveItem(_ref7) {\n    var root = _ref7.root,\n        action = _ref7.action;\n    var field = getField(root, action.id);\n    if (!field) return;\n    if (field.parentNode) field.parentNode.removeChild(field);\n    delete root.ref.fields[action.id];\n  }; // only runs for server files (so doesn't deal with file input)\n\n\n  var didDefineValue = function didDefineValue(_ref8) {\n    var root = _ref8.root,\n        action = _ref8.action;\n    var field = getField(root, action.id);\n    if (!field) return;\n\n    if (action.value === null) {\n      // clear field value\n      field.removeAttribute('value');\n    } else {\n      // set field value\n      field.value = action.value;\n    }\n\n    syncFieldPositionsWithItems(root);\n  };\n\n  var write$8 = createRoute({\n    DID_SET_DISABLED: didSetDisabled,\n    DID_ADD_ITEM: didAddItem,\n    DID_LOAD_ITEM: didLoadItem$1,\n    DID_REMOVE_ITEM: didRemoveItem,\n    DID_DEFINE_VALUE: didDefineValue,\n    DID_PREPARE_OUTPUT: didPrepareOutput,\n    DID_REORDER_ITEMS: didReorderItems,\n    DID_SORT_ITEMS: didReorderItems\n  });\n  var data = createView({\n    tag: 'fieldset',\n    name: 'data',\n    create: create$c,\n    write: write$8,\n    ignoreRect: true\n  });\n\n  var getRootNode = function getRootNode(element) {\n    return 'getRootNode' in element ? element.getRootNode() : document;\n  };\n\n  var images = ['jpg', 'jpeg', 'png', 'gif', 'bmp', 'webp', 'svg', 'tiff'];\n  var text$1 = ['css', 'csv', 'html', 'txt'];\n  var map = {\n    zip: 'zip|compressed',\n    epub: 'application/epub+zip'\n  };\n\n  var guesstimateMimeType = function guesstimateMimeType() {\n    var extension = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '';\n    extension = extension.toLowerCase();\n\n    if (images.includes(extension)) {\n      return 'image/' + (extension === 'jpg' ? 'jpeg' : extension === 'svg' ? 'svg+xml' : extension);\n    }\n\n    if (text$1.includes(extension)) {\n      return 'text/' + extension;\n    }\n\n    return map[extension] || '';\n  };\n\n  var requestDataTransferItems = function requestDataTransferItems(dataTransfer) {\n    return new Promise(function (resolve, reject) {\n      // try to get links from transfer, if found we'll exit immediately (unless a file is in the dataTransfer as well, this is because Firefox could represent the file as a URL and a file object at the same time)\n      var links = getLinks(dataTransfer);\n\n      if (links.length && !hasFiles(dataTransfer)) {\n        return resolve(links);\n      } // try to get files from the transfer\n\n\n      getFiles(dataTransfer).then(resolve);\n    });\n  };\n  /**\n   * Test if datatransfer has files\n   */\n\n\n  var hasFiles = function hasFiles(dataTransfer) {\n    if (dataTransfer.files) return dataTransfer.files.length > 0;\n    return false;\n  };\n  /**\n   * Extracts files from a DataTransfer object\n   */\n\n\n  var getFiles = function getFiles(dataTransfer) {\n    return new Promise(function (resolve, reject) {\n      // get the transfer items as promises\n      var promisedFiles = (dataTransfer.items ? Array.from(dataTransfer.items) : []). // only keep file system items (files and directories)\n      filter(function (item) {\n        return isFileSystemItem(item);\n      }) // map each item to promise\n      .map(function (item) {\n        return getFilesFromItem(item);\n      }); // if is empty, see if we can extract some info from the files property as a fallback\n\n      if (!promisedFiles.length) {\n        // TODO: test for directories (should not be allowed)\n        // Use FileReader, problem is that the files property gets lost in the process\n        resolve(dataTransfer.files ? Array.from(dataTransfer.files) : []);\n        return;\n      } // done!\n\n\n      Promise.all(promisedFiles).then(function (returnedFileGroups) {\n        // flatten groups\n        var files = [];\n        returnedFileGroups.forEach(function (group) {\n          files.push.apply(files, group);\n        }); // done (filter out empty files)!\n\n        resolve(files.filter(function (file) {\n          return file;\n        }).map(function (file) {\n          if (!file._relativePath) file._relativePath = file.webkitRelativePath;\n          return file;\n        }));\n      }).catch(console.error);\n    });\n  };\n\n  var isFileSystemItem = function isFileSystemItem(item) {\n    if (isEntry(item)) {\n      var entry = getAsEntry(item);\n\n      if (entry) {\n        return entry.isFile || entry.isDirectory;\n      }\n    }\n\n    return item.kind === 'file';\n  };\n\n  var getFilesFromItem = function getFilesFromItem(item) {\n    return new Promise(function (resolve, reject) {\n      if (isDirectoryEntry(item)) {\n        getFilesInDirectory(getAsEntry(item)).then(resolve).catch(reject);\n        return;\n      }\n\n      resolve([item.getAsFile()]);\n    });\n  };\n\n  var getFilesInDirectory = function getFilesInDirectory(entry) {\n    return new Promise(function (resolve, reject) {\n      var files = []; // the total entries to read\n\n      var dirCounter = 0;\n      var fileCounter = 0;\n\n      var resolveIfDone = function resolveIfDone() {\n        if (fileCounter === 0 && dirCounter === 0) {\n          resolve(files);\n        }\n      }; // the recursive function\n\n\n      var readEntries = function readEntries(dirEntry) {\n        dirCounter++;\n        var directoryReader = dirEntry.createReader(); // directories are returned in batches, we need to process all batches before we're done\n\n        var readBatch = function readBatch() {\n          directoryReader.readEntries(function (entries) {\n            if (entries.length === 0) {\n              dirCounter--;\n              resolveIfDone();\n              return;\n            }\n\n            entries.forEach(function (entry) {\n              // recursively read more directories\n              if (entry.isDirectory) {\n                readEntries(entry);\n              } else {\n                // read as file\n                fileCounter++;\n                entry.file(function (file) {\n                  var correctedFile = correctMissingFileType(file);\n                  if (entry.fullPath) correctedFile._relativePath = entry.fullPath;\n                  files.push(correctedFile);\n                  fileCounter--;\n                  resolveIfDone();\n                });\n              }\n            }); // try to get next batch of files\n\n            readBatch();\n          }, reject);\n        }; // read first batch of files\n\n\n        readBatch();\n      }; // go!\n\n\n      readEntries(entry);\n    });\n  };\n\n  var correctMissingFileType = function correctMissingFileType(file) {\n    if (file.type.length) return file;\n    var date = file.lastModifiedDate;\n    var name = file.name;\n    var type = guesstimateMimeType(getExtensionFromFilename(file.name));\n    if (!type.length) return file;\n    file = file.slice(0, file.size, type);\n    file.name = name;\n    file.lastModifiedDate = date;\n    return file;\n  };\n\n  var isDirectoryEntry = function isDirectoryEntry(item) {\n    return isEntry(item) && (getAsEntry(item) || {}).isDirectory;\n  };\n\n  var isEntry = function isEntry(item) {\n    return 'webkitGetAsEntry' in item;\n  };\n\n  var getAsEntry = function getAsEntry(item) {\n    return item.webkitGetAsEntry();\n  };\n  /**\n   * Extracts links from a DataTransfer object\n   */\n\n\n  var getLinks = function getLinks(dataTransfer) {\n    var links = [];\n\n    try {\n      // look in meta data property\n      links = getLinksFromTransferMetaData(dataTransfer);\n\n      if (links.length) {\n        return links;\n      }\n\n      links = getLinksFromTransferURLData(dataTransfer);\n    } catch (e) {// nope nope nope (probably IE trouble)\n    }\n\n    return links;\n  };\n\n  var getLinksFromTransferURLData = function getLinksFromTransferURLData(dataTransfer) {\n    var data = dataTransfer.getData('url');\n\n    if (typeof data === 'string' && data.length) {\n      return [data];\n    }\n\n    return [];\n  };\n\n  var getLinksFromTransferMetaData = function getLinksFromTransferMetaData(dataTransfer) {\n    var data = dataTransfer.getData('text/html');\n\n    if (typeof data === 'string' && data.length) {\n      var matches = data.match(/src\\s*=\\s*\"(.+?)\"/);\n\n      if (matches) {\n        return [matches[1]];\n      }\n    }\n\n    return [];\n  };\n\n  var dragNDropObservers = [];\n\n  var eventPosition = function eventPosition(e) {\n    return {\n      pageLeft: e.pageX,\n      pageTop: e.pageY,\n      scopeLeft: e.offsetX || e.layerX,\n      scopeTop: e.offsetY || e.layerY\n    };\n  };\n\n  var createDragNDropClient = function createDragNDropClient(element, scopeToObserve, filterElement) {\n    var observer = getDragNDropObserver(scopeToObserve);\n    var client = {\n      element: element,\n      filterElement: filterElement,\n      state: null,\n      ondrop: function ondrop() {},\n      onenter: function onenter() {},\n      ondrag: function ondrag() {},\n      onexit: function onexit() {},\n      onload: function onload() {},\n      allowdrop: function allowdrop() {}\n    };\n    client.destroy = observer.addListener(client);\n    return client;\n  };\n\n  var getDragNDropObserver = function getDragNDropObserver(element) {\n    // see if already exists, if so, return\n    var observer = dragNDropObservers.find(function (item) {\n      return item.element === element;\n    });\n\n    if (observer) {\n      return observer;\n    } // create new observer, does not yet exist for this element\n\n\n    var newObserver = createDragNDropObserver(element);\n    dragNDropObservers.push(newObserver);\n    return newObserver;\n  };\n\n  var createDragNDropObserver = function createDragNDropObserver(element) {\n    var clients = [];\n    var routes = {\n      dragenter: dragenter,\n      dragover: dragover,\n      dragleave: dragleave,\n      drop: drop\n    };\n    var handlers = {};\n    forin(routes, function (event, createHandler) {\n      handlers[event] = createHandler(element, clients);\n      element.addEventListener(event, handlers[event], false);\n    });\n    var observer = {\n      element: element,\n      addListener: function addListener(client) {\n        // add as client\n        clients.push(client); // return removeListener function\n\n        return function () {\n          // remove client\n          clients.splice(clients.indexOf(client), 1); // if no more clients, clean up observer\n\n          if (clients.length === 0) {\n            dragNDropObservers.splice(dragNDropObservers.indexOf(observer), 1);\n            forin(routes, function (event) {\n              element.removeEventListener(event, handlers[event], false);\n            });\n          }\n        };\n      }\n    };\n    return observer;\n  };\n\n  var elementFromPoint = function elementFromPoint(root, point) {\n    if (!('elementFromPoint' in root)) {\n      root = document;\n    }\n\n    return root.elementFromPoint(point.x, point.y);\n  };\n\n  var isEventTarget = function isEventTarget(e, target) {\n    // get root\n    var root = getRootNode(target); // get element at position\n    // if root is not actual shadow DOM and does not have elementFromPoint method, use the one on document\n\n    var elementAtPosition = elementFromPoint(root, {\n      x: e.pageX - window.pageXOffset,\n      y: e.pageY - window.pageYOffset\n    }); // test if target is the element or if one of its children is\n\n    return elementAtPosition === target || target.contains(elementAtPosition);\n  };\n\n  var initialTarget = null;\n\n  var setDropEffect = function setDropEffect(dataTransfer, effect) {\n    // is in try catch as IE11 will throw error if not\n    try {\n      dataTransfer.dropEffect = effect;\n    } catch (e) {}\n  };\n\n  var dragenter = function dragenter(root, clients) {\n    return function (e) {\n      e.preventDefault();\n      initialTarget = e.target;\n      clients.forEach(function (client) {\n        var element = client.element,\n            onenter = client.onenter;\n\n        if (isEventTarget(e, element)) {\n          client.state = 'enter'; // fire enter event\n\n          onenter(eventPosition(e));\n        }\n      });\n    };\n  };\n\n  var dragover = function dragover(root, clients) {\n    return function (e) {\n      e.preventDefault();\n      var dataTransfer = e.dataTransfer;\n      requestDataTransferItems(dataTransfer).then(function (items) {\n        var overDropTarget = false;\n        clients.some(function (client) {\n          var filterElement = client.filterElement,\n              element = client.element,\n              onenter = client.onenter,\n              onexit = client.onexit,\n              ondrag = client.ondrag,\n              allowdrop = client.allowdrop; // by default we can drop\n\n          setDropEffect(dataTransfer, 'copy'); // allow transfer of these items\n\n          var allowsTransfer = allowdrop(items); // only used when can be dropped on page\n\n          if (!allowsTransfer) {\n            setDropEffect(dataTransfer, 'none');\n            return;\n          } // targetting this client\n\n\n          if (isEventTarget(e, element)) {\n            overDropTarget = true; // had no previous state, means we are entering this client\n\n            if (client.state === null) {\n              client.state = 'enter';\n              onenter(eventPosition(e));\n              return;\n            } // now over element (no matter if it allows the drop or not)\n\n\n            client.state = 'over'; // needs to allow transfer\n\n            if (filterElement && !allowsTransfer) {\n              setDropEffect(dataTransfer, 'none');\n              return;\n            } // dragging\n\n\n            ondrag(eventPosition(e));\n          } else {\n            // should be over an element to drop\n            if (filterElement && !overDropTarget) {\n              setDropEffect(dataTransfer, 'none');\n            } // might have just left this client?\n\n\n            if (client.state) {\n              client.state = null;\n              onexit(eventPosition(e));\n            }\n          }\n        });\n      });\n    };\n  };\n\n  var drop = function drop(root, clients) {\n    return function (e) {\n      e.preventDefault();\n      var dataTransfer = e.dataTransfer;\n      requestDataTransferItems(dataTransfer).then(function (items) {\n        clients.forEach(function (client) {\n          var filterElement = client.filterElement,\n              element = client.element,\n              ondrop = client.ondrop,\n              onexit = client.onexit,\n              allowdrop = client.allowdrop;\n          client.state = null; // if we're filtering on element we need to be over the element to drop\n\n          if (filterElement && !isEventTarget(e, element)) return; // no transfer for this client\n\n          if (!allowdrop(items)) return onexit(eventPosition(e)); // we can drop these items on this client\n\n          ondrop(eventPosition(e), items);\n        });\n      });\n    };\n  };\n\n  var dragleave = function dragleave(root, clients) {\n    return function (e) {\n      if (initialTarget !== e.target) {\n        return;\n      }\n\n      clients.forEach(function (client) {\n        var onexit = client.onexit;\n        client.state = null;\n        onexit(eventPosition(e));\n      });\n    };\n  };\n\n  var createHopper = function createHopper(scope, validateItems, options) {\n    // is now hopper scope\n    scope.classList.add('filepond--hopper'); // shortcuts\n\n    var catchesDropsOnPage = options.catchesDropsOnPage,\n        requiresDropOnElement = options.requiresDropOnElement,\n        _options$filterItems = options.filterItems,\n        filterItems = _options$filterItems === void 0 ? function (items) {\n      return items;\n    } : _options$filterItems; // create a dnd client\n\n    var client = createDragNDropClient(scope, catchesDropsOnPage ? document.documentElement : scope, requiresDropOnElement); // current client state\n\n    var lastState = '';\n    var currentState = ''; // determines if a file may be dropped\n\n    client.allowdrop = function (items) {\n      // TODO: if we can, throw error to indicate the items cannot by dropped\n      return validateItems(filterItems(items));\n    };\n\n    client.ondrop = function (position, items) {\n      var filteredItems = filterItems(items);\n\n      if (!validateItems(filteredItems)) {\n        api.ondragend(position);\n        return;\n      }\n\n      currentState = 'drag-drop';\n      api.onload(filteredItems, position);\n    };\n\n    client.ondrag = function (position) {\n      api.ondrag(position);\n    };\n\n    client.onenter = function (position) {\n      currentState = 'drag-over';\n      api.ondragstart(position);\n    };\n\n    client.onexit = function (position) {\n      currentState = 'drag-exit';\n      api.ondragend(position);\n    };\n\n    var api = {\n      updateHopperState: function updateHopperState() {\n        if (lastState !== currentState) {\n          scope.dataset.hopperState = currentState;\n          lastState = currentState;\n        }\n      },\n      onload: function onload() {},\n      ondragstart: function ondragstart() {},\n      ondrag: function ondrag() {},\n      ondragend: function ondragend() {},\n      destroy: function destroy() {\n        // destroy client\n        client.destroy();\n      }\n    };\n    return api;\n  };\n\n  var listening = false;\n  var listeners$1 = [];\n\n  var handlePaste = function handlePaste(e) {\n    // if is pasting in input or textarea and the target is outside of a filepond scope, ignore\n    var activeEl = document.activeElement;\n\n    if (activeEl && /textarea|input/i.test(activeEl.nodeName)) {\n      // test textarea or input is contained in filepond root\n      var inScope = false;\n      var element = activeEl;\n\n      while (element !== document.body) {\n        if (element.classList.contains('filepond--root')) {\n          inScope = true;\n          break;\n        }\n\n        element = element.parentNode;\n      }\n\n      if (!inScope) return;\n    }\n\n    requestDataTransferItems(e.clipboardData).then(function (files) {\n      // no files received\n      if (!files.length) {\n        return;\n      } // notify listeners of received files\n\n\n      listeners$1.forEach(function (listener) {\n        return listener(files);\n      });\n    });\n  };\n\n  var listen = function listen(cb) {\n    // can't add twice\n    if (listeners$1.includes(cb)) {\n      return;\n    } // add initial listener\n\n\n    listeners$1.push(cb); // setup paste listener for entire page\n\n    if (listening) {\n      return;\n    }\n\n    listening = true;\n    document.addEventListener('paste', handlePaste);\n  };\n\n  var unlisten = function unlisten(listener) {\n    arrayRemove(listeners$1, listeners$1.indexOf(listener)); // clean up\n\n    if (listeners$1.length === 0) {\n      document.removeEventListener('paste', handlePaste);\n      listening = false;\n    }\n  };\n\n  var createPaster = function createPaster() {\n    var cb = function cb(files) {\n      api.onload(files);\n    };\n\n    var api = {\n      destroy: function destroy() {\n        unlisten(cb);\n      },\n      onload: function onload() {}\n    };\n    listen(cb);\n    return api;\n  };\n  /**\n   * Creates the file view\n   */\n\n\n  var create$d = function create(_ref) {\n    var root = _ref.root,\n        props = _ref.props;\n    root.element.id = 'filepond--assistant-' + props.id;\n    attr(root.element, 'role', 'status');\n    attr(root.element, 'aria-live', 'polite');\n    attr(root.element, 'aria-relevant', 'additions');\n  };\n\n  var addFilesNotificationTimeout = null;\n  var notificationClearTimeout = null;\n  var filenames = [];\n\n  var assist = function assist(root, message) {\n    root.element.textContent = message;\n  };\n\n  var clear$1 = function clear(root) {\n    root.element.textContent = '';\n  };\n\n  var listModified = function listModified(root, filename, label) {\n    var total = root.query('GET_TOTAL_ITEMS');\n    assist(root, label + ' ' + filename + ', ' + total + ' ' + (total === 1 ? root.query('GET_LABEL_FILE_COUNT_SINGULAR') : root.query('GET_LABEL_FILE_COUNT_PLURAL'))); // clear group after set amount of time so the status is not read twice\n\n    clearTimeout(notificationClearTimeout);\n    notificationClearTimeout = setTimeout(function () {\n      clear$1(root);\n    }, 1500);\n  };\n\n  var isUsingFilePond = function isUsingFilePond(root) {\n    return root.element.parentNode.contains(document.activeElement);\n  };\n\n  var itemAdded = function itemAdded(_ref2) {\n    var root = _ref2.root,\n        action = _ref2.action;\n\n    if (!isUsingFilePond(root)) {\n      return;\n    }\n\n    root.element.textContent = '';\n    var item = root.query('GET_ITEM', action.id);\n    filenames.push(item.filename);\n    clearTimeout(addFilesNotificationTimeout);\n    addFilesNotificationTimeout = setTimeout(function () {\n      listModified(root, filenames.join(', '), root.query('GET_LABEL_FILE_ADDED'));\n      filenames.length = 0;\n    }, 750);\n  };\n\n  var itemRemoved = function itemRemoved(_ref3) {\n    var root = _ref3.root,\n        action = _ref3.action;\n\n    if (!isUsingFilePond(root)) {\n      return;\n    }\n\n    var item = action.item;\n    listModified(root, item.filename, root.query('GET_LABEL_FILE_REMOVED'));\n  };\n\n  var itemProcessed = function itemProcessed(_ref4) {\n    var root = _ref4.root,\n        action = _ref4.action; // will also notify the user when FilePond is not being used, as the user might be occupied with other activities while uploading a file\n\n    var item = root.query('GET_ITEM', action.id);\n    var filename = item.filename;\n    var label = root.query('GET_LABEL_FILE_PROCESSING_COMPLETE');\n    assist(root, filename + ' ' + label);\n  };\n\n  var itemProcessedUndo = function itemProcessedUndo(_ref5) {\n    var root = _ref5.root,\n        action = _ref5.action;\n    var item = root.query('GET_ITEM', action.id);\n    var filename = item.filename;\n    var label = root.query('GET_LABEL_FILE_PROCESSING_ABORTED');\n    assist(root, filename + ' ' + label);\n  };\n\n  var itemError = function itemError(_ref6) {\n    var root = _ref6.root,\n        action = _ref6.action;\n    var item = root.query('GET_ITEM', action.id);\n    var filename = item.filename; // will also notify the user when FilePond is not being used, as the user might be occupied with other activities while uploading a file\n\n    assist(root, action.status.main + ' ' + filename + ' ' + action.status.sub);\n  };\n\n  var assistant = createView({\n    create: create$d,\n    ignoreRect: true,\n    ignoreRectUpdate: true,\n    write: createRoute({\n      DID_LOAD_ITEM: itemAdded,\n      DID_REMOVE_ITEM: itemRemoved,\n      DID_COMPLETE_ITEM_PROCESSING: itemProcessed,\n      DID_ABORT_ITEM_PROCESSING: itemProcessedUndo,\n      DID_REVERT_ITEM_PROCESSING: itemProcessedUndo,\n      DID_THROW_ITEM_REMOVE_ERROR: itemError,\n      DID_THROW_ITEM_LOAD_ERROR: itemError,\n      DID_THROW_ITEM_INVALID: itemError,\n      DID_THROW_ITEM_PROCESSING_ERROR: itemError\n    }),\n    tag: 'span',\n    name: 'assistant'\n  });\n\n  var toCamels = function toCamels(string) {\n    var separator = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : '-';\n    return string.replace(new RegExp(separator + '.', 'g'), function (sub) {\n      return sub.charAt(1).toUpperCase();\n    });\n  };\n\n  var debounce = function debounce(func) {\n    var interval = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 16;\n    var immidiateOnly = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : true;\n    var last = Date.now();\n    var timeout = null;\n    return function () {\n      for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n        args[_key] = arguments[_key];\n      }\n\n      clearTimeout(timeout);\n      var dist = Date.now() - last;\n\n      var fn = function fn() {\n        last = Date.now();\n        func.apply(void 0, args);\n      };\n\n      if (dist < interval) {\n        // we need to delay by the difference between interval and dist\n        // for example: if distance is 10 ms and interval is 16 ms,\n        // we need to wait an additional 6ms before calling the function)\n        if (!immidiateOnly) {\n          timeout = setTimeout(fn, interval - dist);\n        }\n      } else {\n        // go!\n        fn();\n      }\n    };\n  };\n\n  var MAX_FILES_LIMIT = 1000000;\n\n  var prevent = function prevent(e) {\n    return e.preventDefault();\n  };\n\n  var create$e = function create(_ref) {\n    var root = _ref.root,\n        props = _ref.props; // Add id\n\n    var id = root.query('GET_ID');\n\n    if (id) {\n      root.element.id = id;\n    } // Add className\n\n\n    var className = root.query('GET_CLASS_NAME');\n\n    if (className) {\n      className.split(' ').filter(function (name) {\n        return name.length;\n      }).forEach(function (name) {\n        root.element.classList.add(name);\n      });\n    } // Field label\n\n\n    root.ref.label = root.appendChildView(root.createChildView(dropLabel, Object.assign({}, props, {\n      translateY: null,\n      caption: root.query('GET_LABEL_IDLE')\n    }))); // List of items\n\n    root.ref.list = root.appendChildView(root.createChildView(listScroller, {\n      translateY: null\n    })); // Background panel\n\n    root.ref.panel = root.appendChildView(root.createChildView(panel, {\n      name: 'panel-root'\n    })); // Assistant notifies assistive tech when content changes\n\n    root.ref.assistant = root.appendChildView(root.createChildView(assistant, Object.assign({}, props))); // Data\n\n    root.ref.data = root.appendChildView(root.createChildView(data, Object.assign({}, props))); // Measure (tests if fixed height was set)\n    // DOCTYPE needs to be set for this to work\n\n    root.ref.measure = createElement$1('div');\n    root.ref.measure.style.height = '100%';\n    root.element.appendChild(root.ref.measure); // information on the root height or fixed height status\n\n    root.ref.bounds = null; // apply initial style properties\n\n    root.query('GET_STYLES').filter(function (style) {\n      return !isEmpty(style.value);\n    }).map(function (_ref2) {\n      var name = _ref2.name,\n          value = _ref2.value;\n      root.element.dataset[name] = value;\n    }); // determine if width changed\n\n    root.ref.widthPrevious = null;\n    root.ref.widthUpdated = debounce(function () {\n      root.ref.updateHistory = [];\n      root.dispatch('DID_RESIZE_ROOT');\n    }, 250); // history of updates\n\n    root.ref.previousAspectRatio = null;\n    root.ref.updateHistory = []; // prevent scrolling and zooming on iOS (only if supports pointer events, for then we can enable reorder)\n\n    var canHover = window.matchMedia('(pointer: fine) and (hover: hover)').matches;\n    var hasPointerEvents = ('PointerEvent' in window);\n\n    if (root.query('GET_ALLOW_REORDER') && hasPointerEvents && !canHover) {\n      root.element.addEventListener('touchmove', prevent, {\n        passive: false\n      });\n      root.element.addEventListener('gesturestart', prevent);\n    } // add credits\n\n\n    var credits = root.query('GET_CREDITS');\n    var hasCredits = credits.length === 2;\n\n    if (hasCredits) {\n      var frag = document.createElement('a');\n      frag.className = 'filepond--credits';\n      frag.setAttribute('aria-hidden', 'true');\n      frag.href = credits[0];\n      frag.tabindex = -1;\n      frag.target = '_blank';\n      frag.rel = 'noopener noreferrer';\n      frag.textContent = credits[1];\n      root.element.appendChild(frag);\n      root.ref.credits = frag;\n    }\n  };\n\n  var write$9 = function write(_ref3) {\n    var root = _ref3.root,\n        props = _ref3.props,\n        actions = _ref3.actions; // route actions\n\n    route$5({\n      root: root,\n      props: props,\n      actions: actions\n    }); // apply style properties\n\n    actions.filter(function (action) {\n      return /^DID_SET_STYLE_/.test(action.type);\n    }).filter(function (action) {\n      return !isEmpty(action.data.value);\n    }).map(function (_ref4) {\n      var type = _ref4.type,\n          data = _ref4.data;\n      var name = toCamels(type.substr(8).toLowerCase(), '_');\n      root.element.dataset[name] = data.value;\n      root.invalidateLayout();\n    });\n    if (root.rect.element.hidden) return;\n\n    if (root.rect.element.width !== root.ref.widthPrevious) {\n      root.ref.widthPrevious = root.rect.element.width;\n      root.ref.widthUpdated();\n    } // get box bounds, we do this only once\n\n\n    var bounds = root.ref.bounds;\n\n    if (!bounds) {\n      bounds = root.ref.bounds = calculateRootBoundingBoxHeight(root); // destroy measure element\n\n      root.element.removeChild(root.ref.measure);\n      root.ref.measure = null;\n    } // get quick references to various high level parts of the upload tool\n\n\n    var _root$ref = root.ref,\n        hopper = _root$ref.hopper,\n        label = _root$ref.label,\n        list = _root$ref.list,\n        panel = _root$ref.panel; // sets correct state to hopper scope\n\n    if (hopper) {\n      hopper.updateHopperState();\n    } // bool to indicate if we're full or not\n\n\n    var aspectRatio = root.query('GET_PANEL_ASPECT_RATIO');\n    var isMultiItem = root.query('GET_ALLOW_MULTIPLE');\n    var totalItems = root.query('GET_TOTAL_ITEMS');\n    var maxItems = isMultiItem ? root.query('GET_MAX_FILES') || MAX_FILES_LIMIT : 1;\n    var atMaxCapacity = totalItems === maxItems; // action used to add item\n\n    var addAction = actions.find(function (action) {\n      return action.type === 'DID_ADD_ITEM';\n    }); // if reached max capacity and we've just reached it\n\n    if (atMaxCapacity && addAction) {\n      // get interaction type\n      var interactionMethod = addAction.data.interactionMethod; // hide label\n\n      label.opacity = 0;\n\n      if (isMultiItem) {\n        label.translateY = -40;\n      } else {\n        if (interactionMethod === InteractionMethod.API) {\n          label.translateX = 40;\n        } else if (interactionMethod === InteractionMethod.BROWSE) {\n          label.translateY = 40;\n        } else {\n          label.translateY = 30;\n        }\n      }\n    } else if (!atMaxCapacity) {\n      label.opacity = 1;\n      label.translateX = 0;\n      label.translateY = 0;\n    }\n\n    var listItemMargin = calculateListItemMargin(root);\n    var listHeight = calculateListHeight(root);\n    var labelHeight = label.rect.element.height;\n    var currentLabelHeight = !isMultiItem || atMaxCapacity ? 0 : labelHeight;\n    var listMarginTop = atMaxCapacity ? list.rect.element.marginTop : 0;\n    var listMarginBottom = totalItems === 0 ? 0 : list.rect.element.marginBottom;\n    var visualHeight = currentLabelHeight + listMarginTop + listHeight.visual + listMarginBottom;\n    var boundsHeight = currentLabelHeight + listMarginTop + listHeight.bounds + listMarginBottom; // link list to label bottom position\n\n    list.translateY = Math.max(0, currentLabelHeight - list.rect.element.marginTop) - listItemMargin.top;\n\n    if (aspectRatio) {\n      // fixed aspect ratio\n      // calculate height based on width\n      var width = root.rect.element.width;\n      var height = width * aspectRatio; // clear history if aspect ratio has changed\n\n      if (aspectRatio !== root.ref.previousAspectRatio) {\n        root.ref.previousAspectRatio = aspectRatio;\n        root.ref.updateHistory = [];\n      } // remember this width\n\n\n      var history = root.ref.updateHistory;\n      history.push(width);\n      var MAX_BOUNCES = 2;\n\n      if (history.length > MAX_BOUNCES * 2) {\n        var l = history.length;\n        var bottom = l - 10;\n        var bounces = 0;\n\n        for (var i = l; i >= bottom; i--) {\n          if (history[i] === history[i - 2]) {\n            bounces++;\n          }\n\n          if (bounces >= MAX_BOUNCES) {\n            // dont adjust height\n            return;\n          }\n        }\n      } // fix height of panel so it adheres to aspect ratio\n\n\n      panel.scalable = false;\n      panel.height = height; // available height for list\n\n      var listAvailableHeight = // the height of the panel minus the label height\n      height - currentLabelHeight - ( // the room we leave open between the end of the list and the panel bottom\n      listMarginBottom - listItemMargin.bottom) - ( // if we're full we need to leave some room between the top of the panel and the list\n      atMaxCapacity ? listMarginTop : 0);\n\n      if (listHeight.visual > listAvailableHeight) {\n        list.overflow = listAvailableHeight;\n      } else {\n        list.overflow = null;\n      } // set container bounds (so pushes siblings downwards)\n\n\n      root.height = height;\n    } else if (bounds.fixedHeight) {\n      // fixed height\n      // fix height of panel\n      panel.scalable = false; // available height for list\n\n      var _listAvailableHeight = // the height of the panel minus the label height\n      bounds.fixedHeight - currentLabelHeight - ( // the room we leave open between the end of the list and the panel bottom\n      listMarginBottom - listItemMargin.bottom) - ( // if we're full we need to leave some room between the top of the panel and the list\n      atMaxCapacity ? listMarginTop : 0); // set list height\n\n\n      if (listHeight.visual > _listAvailableHeight) {\n        list.overflow = _listAvailableHeight;\n      } else {\n        list.overflow = null;\n      } // no need to set container bounds as these are handles by CSS fixed height\n\n    } else if (bounds.cappedHeight) {\n      // max-height\n      // not a fixed height panel\n      var isCappedHeight = visualHeight >= bounds.cappedHeight;\n      var panelHeight = Math.min(bounds.cappedHeight, visualHeight);\n      panel.scalable = true;\n      panel.height = isCappedHeight ? panelHeight : panelHeight - listItemMargin.top - listItemMargin.bottom; // available height for list\n\n      var _listAvailableHeight2 = // the height of the panel minus the label height\n      panelHeight - currentLabelHeight - ( // the room we leave open between the end of the list and the panel bottom\n      listMarginBottom - listItemMargin.bottom) - ( // if we're full we need to leave some room between the top of the panel and the list\n      atMaxCapacity ? listMarginTop : 0); // set list height (if is overflowing)\n\n\n      if (visualHeight > bounds.cappedHeight && listHeight.visual > _listAvailableHeight2) {\n        list.overflow = _listAvailableHeight2;\n      } else {\n        list.overflow = null;\n      } // set container bounds (so pushes siblings downwards)\n\n\n      root.height = Math.min(bounds.cappedHeight, boundsHeight - listItemMargin.top - listItemMargin.bottom);\n    } else {\n      // flexible height\n      // not a fixed height panel\n      var itemMargin = totalItems > 0 ? listItemMargin.top + listItemMargin.bottom : 0;\n      panel.scalable = true;\n      panel.height = Math.max(labelHeight, visualHeight - itemMargin); // set container bounds (so pushes siblings downwards)\n\n      root.height = Math.max(labelHeight, boundsHeight - itemMargin);\n    } // move credits to bottom\n\n\n    if (root.ref.credits && panel.heightCurrent) root.ref.credits.style.transform = 'translateY(' + panel.heightCurrent + 'px)';\n  };\n\n  var calculateListItemMargin = function calculateListItemMargin(root) {\n    var item = root.ref.list.childViews[0].childViews[0];\n    return item ? {\n      top: item.rect.element.marginTop,\n      bottom: item.rect.element.marginBottom\n    } : {\n      top: 0,\n      bottom: 0\n    };\n  };\n\n  var calculateListHeight = function calculateListHeight(root) {\n    var visual = 0;\n    var bounds = 0; // get file list reference\n\n    var scrollList = root.ref.list;\n    var itemList = scrollList.childViews[0];\n    var visibleChildren = itemList.childViews.filter(function (child) {\n      return child.rect.element.height;\n    });\n    var children = root.query('GET_ACTIVE_ITEMS').map(function (item) {\n      return visibleChildren.find(function (child) {\n        return child.id === item.id;\n      });\n    }).filter(function (item) {\n      return item;\n    }); // no children, done!\n\n    if (children.length === 0) return {\n      visual: visual,\n      bounds: bounds\n    };\n    var horizontalSpace = itemList.rect.element.width;\n    var dragIndex = getItemIndexByPosition(itemList, children, scrollList.dragCoordinates);\n    var childRect = children[0].rect.element;\n    var itemVerticalMargin = childRect.marginTop + childRect.marginBottom;\n    var itemHorizontalMargin = childRect.marginLeft + childRect.marginRight;\n    var itemWidth = childRect.width + itemHorizontalMargin;\n    var itemHeight = childRect.height + itemVerticalMargin;\n    var newItem = typeof dragIndex !== 'undefined' && dragIndex >= 0 ? 1 : 0;\n    var removedItem = children.find(function (child) {\n      return child.markedForRemoval && child.opacity < 0.45;\n    }) ? -1 : 0;\n    var verticalItemCount = children.length + newItem + removedItem;\n    var itemsPerRow = getItemsPerRow(horizontalSpace, itemWidth); // stack\n\n    if (itemsPerRow === 1) {\n      children.forEach(function (item) {\n        var height = item.rect.element.height + itemVerticalMargin;\n        bounds += height;\n        visual += height * item.opacity;\n      });\n    } // grid\n    else {\n        bounds = Math.ceil(verticalItemCount / itemsPerRow) * itemHeight;\n        visual = bounds;\n      }\n\n    return {\n      visual: visual,\n      bounds: bounds\n    };\n  };\n\n  var calculateRootBoundingBoxHeight = function calculateRootBoundingBoxHeight(root) {\n    var height = root.ref.measureHeight || null;\n    var cappedHeight = parseInt(root.style.maxHeight, 10) || null;\n    var fixedHeight = height === 0 ? null : height;\n    return {\n      cappedHeight: cappedHeight,\n      fixedHeight: fixedHeight\n    };\n  };\n\n  var exceedsMaxFiles = function exceedsMaxFiles(root, items) {\n    var allowReplace = root.query('GET_ALLOW_REPLACE');\n    var allowMultiple = root.query('GET_ALLOW_MULTIPLE');\n    var totalItems = root.query('GET_TOTAL_ITEMS');\n    var maxItems = root.query('GET_MAX_FILES'); // total amount of items being dragged\n\n    var totalBrowseItems = items.length; // if does not allow multiple items and dragging more than one item\n\n    if (!allowMultiple && totalBrowseItems > 1) {\n      return true;\n    } // limit max items to one if not allowed to drop multiple items\n\n\n    maxItems = allowMultiple ? maxItems : allowReplace ? maxItems : 1; // no more room?\n\n    var hasMaxItems = isInt(maxItems);\n\n    if (hasMaxItems && totalItems + totalBrowseItems > maxItems) {\n      root.dispatch('DID_THROW_MAX_FILES', {\n        source: items,\n        error: createResponse('warning', 0, 'Max files')\n      });\n      return true;\n    }\n\n    return false;\n  };\n\n  var getDragIndex = function getDragIndex(list, children, position) {\n    var itemList = list.childViews[0];\n    return getItemIndexByPosition(itemList, children, {\n      left: position.scopeLeft - itemList.rect.element.left,\n      top: position.scopeTop - (list.rect.outer.top + list.rect.element.marginTop + list.rect.element.scrollTop)\n    });\n  };\n  /**\n   * Enable or disable file drop functionality\n   */\n\n\n  var toggleDrop = function toggleDrop(root) {\n    var isAllowed = root.query('GET_ALLOW_DROP');\n    var isDisabled = root.query('GET_DISABLED');\n    var enabled = isAllowed && !isDisabled;\n\n    if (enabled && !root.ref.hopper) {\n      var hopper = createHopper(root.element, function (items) {\n        // allow quick validation of dropped items\n        var beforeDropFile = root.query('GET_BEFORE_DROP_FILE') || function () {\n          return true;\n        }; // all items should be validated by all filters as valid\n\n\n        var dropValidation = root.query('GET_DROP_VALIDATION');\n        return dropValidation ? items.every(function (item) {\n          return applyFilters('ALLOW_HOPPER_ITEM', item, {\n            query: root.query\n          }).every(function (result) {\n            return result === true;\n          }) && beforeDropFile(item);\n        }) : true;\n      }, {\n        filterItems: function filterItems(items) {\n          var ignoredFiles = root.query('GET_IGNORED_FILES');\n          return items.filter(function (item) {\n            if (isFile(item)) {\n              return !ignoredFiles.includes(item.name.toLowerCase());\n            }\n\n            return true;\n          });\n        },\n        catchesDropsOnPage: root.query('GET_DROP_ON_PAGE'),\n        requiresDropOnElement: root.query('GET_DROP_ON_ELEMENT')\n      });\n\n      hopper.onload = function (items, position) {\n        // get item children elements and sort based on list sort\n        var list = root.ref.list.childViews[0];\n        var visibleChildren = list.childViews.filter(function (child) {\n          return child.rect.element.height;\n        });\n        var children = root.query('GET_ACTIVE_ITEMS').map(function (item) {\n          return visibleChildren.find(function (child) {\n            return child.id === item.id;\n          });\n        }).filter(function (item) {\n          return item;\n        });\n        applyFilterChain('ADD_ITEMS', items, {\n          dispatch: root.dispatch\n        }).then(function (queue) {\n          // these files don't fit so stop here\n          if (exceedsMaxFiles(root, queue)) return false; // go\n\n          root.dispatch('ADD_ITEMS', {\n            items: queue,\n            index: getDragIndex(root.ref.list, children, position),\n            interactionMethod: InteractionMethod.DROP\n          });\n        });\n        root.dispatch('DID_DROP', {\n          position: position\n        });\n        root.dispatch('DID_END_DRAG', {\n          position: position\n        });\n      };\n\n      hopper.ondragstart = function (position) {\n        root.dispatch('DID_START_DRAG', {\n          position: position\n        });\n      };\n\n      hopper.ondrag = debounce(function (position) {\n        root.dispatch('DID_DRAG', {\n          position: position\n        });\n      });\n\n      hopper.ondragend = function (position) {\n        root.dispatch('DID_END_DRAG', {\n          position: position\n        });\n      };\n\n      root.ref.hopper = hopper;\n      root.ref.drip = root.appendChildView(root.createChildView(drip));\n    } else if (!enabled && root.ref.hopper) {\n      root.ref.hopper.destroy();\n      root.ref.hopper = null;\n      root.removeChildView(root.ref.drip);\n    }\n  };\n  /**\n   * Enable or disable browse functionality\n   */\n\n\n  var toggleBrowse = function toggleBrowse(root, props) {\n    var isAllowed = root.query('GET_ALLOW_BROWSE');\n    var isDisabled = root.query('GET_DISABLED');\n    var enabled = isAllowed && !isDisabled;\n\n    if (enabled && !root.ref.browser) {\n      root.ref.browser = root.appendChildView(root.createChildView(browser, Object.assign({}, props, {\n        onload: function onload(items) {\n          applyFilterChain('ADD_ITEMS', items, {\n            dispatch: root.dispatch\n          }).then(function (queue) {\n            // these files don't fit so stop here\n            if (exceedsMaxFiles(root, queue)) return false; // add items!\n\n            root.dispatch('ADD_ITEMS', {\n              items: queue,\n              index: -1,\n              interactionMethod: InteractionMethod.BROWSE\n            });\n          });\n        }\n      })), 0);\n    } else if (!enabled && root.ref.browser) {\n      root.removeChildView(root.ref.browser);\n      root.ref.browser = null;\n    }\n  };\n  /**\n   * Enable or disable paste functionality\n   */\n\n\n  var togglePaste = function togglePaste(root) {\n    var isAllowed = root.query('GET_ALLOW_PASTE');\n    var isDisabled = root.query('GET_DISABLED');\n    var enabled = isAllowed && !isDisabled;\n\n    if (enabled && !root.ref.paster) {\n      root.ref.paster = createPaster();\n\n      root.ref.paster.onload = function (items) {\n        applyFilterChain('ADD_ITEMS', items, {\n          dispatch: root.dispatch\n        }).then(function (queue) {\n          // these files don't fit so stop here\n          if (exceedsMaxFiles(root, queue)) return false; // add items!\n\n          root.dispatch('ADD_ITEMS', {\n            items: queue,\n            index: -1,\n            interactionMethod: InteractionMethod.PASTE\n          });\n        });\n      };\n    } else if (!enabled && root.ref.paster) {\n      root.ref.paster.destroy();\n      root.ref.paster = null;\n    }\n  };\n  /**\n   * Route actions\n   */\n\n\n  var route$5 = createRoute({\n    DID_SET_ALLOW_BROWSE: function DID_SET_ALLOW_BROWSE(_ref5) {\n      var root = _ref5.root,\n          props = _ref5.props;\n      toggleBrowse(root, props);\n    },\n    DID_SET_ALLOW_DROP: function DID_SET_ALLOW_DROP(_ref6) {\n      var root = _ref6.root;\n      toggleDrop(root);\n    },\n    DID_SET_ALLOW_PASTE: function DID_SET_ALLOW_PASTE(_ref7) {\n      var root = _ref7.root;\n      togglePaste(root);\n    },\n    DID_SET_DISABLED: function DID_SET_DISABLED(_ref8) {\n      var root = _ref8.root,\n          props = _ref8.props;\n      toggleDrop(root);\n      togglePaste(root);\n      toggleBrowse(root, props);\n      var isDisabled = root.query('GET_DISABLED');\n\n      if (isDisabled) {\n        root.element.dataset.disabled = 'disabled';\n      } else {\n        // delete root.element.dataset.disabled; <= this does not work on iOS 10\n        root.element.removeAttribute('data-disabled');\n      }\n    }\n  });\n  var root = createView({\n    name: 'root',\n    read: function read(_ref9) {\n      var root = _ref9.root;\n\n      if (root.ref.measure) {\n        root.ref.measureHeight = root.ref.measure.offsetHeight;\n      }\n    },\n    create: create$e,\n    write: write$9,\n    destroy: function destroy(_ref10) {\n      var root = _ref10.root;\n\n      if (root.ref.paster) {\n        root.ref.paster.destroy();\n      }\n\n      if (root.ref.hopper) {\n        root.ref.hopper.destroy();\n      }\n\n      root.element.removeEventListener('touchmove', prevent);\n      root.element.removeEventListener('gesturestart', prevent);\n    },\n    mixins: {\n      styles: ['height']\n    }\n  }); // creates the app\n\n  var createApp = function createApp() {\n    var initialOptions = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {}; // let element\n\n    var originalElement = null; // get default options\n\n    var defaultOptions = getOptions(); // create the data store, this will contain all our app info\n\n    var store = createStore( // initial state (should be serializable)\n    createInitialState(defaultOptions), // queries\n    [queries, createOptionQueries(defaultOptions)], // action handlers\n    [actions, createOptionActions(defaultOptions)]); // set initial options\n\n    store.dispatch('SET_OPTIONS', {\n      options: initialOptions\n    }); // kick thread if visibility changes\n\n    var visibilityHandler = function visibilityHandler() {\n      if (document.hidden) return;\n      store.dispatch('KICK');\n    };\n\n    document.addEventListener('visibilitychange', visibilityHandler); // re-render on window resize start and finish\n\n    var resizeDoneTimer = null;\n    var isResizing = false;\n    var isResizingHorizontally = false;\n    var initialWindowWidth = null;\n    var currentWindowWidth = null;\n\n    var resizeHandler = function resizeHandler() {\n      if (!isResizing) {\n        isResizing = true;\n      }\n\n      clearTimeout(resizeDoneTimer);\n      resizeDoneTimer = setTimeout(function () {\n        isResizing = false;\n        initialWindowWidth = null;\n        currentWindowWidth = null;\n\n        if (isResizingHorizontally) {\n          isResizingHorizontally = false;\n          store.dispatch('DID_STOP_RESIZE');\n        }\n      }, 500);\n    };\n\n    window.addEventListener('resize', resizeHandler); // render initial view\n\n    var view = root(store, {\n      id: getUniqueId()\n    }); //\n    // PRIVATE API -------------------------------------------------------------------------------------\n    //\n\n    var isResting = false;\n    var isHidden = false;\n    var readWriteApi = {\n      // necessary for update loop\n\n      /**\n       * Reads from dom (never call manually)\n       * @private\n       */\n      _read: function _read() {\n        // test if we're resizing horizontally\n        // TODO: see if we can optimize this by measuring root rect\n        if (isResizing) {\n          currentWindowWidth = window.innerWidth;\n\n          if (!initialWindowWidth) {\n            initialWindowWidth = currentWindowWidth;\n          }\n\n          if (!isResizingHorizontally && currentWindowWidth !== initialWindowWidth) {\n            store.dispatch('DID_START_RESIZE');\n            isResizingHorizontally = true;\n          }\n        }\n\n        if (isHidden && isResting) {\n          // test if is no longer hidden\n          isResting = view.element.offsetParent === null;\n        } // if resting, no need to read as numbers will still all be correct\n\n\n        if (isResting) return; // read view data\n\n        view._read(); // if is hidden we need to know so we exit rest mode when revealed\n\n\n        isHidden = view.rect.element.hidden;\n      },\n\n      /**\n       * Writes to dom (never call manually)\n       * @private\n       */\n      _write: function _write(ts) {\n        // get all actions from store\n        var actions = store.processActionQueue() // filter out set actions (these will automatically trigger DID_SET)\n        .filter(function (action) {\n          return !/^SET_/.test(action.type);\n        }); // if was idling and no actions stop here\n\n        if (isResting && !actions.length) return; // some actions might trigger events\n\n        routeActionsToEvents(actions); // update the view\n\n        isResting = view._write(ts, actions, isResizingHorizontally); // will clean up all archived items\n\n        removeReleasedItems(store.query('GET_ITEMS')); // now idling\n\n        if (isResting) {\n          store.processDispatchQueue();\n        }\n      }\n    }; //\n    // EXPOSE EVENTS -------------------------------------------------------------------------------------\n    //\n\n    var createEvent = function createEvent(name) {\n      return function (data) {\n        // create default event\n        var event = {\n          type: name\n        }; // no data to add\n\n        if (!data) {\n          return event;\n        } // copy relevant props\n\n\n        if (data.hasOwnProperty('error')) {\n          event.error = data.error ? Object.assign({}, data.error) : null;\n        }\n\n        if (data.status) {\n          event.status = Object.assign({}, data.status);\n        }\n\n        if (data.file) {\n          event.output = data.file;\n        } // only source is available, else add item if possible\n\n\n        if (data.source) {\n          event.file = data.source;\n        } else if (data.item || data.id) {\n          var item = data.item ? data.item : store.query('GET_ITEM', data.id);\n          event.file = item ? createItemAPI(item) : null;\n        } // map all items in a possible items array\n\n\n        if (data.items) {\n          event.items = data.items.map(createItemAPI);\n        } // if this is a progress event add the progress amount\n\n\n        if (/progress/.test(name)) {\n          event.progress = data.progress;\n        } // copy relevant props\n\n\n        if (data.hasOwnProperty('origin') && data.hasOwnProperty('target')) {\n          event.origin = data.origin;\n          event.target = data.target;\n        }\n\n        return event;\n      };\n    };\n\n    var eventRoutes = {\n      DID_DESTROY: createEvent('destroy'),\n      DID_INIT: createEvent('init'),\n      DID_THROW_MAX_FILES: createEvent('warning'),\n      DID_INIT_ITEM: createEvent('initfile'),\n      DID_START_ITEM_LOAD: createEvent('addfilestart'),\n      DID_UPDATE_ITEM_LOAD_PROGRESS: createEvent('addfileprogress'),\n      DID_LOAD_ITEM: createEvent('addfile'),\n      DID_THROW_ITEM_INVALID: [createEvent('error'), createEvent('addfile')],\n      DID_THROW_ITEM_LOAD_ERROR: [createEvent('error'), createEvent('addfile')],\n      DID_THROW_ITEM_REMOVE_ERROR: [createEvent('error'), createEvent('removefile')],\n      DID_PREPARE_OUTPUT: createEvent('preparefile'),\n      DID_START_ITEM_PROCESSING: createEvent('processfilestart'),\n      DID_UPDATE_ITEM_PROCESS_PROGRESS: createEvent('processfileprogress'),\n      DID_ABORT_ITEM_PROCESSING: createEvent('processfileabort'),\n      DID_COMPLETE_ITEM_PROCESSING: createEvent('processfile'),\n      DID_COMPLETE_ITEM_PROCESSING_ALL: createEvent('processfiles'),\n      DID_REVERT_ITEM_PROCESSING: createEvent('processfilerevert'),\n      DID_THROW_ITEM_PROCESSING_ERROR: [createEvent('error'), createEvent('processfile')],\n      DID_REMOVE_ITEM: createEvent('removefile'),\n      DID_UPDATE_ITEMS: createEvent('updatefiles'),\n      DID_ACTIVATE_ITEM: createEvent('activatefile'),\n      DID_REORDER_ITEMS: createEvent('reorderfiles')\n    };\n\n    var exposeEvent = function exposeEvent(event) {\n      // create event object to be dispatched\n      var detail = Object.assign({\n        pond: exports\n      }, event);\n      delete detail.type;\n      view.element.dispatchEvent(new CustomEvent('FilePond:' + event.type, {\n        // event info\n        detail: detail,\n        // event behaviour\n        bubbles: true,\n        cancelable: true,\n        composed: true // triggers listeners outside of shadow root\n\n      })); // event object to params used for `on()` event handlers and callbacks `oninit()`\n\n      var params = []; // if is possible error event, make it the first param\n\n      if (event.hasOwnProperty('error')) {\n        params.push(event.error);\n      } // file is always section\n\n\n      if (event.hasOwnProperty('file')) {\n        params.push(event.file);\n      } // append other props\n\n\n      var filtered = ['type', 'error', 'file'];\n      Object.keys(event).filter(function (key) {\n        return !filtered.includes(key);\n      }).forEach(function (key) {\n        return params.push(event[key]);\n      }); // on(type, () => { })\n\n      exports.fire.apply(exports, [event.type].concat(params)); // oninit = () => {}\n\n      var handler = store.query('GET_ON' + event.type.toUpperCase());\n\n      if (handler) {\n        handler.apply(void 0, params);\n      }\n    };\n\n    var routeActionsToEvents = function routeActionsToEvents(actions) {\n      if (!actions.length) return;\n      actions.filter(function (action) {\n        return eventRoutes[action.type];\n      }).forEach(function (action) {\n        var routes = eventRoutes[action.type];\n        (Array.isArray(routes) ? routes : [routes]).forEach(function (route) {\n          // this isn't fantastic, but because of the stacking of settimeouts plugins can handle the did_load before the did_init\n          if (action.type === 'DID_INIT_ITEM') {\n            exposeEvent(route(action.data));\n          } else {\n            setTimeout(function () {\n              exposeEvent(route(action.data));\n            }, 0);\n          }\n        });\n      });\n    }; //\n    // PUBLIC API -------------------------------------------------------------------------------------\n    //\n\n\n    var setOptions = function setOptions(options) {\n      return store.dispatch('SET_OPTIONS', {\n        options: options\n      });\n    };\n\n    var getFile = function getFile(query) {\n      return store.query('GET_ACTIVE_ITEM', query);\n    };\n\n    var prepareFile = function prepareFile(query) {\n      return new Promise(function (resolve, reject) {\n        store.dispatch('REQUEST_ITEM_PREPARE', {\n          query: query,\n          success: function success(item) {\n            resolve(item);\n          },\n          failure: function failure(error) {\n            reject(error);\n          }\n        });\n      });\n    };\n\n    var addFile = function addFile(source) {\n      var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n      return new Promise(function (resolve, reject) {\n        addFiles([{\n          source: source,\n          options: options\n        }], {\n          index: options.index\n        }).then(function (items) {\n          return resolve(items && items[0]);\n        }).catch(reject);\n      });\n    };\n\n    var isFilePondFile = function isFilePondFile(obj) {\n      return obj.file && obj.id;\n    };\n\n    var removeFile = function removeFile(query, options) {\n      // if only passed options\n      if (typeof query === 'object' && !isFilePondFile(query) && !options) {\n        options = query;\n        query = undefined;\n      } // request item removal\n\n\n      store.dispatch('REMOVE_ITEM', Object.assign({}, options, {\n        query: query\n      })); // see if item has been removed\n\n      return store.query('GET_ACTIVE_ITEM', query) === null;\n    };\n\n    var addFiles = function addFiles() {\n      for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n        args[_key] = arguments[_key];\n      }\n\n      return new Promise(function (resolve, reject) {\n        var sources = [];\n        var options = {}; // user passed a sources array\n\n        if (isArray(args[0])) {\n          sources.push.apply(sources, args[0]);\n          Object.assign(options, args[1] || {});\n        } else {\n          // user passed sources as arguments, last one might be options object\n          var lastArgument = args[args.length - 1];\n\n          if (typeof lastArgument === 'object' && !(lastArgument instanceof Blob)) {\n            Object.assign(options, args.pop());\n          } // add rest to sources\n\n\n          sources.push.apply(sources, args);\n        }\n\n        store.dispatch('ADD_ITEMS', {\n          items: sources,\n          index: options.index,\n          interactionMethod: InteractionMethod.API,\n          success: resolve,\n          failure: reject\n        });\n      });\n    };\n\n    var getFiles = function getFiles() {\n      return store.query('GET_ACTIVE_ITEMS');\n    };\n\n    var processFile = function processFile(query) {\n      return new Promise(function (resolve, reject) {\n        store.dispatch('REQUEST_ITEM_PROCESSING', {\n          query: query,\n          success: function success(item) {\n            resolve(item);\n          },\n          failure: function failure(error) {\n            reject(error);\n          }\n        });\n      });\n    };\n\n    var prepareFiles = function prepareFiles() {\n      for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n        args[_key2] = arguments[_key2];\n      }\n\n      var queries = Array.isArray(args[0]) ? args[0] : args;\n      var items = queries.length ? queries : getFiles();\n      return Promise.all(items.map(prepareFile));\n    };\n\n    var processFiles = function processFiles() {\n      for (var _len3 = arguments.length, args = new Array(_len3), _key3 = 0; _key3 < _len3; _key3++) {\n        args[_key3] = arguments[_key3];\n      }\n\n      var queries = Array.isArray(args[0]) ? args[0] : args;\n\n      if (!queries.length) {\n        var files = getFiles().filter(function (item) {\n          return !(item.status === ItemStatus.IDLE && item.origin === FileOrigin.LOCAL) && item.status !== ItemStatus.PROCESSING && item.status !== ItemStatus.PROCESSING_COMPLETE && item.status !== ItemStatus.PROCESSING_REVERT_ERROR;\n        });\n        return Promise.all(files.map(processFile));\n      }\n\n      return Promise.all(queries.map(processFile));\n    };\n\n    var removeFiles = function removeFiles() {\n      for (var _len4 = arguments.length, args = new Array(_len4), _key4 = 0; _key4 < _len4; _key4++) {\n        args[_key4] = arguments[_key4];\n      }\n\n      var queries = Array.isArray(args[0]) ? args[0] : args;\n      var options;\n\n      if (typeof queries[queries.length - 1] === 'object') {\n        options = queries.pop();\n      } else if (Array.isArray(args[0])) {\n        options = args[1];\n      }\n\n      var files = getFiles();\n      if (!queries.length) return Promise.all(files.map(function (file) {\n        return removeFile(file, options);\n      })); // when removing by index the indexes shift after each file removal so we need to convert indexes to ids\n\n      var mappedQueries = queries.map(function (query) {\n        return isNumber(query) ? files[query] ? files[query].id : null : query;\n      }).filter(function (query) {\n        return query;\n      });\n      return mappedQueries.map(function (q) {\n        return removeFile(q, options);\n      });\n    };\n\n    var exports = Object.assign({}, on(), {}, readWriteApi, {}, createOptionAPI(store, defaultOptions), {\n      /**\n       * Override options defined in options object\n       * @param options\n       */\n      setOptions: setOptions,\n\n      /**\n       * Load the given file\n       * @param source - the source of the file (either a File, base64 data uri or url)\n       * @param options - object, { index: 0 }\n       */\n      addFile: addFile,\n\n      /**\n       * Load the given files\n       * @param sources - the sources of the files to load\n       * @param options - object, { index: 0 }\n       */\n      addFiles: addFiles,\n\n      /**\n       * Returns the file objects matching the given query\n       * @param query { string, number, null }\n       */\n      getFile: getFile,\n\n      /**\n       * Upload file with given name\n       * @param query { string, number, null  }\n       */\n      processFile: processFile,\n\n      /**\n       * Request prepare output for file with given name\n       * @param query { string, number, null  }\n       */\n      prepareFile: prepareFile,\n\n      /**\n       * Removes a file by its name\n       * @param query { string, number, null  }\n       */\n      removeFile: removeFile,\n\n      /**\n       * Moves a file to a new location in the files list\n       */\n      moveFile: function moveFile(query, index) {\n        return store.dispatch('MOVE_ITEM', {\n          query: query,\n          index: index\n        });\n      },\n\n      /**\n       * Returns all files (wrapped in public api)\n       */\n      getFiles: getFiles,\n\n      /**\n       * Starts uploading all files\n       */\n      processFiles: processFiles,\n\n      /**\n       * Clears all files from the files list\n       */\n      removeFiles: removeFiles,\n\n      /**\n       * Starts preparing output of all files\n       */\n      prepareFiles: prepareFiles,\n\n      /**\n       * Sort list of files\n       */\n      sort: function sort(compare) {\n        return store.dispatch('SORT', {\n          compare: compare\n        });\n      },\n\n      /**\n       * Browse the file system for a file\n       */\n      browse: function browse() {\n        // needs to be trigger directly as user action needs to be traceable (is not traceable in requestAnimationFrame)\n        var input = view.element.querySelector('input[type=file]');\n\n        if (input) {\n          input.click();\n        }\n      },\n\n      /**\n       * Destroys the app\n       */\n      destroy: function destroy() {\n        // request destruction\n        exports.fire('destroy', view.element); // stop active processes (file uploads, fetches, stuff like that)\n        // loop over items and depending on states call abort for ongoing processes\n\n        store.dispatch('ABORT_ALL'); // destroy view\n\n        view._destroy(); // stop listening to resize\n\n\n        window.removeEventListener('resize', resizeHandler); // stop listening to the visiblitychange event\n\n        document.removeEventListener('visibilitychange', visibilityHandler); // dispatch destroy\n\n        store.dispatch('DID_DESTROY');\n      },\n\n      /**\n       * Inserts the plugin before the target element\n       */\n      insertBefore: function insertBefore$1(element) {\n        return insertBefore(view.element, element);\n      },\n\n      /**\n       * Inserts the plugin after the target element\n       */\n      insertAfter: function insertAfter$1(element) {\n        return insertAfter(view.element, element);\n      },\n\n      /**\n       * Appends the plugin to the target element\n       */\n      appendTo: function appendTo(element) {\n        return element.appendChild(view.element);\n      },\n\n      /**\n       * Replaces an element with the app\n       */\n      replaceElement: function replaceElement(element) {\n        // insert the app before the element\n        insertBefore(view.element, element); // remove the original element\n\n        element.parentNode.removeChild(element); // remember original element\n\n        originalElement = element;\n      },\n\n      /**\n       * Restores the original element\n       */\n      restoreElement: function restoreElement() {\n        if (!originalElement) {\n          return; // no element to restore\n        } // restore original element\n\n\n        insertAfter(originalElement, view.element); // remove our element\n\n        view.element.parentNode.removeChild(view.element); // remove reference\n\n        originalElement = null;\n      },\n\n      /**\n       * Returns true if the app root is attached to given element\n       * @param element\n       */\n      isAttachedTo: function isAttachedTo(element) {\n        return view.element === element || originalElement === element;\n      },\n\n      /**\n       * Returns the root element\n       */\n      element: {\n        get: function get() {\n          return view.element;\n        }\n      },\n\n      /**\n       * Returns the current pond status\n       */\n      status: {\n        get: function get() {\n          return store.query('GET_STATUS');\n        }\n      }\n    }); // Done!\n\n    store.dispatch('DID_INIT'); // create actual api object\n\n    return createObject(exports);\n  };\n\n  var createAppObject = function createAppObject() {\n    var customOptions = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {}; // default options\n\n    var defaultOptions = {};\n    forin(getOptions(), function (key, value) {\n      defaultOptions[key] = value[0];\n    }); // set app options\n\n    var app = createApp(Object.assign({}, defaultOptions, {}, customOptions)); // return the plugin instance\n\n    return app;\n  };\n\n  var lowerCaseFirstLetter = function lowerCaseFirstLetter(string) {\n    return string.charAt(0).toLowerCase() + string.slice(1);\n  };\n\n  var attributeNameToPropertyName = function attributeNameToPropertyName(attributeName) {\n    return toCamels(attributeName.replace(/^data-/, ''));\n  };\n\n  var mapObject = function mapObject(object, propertyMap) {\n    // remove unwanted\n    forin(propertyMap, function (selector, mapping) {\n      forin(object, function (property, value) {\n        // create regexp shortcut\n        var selectorRegExp = new RegExp(selector); // tests if\n\n        var matches = selectorRegExp.test(property); // no match, skip\n\n        if (!matches) {\n          return;\n        } // if there's a mapping, the original property is always removed\n\n\n        delete object[property]; // should only remove, we done!\n\n        if (mapping === false) {\n          return;\n        } // move value to new property\n\n\n        if (isString(mapping)) {\n          object[mapping] = value;\n          return;\n        } // move to group\n\n\n        var group = mapping.group;\n\n        if (isObject(mapping) && !object[group]) {\n          object[group] = {};\n        }\n\n        object[group][lowerCaseFirstLetter(property.replace(selectorRegExp, ''))] = value;\n      }); // do submapping\n\n      if (mapping.mapping) {\n        mapObject(object[mapping.group], mapping.mapping);\n      }\n    });\n  };\n\n  var getAttributesAsObject = function getAttributesAsObject(node) {\n    var attributeMapping = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {}; // turn attributes into object\n\n    var attributes = [];\n    forin(node.attributes, function (index) {\n      attributes.push(node.attributes[index]);\n    });\n    var output = attributes.filter(function (attribute) {\n      return attribute.name;\n    }).reduce(function (obj, attribute) {\n      var value = attr(node, attribute.name);\n      obj[attributeNameToPropertyName(attribute.name)] = value === attribute.name ? true : value;\n      return obj;\n    }, {}); // do mapping of object properties\n\n    mapObject(output, attributeMapping);\n    return output;\n  };\n\n  var createAppAtElement = function createAppAtElement(element) {\n    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {}; // how attributes of the input element are mapped to the options for the plugin\n\n    var attributeMapping = {\n      // translate to other name\n      '^class$': 'className',\n      '^multiple$': 'allowMultiple',\n      '^capture$': 'captureMethod',\n      '^webkitdirectory$': 'allowDirectoriesOnly',\n      // group under single property\n      '^server': {\n        group: 'server',\n        mapping: {\n          '^process': {\n            group: 'process'\n          },\n          '^revert': {\n            group: 'revert'\n          },\n          '^fetch': {\n            group: 'fetch'\n          },\n          '^restore': {\n            group: 'restore'\n          },\n          '^load': {\n            group: 'load'\n          }\n        }\n      },\n      // don't include in object\n      '^type$': false,\n      '^files$': false\n    }; // add additional option translators\n\n    applyFilters('SET_ATTRIBUTE_TO_OPTION_MAP', attributeMapping); // create final options object by setting options object and then overriding options supplied on element\n\n    var mergedOptions = Object.assign({}, options);\n    var attributeOptions = getAttributesAsObject(element.nodeName === 'FIELDSET' ? element.querySelector('input[type=file]') : element, attributeMapping); // merge with options object\n\n    Object.keys(attributeOptions).forEach(function (key) {\n      if (isObject(attributeOptions[key])) {\n        if (!isObject(mergedOptions[key])) {\n          mergedOptions[key] = {};\n        }\n\n        Object.assign(mergedOptions[key], attributeOptions[key]);\n      } else {\n        mergedOptions[key] = attributeOptions[key];\n      }\n    }); // if parent is a fieldset, get files from parent by selecting all input fields that are not file upload fields\n    // these will then be automatically set to the initial files\n\n    mergedOptions.files = (options.files || []).concat(Array.from(element.querySelectorAll('input:not([type=file])')).map(function (input) {\n      return {\n        source: input.value,\n        options: {\n          type: input.dataset.type\n        }\n      };\n    })); // build plugin\n\n    var app = createAppObject(mergedOptions); // add already selected files\n\n    if (element.files) {\n      Array.from(element.files).forEach(function (file) {\n        app.addFile(file);\n      });\n    } // replace the target element\n\n\n    app.replaceElement(element); // expose\n\n    return app;\n  }; // if an element is passed, we create the instance at that element, if not, we just create an up object\n\n\n  var createApp$1 = function createApp() {\n    return isNode(arguments.length <= 0 ? undefined : arguments[0]) ? createAppAtElement.apply(void 0, arguments) : createAppObject.apply(void 0, arguments);\n  };\n\n  var PRIVATE_METHODS = ['fire', '_read', '_write'];\n\n  var createAppAPI = function createAppAPI(app) {\n    var api = {};\n    copyObjectPropertiesToObject(app, api, PRIVATE_METHODS);\n    return api;\n  };\n  /**\n   * Replaces placeholders in given string with replacements\n   * @param string - \"Foo {bar}\"\"\n   * @param replacements - { \"bar\": 10 }\n   */\n\n\n  var replaceInString = function replaceInString(string, replacements) {\n    return string.replace(/(?:{([a-zA-Z]+)})/g, function (match, group) {\n      return replacements[group];\n    });\n  };\n\n  var createWorker = function createWorker(fn) {\n    var workerBlob = new Blob(['(', fn.toString(), ')()'], {\n      type: 'application/javascript'\n    });\n    var workerURL = URL.createObjectURL(workerBlob);\n    var worker = new Worker(workerURL);\n    return {\n      transfer: function transfer(message, cb) {},\n      post: function post(message, cb, transferList) {\n        var id = getUniqueId();\n\n        worker.onmessage = function (e) {\n          if (e.data.id === id) {\n            cb(e.data.message);\n          }\n        };\n\n        worker.postMessage({\n          id: id,\n          message: message\n        }, transferList);\n      },\n      terminate: function terminate() {\n        worker.terminate();\n        URL.revokeObjectURL(workerURL);\n      }\n    };\n  };\n\n  var loadImage = function loadImage(url) {\n    return new Promise(function (resolve, reject) {\n      var img = new Image();\n\n      img.onload = function () {\n        resolve(img);\n      };\n\n      img.onerror = function (e) {\n        reject(e);\n      };\n\n      img.src = url;\n    });\n  };\n\n  var renameFile = function renameFile(file, name) {\n    var renamedFile = file.slice(0, file.size, file.type);\n    renamedFile.lastModifiedDate = file.lastModifiedDate;\n    renamedFile.name = name;\n    return renamedFile;\n  };\n\n  var copyFile = function copyFile(file) {\n    return renameFile(file, file.name);\n  }; // already registered plugins (can't register twice)\n\n\n  var registeredPlugins = []; // pass utils to plugin\n\n  var createAppPlugin = function createAppPlugin(plugin) {\n    // already registered\n    if (registeredPlugins.includes(plugin)) {\n      return;\n    } // remember this plugin\n\n\n    registeredPlugins.push(plugin); // setup!\n\n    var pluginOutline = plugin({\n      addFilter: addFilter,\n      utils: {\n        Type: Type,\n        forin: forin,\n        isString: isString,\n        isFile: isFile,\n        toNaturalFileSize: toNaturalFileSize,\n        replaceInString: replaceInString,\n        getExtensionFromFilename: getExtensionFromFilename,\n        getFilenameWithoutExtension: getFilenameWithoutExtension,\n        guesstimateMimeType: guesstimateMimeType,\n        getFileFromBlob: getFileFromBlob,\n        getFilenameFromURL: getFilenameFromURL,\n        createRoute: createRoute,\n        createWorker: createWorker,\n        createView: createView,\n        createItemAPI: createItemAPI,\n        loadImage: loadImage,\n        copyFile: copyFile,\n        renameFile: renameFile,\n        createBlob: createBlob,\n        applyFilterChain: applyFilterChain,\n        text: text,\n        getNumericAspectRatioFromString: getNumericAspectRatioFromString\n      },\n      views: {\n        fileActionButton: fileActionButton\n      }\n    }); // add plugin options to default options\n\n    extendDefaultOptions(pluginOutline.options);\n  }; // feature detection used by supported() method\n\n\n  var isOperaMini = function isOperaMini() {\n    return Object.prototype.toString.call(window.operamini) === '[object OperaMini]';\n  };\n\n  var hasPromises = function hasPromises() {\n    return 'Promise' in window;\n  };\n\n  var hasBlobSlice = function hasBlobSlice() {\n    return 'slice' in Blob.prototype;\n  };\n\n  var hasCreateObjectURL = function hasCreateObjectURL() {\n    return 'URL' in window && 'createObjectURL' in window.URL;\n  };\n\n  var hasVisibility = function hasVisibility() {\n    return 'visibilityState' in document;\n  };\n\n  var hasTiming = function hasTiming() {\n    return 'performance' in window;\n  }; // iOS 8.x\n\n\n  var hasCSSSupports = function hasCSSSupports() {\n    return 'supports' in (window.CSS || {});\n  }; // use to detect Safari 9+\n\n\n  var isIE11 = function isIE11() {\n    return /MSIE|Trident/.test(window.navigator.userAgent);\n  };\n\n  var supported = function () {\n    // Runs immediately and then remembers result for subsequent calls\n    var isSupported = // Has to be a browser\n    isBrowser() && // Can't run on Opera Mini due to lack of everything\n    !isOperaMini() && // Require these APIs to feature detect a modern browser\n    hasVisibility() && hasPromises() && hasBlobSlice() && hasCreateObjectURL() && hasTiming() && ( // doesn't need CSSSupports but is a good way to detect Safari 9+ (we do want to support IE11 though)\n    hasCSSSupports() || isIE11());\n    return function () {\n      return isSupported;\n    };\n  }();\n  /**\n   * Plugin internal state (over all instances)\n   */\n\n\n  var state = {\n    // active app instances, used to redraw the apps and to find the later\n    apps: []\n  }; // plugin name\n\n  var name = 'filepond';\n  /**\n   * Public Plugin methods\n   */\n\n  var fn = function fn() {};\n\n  exports.Status = {};\n  exports.FileStatus = {};\n  exports.FileOrigin = {};\n  exports.OptionTypes = {};\n  exports.create = fn;\n  exports.destroy = fn;\n  exports.parse = fn;\n  exports.find = fn;\n  exports.registerPlugin = fn;\n  exports.getOptions = fn;\n  exports.setOptions = fn; // if not supported, no API\n\n  if (supported()) {\n    // start painter and fire load event\n    createPainter(function () {\n      state.apps.forEach(function (app) {\n        return app._read();\n      });\n    }, function (ts) {\n      state.apps.forEach(function (app) {\n        return app._write(ts);\n      });\n    }); // fire loaded event so we know when FilePond is available\n\n    var dispatch = function dispatch() {\n      // let others know we have area ready\n      document.dispatchEvent(new CustomEvent('FilePond:loaded', {\n        detail: {\n          supported: supported,\n          create: exports.create,\n          destroy: exports.destroy,\n          parse: exports.parse,\n          find: exports.find,\n          registerPlugin: exports.registerPlugin,\n          setOptions: exports.setOptions\n        }\n      })); // clean up event\n\n      document.removeEventListener('DOMContentLoaded', dispatch);\n    };\n\n    if (document.readyState !== 'loading') {\n      // move to back of execution queue, FilePond should have been exported by then\n      setTimeout(function () {\n        return dispatch();\n      }, 0);\n    } else {\n      document.addEventListener('DOMContentLoaded', dispatch);\n    } // updates the OptionTypes object based on the current options\n\n\n    var updateOptionTypes = function updateOptionTypes() {\n      return forin(getOptions(), function (key, value) {\n        exports.OptionTypes[key] = value[1];\n      });\n    };\n\n    exports.Status = Object.assign({}, Status);\n    exports.FileOrigin = Object.assign({}, FileOrigin);\n    exports.FileStatus = Object.assign({}, ItemStatus);\n    exports.OptionTypes = {};\n    updateOptionTypes(); // create method, creates apps and adds them to the app array\n\n    exports.create = function create() {\n      var app = createApp$1.apply(void 0, arguments);\n      app.on('destroy', exports.destroy);\n      state.apps.push(app);\n      return createAppAPI(app);\n    }; // destroys apps and removes them from the app array\n\n\n    exports.destroy = function destroy(hook) {\n      // returns true if the app was destroyed successfully\n      var indexToRemove = state.apps.findIndex(function (app) {\n        return app.isAttachedTo(hook);\n      });\n\n      if (indexToRemove >= 0) {\n        // remove from apps\n        var app = state.apps.splice(indexToRemove, 1)[0]; // restore original dom element\n\n        app.restoreElement();\n        return true;\n      }\n\n      return false;\n    }; // parses the given context for plugins (does not include the context element itself)\n\n\n    exports.parse = function parse(context) {\n      // get all possible hooks\n      var matchedHooks = Array.from(context.querySelectorAll('.' + name)); // filter out already active hooks\n\n      var newHooks = matchedHooks.filter(function (newHook) {\n        return !state.apps.find(function (app) {\n          return app.isAttachedTo(newHook);\n        });\n      }); // create new instance for each hook\n\n      return newHooks.map(function (hook) {\n        return exports.create(hook);\n      });\n    }; // returns an app based on the given element hook\n\n\n    exports.find = function find(hook) {\n      var app = state.apps.find(function (app) {\n        return app.isAttachedTo(hook);\n      });\n\n      if (!app) {\n        return null;\n      }\n\n      return createAppAPI(app);\n    }; // adds a plugin extension\n\n\n    exports.registerPlugin = function registerPlugin() {\n      for (var _len = arguments.length, plugins = new Array(_len), _key = 0; _key < _len; _key++) {\n        plugins[_key] = arguments[_key];\n      } // register plugins\n\n\n      plugins.forEach(createAppPlugin); // update OptionTypes, each plugin might have extended the default options\n\n      updateOptionTypes();\n    };\n\n    exports.getOptions = function getOptions$1() {\n      var opts = {};\n      forin(getOptions(), function (key, value) {\n        opts[key] = value[0];\n      });\n      return opts;\n    };\n\n    exports.setOptions = function setOptions$1(opts) {\n      if (isObject(opts)) {\n        // update existing plugins\n        state.apps.forEach(function (app) {\n          app.setOptions(opts);\n        }); // override defaults\n\n        setOptions(opts);\n      } // return new options\n\n\n      return exports.getOptions();\n    };\n  }\n\n  exports.supported = supported;\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n});","map":{"version":3,"sources":["/Users/AustinCai/Desktop/CS 370/ARC/Arc-FrontEnd-2.0/node_modules/filepond/dist/filepond.js"],"names":["global","factory","exports","module","define","amd","self","FilePond","isNode","value","HTMLElement","createStore","initialState","queries","arguments","length","undefined","actions","state","Object","assign","actionQueue","dispatchQueue","getState","processActionQueue","queue","concat","processDispatchQueue","forEach","_ref","type","data","dispatch","isBlocking","document","hidden","push","actionHandlers","query","str","_queryHandles","_len","args","Array","_key","queryHandles","apply","api","action","defineProperty","obj","property","definition","forin","cb","key","hasOwnProperty","createObject","attr","node","name","getAttribute","hasAttribute","setAttribute","ns","svgElements","isSVGElement","tag","includes","createElement","className","attributes","element","createElementNS","appendChild","parent","child","index","children","insertBefore","appendChildView","childViews","view","splice","removeChildView","indexOf","parentNode","removeChild","IS_BROWSER","window","isBrowser","testElement","getChildCount","el","childNodes","getViewRect","elementRect","offset","scale","left","top","right","width","bottom","height","rect","inner","outer","filter","childView","isRectIgnored","map","childViewRect","expandRect","calculateRectSize","marginBottom","marginRight","isNumber","thereYet","position","destination","velocity","errorMargin","Math","abs","spring","_ref$stiffness","stiffness","_ref$damping","damping","_ref$mass","mass","target","resting","interpolate","ts","skipToEndState","f","onupdate","oncomplete","setTarget","set","get","easeLinear","t","easeInOutQuad","tween","_ref$duration","duration","_ref$easing","easing","_ref$delay","delay","start","p","reverse","animator","createAnimator","category","def","props","addGetSet","keys","overwrite","isArray","o","getter","setter","animations","mixinConfig","viewProps","viewInternalAPI","viewExternalAPI","initialProps","animation","prop","write","destroy","addEvent","fn","addEventListener","removeEvent","removeEventListener","listeners","viewState","events","add","remove","on","off","findIndex","event","apis","isDefined","defaults","opacity","scaleX","scaleY","translateX","translateY","rotateX","rotateY","rotateZ","originX","originY","styles","currentProps","getOffset","getScale","getRect","propsHaveChanged","applyStyles","newProps","_ref2","perspective","transforms","elementCurrentStyle","style","cssText","Mixins","updateRect","layoutCalculated","paddingTop","parseInt","marginTop","marginLeft","offsetLeft","offsetTop","offsetWidth","offsetHeight","scrollTop","offsetParent","createView","_ref$tag","_ref$name","_ref$attributes","_ref$read","read","_ref$write","_ref$create","create","_ref$destroy","_ref$filterFrameActio","filterFrameActionsForChild","_ref$didCreateView","didCreateView","_ref$didWriteView","didWriteView","_ref$ignoreRect","ignoreRect","_ref$ignoreRectUpdate","ignoreRectUpdate","_ref$mixins","mixins","store","getComputedStyle","frameRect","isResting","activeMixins","ref","writers","readers","destroyers","getElement","getChildViews","getReference","createChildView","getStyle","_read","shouldUpdate","root","internalAPI","reader","_write","frameActions","shouldOptimize","writer","writerResting","timestamp","mixin","mixinResting","childResting","_destroy","destroyer","sharedAPIDefinition","internalAPIDefinition","is","needle","linkView","unlinkView","registerWriter","registerReader","registerDestroyer","invalidateLayout","externalAPIDefinition","mixinAPIDefinition","sort","a","b","mixinAPI","childCount","createPainter","fps","painter","interval","last","id","requestTick","cancelTick","setTimerType","setTimeout","tick","performance","now","clearTimeout","requestAnimationFrame","cancelAnimationFrame","delta","pause","createRoute","routes","_ref$actions","newNode","referenceNode","insertAfter","nextSibling","isEmpty","trim","toString","toArray","splitter","split","isBoolean","toBoolean","isString","toNumber","replace","toInt","toFloat","parseFloat","isInt","isFinite","floor","toBytes","base","naturalFileSize","test","isFunction","toFunctionReference","string","levels","level","shift","methods","process","patch","revert","fetch","restore","load","createServerAPI","outline","url","timeout","headers","createAction","method","withCredentials","onload","ondata","onerror","parts","header","toServerAPI","isNull","isObject","isAPI","getType","replaceSingleQuotes","conversionTable","array","boolean","int","number","float","bytes","function","_function","serverapi","object","JSON","parse","e","convertTo","getValueByType","newValue","defaultValue","valueType","newValueType","convertedValue","option","createOption","currentValue","enumerable","createOptions","options","optionDefinition","createInitialState","items","listUpdateTimeout","itemUpdateTimeout","processingQueue","fromCamels","separator","part","toLowerCase","join","createOptionAPI","toUpperCase","createOptionActions","createOptionQueries","InteractionMethod","API","DROP","BROWSE","PASTE","NONE","getUniqueId","random","substr","_typeof","Symbol","iterator","constructor","prototype","REACT_ELEMENT_TYPE","_jsx","defaultProps","childrenLength","propName","childArray","i","$$typeof","_owner","_asyncIterator","iterable","asyncIterator","call","TypeError","_AwaitValue","wrapped","_AsyncGenerator","gen","front","back","send","arg","Promise","resolve","reject","request","next","resume","result","wrappedAwait","then","settle","done","err","_invoke","return","throw","_wrapAsyncGenerator","_awaitAsyncGenerator","_asyncGeneratorDelegate","awaitWrap","iter","waiting","pump","asyncGeneratorStep","_next","_throw","info","error","_asyncToGenerator","_classCallCheck","instance","Constructor","_defineProperties","descriptor","configurable","writable","_createClass","protoProps","staticProps","_defineEnumerableProperties","descs","desc","getOwnPropertySymbols","objectSymbols","sym","_defaults","getOwnPropertyNames","getOwnPropertyDescriptor","_defineProperty","_extends","source","_objectSpread","ownKeys","enumerableOnly","symbols","_objectSpread2","getOwnPropertyDescriptors","defineProperties","_inherits","subClass","superClass","_setPrototypeOf","_inheritsLoose","__proto__","_getPrototypeOf","setPrototypeOf","getPrototypeOf","isNativeReflectConstruct","Reflect","construct","sham","Proxy","Date","_construct","Parent","Class","Function","bind","_isNativeFunction","_wrapNativeSuper","_cache","Map","has","Wrapper","_instanceof","hasInstance","_interopRequireDefault","__esModule","default","_interopRequireWildcard","newObj","_newArrowCheck","innerThis","boundThis","_objectDestructuringEmpty","_objectWithoutPropertiesLoose","excluded","sourceKeys","_objectWithoutProperties","sourceSymbolKeys","propertyIsEnumerable","_assertThisInitialized","ReferenceError","_possibleConstructorReturn","_superPropBase","_get","receiver","_set","isStrict","s","Error","_taggedTemplateLiteral","strings","raw","slice","freeze","_taggedTemplateLiteralLoose","_temporalRef","val","_temporalUndefined","_readOnlyError","_classNameTDZError","_slicedToArray","arr","_arrayWithHoles","_iterableToArrayLimit","_nonIterableRest","_slicedToArrayLoose","_iterableToArrayLimitLoose","_toArray","_iterableToArray","_toConsumableArray","_arrayWithoutHoles","_nonIterableSpread","arr2","from","_arr","_n","_d","_e","_i","_s","_iterator","_step","_skipFirstGeneratorNext","it","_toPrimitive","input","hint","prim","toPrimitive","res","String","Number","_toPropertyKey","_initializerWarningHelper","context","_initializerDefineProperty","initializer","_applyDecoratedDescriptor","decorators","reduce","decorator","_classPrivateFieldLooseKey","_classPrivateFieldLooseBase","privateKey","_classPrivateFieldGet","privateMap","_classPrivateFieldSet","_classPrivateFieldDestructureSet","__destrObj","v","_classStaticPrivateFieldSpecGet","classConstructor","_classStaticPrivateFieldSpecSet","_classStaticPrivateMethodGet","_classStaticPrivateMethodSet","_decorate","_getDecoratorsApi","r","initialize","O","initializeInstanceElements","decorated","elements","decorateClass","_coalesceClassElements","d","_createElementDescriptor","initializeClassElements","F","runClassFinishers","finishers","elementsDefinitionOrder","kind","placement","defineClassElement","proto","newElements","placements","static","own","addElementPlacement","_hasDecorators","elementFinishersExtras","decorateElement","extras","decorateConstructor","silent","elementObject","fromElementDescriptor","elementFinisherExtras","toElementFinisherExtras","finisher","newExtras","j","fromClassDescriptor","elementsAndFinisher","toClassDescriptor","k","toStringTag","toElementDescriptors","elementObjects","toElementDescriptor","disallowProperty","_optionalCallableProperty","newConstructor","objectType","_coalesceGetterSetter","other","isSameElement","find","_isDataDescriptor","_classPrivateMethodGet","privateSet","_classPrivateMethodSet","_wrapRegExp","re","groups","BabelRegExp","_RegExp","RegExp","_super","_groups","WeakMap","_this","exec","buildGroups","substitution","_","g","arrayRemove","run","sync","listener","_fire","fire","fireSync","_len2","_key2","onOnce","_cb","copyObjectPropertiesToObject","src","PRIVATE","createItemAPI","item","removeReleasedItems","released","ItemStatus","INIT","IDLE","PROCESSING_QUEUED","PROCESSING","PROCESSING_COMPLETE","PROCESSING_ERROR","PROCESSING_REVERT_ERROR","LOADING","LOAD_ERROR","FileOrigin","INPUT","LIMBO","LOCAL","getNonNumeric","getDecimalSeparator","toLocaleString","getThousandsSeparator","decimalSeparator","thousandsStringWithSeparator","thousandsStringWithoutSeparator","Type","BOOLEAN","INT","NUMBER","STRING","ARRAY","OBJECT","FUNCTION","ACTION","SERVER_API","REGEX","filters","applyFilterChain","utils","matchingFilters","initialFilter","current","catch","applyFilters","addFilter","extendDefaultOptions","additionalOptions","defaultOptions","getOptions","setOptions","opts","disabled","required","captureMethod","allowSyncAcceptAttribute","allowDrop","allowBrowse","allowPaste","allowMultiple","allowReplace","allowRevert","allowRemove","allowProcess","allowReorder","allowDirectoriesOnly","storeAsFile","forceRevert","maxFiles","checkValidity","itemInsertLocationFreedom","itemInsertLocation","itemInsertInterval","dropOnPage","dropOnElement","dropValidation","ignoredFiles","instantUpload","maxParallelUploads","allowMinimumUploadDuration","chunkUploads","chunkForce","chunkSize","chunkRetryDelays","server","fileSizeBase","labelFileSizeBytes","labelFileSizeKilobytes","labelFileSizeMegabytes","labelFileSizeGigabytes","labelDecimalSeparator","labelThousandsSeparator","labelIdle","labelInvalidField","labelFileWaitingForSize","labelFileSizeNotAvailable","labelFileCountSingular","labelFileCountPlural","labelFileLoading","labelFileAdded","labelFileLoadError","labelFileRemoved","labelFileRemoveError","labelFileProcessing","labelFileProcessingComplete","labelFileProcessingAborted","labelFileProcessingError","labelFileProcessingRevertError","labelTapToCancel","labelTapToRetry","labelTapToUndo","labelButtonRemoveItem","labelButtonAbortItemLoad","labelButtonRetryItemLoad","labelButtonAbortItemProcessing","labelButtonUndoItemProcessing","labelButtonRetryItemProcessing","labelButtonProcessItem","iconRemove","iconProcess","iconRetry","iconUndo","iconDone","oninit","onwarning","onactivatefile","oninitfile","onaddfilestart","onaddfileprogress","onaddfile","onprocessfilestart","onprocessfileprogress","onprocessfileabort","onprocessfilerevert","onprocessfile","onprocessfiles","onremovefile","onpreparefile","onupdatefiles","onreorderfiles","beforeDropFile","beforeAddFile","beforeRemoveFile","beforePrepareFile","stylePanelLayout","stylePanelAspectRatio","styleItemPanelAspectRatio","styleButtonRemoveItemPosition","styleButtonProcessItemPosition","styleLoadIndicatorPosition","styleProgressIndicatorPosition","styleButtonRemoveItemAlign","files","credits","getItemByQuery","getNumericAspectRatioFromString","aspectRatio","getActiveItems","archived","Status","EMPTY","ERROR","BUSY","READY","canUpdateFileInput","dataTransfer","DataTransfer","File","ITEM_ERROR","ITEM_BUSY","ITEM_READY","isItemInErrorState","status","isItemInBusyState","isItemInReadyState","isAsync","GET_STATUS","some","GET_ITEM","GET_ACTIVE_ITEM","GET_ACTIVE_ITEMS","GET_ITEMS","GET_ITEM_NAME","filename","GET_ITEM_SIZE","fileSize","GET_STYLES","GET_PANEL_ASPECT_RATIO","isShapeCircle","GET_ITEM_PANEL_ASPECT_RATIO","GET_ITEMS_BY_STATUS","GET_TOTAL_ITEMS","SHOULD_UPDATE_FILE_INPUT","IS_ASYNC","GET_FILE_SIZE_LABELS","labelBytes","labelKilobytes","labelMegabytes","labelGigabytes","hasRoomForItem","count","maxFileCount","limit","min","max","arrayInsert","insertItem","isBase64DataURI","getFilenameFromURL","pop","getExtensionFromFilename","guesstimateExtension","subtype","leftPad","padding","getDateString","date","getFullYear","getMonth","getDate","getHours","getMinutes","getSeconds","getFileFromBlob","blob","extension","file","size","lastModifiedDate","_relativePath","getBlobBuilder","BlobBuilder","WebKitBlobBuilder","MozBlobBuilder","MSBlobBuilder","createBlob","arrayBuffer","mimeType","BB","bb","append","getBlob","Blob","getBlobFromByteStringWithMimeType","byteString","ab","ArrayBuffer","ia","Uint8Array","charCodeAt","getMimeTypeFromBase64DataURI","dataURI","getBase64DataFromBase64DataURI","getByteStringFromBase64DataURI","atob","getBlobFromBase64DataURI","getFileFromBase64DataURI","getFileNameFromHeader","matches","decodeURI","getFileSizeFromHeader","match","getTranfserIdFromHeader","getFileInfoFromHeaders","rows","_iteratorNormalCompletion","_didIteratorError","_iteratorError","createFileLoader","fetchFn","complete","progress","getProgress","abort","loadURL","body","code","response","computable","total","fileinfo","setSource","isGet","sendRequest","onheaders","onprogress","ontimeout","onabort","aborted","xhr","headersReceived","encodeURI","encodeURIComponent","stringify","XMLHttpRequest","upload","lengthComputable","loaded","onreadystatechange","readyState","open","unescape","setRequestHeader","responseType","createResponse","createTimeoutResponse","getAllResponseHeaders","hasQS","buildURL","createFetchFunction","apiUrl","statusText","ChunkStatus","QUEUED","COMPLETE","WAITING","processFileChunked","metadata","transfer","chunks","chunkTransferId","chunkServer","serverId","fd","getResponseHeader","requestTransferId","formData","FormData","requestParams","requestTransferOffset","requestUrl","lastChunkIndex","retries","completeProcessingChunks","canProcessChunk","chunk","processChunk","every","processChunks","updateTotalProgress","retryProcessChunk","totalBytesTransfered","totalSize","totalProcessing","abortChunks","createFileProcessorFunction","canChunkUpload","shouldChunkUpload","willChunkUpload","createProcessorFunction","params","createRevertFunction","uniqueFileId","getRandomNumber","createPerceivedPerformanceUpdater","tickMin","tickMax","runtime","clear","createFileProcessor","processFn","perceivedProgress","perceivedPerformanceUpdater","perceivedDuration","progressFn","completeFn","transferId","reset","getDuration","getFilenameWithoutExtension","lastIndexOf","createFileStub","isFile","deepCloneObject","createItem","origin","serverFileReference","frozen","processingAborted","activeLoader","activeProcessor","abortProcessingRequestComplete","setStatus","getFileExtension","getFileType","getFileSize","getFile","loader","meta","success","retryLoad","abortLoad","processor","onprocess","console","requestProcessing","abortProcessing","revertFileUpload","serverTransferId","_setMetadata","setMetadata","getMetadata","filenameWithoutExtension","fileExtension","fileType","relativePath","extend","handler","itemAPI","release","archive","getItemIndexByQuery","getItemById","itemId","fetchBlob","getDomainFromURL","location","protocol","isExternalURL","href","dynamicLabel","label","isMockItem","listUpdated","optionalPromise","sortItems","compare","getItemByQueryFromState","itemHandler","_ref$success","_ref$failure","failure","ABORT_ALL","DID_SET_FILES","_ref2$value","activeItems","interactionMethod","DID_UPDATE_ITEM_METADATA","_ref3","change","shouldPrepareOutput","doUpload","MOVE_ITEM","_ref4","currentIndex","SORT","_ref5","ADD_ITEMS","_ref6","_ref6$success","_ref6$failure","insertLocation","totalItems","isValidFile","validItems","promises","all","ADD_ITEM","_ref7","_ref7$index","_ref7$success","_ref7$failure","_ref7$options","_item","mainStatus","main","sub","handleAdd","shouldAdd","loadComplete","_ref8","REQUEST_PREPARE_OUTPUT","_ref9","_ref9$failure","COMPLETE_LOAD_ITEM","_ref10","RETRY_ITEM_LOAD","REQUEST_ITEM_PREPARE","_success","output","REQUEST_ITEM_PROCESSING","itemCanBeQueuedForProcessing","processNow","PROCESS_ITEM","totalCurrentUploads","processNext","queueEntry","itemReference","noop","allItemsProcessed","RETRY_ITEM_PROCESSING","REQUEST_REMOVE_ITEM","shouldRemove","RELEASE_ITEM","REMOVE_ITEM","removeFromView","ABORT_ITEM_LOAD","ABORT_ITEM_PROCESSING","REQUEST_REVERT_ITEM_PROCESSING","handleRevert","shouldRevert","requestRemoveResult","REVERT_ITEM_PROCESSING","SET_OPTIONS","_ref11","optionKeys","prioritizedOptionKeys","PrioritizedOptions","orderedOptionKeys","formatFilename","createElement$1","tagName","text","textNode","createTextNode","nodeValue","polarToCartesian","centerX","centerY","radius","angleInDegrees","angleInRadians","PI","x","cos","y","sin","describeArc","startAngle","endAngle","arcSweep","end","percentageArc","to","spin","svg","path","align","dataset","ringStrokeWidth","ringFrom","ringTo","coordinates","progressIndicator","create$1","innerHTML","icon","isDisabled","write$1","shouldDisable","removeAttribute","fileActionButton","toNaturalFileSize","_options$labelBytes","_options$labelKilobyt","_options$labelMegabyt","_options$labelGigabyt","round","KB","MB","GB","removeDecimalsWhenZero","decimalCount","toFixed","create$2","fileName","updateFile","updateFileSizeOnError","fileInfo","DID_LOAD_ITEM","DID_UPDATE_ITEM_META","DID_THROW_ITEM_LOAD_ERROR","DID_THROW_ITEM_INVALID","toPercentage","create$3","didSetItemLoadProgress","title","didSetItemProcessProgress","didRequestItemProcessing","didAbortItemProcessing","didCompleteItemProcessing","fileStatus","DID_REVERT_ITEM_PROCESSING","DID_REQUEST_ITEM_PROCESSING","DID_ABORT_ITEM_PROCESSING","DID_COMPLETE_ITEM_PROCESSING","DID_UPDATE_ITEM_PROCESS_PROGRESS","DID_UPDATE_ITEM_LOAD_PROGRESS","DID_THROW_ITEM_PROCESSING_ERROR","DID_THROW_ITEM_PROCESSING_REVERT_ERROR","DID_THROW_ITEM_REMOVE_ERROR","Buttons","AbortItemLoad","RetryItemLoad","RemoveItem","ProcessItem","AbortItemProcessing","RetryItemProcessing","RevertItemProcessing","ButtonKeys","calculateFileInfoOffset","getRemoveIndicatorAligment","buttonRect","buttonRemoveItem","calculateButtonWidth","buttonAbortItemLoad","calculateFileVerticalCenterOffset","calculateFileHorizontalCenterOffset","getLoadIndicatorAlignment","getProcessIndicatorAlignment","DefaultStyle","buttonRetryItemLoad","buttonProcessItem","buttonAbortItemProcessing","buttonRetryItemProcessing","buttonRevertItemProcessing","loadProgressIndicator","processProgressIndicator","processingCompleteIndicator","IdleStyle","ProcessingStyle","StyleMap","DID_START_ITEM_LOAD","DID_START_ITEM_REMOVE","DID_LOAD_LOCAL_ITEM","DID_START_ITEM_PROCESSING","processingCompleteIndicatorView","create$4","LocalButtons","prev","curr","alignRemoveItemButton","buttonFilter","enabledButtons","_map","buttonView","classList","stopPropagation","loadIndicatorView","progressIndicatorView","activeStyles","write$2","route","stylesToApply","defaultStyles","control","DID_SET_LABEL_BUTTON_ABORT_ITEM_PROCESSING","DID_SET_LABEL_BUTTON_ABORT_ITEM_LOAD","DID_SET_LABEL_BUTTON_ABORT_ITEM_REMOVAL","buttonAbortItemRemoval","_ref12","create$5","didLoadItem","fileWrapper","PANEL_SPRING_PROPS","create$6","section","createSection","scalable","viewConstructor","write$3","topRect","bottomRect","center","panel","heightCurrent","createDragHelper","itemIds","prevIndex","setIndex","getIndex","getItemIndex","ITEM_TRANSLATE_SPRING","ITEM_SCALE_SPRING","StateMap","create$7","handleClick","container","markedForRemoval","dragState","grab","isPrimary","removedActivateListener","pageX","pageY","dragOrigin","dragCenter","offsetX","offsetY","drag","preventDefault","dragOffset","dist","drop","route$1","DID_UPDATE_PANEL_HEIGHT","write$4","DID_GRAB_ITEM","DID_DRAG_ITEM","DID_DROP_ITEM","currentState","filepondItemState","getItemsPerRow","horizontalSpace","itemWidth","getItemIndexByPosition","positionInView","l","itemRect","itemHorizontalMargin","itemsPerRow","childMid","itemVerticalMargin","itemHeight","_index","indexX","indexY","itemTop","itemRight","itemBottom","dropAreaDimensions","getHeight","setHeight","getWidth","setWidth","setDimensions","create$8","lastItemSpanwDate","addItemView","addIndex","spawnDate","cooldown","moveItem","vx","vy","introItemView","removeItemView","getItemHeight","getItemWidth","dragItem","numItems","oldIndex","dragPosition","dragHeight","dragWidth","cols","getGridIndex","getColIndex","visibleChildren","idx","childHeight","childBottom","childTop","route$2","DID_ADD_ITEM","DID_REMOVE_ITEM","write$5","dragCoordinates","dragIndex","dragIndexOffset","removeIndexOffset","addIndexOffset","childRect","visualHeight","prevX","prevY","visualIndex","vectorX","sign","vectorY","filterSetItemActions","list","create$9","overflowing","storeDragCoordinates","scopeLeft","scopeTop","clearDragCoordinates","route$3","DID_DRAG","DID_END_DRAG","write$6","overflow","newHeight","listScroller","attrToggle","enabledValue","resetFileInput","form","create$a","setAcceptedFileTypes","toggleAllowMultiple","toggleDirectoryFilter","toggleDisabled","toggleRequired","setCaptureMethod","handleChange","webkitRelativePath","doesAllowBrowse","disableField","updateRequiredStatus","shouldCheckValidity","setCustomValidity","updateFieldValidityStatus","browser","DID_SET_DISABLED","DID_SET_ALLOW_BROWSE","DID_SET_ALLOW_DIRECTORIES_ONLY","DID_SET_ALLOW_MULTIPLE","DID_SET_ACCEPTED_FILE_TYPES","DID_SET_CAPTURE_METHOD","DID_SET_REQUIRED","Key","ENTER","SPACE","create$b","handleKeyDown","isActivationKey","keyCode","click","isLabelClick","contains","updateLabelValue","caption","clickable","querySelector","dropLabel","DID_SET_LABEL_IDLE","addBlob","moveBlob","hideBlob","explodeBlob","write$7","route$4","DID_DROP","drip","setInputFiles","create$c","fields","getField","syncFieldPositionsWithItems","didReorderItems","didAddItem","fileItem","isLocalFile","shouldUseFileInput","dataContainer","didLoadItem$1","field","didPrepareOutput","didSetDisabled","didRemoveItem","didDefineValue","write$8","DID_DEFINE_VALUE","DID_PREPARE_OUTPUT","DID_REORDER_ITEMS","DID_SORT_ITEMS","getRootNode","images","text$1","zip","epub","guesstimateMimeType","requestDataTransferItems","links","getLinks","hasFiles","getFiles","promisedFiles","isFileSystemItem","getFilesFromItem","returnedFileGroups","group","isEntry","entry","getAsEntry","isDirectory","isDirectoryEntry","getFilesInDirectory","getAsFile","dirCounter","fileCounter","resolveIfDone","readEntries","dirEntry","directoryReader","createReader","readBatch","entries","correctedFile","correctMissingFileType","fullPath","webkitGetAsEntry","getLinksFromTransferMetaData","getLinksFromTransferURLData","getData","dragNDropObservers","eventPosition","pageLeft","pageTop","layerX","layerY","createDragNDropClient","scopeToObserve","filterElement","observer","getDragNDropObserver","client","ondrop","onenter","ondrag","onexit","allowdrop","addListener","newObserver","createDragNDropObserver","clients","dragenter","dragover","dragleave","handlers","createHandler","elementFromPoint","point","isEventTarget","elementAtPosition","pageXOffset","pageYOffset","initialTarget","setDropEffect","effect","dropEffect","overDropTarget","allowsTransfer","createHopper","scope","validateItems","catchesDropsOnPage","requiresDropOnElement","_options$filterItems","filterItems","documentElement","lastState","filteredItems","ondragend","ondragstart","updateHopperState","hopperState","listening","listeners$1","handlePaste","activeEl","activeElement","nodeName","inScope","clipboardData","listen","unlisten","createPaster","create$d","addFilesNotificationTimeout","notificationClearTimeout","filenames","assist","message","textContent","clear$1","listModified","isUsingFilePond","itemAdded","itemRemoved","itemProcessed","itemProcessedUndo","itemError","assistant","toCamels","charAt","debounce","func","immidiateOnly","MAX_FILES_LIMIT","prevent","create$e","measure","bounds","widthPrevious","widthUpdated","updateHistory","previousAspectRatio","canHover","matchMedia","hasPointerEvents","passive","hasCredits","frag","tabindex","rel","write$9","route$5","calculateRootBoundingBoxHeight","_root$ref","hopper","isMultiItem","maxItems","atMaxCapacity","addAction","listItemMargin","calculateListItemMargin","listHeight","calculateListHeight","labelHeight","currentLabelHeight","listMarginTop","listMarginBottom","visual","boundsHeight","history","MAX_BOUNCES","bounces","listAvailableHeight","fixedHeight","_listAvailableHeight","cappedHeight","isCappedHeight","panelHeight","_listAvailableHeight2","itemMargin","transform","scrollList","itemList","newItem","removedItem","verticalItemCount","ceil","measureHeight","maxHeight","exceedsMaxFiles","totalBrowseItems","hasMaxItems","getDragIndex","toggleDrop","isAllowed","enabled","toggleBrowse","togglePaste","paster","DID_SET_ALLOW_DROP","DID_SET_ALLOW_PASTE","createApp","initialOptions","originalElement","visibilityHandler","resizeDoneTimer","isResizing","isResizingHorizontally","initialWindowWidth","currentWindowWidth","resizeHandler","isHidden","readWriteApi","innerWidth","routeActionsToEvents","createEvent","eventRoutes","DID_DESTROY","DID_INIT","DID_THROW_MAX_FILES","DID_INIT_ITEM","DID_COMPLETE_ITEM_PROCESSING_ALL","DID_UPDATE_ITEMS","DID_ACTIVATE_ITEM","exposeEvent","detail","pond","dispatchEvent","CustomEvent","bubbles","cancelable","composed","filtered","prepareFile","addFile","addFiles","isFilePondFile","removeFile","sources","lastArgument","processFile","prepareFiles","processFiles","_len3","_key3","removeFiles","_len4","_key4","mappedQueries","q","moveFile","browse","insertBefore$1","insertAfter$1","appendTo","replaceElement","restoreElement","isAttachedTo","createAppObject","customOptions","app","lowerCaseFirstLetter","attributeNameToPropertyName","attributeName","mapObject","propertyMap","selector","mapping","selectorRegExp","getAttributesAsObject","attributeMapping","attribute","createAppAtElement","mergedOptions","attributeOptions","querySelectorAll","createApp$1","PRIVATE_METHODS","createAppAPI","replaceInString","replacements","createWorker","workerBlob","workerURL","URL","createObjectURL","worker","Worker","post","transferList","onmessage","postMessage","terminate","revokeObjectURL","loadImage","img","Image","renameFile","renamedFile","copyFile","registeredPlugins","createAppPlugin","plugin","pluginOutline","views","isOperaMini","operamini","hasPromises","hasBlobSlice","hasCreateObjectURL","hasVisibility","hasTiming","hasCSSSupports","CSS","isIE11","navigator","userAgent","supported","isSupported","apps","FileStatus","OptionTypes","registerPlugin","updateOptionTypes","hook","indexToRemove","matchedHooks","newHooks","newHook","plugins","getOptions$1","setOptions$1"],"mappings":"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","sourcesContent":["/*!\n * FilePond 4.30.3\n * Licensed under MIT, https://opensource.org/licenses/MIT/\n * Please visit https://pqina.nl/filepond/ for details.\n */\n\n/* eslint-disable */\n\n(function(global, factory) {\n    typeof exports === 'object' && typeof module !== 'undefined'\n        ? factory(exports)\n        : typeof define === 'function' && define.amd\n        ? define(['exports'], factory)\n        : ((global = global || self), factory((global.FilePond = {})));\n})(this, function(exports) {\n    'use strict';\n\n    var isNode = function isNode(value) {\n        return value instanceof HTMLElement;\n    };\n\n    var createStore = function createStore(initialState) {\n        var queries = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];\n        var actions = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : [];\n        // internal state\n        var state = Object.assign({}, initialState);\n\n        // contains all actions for next frame, is clear when actions are requested\n        var actionQueue = [];\n        var dispatchQueue = [];\n\n        // returns a duplicate of the current state\n        var getState = function getState() {\n            return Object.assign({}, state);\n        };\n\n        // returns a duplicate of the actions array and clears the actions array\n        var processActionQueue = function processActionQueue() {\n            // create copy of actions queue\n            var queue = [].concat(actionQueue);\n\n            // clear actions queue (we don't want no double actions)\n            actionQueue.length = 0;\n\n            return queue;\n        };\n\n        // processes actions that might block the main UI thread\n        var processDispatchQueue = function processDispatchQueue() {\n            // create copy of actions queue\n            var queue = [].concat(dispatchQueue);\n\n            // clear actions queue (we don't want no double actions)\n            dispatchQueue.length = 0;\n\n            // now dispatch these actions\n            queue.forEach(function(_ref) {\n                var type = _ref.type,\n                    data = _ref.data;\n                dispatch(type, data);\n            });\n        };\n\n        // adds a new action, calls its handler and\n        var dispatch = function dispatch(type, data, isBlocking) {\n            // is blocking action (should never block if document is hidden)\n            if (isBlocking && !document.hidden) {\n                dispatchQueue.push({ type: type, data: data });\n                return;\n            }\n\n            // if this action has a handler, handle the action\n            if (actionHandlers[type]) {\n                actionHandlers[type](data);\n            }\n\n            // now add action\n            actionQueue.push({\n                type: type,\n                data: data,\n            });\n        };\n\n        var query = function query(str) {\n            var _queryHandles;\n            for (\n                var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1;\n                _key < _len;\n                _key++\n            ) {\n                args[_key - 1] = arguments[_key];\n            }\n            return queryHandles[str]\n                ? (_queryHandles = queryHandles)[str].apply(_queryHandles, args)\n                : null;\n        };\n\n        var api = {\n            getState: getState,\n            processActionQueue: processActionQueue,\n            processDispatchQueue: processDispatchQueue,\n            dispatch: dispatch,\n            query: query,\n        };\n\n        var queryHandles = {};\n        queries.forEach(function(query) {\n            queryHandles = Object.assign({}, query(state), {}, queryHandles);\n        });\n\n        var actionHandlers = {};\n        actions.forEach(function(action) {\n            actionHandlers = Object.assign({}, action(dispatch, query, state), {}, actionHandlers);\n        });\n\n        return api;\n    };\n\n    var defineProperty = function defineProperty(obj, property, definition) {\n        if (typeof definition === 'function') {\n            obj[property] = definition;\n            return;\n        }\n        Object.defineProperty(obj, property, Object.assign({}, definition));\n    };\n\n    var forin = function forin(obj, cb) {\n        for (var key in obj) {\n            if (!obj.hasOwnProperty(key)) {\n                continue;\n            }\n\n            cb(key, obj[key]);\n        }\n    };\n\n    var createObject = function createObject(definition) {\n        var obj = {};\n        forin(definition, function(property) {\n            defineProperty(obj, property, definition[property]);\n        });\n        return obj;\n    };\n\n    var attr = function attr(node, name) {\n        var value = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;\n        if (value === null) {\n            return node.getAttribute(name) || node.hasAttribute(name);\n        }\n        node.setAttribute(name, value);\n    };\n\n    var ns = 'http://www.w3.org/2000/svg';\n    var svgElements = ['svg', 'path']; // only svg elements used\n\n    var isSVGElement = function isSVGElement(tag) {\n        return svgElements.includes(tag);\n    };\n\n    var createElement = function createElement(tag, className) {\n        var attributes = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n        if (typeof className === 'object') {\n            attributes = className;\n            className = null;\n        }\n        var element = isSVGElement(tag)\n            ? document.createElementNS(ns, tag)\n            : document.createElement(tag);\n        if (className) {\n            if (isSVGElement(tag)) {\n                attr(element, 'class', className);\n            } else {\n                element.className = className;\n            }\n        }\n        forin(attributes, function(name, value) {\n            attr(element, name, value);\n        });\n        return element;\n    };\n\n    var appendChild = function appendChild(parent) {\n        return function(child, index) {\n            if (typeof index !== 'undefined' && parent.children[index]) {\n                parent.insertBefore(child, parent.children[index]);\n            } else {\n                parent.appendChild(child);\n            }\n        };\n    };\n\n    var appendChildView = function appendChildView(parent, childViews) {\n        return function(view, index) {\n            if (typeof index !== 'undefined') {\n                childViews.splice(index, 0, view);\n            } else {\n                childViews.push(view);\n            }\n\n            return view;\n        };\n    };\n\n    var removeChildView = function removeChildView(parent, childViews) {\n        return function(view) {\n            // remove from child views\n            childViews.splice(childViews.indexOf(view), 1);\n\n            // remove the element\n            if (view.element.parentNode) {\n                parent.removeChild(view.element);\n            }\n\n            return view;\n        };\n    };\n\n    var IS_BROWSER = (function() {\n        return typeof window !== 'undefined' && typeof window.document !== 'undefined';\n    })();\n    var isBrowser = function isBrowser() {\n        return IS_BROWSER;\n    };\n\n    var testElement = isBrowser() ? createElement('svg') : {};\n    var getChildCount =\n        'children' in testElement\n            ? function(el) {\n                  return el.children.length;\n              }\n            : function(el) {\n                  return el.childNodes.length;\n              };\n\n    var getViewRect = function getViewRect(elementRect, childViews, offset, scale) {\n        var left = offset[0] || elementRect.left;\n        var top = offset[1] || elementRect.top;\n        var right = left + elementRect.width;\n        var bottom = top + elementRect.height * (scale[1] || 1);\n\n        var rect = {\n            // the rectangle of the element itself\n            element: Object.assign({}, elementRect),\n\n            // the rectangle of the element expanded to contain its children, does not include any margins\n            inner: {\n                left: elementRect.left,\n                top: elementRect.top,\n                right: elementRect.right,\n                bottom: elementRect.bottom,\n            },\n\n            // the rectangle of the element expanded to contain its children including own margin and child margins\n            // margins will be added after we've recalculated the size\n            outer: {\n                left: left,\n                top: top,\n                right: right,\n                bottom: bottom,\n            },\n        };\n\n        // expand rect to fit all child rectangles\n        childViews\n            .filter(function(childView) {\n                return !childView.isRectIgnored();\n            })\n            .map(function(childView) {\n                return childView.rect;\n            })\n            .forEach(function(childViewRect) {\n                expandRect(rect.inner, Object.assign({}, childViewRect.inner));\n                expandRect(rect.outer, Object.assign({}, childViewRect.outer));\n            });\n\n        // calculate inner width and height\n        calculateRectSize(rect.inner);\n\n        // append additional margin (top and left margins are included in top and left automatically)\n        rect.outer.bottom += rect.element.marginBottom;\n        rect.outer.right += rect.element.marginRight;\n\n        // calculate outer width and height\n        calculateRectSize(rect.outer);\n\n        return rect;\n    };\n\n    var expandRect = function expandRect(parent, child) {\n        // adjust for parent offset\n        child.top += parent.top;\n        child.right += parent.left;\n        child.bottom += parent.top;\n        child.left += parent.left;\n\n        if (child.bottom > parent.bottom) {\n            parent.bottom = child.bottom;\n        }\n\n        if (child.right > parent.right) {\n            parent.right = child.right;\n        }\n    };\n\n    var calculateRectSize = function calculateRectSize(rect) {\n        rect.width = rect.right - rect.left;\n        rect.height = rect.bottom - rect.top;\n    };\n\n    var isNumber = function isNumber(value) {\n        return typeof value === 'number';\n    };\n\n    /**\n     * Determines if position is at destination\n     * @param position\n     * @param destination\n     * @param velocity\n     * @param errorMargin\n     * @returns {boolean}\n     */\n    var thereYet = function thereYet(position, destination, velocity) {\n        var errorMargin = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 0.001;\n        return Math.abs(position - destination) < errorMargin && Math.abs(velocity) < errorMargin;\n    };\n\n    /**\n     * Spring animation\n     */\n    var spring =\n        // default options\n        function spring() // method definition\n        {\n            var _ref = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {},\n                _ref$stiffness = _ref.stiffness,\n                stiffness = _ref$stiffness === void 0 ? 0.5 : _ref$stiffness,\n                _ref$damping = _ref.damping,\n                damping = _ref$damping === void 0 ? 0.75 : _ref$damping,\n                _ref$mass = _ref.mass,\n                mass = _ref$mass === void 0 ? 10 : _ref$mass;\n            var target = null;\n            var position = null;\n            var velocity = 0;\n            var resting = false;\n\n            // updates spring state\n            var interpolate = function interpolate(ts, skipToEndState) {\n                // in rest, don't animate\n                if (resting) return;\n\n                // need at least a target or position to do springy things\n                if (!(isNumber(target) && isNumber(position))) {\n                    resting = true;\n                    velocity = 0;\n                    return;\n                }\n\n                // calculate spring force\n                var f = -(position - target) * stiffness;\n\n                // update velocity by adding force based on mass\n                velocity += f / mass;\n\n                // update position by adding velocity\n                position += velocity;\n\n                // slow down based on amount of damping\n                velocity *= damping;\n\n                // we've arrived if we're near target and our velocity is near zero\n                if (thereYet(position, target, velocity) || skipToEndState) {\n                    position = target;\n                    velocity = 0;\n                    resting = true;\n\n                    // we done\n                    api.onupdate(position);\n                    api.oncomplete(position);\n                } else {\n                    // progress update\n                    api.onupdate(position);\n                }\n            };\n\n            /**\n             * Set new target value\n             * @param value\n             */\n            var setTarget = function setTarget(value) {\n                // if currently has no position, set target and position to this value\n                if (isNumber(value) && !isNumber(position)) {\n                    position = value;\n                }\n\n                // next target value will not be animated to\n                if (target === null) {\n                    target = value;\n                    position = value;\n                }\n\n                // let start moving to target\n                target = value;\n\n                // already at target\n                if (position === target || typeof target === 'undefined') {\n                    // now resting as target is current position, stop moving\n                    resting = true;\n                    velocity = 0;\n\n                    // done!\n                    api.onupdate(position);\n                    api.oncomplete(position);\n\n                    return;\n                }\n\n                resting = false;\n            };\n\n            // need 'api' to call onupdate callback\n            var api = createObject({\n                interpolate: interpolate,\n                target: {\n                    set: setTarget,\n                    get: function get() {\n                        return target;\n                    },\n                },\n\n                resting: {\n                    get: function get() {\n                        return resting;\n                    },\n                },\n\n                onupdate: function onupdate(value) {},\n                oncomplete: function oncomplete(value) {},\n            });\n\n            return api;\n        };\n\n    var easeLinear = function easeLinear(t) {\n        return t;\n    };\n    var easeInOutQuad = function easeInOutQuad(t) {\n        return t < 0.5 ? 2 * t * t : -1 + (4 - 2 * t) * t;\n    };\n\n    var tween =\n        // default values\n        function tween() // method definition\n        {\n            var _ref = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {},\n                _ref$duration = _ref.duration,\n                duration = _ref$duration === void 0 ? 500 : _ref$duration,\n                _ref$easing = _ref.easing,\n                easing = _ref$easing === void 0 ? easeInOutQuad : _ref$easing,\n                _ref$delay = _ref.delay,\n                delay = _ref$delay === void 0 ? 0 : _ref$delay;\n            var start = null;\n            var t;\n            var p;\n            var resting = true;\n            var reverse = false;\n            var target = null;\n\n            var interpolate = function interpolate(ts, skipToEndState) {\n                if (resting || target === null) return;\n\n                if (start === null) {\n                    start = ts;\n                }\n\n                if (ts - start < delay) return;\n\n                t = ts - start - delay;\n\n                if (t >= duration || skipToEndState) {\n                    t = 1;\n                    p = reverse ? 0 : 1;\n                    api.onupdate(p * target);\n                    api.oncomplete(p * target);\n                    resting = true;\n                } else {\n                    p = t / duration;\n                    api.onupdate((t >= 0 ? easing(reverse ? 1 - p : p) : 0) * target);\n                }\n            };\n\n            // need 'api' to call onupdate callback\n            var api = createObject({\n                interpolate: interpolate,\n                target: {\n                    get: function get() {\n                        return reverse ? 0 : target;\n                    },\n                    set: function set(value) {\n                        // is initial value\n                        if (target === null) {\n                            target = value;\n                            api.onupdate(value);\n                            api.oncomplete(value);\n                            return;\n                        }\n\n                        // want to tween to a smaller value and have a current value\n                        if (value < target) {\n                            target = 1;\n                            reverse = true;\n                        } else {\n                            // not tweening to a smaller value\n                            reverse = false;\n                            target = value;\n                        }\n\n                        // let's go!\n                        resting = false;\n                        start = null;\n                    },\n                },\n\n                resting: {\n                    get: function get() {\n                        return resting;\n                    },\n                },\n\n                onupdate: function onupdate(value) {},\n                oncomplete: function oncomplete(value) {},\n            });\n\n            return api;\n        };\n\n    var animator = {\n        spring: spring,\n        tween: tween,\n    };\n\n    /*\n                       { type: 'spring', stiffness: .5, damping: .75, mass: 10 };\n                       { translation: { type: 'spring', ... }, ... }\n                       { translation: { x: { type: 'spring', ... } } }\n                      */\n    var createAnimator = function createAnimator(definition, category, property) {\n        // default is single definition\n        // we check if transform is set, if so, we check if property is set\n        var def =\n            definition[category] && typeof definition[category][property] === 'object'\n                ? definition[category][property]\n                : definition[category] || definition;\n\n        var type = typeof def === 'string' ? def : def.type;\n        var props = typeof def === 'object' ? Object.assign({}, def) : {};\n\n        return animator[type] ? animator[type](props) : null;\n    };\n\n    var addGetSet = function addGetSet(keys, obj, props) {\n        var overwrite = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : false;\n        obj = Array.isArray(obj) ? obj : [obj];\n        obj.forEach(function(o) {\n            keys.forEach(function(key) {\n                var name = key;\n                var getter = function getter() {\n                    return props[key];\n                };\n                var setter = function setter(value) {\n                    return (props[key] = value);\n                };\n\n                if (typeof key === 'object') {\n                    name = key.key;\n                    getter = key.getter || getter;\n                    setter = key.setter || setter;\n                }\n\n                if (o[name] && !overwrite) {\n                    return;\n                }\n\n                o[name] = {\n                    get: getter,\n                    set: setter,\n                };\n            });\n        });\n    };\n\n    // add to state,\n    // add getters and setters to internal and external api (if not set)\n    // setup animators\n\n    var animations = function animations(_ref) {\n        var mixinConfig = _ref.mixinConfig,\n            viewProps = _ref.viewProps,\n            viewInternalAPI = _ref.viewInternalAPI,\n            viewExternalAPI = _ref.viewExternalAPI;\n        // initial properties\n        var initialProps = Object.assign({}, viewProps);\n\n        // list of all active animations\n        var animations = [];\n\n        // setup animators\n        forin(mixinConfig, function(property, animation) {\n            var animator = createAnimator(animation);\n            if (!animator) {\n                return;\n            }\n\n            // when the animator updates, update the view state value\n            animator.onupdate = function(value) {\n                viewProps[property] = value;\n            };\n\n            // set animator target\n            animator.target = initialProps[property];\n\n            // when value is set, set the animator target value\n            var prop = {\n                key: property,\n                setter: function setter(value) {\n                    // if already at target, we done!\n                    if (animator.target === value) {\n                        return;\n                    }\n\n                    animator.target = value;\n                },\n                getter: function getter() {\n                    return viewProps[property];\n                },\n            };\n\n            // add getters and setters\n            addGetSet([prop], [viewInternalAPI, viewExternalAPI], viewProps, true);\n\n            // add it to the list for easy updating from the _write method\n            animations.push(animator);\n        });\n\n        // expose internal write api\n        return {\n            write: function write(ts) {\n                var skipToEndState = document.hidden;\n                var resting = true;\n                animations.forEach(function(animation) {\n                    if (!animation.resting) resting = false;\n                    animation.interpolate(ts, skipToEndState);\n                });\n                return resting;\n            },\n            destroy: function destroy() {},\n        };\n    };\n\n    var addEvent = function addEvent(element) {\n        return function(type, fn) {\n            element.addEventListener(type, fn);\n        };\n    };\n\n    var removeEvent = function removeEvent(element) {\n        return function(type, fn) {\n            element.removeEventListener(type, fn);\n        };\n    };\n\n    // mixin\n    var listeners = function listeners(_ref) {\n        var mixinConfig = _ref.mixinConfig,\n            viewProps = _ref.viewProps,\n            viewInternalAPI = _ref.viewInternalAPI,\n            viewExternalAPI = _ref.viewExternalAPI,\n            viewState = _ref.viewState,\n            view = _ref.view;\n        var events = [];\n\n        var add = addEvent(view.element);\n        var remove = removeEvent(view.element);\n\n        viewExternalAPI.on = function(type, fn) {\n            events.push({\n                type: type,\n                fn: fn,\n            });\n\n            add(type, fn);\n        };\n\n        viewExternalAPI.off = function(type, fn) {\n            events.splice(\n                events.findIndex(function(event) {\n                    return event.type === type && event.fn === fn;\n                }),\n                1\n            );\n\n            remove(type, fn);\n        };\n\n        return {\n            write: function write() {\n                // not busy\n                return true;\n            },\n            destroy: function destroy() {\n                events.forEach(function(event) {\n                    remove(event.type, event.fn);\n                });\n            },\n        };\n    };\n\n    // add to external api and link to props\n\n    var apis = function apis(_ref) {\n        var mixinConfig = _ref.mixinConfig,\n            viewProps = _ref.viewProps,\n            viewExternalAPI = _ref.viewExternalAPI;\n        addGetSet(mixinConfig, viewExternalAPI, viewProps);\n    };\n\n    var isDefined = function isDefined(value) {\n        return value != null;\n    };\n\n    // add to state,\n    // add getters and setters to internal and external api (if not set)\n    // set initial state based on props in viewProps\n    // apply as transforms each frame\n\n    var defaults = {\n        opacity: 1,\n        scaleX: 1,\n        scaleY: 1,\n        translateX: 0,\n        translateY: 0,\n        rotateX: 0,\n        rotateY: 0,\n        rotateZ: 0,\n        originX: 0,\n        originY: 0,\n    };\n\n    var styles = function styles(_ref) {\n        var mixinConfig = _ref.mixinConfig,\n            viewProps = _ref.viewProps,\n            viewInternalAPI = _ref.viewInternalAPI,\n            viewExternalAPI = _ref.viewExternalAPI,\n            view = _ref.view;\n        // initial props\n        var initialProps = Object.assign({}, viewProps);\n\n        // current props\n        var currentProps = {};\n\n        // we will add those properties to the external API and link them to the viewState\n        addGetSet(mixinConfig, [viewInternalAPI, viewExternalAPI], viewProps);\n\n        // override rect on internal and external rect getter so it takes in account transforms\n        var getOffset = function getOffset() {\n            return [viewProps['translateX'] || 0, viewProps['translateY'] || 0];\n        };\n\n        var getScale = function getScale() {\n            return [viewProps['scaleX'] || 0, viewProps['scaleY'] || 0];\n        };\n        var getRect = function getRect() {\n            return view.rect\n                ? getViewRect(view.rect, view.childViews, getOffset(), getScale())\n                : null;\n        };\n        viewInternalAPI.rect = { get: getRect };\n        viewExternalAPI.rect = { get: getRect };\n\n        // apply view props\n        mixinConfig.forEach(function(key) {\n            viewProps[key] =\n                typeof initialProps[key] === 'undefined' ? defaults[key] : initialProps[key];\n        });\n\n        // expose api\n        return {\n            write: function write() {\n                // see if props have changed\n                if (!propsHaveChanged(currentProps, viewProps)) {\n                    return;\n                }\n\n                // moves element to correct position on screen\n                applyStyles(view.element, viewProps);\n\n                // store new transforms\n                Object.assign(currentProps, Object.assign({}, viewProps));\n\n                // no longer busy\n                return true;\n            },\n            destroy: function destroy() {},\n        };\n    };\n\n    var propsHaveChanged = function propsHaveChanged(currentProps, newProps) {\n        // different amount of keys\n        if (Object.keys(currentProps).length !== Object.keys(newProps).length) {\n            return true;\n        }\n\n        // lets analyze the individual props\n        for (var prop in newProps) {\n            if (newProps[prop] !== currentProps[prop]) {\n                return true;\n            }\n        }\n\n        return false;\n    };\n\n    var applyStyles = function applyStyles(element, _ref2) {\n        var opacity = _ref2.opacity,\n            perspective = _ref2.perspective,\n            translateX = _ref2.translateX,\n            translateY = _ref2.translateY,\n            scaleX = _ref2.scaleX,\n            scaleY = _ref2.scaleY,\n            rotateX = _ref2.rotateX,\n            rotateY = _ref2.rotateY,\n            rotateZ = _ref2.rotateZ,\n            originX = _ref2.originX,\n            originY = _ref2.originY,\n            width = _ref2.width,\n            height = _ref2.height;\n\n        var transforms = '';\n        var styles = '';\n\n        // handle transform origin\n        if (isDefined(originX) || isDefined(originY)) {\n            styles += 'transform-origin: ' + (originX || 0) + 'px ' + (originY || 0) + 'px;';\n        }\n\n        // transform order is relevant\n        // 0. perspective\n        if (isDefined(perspective)) {\n            transforms += 'perspective(' + perspective + 'px) ';\n        }\n\n        // 1. translate\n        if (isDefined(translateX) || isDefined(translateY)) {\n            transforms +=\n                'translate3d(' + (translateX || 0) + 'px, ' + (translateY || 0) + 'px, 0) ';\n        }\n\n        // 2. scale\n        if (isDefined(scaleX) || isDefined(scaleY)) {\n            transforms +=\n                'scale3d(' +\n                (isDefined(scaleX) ? scaleX : 1) +\n                ', ' +\n                (isDefined(scaleY) ? scaleY : 1) +\n                ', 1) ';\n        }\n\n        // 3. rotate\n        if (isDefined(rotateZ)) {\n            transforms += 'rotateZ(' + rotateZ + 'rad) ';\n        }\n\n        if (isDefined(rotateX)) {\n            transforms += 'rotateX(' + rotateX + 'rad) ';\n        }\n\n        if (isDefined(rotateY)) {\n            transforms += 'rotateY(' + rotateY + 'rad) ';\n        }\n\n        // add transforms\n        if (transforms.length) {\n            styles += 'transform:' + transforms + ';';\n        }\n\n        // add opacity\n        if (isDefined(opacity)) {\n            styles += 'opacity:' + opacity + ';';\n\n            // if we reach zero, we make the element inaccessible\n            if (opacity === 0) {\n                styles += 'visibility:hidden;';\n            }\n\n            // if we're below 100% opacity this element can't be clicked\n            if (opacity < 1) {\n                styles += 'pointer-events:none;';\n            }\n        }\n\n        // add height\n        if (isDefined(height)) {\n            styles += 'height:' + height + 'px;';\n        }\n\n        // add width\n        if (isDefined(width)) {\n            styles += 'width:' + width + 'px;';\n        }\n\n        // apply styles\n        var elementCurrentStyle = element.elementCurrentStyle || '';\n\n        // if new styles does not match current styles, lets update!\n        if (styles.length !== elementCurrentStyle.length || styles !== elementCurrentStyle) {\n            element.style.cssText = styles;\n            // store current styles so we can compare them to new styles later on\n            // _not_ getting the style value is faster\n            element.elementCurrentStyle = styles;\n        }\n    };\n\n    var Mixins = {\n        styles: styles,\n        listeners: listeners,\n        animations: animations,\n        apis: apis,\n    };\n\n    var updateRect = function updateRect() {\n        var rect = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n        var element = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n        var style = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n\n        if (!element.layoutCalculated) {\n            rect.paddingTop = parseInt(style.paddingTop, 10) || 0;\n            rect.marginTop = parseInt(style.marginTop, 10) || 0;\n            rect.marginRight = parseInt(style.marginRight, 10) || 0;\n            rect.marginBottom = parseInt(style.marginBottom, 10) || 0;\n            rect.marginLeft = parseInt(style.marginLeft, 10) || 0;\n            element.layoutCalculated = true;\n        }\n\n        rect.left = element.offsetLeft || 0;\n        rect.top = element.offsetTop || 0;\n        rect.width = element.offsetWidth || 0;\n        rect.height = element.offsetHeight || 0;\n\n        rect.right = rect.left + rect.width;\n        rect.bottom = rect.top + rect.height;\n\n        rect.scrollTop = element.scrollTop;\n\n        rect.hidden = element.offsetParent === null;\n\n        return rect;\n    };\n\n    var createView =\n        // default view definition\n        function createView() {\n            var _ref = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {},\n                _ref$tag = _ref.tag,\n                tag = _ref$tag === void 0 ? 'div' : _ref$tag,\n                _ref$name = _ref.name,\n                name = _ref$name === void 0 ? null : _ref$name,\n                _ref$attributes = _ref.attributes,\n                attributes = _ref$attributes === void 0 ? {} : _ref$attributes,\n                _ref$read = _ref.read,\n                read = _ref$read === void 0 ? function() {} : _ref$read,\n                _ref$write = _ref.write,\n                write = _ref$write === void 0 ? function() {} : _ref$write,\n                _ref$create = _ref.create,\n                create = _ref$create === void 0 ? function() {} : _ref$create,\n                _ref$destroy = _ref.destroy,\n                destroy = _ref$destroy === void 0 ? function() {} : _ref$destroy,\n                _ref$filterFrameActio = _ref.filterFrameActionsForChild,\n                filterFrameActionsForChild =\n                    _ref$filterFrameActio === void 0\n                        ? function(child, actions) {\n                              return actions;\n                          }\n                        : _ref$filterFrameActio,\n                _ref$didCreateView = _ref.didCreateView,\n                didCreateView = _ref$didCreateView === void 0 ? function() {} : _ref$didCreateView,\n                _ref$didWriteView = _ref.didWriteView,\n                didWriteView = _ref$didWriteView === void 0 ? function() {} : _ref$didWriteView,\n                _ref$ignoreRect = _ref.ignoreRect,\n                ignoreRect = _ref$ignoreRect === void 0 ? false : _ref$ignoreRect,\n                _ref$ignoreRectUpdate = _ref.ignoreRectUpdate,\n                ignoreRectUpdate = _ref$ignoreRectUpdate === void 0 ? false : _ref$ignoreRectUpdate,\n                _ref$mixins = _ref.mixins,\n                mixins = _ref$mixins === void 0 ? [] : _ref$mixins;\n            return function(\n                // each view requires reference to store\n                store\n            ) {\n                var props = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n                // root element should not be changed\n                var element = createElement(tag, 'filepond--' + name, attributes);\n\n                // style reference should also not be changed\n                var style = window.getComputedStyle(element, null);\n\n                // element rectangle\n                var rect = updateRect();\n                var frameRect = null;\n\n                // rest state\n                var isResting = false;\n\n                // pretty self explanatory\n                var childViews = [];\n\n                // loaded mixins\n                var activeMixins = [];\n\n                // references to created children\n                var ref = {};\n\n                // state used for each instance\n                var state = {};\n\n                // list of writers that will be called to update this view\n                var writers = [\n                    write, // default writer\n                ];\n\n                var readers = [\n                    read, // default reader\n                ];\n\n                var destroyers = [\n                    destroy, // default destroy\n                ];\n\n                // core view methods\n                var getElement = function getElement() {\n                    return element;\n                };\n                var getChildViews = function getChildViews() {\n                    return childViews.concat();\n                };\n                var getReference = function getReference() {\n                    return ref;\n                };\n                var createChildView = function createChildView(store) {\n                    return function(view, props) {\n                        return view(store, props);\n                    };\n                };\n                var getRect = function getRect() {\n                    if (frameRect) {\n                        return frameRect;\n                    }\n                    frameRect = getViewRect(rect, childViews, [0, 0], [1, 1]);\n                    return frameRect;\n                };\n                var getStyle = function getStyle() {\n                    return style;\n                };\n\n                /**\n                 * Read data from DOM\n                 * @private\n                 */\n                var _read = function _read() {\n                    frameRect = null;\n\n                    // read child views\n                    childViews.forEach(function(child) {\n                        return child._read();\n                    });\n\n                    var shouldUpdate = !(ignoreRectUpdate && rect.width && rect.height);\n                    if (shouldUpdate) {\n                        updateRect(rect, element, style);\n                    }\n\n                    // readers\n                    var api = { root: internalAPI, props: props, rect: rect };\n                    readers.forEach(function(reader) {\n                        return reader(api);\n                    });\n                };\n\n                /**\n                 * Write data to DOM\n                 * @private\n                 */\n                var _write = function _write(ts, frameActions, shouldOptimize) {\n                    // if no actions, we assume that the view is resting\n                    var resting = frameActions.length === 0;\n\n                    // writers\n                    writers.forEach(function(writer) {\n                        var writerResting = writer({\n                            props: props,\n                            root: internalAPI,\n                            actions: frameActions,\n                            timestamp: ts,\n                            shouldOptimize: shouldOptimize,\n                        });\n\n                        if (writerResting === false) {\n                            resting = false;\n                        }\n                    });\n\n                    // run mixins\n                    activeMixins.forEach(function(mixin) {\n                        // if one of the mixins is still busy after write operation, we are not resting\n                        var mixinResting = mixin.write(ts);\n                        if (mixinResting === false) {\n                            resting = false;\n                        }\n                    });\n\n                    // updates child views that are currently attached to the DOM\n                    childViews\n                        .filter(function(child) {\n                            return !!child.element.parentNode;\n                        })\n                        .forEach(function(child) {\n                            // if a child view is not resting, we are not resting\n                            var childResting = child._write(\n                                ts,\n                                filterFrameActionsForChild(child, frameActions),\n                                shouldOptimize\n                            );\n\n                            if (!childResting) {\n                                resting = false;\n                            }\n                        });\n\n                    // append new elements to DOM and update those\n                    childViews\n                        //.filter(child => !child.element.parentNode)\n                        .forEach(function(child, index) {\n                            // skip\n                            if (child.element.parentNode) {\n                                return;\n                            }\n\n                            // append to DOM\n                            internalAPI.appendChild(child.element, index);\n\n                            // call read (need to know the size of these elements)\n                            child._read();\n\n                            // re-call write\n                            child._write(\n                                ts,\n                                filterFrameActionsForChild(child, frameActions),\n                                shouldOptimize\n                            );\n\n                            // we just added somthing to the dom, no rest\n                            resting = false;\n                        });\n\n                    // update resting state\n                    isResting = resting;\n\n                    didWriteView({\n                        props: props,\n                        root: internalAPI,\n                        actions: frameActions,\n                        timestamp: ts,\n                    });\n\n                    // let parent know if we are resting\n                    return resting;\n                };\n\n                var _destroy = function _destroy() {\n                    activeMixins.forEach(function(mixin) {\n                        return mixin.destroy();\n                    });\n                    destroyers.forEach(function(destroyer) {\n                        destroyer({ root: internalAPI, props: props });\n                    });\n                    childViews.forEach(function(child) {\n                        return child._destroy();\n                    });\n                };\n\n                // sharedAPI\n                var sharedAPIDefinition = {\n                    element: {\n                        get: getElement,\n                    },\n\n                    style: {\n                        get: getStyle,\n                    },\n\n                    childViews: {\n                        get: getChildViews,\n                    },\n                };\n\n                // private API definition\n                var internalAPIDefinition = Object.assign({}, sharedAPIDefinition, {\n                    rect: {\n                        get: getRect,\n                    },\n\n                    // access to custom children references\n                    ref: {\n                        get: getReference,\n                    },\n\n                    // dom modifiers\n                    is: function is(needle) {\n                        return name === needle;\n                    },\n                    appendChild: appendChild(element),\n                    createChildView: createChildView(store),\n                    linkView: function linkView(view) {\n                        childViews.push(view);\n                        return view;\n                    },\n                    unlinkView: function unlinkView(view) {\n                        childViews.splice(childViews.indexOf(view), 1);\n                    },\n                    appendChildView: appendChildView(element, childViews),\n                    removeChildView: removeChildView(element, childViews),\n                    registerWriter: function registerWriter(writer) {\n                        return writers.push(writer);\n                    },\n                    registerReader: function registerReader(reader) {\n                        return readers.push(reader);\n                    },\n                    registerDestroyer: function registerDestroyer(destroyer) {\n                        return destroyers.push(destroyer);\n                    },\n                    invalidateLayout: function invalidateLayout() {\n                        return (element.layoutCalculated = false);\n                    },\n\n                    // access to data store\n                    dispatch: store.dispatch,\n                    query: store.query,\n                });\n\n                // public view API methods\n                var externalAPIDefinition = {\n                    element: {\n                        get: getElement,\n                    },\n\n                    childViews: {\n                        get: getChildViews,\n                    },\n\n                    rect: {\n                        get: getRect,\n                    },\n\n                    resting: {\n                        get: function get() {\n                            return isResting;\n                        },\n                    },\n\n                    isRectIgnored: function isRectIgnored() {\n                        return ignoreRect;\n                    },\n                    _read: _read,\n                    _write: _write,\n                    _destroy: _destroy,\n                };\n\n                // mixin API methods\n                var mixinAPIDefinition = Object.assign({}, sharedAPIDefinition, {\n                    rect: {\n                        get: function get() {\n                            return rect;\n                        },\n                    },\n                });\n\n                // add mixin functionality\n                Object.keys(mixins)\n                    .sort(function(a, b) {\n                        // move styles to the back of the mixin list (so adjustments of other mixins are applied to the props correctly)\n                        if (a === 'styles') {\n                            return 1;\n                        } else if (b === 'styles') {\n                            return -1;\n                        }\n                        return 0;\n                    })\n                    .forEach(function(key) {\n                        var mixinAPI = Mixins[key]({\n                            mixinConfig: mixins[key],\n                            viewProps: props,\n                            viewState: state,\n                            viewInternalAPI: internalAPIDefinition,\n                            viewExternalAPI: externalAPIDefinition,\n                            view: createObject(mixinAPIDefinition),\n                        });\n\n                        if (mixinAPI) {\n                            activeMixins.push(mixinAPI);\n                        }\n                    });\n\n                // construct private api\n                var internalAPI = createObject(internalAPIDefinition);\n\n                // create the view\n                create({\n                    root: internalAPI,\n                    props: props,\n                });\n\n                // append created child views to root node\n                var childCount = getChildCount(element); // need to know the current child count so appending happens in correct order\n                childViews.forEach(function(child, index) {\n                    internalAPI.appendChild(child.element, childCount + index);\n                });\n\n                // call did create\n                didCreateView(internalAPI);\n\n                // expose public api\n                return createObject(externalAPIDefinition);\n            };\n        };\n\n    var createPainter = function createPainter(read, write) {\n        var fps = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 60;\n\n        var name = '__framePainter';\n\n        // set global painter\n        if (window[name]) {\n            window[name].readers.push(read);\n            window[name].writers.push(write);\n            return;\n        }\n\n        window[name] = {\n            readers: [read],\n            writers: [write],\n        };\n\n        var painter = window[name];\n\n        var interval = 1000 / fps;\n        var last = null;\n        var id = null;\n        var requestTick = null;\n        var cancelTick = null;\n\n        var setTimerType = function setTimerType() {\n            if (document.hidden) {\n                requestTick = function requestTick() {\n                    return window.setTimeout(function() {\n                        return tick(performance.now());\n                    }, interval);\n                };\n                cancelTick = function cancelTick() {\n                    return window.clearTimeout(id);\n                };\n            } else {\n                requestTick = function requestTick() {\n                    return window.requestAnimationFrame(tick);\n                };\n                cancelTick = function cancelTick() {\n                    return window.cancelAnimationFrame(id);\n                };\n            }\n        };\n\n        document.addEventListener('visibilitychange', function() {\n            if (cancelTick) cancelTick();\n            setTimerType();\n            tick(performance.now());\n        });\n\n        var tick = function tick(ts) {\n            // queue next tick\n            id = requestTick(tick);\n\n            // limit fps\n            if (!last) {\n                last = ts;\n            }\n\n            var delta = ts - last;\n\n            if (delta <= interval) {\n                // skip frame\n                return;\n            }\n\n            // align next frame\n            last = ts - (delta % interval);\n\n            // update view\n            painter.readers.forEach(function(read) {\n                return read();\n            });\n            painter.writers.forEach(function(write) {\n                return write(ts);\n            });\n        };\n\n        setTimerType();\n        tick(performance.now());\n\n        return {\n            pause: function pause() {\n                cancelTick(id);\n            },\n        };\n    };\n\n    var createRoute = function createRoute(routes, fn) {\n        return function(_ref) {\n            var root = _ref.root,\n                props = _ref.props,\n                _ref$actions = _ref.actions,\n                actions = _ref$actions === void 0 ? [] : _ref$actions,\n                timestamp = _ref.timestamp,\n                shouldOptimize = _ref.shouldOptimize;\n            actions\n                .filter(function(action) {\n                    return routes[action.type];\n                })\n                .forEach(function(action) {\n                    return routes[action.type]({\n                        root: root,\n                        props: props,\n                        action: action.data,\n                        timestamp: timestamp,\n                        shouldOptimize: shouldOptimize,\n                    });\n                });\n\n            if (fn) {\n                fn({\n                    root: root,\n                    props: props,\n                    actions: actions,\n                    timestamp: timestamp,\n                    shouldOptimize: shouldOptimize,\n                });\n            }\n        };\n    };\n\n    var insertBefore = function insertBefore(newNode, referenceNode) {\n        return referenceNode.parentNode.insertBefore(newNode, referenceNode);\n    };\n\n    var insertAfter = function insertAfter(newNode, referenceNode) {\n        return referenceNode.parentNode.insertBefore(newNode, referenceNode.nextSibling);\n    };\n\n    var isArray = function isArray(value) {\n        return Array.isArray(value);\n    };\n\n    var isEmpty = function isEmpty(value) {\n        return value == null;\n    };\n\n    var trim = function trim(str) {\n        return str.trim();\n    };\n\n    var toString = function toString(value) {\n        return '' + value;\n    };\n\n    var toArray = function toArray(value) {\n        var splitter = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : ',';\n        if (isEmpty(value)) {\n            return [];\n        }\n        if (isArray(value)) {\n            return value;\n        }\n        return toString(value)\n            .split(splitter)\n            .map(trim)\n            .filter(function(str) {\n                return str.length;\n            });\n    };\n\n    var isBoolean = function isBoolean(value) {\n        return typeof value === 'boolean';\n    };\n\n    var toBoolean = function toBoolean(value) {\n        return isBoolean(value) ? value : value === 'true';\n    };\n\n    var isString = function isString(value) {\n        return typeof value === 'string';\n    };\n\n    var toNumber = function toNumber(value) {\n        return isNumber(value)\n            ? value\n            : isString(value)\n            ? toString(value).replace(/[a-z]+/gi, '')\n            : 0;\n    };\n\n    var toInt = function toInt(value) {\n        return parseInt(toNumber(value), 10);\n    };\n\n    var toFloat = function toFloat(value) {\n        return parseFloat(toNumber(value));\n    };\n\n    var isInt = function isInt(value) {\n        return isNumber(value) && isFinite(value) && Math.floor(value) === value;\n    };\n\n    var toBytes = function toBytes(value) {\n        var base = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 1000;\n        // is in bytes\n        if (isInt(value)) {\n            return value;\n        }\n\n        // is natural file size\n        var naturalFileSize = toString(value).trim();\n\n        // if is value in megabytes\n        if (/MB$/i.test(naturalFileSize)) {\n            naturalFileSize = naturalFileSize.replace(/MB$i/, '').trim();\n            return toInt(naturalFileSize) * base * base;\n        }\n\n        // if is value in kilobytes\n        if (/KB/i.test(naturalFileSize)) {\n            naturalFileSize = naturalFileSize.replace(/KB$i/, '').trim();\n            return toInt(naturalFileSize) * base;\n        }\n\n        return toInt(naturalFileSize);\n    };\n\n    var isFunction = function isFunction(value) {\n        return typeof value === 'function';\n    };\n\n    var toFunctionReference = function toFunctionReference(string) {\n        var ref = self;\n        var levels = string.split('.');\n        var level = null;\n        while ((level = levels.shift())) {\n            ref = ref[level];\n            if (!ref) {\n                return null;\n            }\n        }\n        return ref;\n    };\n\n    var methods = {\n        process: 'POST',\n        patch: 'PATCH',\n        revert: 'DELETE',\n        fetch: 'GET',\n        restore: 'GET',\n        load: 'GET',\n    };\n\n    var createServerAPI = function createServerAPI(outline) {\n        var api = {};\n\n        api.url = isString(outline) ? outline : outline.url || '';\n        api.timeout = outline.timeout ? parseInt(outline.timeout, 10) : 0;\n        api.headers = outline.headers ? outline.headers : {};\n\n        forin(methods, function(key) {\n            api[key] = createAction(key, outline[key], methods[key], api.timeout, api.headers);\n        });\n\n        // remove process if no url or process on outline\n        api.process = outline.process || isString(outline) || outline.url ? api.process : null;\n\n        // special treatment for remove\n        api.remove = outline.remove || null;\n\n        // remove generic headers from api object\n        delete api.headers;\n\n        return api;\n    };\n\n    var createAction = function createAction(name, outline, method, timeout, headers) {\n        // is explicitely set to null so disable\n        if (outline === null) {\n            return null;\n        }\n\n        // if is custom function, done! Dev handles everything.\n        if (typeof outline === 'function') {\n            return outline;\n        }\n\n        // build action object\n        var action = {\n            url: method === 'GET' || method === 'PATCH' ? '?' + name + '=' : '',\n            method: method,\n            headers: headers,\n            withCredentials: false,\n            timeout: timeout,\n            onload: null,\n            ondata: null,\n            onerror: null,\n        };\n\n        // is a single url\n        if (isString(outline)) {\n            action.url = outline;\n            return action;\n        }\n\n        // overwrite\n        Object.assign(action, outline);\n\n        // see if should reformat headers;\n        if (isString(action.headers)) {\n            var parts = action.headers.split(/:(.+)/);\n            action.headers = {\n                header: parts[0],\n                value: parts[1],\n            };\n        }\n\n        // if is bool withCredentials\n        action.withCredentials = toBoolean(action.withCredentials);\n\n        return action;\n    };\n\n    var toServerAPI = function toServerAPI(value) {\n        return createServerAPI(value);\n    };\n\n    var isNull = function isNull(value) {\n        return value === null;\n    };\n\n    var isObject = function isObject(value) {\n        return typeof value === 'object' && value !== null;\n    };\n\n    var isAPI = function isAPI(value) {\n        return (\n            isObject(value) &&\n            isString(value.url) &&\n            isObject(value.process) &&\n            isObject(value.revert) &&\n            isObject(value.restore) &&\n            isObject(value.fetch)\n        );\n    };\n\n    var getType = function getType(value) {\n        if (isArray(value)) {\n            return 'array';\n        }\n\n        if (isNull(value)) {\n            return 'null';\n        }\n\n        if (isInt(value)) {\n            return 'int';\n        }\n\n        if (/^[0-9]+ ?(?:GB|MB|KB)$/gi.test(value)) {\n            return 'bytes';\n        }\n\n        if (isAPI(value)) {\n            return 'api';\n        }\n\n        return typeof value;\n    };\n\n    var replaceSingleQuotes = function replaceSingleQuotes(str) {\n        return str\n            .replace(/{\\s*'/g, '{\"')\n            .replace(/'\\s*}/g, '\"}')\n            .replace(/'\\s*:/g, '\":')\n            .replace(/:\\s*'/g, ':\"')\n            .replace(/,\\s*'/g, ',\"')\n            .replace(/'\\s*,/g, '\",');\n    };\n\n    var conversionTable = {\n        array: toArray,\n        boolean: toBoolean,\n        int: function int(value) {\n            return getType(value) === 'bytes' ? toBytes(value) : toInt(value);\n        },\n        number: toFloat,\n        float: toFloat,\n        bytes: toBytes,\n        string: function string(value) {\n            return isFunction(value) ? value : toString(value);\n        },\n        function: function _function(value) {\n            return toFunctionReference(value);\n        },\n        serverapi: toServerAPI,\n        object: function object(value) {\n            try {\n                return JSON.parse(replaceSingleQuotes(value));\n            } catch (e) {\n                return null;\n            }\n        },\n    };\n\n    var convertTo = function convertTo(value, type) {\n        return conversionTable[type](value);\n    };\n\n    var getValueByType = function getValueByType(newValue, defaultValue, valueType) {\n        // can always assign default value\n        if (newValue === defaultValue) {\n            return newValue;\n        }\n\n        // get the type of the new value\n        var newValueType = getType(newValue);\n\n        // is valid type?\n        if (newValueType !== valueType) {\n            // is string input, let's attempt to convert\n            var convertedValue = convertTo(newValue, valueType);\n\n            // what is the type now\n            newValueType = getType(convertedValue);\n\n            // no valid conversions found\n            if (convertedValue === null) {\n                throw 'Trying to assign value with incorrect type to \"' +\n                    option +\n                    '\", allowed type: \"' +\n                    valueType +\n                    '\"';\n            } else {\n                newValue = convertedValue;\n            }\n        }\n\n        // assign new value\n        return newValue;\n    };\n\n    var createOption = function createOption(defaultValue, valueType) {\n        var currentValue = defaultValue;\n        return {\n            enumerable: true,\n            get: function get() {\n                return currentValue;\n            },\n            set: function set(newValue) {\n                currentValue = getValueByType(newValue, defaultValue, valueType);\n            },\n        };\n    };\n\n    var createOptions = function createOptions(options) {\n        var obj = {};\n        forin(options, function(prop) {\n            var optionDefinition = options[prop];\n            obj[prop] = createOption(optionDefinition[0], optionDefinition[1]);\n        });\n        return createObject(obj);\n    };\n\n    var createInitialState = function createInitialState(options) {\n        return {\n            // model\n            items: [],\n\n            // timeout used for calling update items\n            listUpdateTimeout: null,\n\n            // timeout used for stacking metadata updates\n            itemUpdateTimeout: null,\n\n            // queue of items waiting to be processed\n            processingQueue: [],\n\n            // options\n            options: createOptions(options),\n        };\n    };\n\n    var fromCamels = function fromCamels(string) {\n        var separator = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : '-';\n        return string\n            .split(/(?=[A-Z])/)\n            .map(function(part) {\n                return part.toLowerCase();\n            })\n            .join(separator);\n    };\n\n    var createOptionAPI = function createOptionAPI(store, options) {\n        var obj = {};\n        forin(options, function(key) {\n            obj[key] = {\n                get: function get() {\n                    return store.getState().options[key];\n                },\n                set: function set(value) {\n                    store.dispatch('SET_' + fromCamels(key, '_').toUpperCase(), {\n                        value: value,\n                    });\n                },\n            };\n        });\n        return obj;\n    };\n\n    var createOptionActions = function createOptionActions(options) {\n        return function(dispatch, query, state) {\n            var obj = {};\n            forin(options, function(key) {\n                var name = fromCamels(key, '_').toUpperCase();\n\n                obj['SET_' + name] = function(action) {\n                    try {\n                        state.options[key] = action.value;\n                    } catch (e) {} // nope, failed\n\n                    // we successfully set the value of this option\n                    dispatch('DID_SET_' + name, { value: state.options[key] });\n                };\n            });\n            return obj;\n        };\n    };\n\n    var createOptionQueries = function createOptionQueries(options) {\n        return function(state) {\n            var obj = {};\n            forin(options, function(key) {\n                obj['GET_' + fromCamels(key, '_').toUpperCase()] = function(action) {\n                    return state.options[key];\n                };\n            });\n            return obj;\n        };\n    };\n\n    var InteractionMethod = {\n        API: 1,\n        DROP: 2,\n        BROWSE: 3,\n        PASTE: 4,\n        NONE: 5,\n    };\n\n    var getUniqueId = function getUniqueId() {\n        return Math.random()\n            .toString(36)\n            .substr(2, 9);\n    };\n\n    function _typeof(obj) {\n        if (typeof Symbol === 'function' && typeof Symbol.iterator === 'symbol') {\n            _typeof = function(obj) {\n                return typeof obj;\n            };\n        } else {\n            _typeof = function(obj) {\n                return obj &&\n                    typeof Symbol === 'function' &&\n                    obj.constructor === Symbol &&\n                    obj !== Symbol.prototype\n                    ? 'symbol'\n                    : typeof obj;\n            };\n        }\n\n        return _typeof(obj);\n    }\n\n    var REACT_ELEMENT_TYPE;\n\n    function _jsx(type, props, key, children) {\n        if (!REACT_ELEMENT_TYPE) {\n            REACT_ELEMENT_TYPE =\n                (typeof Symbol === 'function' && Symbol['for'] && Symbol['for']('react.element')) ||\n                0xeac7;\n        }\n\n        var defaultProps = type && type.defaultProps;\n        var childrenLength = arguments.length - 3;\n\n        if (!props && childrenLength !== 0) {\n            props = {\n                children: void 0,\n            };\n        }\n\n        if (props && defaultProps) {\n            for (var propName in defaultProps) {\n                if (props[propName] === void 0) {\n                    props[propName] = defaultProps[propName];\n                }\n            }\n        } else if (!props) {\n            props = defaultProps || {};\n        }\n\n        if (childrenLength === 1) {\n            props.children = children;\n        } else if (childrenLength > 1) {\n            var childArray = new Array(childrenLength);\n\n            for (var i = 0; i < childrenLength; i++) {\n                childArray[i] = arguments[i + 3];\n            }\n\n            props.children = childArray;\n        }\n\n        return {\n            $$typeof: REACT_ELEMENT_TYPE,\n            type: type,\n            key: key === undefined ? null : '' + key,\n            ref: null,\n            props: props,\n            _owner: null,\n        };\n    }\n\n    function _asyncIterator(iterable) {\n        var method;\n\n        if (typeof Symbol !== 'undefined') {\n            if (Symbol.asyncIterator) {\n                method = iterable[Symbol.asyncIterator];\n                if (method != null) return method.call(iterable);\n            }\n\n            if (Symbol.iterator) {\n                method = iterable[Symbol.iterator];\n                if (method != null) return method.call(iterable);\n            }\n        }\n\n        throw new TypeError('Object is not async iterable');\n    }\n\n    function _AwaitValue(value) {\n        this.wrapped = value;\n    }\n\n    function _AsyncGenerator(gen) {\n        var front, back;\n\n        function send(key, arg) {\n            return new Promise(function(resolve, reject) {\n                var request = {\n                    key: key,\n                    arg: arg,\n                    resolve: resolve,\n                    reject: reject,\n                    next: null,\n                };\n\n                if (back) {\n                    back = back.next = request;\n                } else {\n                    front = back = request;\n                    resume(key, arg);\n                }\n            });\n        }\n\n        function resume(key, arg) {\n            try {\n                var result = gen[key](arg);\n                var value = result.value;\n                var wrappedAwait = value instanceof _AwaitValue;\n                Promise.resolve(wrappedAwait ? value.wrapped : value).then(\n                    function(arg) {\n                        if (wrappedAwait) {\n                            resume('next', arg);\n                            return;\n                        }\n\n                        settle(result.done ? 'return' : 'normal', arg);\n                    },\n                    function(err) {\n                        resume('throw', err);\n                    }\n                );\n            } catch (err) {\n                settle('throw', err);\n            }\n        }\n\n        function settle(type, value) {\n            switch (type) {\n                case 'return':\n                    front.resolve({\n                        value: value,\n                        done: true,\n                    });\n                    break;\n\n                case 'throw':\n                    front.reject(value);\n                    break;\n\n                default:\n                    front.resolve({\n                        value: value,\n                        done: false,\n                    });\n                    break;\n            }\n\n            front = front.next;\n\n            if (front) {\n                resume(front.key, front.arg);\n            } else {\n                back = null;\n            }\n        }\n\n        this._invoke = send;\n\n        if (typeof gen.return !== 'function') {\n            this.return = undefined;\n        }\n    }\n\n    if (typeof Symbol === 'function' && Symbol.asyncIterator) {\n        _AsyncGenerator.prototype[Symbol.asyncIterator] = function() {\n            return this;\n        };\n    }\n\n    _AsyncGenerator.prototype.next = function(arg) {\n        return this._invoke('next', arg);\n    };\n\n    _AsyncGenerator.prototype.throw = function(arg) {\n        return this._invoke('throw', arg);\n    };\n\n    _AsyncGenerator.prototype.return = function(arg) {\n        return this._invoke('return', arg);\n    };\n\n    function _wrapAsyncGenerator(fn) {\n        return function() {\n            return new _AsyncGenerator(fn.apply(this, arguments));\n        };\n    }\n\n    function _awaitAsyncGenerator(value) {\n        return new _AwaitValue(value);\n    }\n\n    function _asyncGeneratorDelegate(inner, awaitWrap) {\n        var iter = {},\n            waiting = false;\n\n        function pump(key, value) {\n            waiting = true;\n            value = new Promise(function(resolve) {\n                resolve(inner[key](value));\n            });\n            return {\n                done: false,\n                value: awaitWrap(value),\n            };\n        }\n\n        if (typeof Symbol === 'function' && Symbol.iterator) {\n            iter[Symbol.iterator] = function() {\n                return this;\n            };\n        }\n\n        iter.next = function(value) {\n            if (waiting) {\n                waiting = false;\n                return value;\n            }\n\n            return pump('next', value);\n        };\n\n        if (typeof inner.throw === 'function') {\n            iter.throw = function(value) {\n                if (waiting) {\n                    waiting = false;\n                    throw value;\n                }\n\n                return pump('throw', value);\n            };\n        }\n\n        if (typeof inner.return === 'function') {\n            iter.return = function(value) {\n                return pump('return', value);\n            };\n        }\n\n        return iter;\n    }\n\n    function asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) {\n        try {\n            var info = gen[key](arg);\n            var value = info.value;\n        } catch (error) {\n            reject(error);\n            return;\n        }\n\n        if (info.done) {\n            resolve(value);\n        } else {\n            Promise.resolve(value).then(_next, _throw);\n        }\n    }\n\n    function _asyncToGenerator(fn) {\n        return function() {\n            var self = this,\n                args = arguments;\n            return new Promise(function(resolve, reject) {\n                var gen = fn.apply(self, args);\n\n                function _next(value) {\n                    asyncGeneratorStep(gen, resolve, reject, _next, _throw, 'next', value);\n                }\n\n                function _throw(err) {\n                    asyncGeneratorStep(gen, resolve, reject, _next, _throw, 'throw', err);\n                }\n\n                _next(undefined);\n            });\n        };\n    }\n\n    function _classCallCheck(instance, Constructor) {\n        if (!(instance instanceof Constructor)) {\n            throw new TypeError('Cannot call a class as a function');\n        }\n    }\n\n    function _defineProperties(target, props) {\n        for (var i = 0; i < props.length; i++) {\n            var descriptor = props[i];\n            descriptor.enumerable = descriptor.enumerable || false;\n            descriptor.configurable = true;\n            if ('value' in descriptor) descriptor.writable = true;\n            Object.defineProperty(target, descriptor.key, descriptor);\n        }\n    }\n\n    function _createClass(Constructor, protoProps, staticProps) {\n        if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n        if (staticProps) _defineProperties(Constructor, staticProps);\n        return Constructor;\n    }\n\n    function _defineEnumerableProperties(obj, descs) {\n        for (var key in descs) {\n            var desc = descs[key];\n            desc.configurable = desc.enumerable = true;\n            if ('value' in desc) desc.writable = true;\n            Object.defineProperty(obj, key, desc);\n        }\n\n        if (Object.getOwnPropertySymbols) {\n            var objectSymbols = Object.getOwnPropertySymbols(descs);\n\n            for (var i = 0; i < objectSymbols.length; i++) {\n                var sym = objectSymbols[i];\n                var desc = descs[sym];\n                desc.configurable = desc.enumerable = true;\n                if ('value' in desc) desc.writable = true;\n                Object.defineProperty(obj, sym, desc);\n            }\n        }\n\n        return obj;\n    }\n\n    function _defaults(obj, defaults) {\n        var keys = Object.getOwnPropertyNames(defaults);\n\n        for (var i = 0; i < keys.length; i++) {\n            var key = keys[i];\n            var value = Object.getOwnPropertyDescriptor(defaults, key);\n\n            if (value && value.configurable && obj[key] === undefined) {\n                Object.defineProperty(obj, key, value);\n            }\n        }\n\n        return obj;\n    }\n\n    function _defineProperty(obj, key, value) {\n        if (key in obj) {\n            Object.defineProperty(obj, key, {\n                value: value,\n                enumerable: true,\n                configurable: true,\n                writable: true,\n            });\n        } else {\n            obj[key] = value;\n        }\n\n        return obj;\n    }\n\n    function _extends() {\n        _extends =\n            Object.assign ||\n            function(target) {\n                for (var i = 1; i < arguments.length; i++) {\n                    var source = arguments[i];\n\n                    for (var key in source) {\n                        if (Object.prototype.hasOwnProperty.call(source, key)) {\n                            target[key] = source[key];\n                        }\n                    }\n                }\n\n                return target;\n            };\n\n        return _extends.apply(this, arguments);\n    }\n\n    function _objectSpread(target) {\n        for (var i = 1; i < arguments.length; i++) {\n            var source = arguments[i] != null ? arguments[i] : {};\n            var ownKeys = Object.keys(source);\n\n            if (typeof Object.getOwnPropertySymbols === 'function') {\n                ownKeys = ownKeys.concat(\n                    Object.getOwnPropertySymbols(source).filter(function(sym) {\n                        return Object.getOwnPropertyDescriptor(source, sym).enumerable;\n                    })\n                );\n            }\n\n            ownKeys.forEach(function(key) {\n                _defineProperty(target, key, source[key]);\n            });\n        }\n\n        return target;\n    }\n\n    function ownKeys(object, enumerableOnly) {\n        var keys = Object.keys(object);\n\n        if (Object.getOwnPropertySymbols) {\n            var symbols = Object.getOwnPropertySymbols(object);\n            if (enumerableOnly)\n                symbols = symbols.filter(function(sym) {\n                    return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n                });\n            keys.push.apply(keys, symbols);\n        }\n\n        return keys;\n    }\n\n    function _objectSpread2(target) {\n        for (var i = 1; i < arguments.length; i++) {\n            var source = arguments[i] != null ? arguments[i] : {};\n\n            if (i % 2) {\n                ownKeys(source, true).forEach(function(key) {\n                    _defineProperty(target, key, source[key]);\n                });\n            } else if (Object.getOwnPropertyDescriptors) {\n                Object.defineProperties(target, Object.getOwnPropertyDescriptors(source));\n            } else {\n                ownKeys(source).forEach(function(key) {\n                    Object.defineProperty(\n                        target,\n                        key,\n                        Object.getOwnPropertyDescriptor(source, key)\n                    );\n                });\n            }\n        }\n\n        return target;\n    }\n\n    function _inherits(subClass, superClass) {\n        if (typeof superClass !== 'function' && superClass !== null) {\n            throw new TypeError('Super expression must either be null or a function');\n        }\n\n        subClass.prototype = Object.create(superClass && superClass.prototype, {\n            constructor: {\n                value: subClass,\n                writable: true,\n                configurable: true,\n            },\n        });\n        if (superClass) _setPrototypeOf(subClass, superClass);\n    }\n\n    function _inheritsLoose(subClass, superClass) {\n        subClass.prototype = Object.create(superClass.prototype);\n        subClass.prototype.constructor = subClass;\n        subClass.__proto__ = superClass;\n    }\n\n    function _getPrototypeOf(o) {\n        _getPrototypeOf = Object.setPrototypeOf\n            ? Object.getPrototypeOf\n            : function _getPrototypeOf(o) {\n                  return o.__proto__ || Object.getPrototypeOf(o);\n              };\n        return _getPrototypeOf(o);\n    }\n\n    function _setPrototypeOf(o, p) {\n        _setPrototypeOf =\n            Object.setPrototypeOf ||\n            function _setPrototypeOf(o, p) {\n                o.__proto__ = p;\n                return o;\n            };\n\n        return _setPrototypeOf(o, p);\n    }\n\n    function isNativeReflectConstruct() {\n        if (typeof Reflect === 'undefined' || !Reflect.construct) return false;\n        if (Reflect.construct.sham) return false;\n        if (typeof Proxy === 'function') return true;\n\n        try {\n            Date.prototype.toString.call(Reflect.construct(Date, [], function() {}));\n            return true;\n        } catch (e) {\n            return false;\n        }\n    }\n\n    function _construct(Parent, args, Class) {\n        if (isNativeReflectConstruct()) {\n            _construct = Reflect.construct;\n        } else {\n            _construct = function _construct(Parent, args, Class) {\n                var a = [null];\n                a.push.apply(a, args);\n                var Constructor = Function.bind.apply(Parent, a);\n                var instance = new Constructor();\n                if (Class) _setPrototypeOf(instance, Class.prototype);\n                return instance;\n            };\n        }\n\n        return _construct.apply(null, arguments);\n    }\n\n    function _isNativeFunction(fn) {\n        return Function.toString.call(fn).indexOf('[native code]') !== -1;\n    }\n\n    function _wrapNativeSuper(Class) {\n        var _cache = typeof Map === 'function' ? new Map() : undefined;\n\n        _wrapNativeSuper = function _wrapNativeSuper(Class) {\n            if (Class === null || !_isNativeFunction(Class)) return Class;\n\n            if (typeof Class !== 'function') {\n                throw new TypeError('Super expression must either be null or a function');\n            }\n\n            if (typeof _cache !== 'undefined') {\n                if (_cache.has(Class)) return _cache.get(Class);\n\n                _cache.set(Class, Wrapper);\n            }\n\n            function Wrapper() {\n                return _construct(Class, arguments, _getPrototypeOf(this).constructor);\n            }\n\n            Wrapper.prototype = Object.create(Class.prototype, {\n                constructor: {\n                    value: Wrapper,\n                    enumerable: false,\n                    writable: true,\n                    configurable: true,\n                },\n            });\n            return _setPrototypeOf(Wrapper, Class);\n        };\n\n        return _wrapNativeSuper(Class);\n    }\n\n    function _instanceof(left, right) {\n        if (right != null && typeof Symbol !== 'undefined' && right[Symbol.hasInstance]) {\n            return !!right[Symbol.hasInstance](left);\n        } else {\n            return left instanceof right;\n        }\n    }\n\n    function _interopRequireDefault(obj) {\n        return obj && obj.__esModule\n            ? obj\n            : {\n                  default: obj,\n              };\n    }\n\n    function _interopRequireWildcard(obj) {\n        if (obj && obj.__esModule) {\n            return obj;\n        } else {\n            var newObj = {};\n\n            if (obj != null) {\n                for (var key in obj) {\n                    if (Object.prototype.hasOwnProperty.call(obj, key)) {\n                        var desc =\n                            Object.defineProperty && Object.getOwnPropertyDescriptor\n                                ? Object.getOwnPropertyDescriptor(obj, key)\n                                : {};\n\n                        if (desc.get || desc.set) {\n                            Object.defineProperty(newObj, key, desc);\n                        } else {\n                            newObj[key] = obj[key];\n                        }\n                    }\n                }\n            }\n\n            newObj.default = obj;\n            return newObj;\n        }\n    }\n\n    function _newArrowCheck(innerThis, boundThis) {\n        if (innerThis !== boundThis) {\n            throw new TypeError('Cannot instantiate an arrow function');\n        }\n    }\n\n    function _objectDestructuringEmpty(obj) {\n        if (obj == null) throw new TypeError('Cannot destructure undefined');\n    }\n\n    function _objectWithoutPropertiesLoose(source, excluded) {\n        if (source == null) return {};\n        var target = {};\n        var sourceKeys = Object.keys(source);\n        var key, i;\n\n        for (i = 0; i < sourceKeys.length; i++) {\n            key = sourceKeys[i];\n            if (excluded.indexOf(key) >= 0) continue;\n            target[key] = source[key];\n        }\n\n        return target;\n    }\n\n    function _objectWithoutProperties(source, excluded) {\n        if (source == null) return {};\n\n        var target = _objectWithoutPropertiesLoose(source, excluded);\n\n        var key, i;\n\n        if (Object.getOwnPropertySymbols) {\n            var sourceSymbolKeys = Object.getOwnPropertySymbols(source);\n\n            for (i = 0; i < sourceSymbolKeys.length; i++) {\n                key = sourceSymbolKeys[i];\n                if (excluded.indexOf(key) >= 0) continue;\n                if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue;\n                target[key] = source[key];\n            }\n        }\n\n        return target;\n    }\n\n    function _assertThisInitialized(self) {\n        if (self === void 0) {\n            throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n        }\n\n        return self;\n    }\n\n    function _possibleConstructorReturn(self, call) {\n        if (call && (typeof call === 'object' || typeof call === 'function')) {\n            return call;\n        }\n\n        return _assertThisInitialized(self);\n    }\n\n    function _superPropBase(object, property) {\n        while (!Object.prototype.hasOwnProperty.call(object, property)) {\n            object = _getPrototypeOf(object);\n            if (object === null) break;\n        }\n\n        return object;\n    }\n\n    function _get(target, property, receiver) {\n        if (typeof Reflect !== 'undefined' && Reflect.get) {\n            _get = Reflect.get;\n        } else {\n            _get = function _get(target, property, receiver) {\n                var base = _superPropBase(target, property);\n\n                if (!base) return;\n                var desc = Object.getOwnPropertyDescriptor(base, property);\n\n                if (desc.get) {\n                    return desc.get.call(receiver);\n                }\n\n                return desc.value;\n            };\n        }\n\n        return _get(target, property, receiver || target);\n    }\n\n    function set(target, property, value, receiver) {\n        if (typeof Reflect !== 'undefined' && Reflect.set) {\n            set = Reflect.set;\n        } else {\n            set = function set(target, property, value, receiver) {\n                var base = _superPropBase(target, property);\n\n                var desc;\n\n                if (base) {\n                    desc = Object.getOwnPropertyDescriptor(base, property);\n\n                    if (desc.set) {\n                        desc.set.call(receiver, value);\n                        return true;\n                    } else if (!desc.writable) {\n                        return false;\n                    }\n                }\n\n                desc = Object.getOwnPropertyDescriptor(receiver, property);\n\n                if (desc) {\n                    if (!desc.writable) {\n                        return false;\n                    }\n\n                    desc.value = value;\n                    Object.defineProperty(receiver, property, desc);\n                } else {\n                    _defineProperty(receiver, property, value);\n                }\n\n                return true;\n            };\n        }\n\n        return set(target, property, value, receiver);\n    }\n\n    function _set(target, property, value, receiver, isStrict) {\n        var s = set(target, property, value, receiver || target);\n\n        if (!s && isStrict) {\n            throw new Error('failed to set property');\n        }\n\n        return value;\n    }\n\n    function _taggedTemplateLiteral(strings, raw) {\n        if (!raw) {\n            raw = strings.slice(0);\n        }\n\n        return Object.freeze(\n            Object.defineProperties(strings, {\n                raw: {\n                    value: Object.freeze(raw),\n                },\n            })\n        );\n    }\n\n    function _taggedTemplateLiteralLoose(strings, raw) {\n        if (!raw) {\n            raw = strings.slice(0);\n        }\n\n        strings.raw = raw;\n        return strings;\n    }\n\n    function _temporalRef(val, name) {\n        if (val === _temporalUndefined) {\n            throw new ReferenceError(name + ' is not defined - temporal dead zone');\n        } else {\n            return val;\n        }\n    }\n\n    function _readOnlyError(name) {\n        throw new Error('\"' + name + '\" is read-only');\n    }\n\n    function _classNameTDZError(name) {\n        throw new Error('Class \"' + name + '\" cannot be referenced in computed property keys.');\n    }\n\n    var _temporalUndefined = {};\n\n    function _slicedToArray(arr, i) {\n        return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _nonIterableRest();\n    }\n\n    function _slicedToArrayLoose(arr, i) {\n        return _arrayWithHoles(arr) || _iterableToArrayLimitLoose(arr, i) || _nonIterableRest();\n    }\n\n    function _toArray(arr) {\n        return _arrayWithHoles(arr) || _iterableToArray(arr) || _nonIterableRest();\n    }\n\n    function _toConsumableArray(arr) {\n        return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _nonIterableSpread();\n    }\n\n    function _arrayWithoutHoles(arr) {\n        if (Array.isArray(arr)) {\n            for (var i = 0, arr2 = new Array(arr.length); i < arr.length; i++) arr2[i] = arr[i];\n\n            return arr2;\n        }\n    }\n\n    function _arrayWithHoles(arr) {\n        if (Array.isArray(arr)) return arr;\n    }\n\n    function _iterableToArray(iter) {\n        if (\n            Symbol.iterator in Object(iter) ||\n            Object.prototype.toString.call(iter) === '[object Arguments]'\n        )\n            return Array.from(iter);\n    }\n\n    function _iterableToArrayLimit(arr, i) {\n        var _arr = [];\n        var _n = true;\n        var _d = false;\n        var _e = undefined;\n\n        try {\n            for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) {\n                _arr.push(_s.value);\n\n                if (i && _arr.length === i) break;\n            }\n        } catch (err) {\n            _d = true;\n            _e = err;\n        } finally {\n            try {\n                if (!_n && _i['return'] != null) _i['return']();\n            } finally {\n                if (_d) throw _e;\n            }\n        }\n\n        return _arr;\n    }\n\n    function _iterableToArrayLimitLoose(arr, i) {\n        var _arr = [];\n\n        for (var _iterator = arr[Symbol.iterator](), _step; !(_step = _iterator.next()).done; ) {\n            _arr.push(_step.value);\n\n            if (i && _arr.length === i) break;\n        }\n\n        return _arr;\n    }\n\n    function _nonIterableSpread() {\n        throw new TypeError('Invalid attempt to spread non-iterable instance');\n    }\n\n    function _nonIterableRest() {\n        throw new TypeError('Invalid attempt to destructure non-iterable instance');\n    }\n\n    function _skipFirstGeneratorNext(fn) {\n        return function() {\n            var it = fn.apply(this, arguments);\n            it.next();\n            return it;\n        };\n    }\n\n    function _toPrimitive(input, hint) {\n        if (typeof input !== 'object' || input === null) return input;\n        var prim = input[Symbol.toPrimitive];\n\n        if (prim !== undefined) {\n            var res = prim.call(input, hint || 'default');\n            if (typeof res !== 'object') return res;\n            throw new TypeError('@@toPrimitive must return a primitive value.');\n        }\n\n        return (hint === 'string' ? String : Number)(input);\n    }\n\n    function _toPropertyKey(arg) {\n        var key = _toPrimitive(arg, 'string');\n\n        return typeof key === 'symbol' ? key : String(key);\n    }\n\n    function _initializerWarningHelper(descriptor, context) {\n        throw new Error(\n            'Decorating class property failed. Please ensure that ' +\n                'proposal-class-properties is enabled and set to use loose mode. ' +\n                'To use proposal-class-properties in spec mode with decorators, wait for ' +\n                'the next major version of decorators in stage 2.'\n        );\n    }\n\n    function _initializerDefineProperty(target, property, descriptor, context) {\n        if (!descriptor) return;\n        Object.defineProperty(target, property, {\n            enumerable: descriptor.enumerable,\n            configurable: descriptor.configurable,\n            writable: descriptor.writable,\n            value: descriptor.initializer ? descriptor.initializer.call(context) : void 0,\n        });\n    }\n\n    function _applyDecoratedDescriptor(target, property, decorators, descriptor, context) {\n        var desc = {};\n        Object.keys(descriptor).forEach(function(key) {\n            desc[key] = descriptor[key];\n        });\n        desc.enumerable = !!desc.enumerable;\n        desc.configurable = !!desc.configurable;\n\n        if ('value' in desc || desc.initializer) {\n            desc.writable = true;\n        }\n\n        desc = decorators\n            .slice()\n            .reverse()\n            .reduce(function(desc, decorator) {\n                return decorator(target, property, desc) || desc;\n            }, desc);\n\n        if (context && desc.initializer !== void 0) {\n            desc.value = desc.initializer ? desc.initializer.call(context) : void 0;\n            desc.initializer = undefined;\n        }\n\n        if (desc.initializer === void 0) {\n            Object.defineProperty(target, property, desc);\n            desc = null;\n        }\n\n        return desc;\n    }\n\n    var id = 0;\n\n    function _classPrivateFieldLooseKey(name) {\n        return '__private_' + id++ + '_' + name;\n    }\n\n    function _classPrivateFieldLooseBase(receiver, privateKey) {\n        if (!Object.prototype.hasOwnProperty.call(receiver, privateKey)) {\n            throw new TypeError('attempted to use private field on non-instance');\n        }\n\n        return receiver;\n    }\n\n    function _classPrivateFieldGet(receiver, privateMap) {\n        var descriptor = privateMap.get(receiver);\n\n        if (!descriptor) {\n            throw new TypeError('attempted to get private field on non-instance');\n        }\n\n        if (descriptor.get) {\n            return descriptor.get.call(receiver);\n        }\n\n        return descriptor.value;\n    }\n\n    function _classPrivateFieldSet(receiver, privateMap, value) {\n        var descriptor = privateMap.get(receiver);\n\n        if (!descriptor) {\n            throw new TypeError('attempted to set private field on non-instance');\n        }\n\n        if (descriptor.set) {\n            descriptor.set.call(receiver, value);\n        } else {\n            if (!descriptor.writable) {\n                throw new TypeError('attempted to set read only private field');\n            }\n\n            descriptor.value = value;\n        }\n\n        return value;\n    }\n\n    function _classPrivateFieldDestructureSet(receiver, privateMap) {\n        if (!privateMap.has(receiver)) {\n            throw new TypeError('attempted to set private field on non-instance');\n        }\n\n        var descriptor = privateMap.get(receiver);\n\n        if (descriptor.set) {\n            if (!('__destrObj' in descriptor)) {\n                descriptor.__destrObj = {\n                    set value(v) {\n                        descriptor.set.call(receiver, v);\n                    },\n                };\n            }\n\n            return descriptor.__destrObj;\n        } else {\n            if (!descriptor.writable) {\n                throw new TypeError('attempted to set read only private field');\n            }\n\n            return descriptor;\n        }\n    }\n\n    function _classStaticPrivateFieldSpecGet(receiver, classConstructor, descriptor) {\n        if (receiver !== classConstructor) {\n            throw new TypeError('Private static access of wrong provenance');\n        }\n\n        return descriptor.value;\n    }\n\n    function _classStaticPrivateFieldSpecSet(receiver, classConstructor, descriptor, value) {\n        if (receiver !== classConstructor) {\n            throw new TypeError('Private static access of wrong provenance');\n        }\n\n        if (!descriptor.writable) {\n            throw new TypeError('attempted to set read only private field');\n        }\n\n        descriptor.value = value;\n        return value;\n    }\n\n    function _classStaticPrivateMethodGet(receiver, classConstructor, method) {\n        if (receiver !== classConstructor) {\n            throw new TypeError('Private static access of wrong provenance');\n        }\n\n        return method;\n    }\n\n    function _classStaticPrivateMethodSet() {\n        throw new TypeError('attempted to set read only static private field');\n    }\n\n    function _decorate(decorators, factory, superClass, mixins) {\n        var api = _getDecoratorsApi();\n\n        if (mixins) {\n            for (var i = 0; i < mixins.length; i++) {\n                api = mixins[i](api);\n            }\n        }\n\n        var r = factory(function initialize(O) {\n            api.initializeInstanceElements(O, decorated.elements);\n        }, superClass);\n        var decorated = api.decorateClass(\n            _coalesceClassElements(r.d.map(_createElementDescriptor)),\n            decorators\n        );\n        api.initializeClassElements(r.F, decorated.elements);\n        return api.runClassFinishers(r.F, decorated.finishers);\n    }\n\n    function _getDecoratorsApi() {\n        _getDecoratorsApi = function() {\n            return api;\n        };\n\n        var api = {\n            elementsDefinitionOrder: [['method'], ['field']],\n            initializeInstanceElements: function(O, elements) {\n                ['method', 'field'].forEach(function(kind) {\n                    elements.forEach(function(element) {\n                        if (element.kind === kind && element.placement === 'own') {\n                            this.defineClassElement(O, element);\n                        }\n                    }, this);\n                }, this);\n            },\n            initializeClassElements: function(F, elements) {\n                var proto = F.prototype;\n                ['method', 'field'].forEach(function(kind) {\n                    elements.forEach(function(element) {\n                        var placement = element.placement;\n\n                        if (\n                            element.kind === kind &&\n                            (placement === 'static' || placement === 'prototype')\n                        ) {\n                            var receiver = placement === 'static' ? F : proto;\n                            this.defineClassElement(receiver, element);\n                        }\n                    }, this);\n                }, this);\n            },\n            defineClassElement: function(receiver, element) {\n                var descriptor = element.descriptor;\n\n                if (element.kind === 'field') {\n                    var initializer = element.initializer;\n                    descriptor = {\n                        enumerable: descriptor.enumerable,\n                        writable: descriptor.writable,\n                        configurable: descriptor.configurable,\n                        value: initializer === void 0 ? void 0 : initializer.call(receiver),\n                    };\n                }\n\n                Object.defineProperty(receiver, element.key, descriptor);\n            },\n            decorateClass: function(elements, decorators) {\n                var newElements = [];\n                var finishers = [];\n                var placements = {\n                    static: [],\n                    prototype: [],\n                    own: [],\n                };\n                elements.forEach(function(element) {\n                    this.addElementPlacement(element, placements);\n                }, this);\n                elements.forEach(function(element) {\n                    if (!_hasDecorators(element)) return newElements.push(element);\n                    var elementFinishersExtras = this.decorateElement(element, placements);\n                    newElements.push(elementFinishersExtras.element);\n                    newElements.push.apply(newElements, elementFinishersExtras.extras);\n                    finishers.push.apply(finishers, elementFinishersExtras.finishers);\n                }, this);\n\n                if (!decorators) {\n                    return {\n                        elements: newElements,\n                        finishers: finishers,\n                    };\n                }\n\n                var result = this.decorateConstructor(newElements, decorators);\n                finishers.push.apply(finishers, result.finishers);\n                result.finishers = finishers;\n                return result;\n            },\n            addElementPlacement: function(element, placements, silent) {\n                var keys = placements[element.placement];\n\n                if (!silent && keys.indexOf(element.key) !== -1) {\n                    throw new TypeError('Duplicated element (' + element.key + ')');\n                }\n\n                keys.push(element.key);\n            },\n            decorateElement: function(element, placements) {\n                var extras = [];\n                var finishers = [];\n\n                for (var decorators = element.decorators, i = decorators.length - 1; i >= 0; i--) {\n                    var keys = placements[element.placement];\n                    keys.splice(keys.indexOf(element.key), 1);\n                    var elementObject = this.fromElementDescriptor(element);\n                    var elementFinisherExtras = this.toElementFinisherExtras(\n                        (0, decorators[i])(elementObject) || elementObject\n                    );\n                    element = elementFinisherExtras.element;\n                    this.addElementPlacement(element, placements);\n\n                    if (elementFinisherExtras.finisher) {\n                        finishers.push(elementFinisherExtras.finisher);\n                    }\n\n                    var newExtras = elementFinisherExtras.extras;\n\n                    if (newExtras) {\n                        for (var j = 0; j < newExtras.length; j++) {\n                            this.addElementPlacement(newExtras[j], placements);\n                        }\n\n                        extras.push.apply(extras, newExtras);\n                    }\n                }\n\n                return {\n                    element: element,\n                    finishers: finishers,\n                    extras: extras,\n                };\n            },\n            decorateConstructor: function(elements, decorators) {\n                var finishers = [];\n\n                for (var i = decorators.length - 1; i >= 0; i--) {\n                    var obj = this.fromClassDescriptor(elements);\n                    var elementsAndFinisher = this.toClassDescriptor(\n                        (0, decorators[i])(obj) || obj\n                    );\n\n                    if (elementsAndFinisher.finisher !== undefined) {\n                        finishers.push(elementsAndFinisher.finisher);\n                    }\n\n                    if (elementsAndFinisher.elements !== undefined) {\n                        elements = elementsAndFinisher.elements;\n\n                        for (var j = 0; j < elements.length - 1; j++) {\n                            for (var k = j + 1; k < elements.length; k++) {\n                                if (\n                                    elements[j].key === elements[k].key &&\n                                    elements[j].placement === elements[k].placement\n                                ) {\n                                    throw new TypeError(\n                                        'Duplicated element (' + elements[j].key + ')'\n                                    );\n                                }\n                            }\n                        }\n                    }\n                }\n\n                return {\n                    elements: elements,\n                    finishers: finishers,\n                };\n            },\n            fromElementDescriptor: function(element) {\n                var obj = {\n                    kind: element.kind,\n                    key: element.key,\n                    placement: element.placement,\n                    descriptor: element.descriptor,\n                };\n                var desc = {\n                    value: 'Descriptor',\n                    configurable: true,\n                };\n                Object.defineProperty(obj, Symbol.toStringTag, desc);\n                if (element.kind === 'field') obj.initializer = element.initializer;\n                return obj;\n            },\n            toElementDescriptors: function(elementObjects) {\n                if (elementObjects === undefined) return;\n                return _toArray(elementObjects).map(function(elementObject) {\n                    var element = this.toElementDescriptor(elementObject);\n                    this.disallowProperty(elementObject, 'finisher', 'An element descriptor');\n                    this.disallowProperty(elementObject, 'extras', 'An element descriptor');\n                    return element;\n                }, this);\n            },\n            toElementDescriptor: function(elementObject) {\n                var kind = String(elementObject.kind);\n\n                if (kind !== 'method' && kind !== 'field') {\n                    throw new TypeError(\n                        'An element descriptor\\'s .kind property must be either \"method\" or' +\n                            ' \"field\", but a decorator created an element descriptor with' +\n                            ' .kind \"' +\n                            kind +\n                            '\"'\n                    );\n                }\n\n                var key = _toPropertyKey(elementObject.key);\n\n                var placement = String(elementObject.placement);\n\n                if (placement !== 'static' && placement !== 'prototype' && placement !== 'own') {\n                    throw new TypeError(\n                        'An element descriptor\\'s .placement property must be one of \"static\",' +\n                            ' \"prototype\" or \"own\", but a decorator created an element descriptor' +\n                            ' with .placement \"' +\n                            placement +\n                            '\"'\n                    );\n                }\n\n                var descriptor = elementObject.descriptor;\n                this.disallowProperty(elementObject, 'elements', 'An element descriptor');\n                var element = {\n                    kind: kind,\n                    key: key,\n                    placement: placement,\n                    descriptor: Object.assign({}, descriptor),\n                };\n\n                if (kind !== 'field') {\n                    this.disallowProperty(elementObject, 'initializer', 'A method descriptor');\n                } else {\n                    this.disallowProperty(\n                        descriptor,\n                        'get',\n                        'The property descriptor of a field descriptor'\n                    );\n                    this.disallowProperty(\n                        descriptor,\n                        'set',\n                        'The property descriptor of a field descriptor'\n                    );\n                    this.disallowProperty(\n                        descriptor,\n                        'value',\n                        'The property descriptor of a field descriptor'\n                    );\n                    element.initializer = elementObject.initializer;\n                }\n\n                return element;\n            },\n            toElementFinisherExtras: function(elementObject) {\n                var element = this.toElementDescriptor(elementObject);\n\n                var finisher = _optionalCallableProperty(elementObject, 'finisher');\n\n                var extras = this.toElementDescriptors(elementObject.extras);\n                return {\n                    element: element,\n                    finisher: finisher,\n                    extras: extras,\n                };\n            },\n            fromClassDescriptor: function(elements) {\n                var obj = {\n                    kind: 'class',\n                    elements: elements.map(this.fromElementDescriptor, this),\n                };\n                var desc = {\n                    value: 'Descriptor',\n                    configurable: true,\n                };\n                Object.defineProperty(obj, Symbol.toStringTag, desc);\n                return obj;\n            },\n            toClassDescriptor: function(obj) {\n                var kind = String(obj.kind);\n\n                if (kind !== 'class') {\n                    throw new TypeError(\n                        'A class descriptor\\'s .kind property must be \"class\", but a decorator' +\n                            ' created a class descriptor with .kind \"' +\n                            kind +\n                            '\"'\n                    );\n                }\n\n                this.disallowProperty(obj, 'key', 'A class descriptor');\n                this.disallowProperty(obj, 'placement', 'A class descriptor');\n                this.disallowProperty(obj, 'descriptor', 'A class descriptor');\n                this.disallowProperty(obj, 'initializer', 'A class descriptor');\n                this.disallowProperty(obj, 'extras', 'A class descriptor');\n\n                var finisher = _optionalCallableProperty(obj, 'finisher');\n\n                var elements = this.toElementDescriptors(obj.elements);\n                return {\n                    elements: elements,\n                    finisher: finisher,\n                };\n            },\n            runClassFinishers: function(constructor, finishers) {\n                for (var i = 0; i < finishers.length; i++) {\n                    var newConstructor = (0, finishers[i])(constructor);\n\n                    if (newConstructor !== undefined) {\n                        if (typeof newConstructor !== 'function') {\n                            throw new TypeError('Finishers must return a constructor.');\n                        }\n\n                        constructor = newConstructor;\n                    }\n                }\n\n                return constructor;\n            },\n            disallowProperty: function(obj, name, objectType) {\n                if (obj[name] !== undefined) {\n                    throw new TypeError(objectType + \" can't have a .\" + name + ' property.');\n                }\n            },\n        };\n        return api;\n    }\n\n    function _createElementDescriptor(def) {\n        var key = _toPropertyKey(def.key);\n\n        var descriptor;\n\n        if (def.kind === 'method') {\n            descriptor = {\n                value: def.value,\n                writable: true,\n                configurable: true,\n                enumerable: false,\n            };\n        } else if (def.kind === 'get') {\n            descriptor = {\n                get: def.value,\n                configurable: true,\n                enumerable: false,\n            };\n        } else if (def.kind === 'set') {\n            descriptor = {\n                set: def.value,\n                configurable: true,\n                enumerable: false,\n            };\n        } else if (def.kind === 'field') {\n            descriptor = {\n                configurable: true,\n                writable: true,\n                enumerable: true,\n            };\n        }\n\n        var element = {\n            kind: def.kind === 'field' ? 'field' : 'method',\n            key: key,\n            placement: def.static ? 'static' : def.kind === 'field' ? 'own' : 'prototype',\n            descriptor: descriptor,\n        };\n        if (def.decorators) element.decorators = def.decorators;\n        if (def.kind === 'field') element.initializer = def.value;\n        return element;\n    }\n\n    function _coalesceGetterSetter(element, other) {\n        if (element.descriptor.get !== undefined) {\n            other.descriptor.get = element.descriptor.get;\n        } else {\n            other.descriptor.set = element.descriptor.set;\n        }\n    }\n\n    function _coalesceClassElements(elements) {\n        var newElements = [];\n\n        var isSameElement = function(other) {\n            return (\n                other.kind === 'method' &&\n                other.key === element.key &&\n                other.placement === element.placement\n            );\n        };\n\n        for (var i = 0; i < elements.length; i++) {\n            var element = elements[i];\n            var other;\n\n            if (element.kind === 'method' && (other = newElements.find(isSameElement))) {\n                if (_isDataDescriptor(element.descriptor) || _isDataDescriptor(other.descriptor)) {\n                    if (_hasDecorators(element) || _hasDecorators(other)) {\n                        throw new ReferenceError(\n                            'Duplicated methods (' + element.key + \") can't be decorated.\"\n                        );\n                    }\n\n                    other.descriptor = element.descriptor;\n                } else {\n                    if (_hasDecorators(element)) {\n                        if (_hasDecorators(other)) {\n                            throw new ReferenceError(\n                                \"Decorators can't be placed on different accessors with for \" +\n                                    'the same property (' +\n                                    element.key +\n                                    ').'\n                            );\n                        }\n\n                        other.decorators = element.decorators;\n                    }\n\n                    _coalesceGetterSetter(element, other);\n                }\n            } else {\n                newElements.push(element);\n            }\n        }\n\n        return newElements;\n    }\n\n    function _hasDecorators(element) {\n        return element.decorators && element.decorators.length;\n    }\n\n    function _isDataDescriptor(desc) {\n        return desc !== undefined && !(desc.value === undefined && desc.writable === undefined);\n    }\n\n    function _optionalCallableProperty(obj, name) {\n        var value = obj[name];\n\n        if (value !== undefined && typeof value !== 'function') {\n            throw new TypeError(\"Expected '\" + name + \"' to be a function\");\n        }\n\n        return value;\n    }\n\n    function _classPrivateMethodGet(receiver, privateSet, fn) {\n        if (!privateSet.has(receiver)) {\n            throw new TypeError('attempted to get private field on non-instance');\n        }\n\n        return fn;\n    }\n\n    function _classPrivateMethodSet() {\n        throw new TypeError('attempted to reassign private method');\n    }\n\n    function _wrapRegExp(re, groups) {\n        _wrapRegExp = function(re, groups) {\n            return new BabelRegExp(re, groups);\n        };\n\n        var _RegExp = _wrapNativeSuper(RegExp);\n\n        var _super = RegExp.prototype;\n\n        var _groups = new WeakMap();\n\n        function BabelRegExp(re, groups) {\n            var _this = _RegExp.call(this, re);\n\n            _groups.set(_this, groups);\n\n            return _this;\n        }\n\n        _inherits(BabelRegExp, _RegExp);\n\n        BabelRegExp.prototype.exec = function(str) {\n            var result = _super.exec.call(this, str);\n\n            if (result) result.groups = buildGroups(result, this);\n            return result;\n        };\n\n        BabelRegExp.prototype[Symbol.replace] = function(str, substitution) {\n            if (typeof substitution === 'string') {\n                var groups = _groups.get(this);\n\n                return _super[Symbol.replace].call(\n                    this,\n                    str,\n                    substitution.replace(/\\$<([^>]+)>/g, function(_, name) {\n                        return '$' + groups[name];\n                    })\n                );\n            } else if (typeof substitution === 'function') {\n                var _this = this;\n\n                return _super[Symbol.replace].call(this, str, function() {\n                    var args = [];\n                    args.push.apply(args, arguments);\n\n                    if (typeof args[args.length - 1] !== 'object') {\n                        args.push(buildGroups(args, _this));\n                    }\n\n                    return substitution.apply(this, args);\n                });\n            } else {\n                return _super[Symbol.replace].call(this, str, substitution);\n            }\n        };\n\n        function buildGroups(result, re) {\n            var g = _groups.get(re);\n\n            return Object.keys(g).reduce(function(groups, name) {\n                groups[name] = result[g[name]];\n                return groups;\n            }, Object.create(null));\n        }\n\n        return _wrapRegExp.apply(this, arguments);\n    }\n\n    var arrayRemove = function arrayRemove(arr, index) {\n        return arr.splice(index, 1);\n    };\n\n    var run = function run(cb, sync) {\n        if (sync) {\n            cb();\n        } else if (document.hidden) {\n            Promise.resolve(1).then(cb);\n        } else {\n            setTimeout(cb, 0);\n        }\n    };\n\n    var on = function on() {\n        var listeners = [];\n        var off = function off(event, cb) {\n            arrayRemove(\n                listeners,\n                listeners.findIndex(function(listener) {\n                    return listener.event === event && (listener.cb === cb || !cb);\n                })\n            );\n        };\n        var _fire = function fire(event, args, sync) {\n            listeners\n                .filter(function(listener) {\n                    return listener.event === event;\n                })\n                .map(function(listener) {\n                    return listener.cb;\n                })\n                .forEach(function(cb) {\n                    return run(function() {\n                        return cb.apply(void 0, _toConsumableArray(args));\n                    }, sync);\n                });\n        };\n        return {\n            fireSync: function fireSync(event) {\n                for (\n                    var _len = arguments.length,\n                        args = new Array(_len > 1 ? _len - 1 : 0),\n                        _key = 1;\n                    _key < _len;\n                    _key++\n                ) {\n                    args[_key - 1] = arguments[_key];\n                }\n                _fire(event, args, true);\n            },\n            fire: function fire(event) {\n                for (\n                    var _len2 = arguments.length,\n                        args = new Array(_len2 > 1 ? _len2 - 1 : 0),\n                        _key2 = 1;\n                    _key2 < _len2;\n                    _key2++\n                ) {\n                    args[_key2 - 1] = arguments[_key2];\n                }\n                _fire(event, args, false);\n            },\n            on: function on(event, cb) {\n                listeners.push({ event: event, cb: cb });\n            },\n            onOnce: function onOnce(event, _cb) {\n                listeners.push({\n                    event: event,\n                    cb: function cb() {\n                        off(event, _cb);\n                        _cb.apply(void 0, arguments);\n                    },\n                });\n            },\n            off: off,\n        };\n    };\n\n    var copyObjectPropertiesToObject = function copyObjectPropertiesToObject(\n        src,\n        target,\n        excluded\n    ) {\n        Object.getOwnPropertyNames(src)\n            .filter(function(property) {\n                return !excluded.includes(property);\n            })\n            .forEach(function(key) {\n                return Object.defineProperty(\n                    target,\n                    key,\n                    Object.getOwnPropertyDescriptor(src, key)\n                );\n            });\n    };\n\n    var PRIVATE = [\n        'fire',\n        'process',\n        'revert',\n        'load',\n        'on',\n        'off',\n        'onOnce',\n        'retryLoad',\n        'extend',\n        'archive',\n        'archived',\n        'release',\n        'released',\n        'requestProcessing',\n        'freeze',\n    ];\n\n    var createItemAPI = function createItemAPI(item) {\n        var api = {};\n        copyObjectPropertiesToObject(item, api, PRIVATE);\n        return api;\n    };\n\n    var removeReleasedItems = function removeReleasedItems(items) {\n        items.forEach(function(item, index) {\n            if (item.released) {\n                arrayRemove(items, index);\n            }\n        });\n    };\n\n    var ItemStatus = {\n        INIT: 1,\n        IDLE: 2,\n        PROCESSING_QUEUED: 9,\n        PROCESSING: 3,\n        PROCESSING_COMPLETE: 5,\n        PROCESSING_ERROR: 6,\n        PROCESSING_REVERT_ERROR: 10,\n        LOADING: 7,\n        LOAD_ERROR: 8,\n    };\n\n    var FileOrigin = {\n        INPUT: 1,\n        LIMBO: 2,\n        LOCAL: 3,\n    };\n\n    var getNonNumeric = function getNonNumeric(str) {\n        return /[^0-9]+/.exec(str);\n    };\n\n    var getDecimalSeparator = function getDecimalSeparator() {\n        return getNonNumeric((1.1).toLocaleString())[0];\n    };\n\n    var getThousandsSeparator = function getThousandsSeparator() {\n        // Added for browsers that do not return the thousands separator (happend on native browser Android 4.4.4)\n        // We check against the normal toString output and if they're the same return a comma when decimal separator is a dot\n        var decimalSeparator = getDecimalSeparator();\n        var thousandsStringWithSeparator = (1000.0).toLocaleString();\n        var thousandsStringWithoutSeparator = (1000.0).toString();\n        if (thousandsStringWithSeparator !== thousandsStringWithoutSeparator) {\n            return getNonNumeric(thousandsStringWithSeparator)[0];\n        }\n        return decimalSeparator === '.' ? ',' : '.';\n    };\n\n    var Type = {\n        BOOLEAN: 'boolean',\n        INT: 'int',\n        NUMBER: 'number',\n        STRING: 'string',\n        ARRAY: 'array',\n        OBJECT: 'object',\n        FUNCTION: 'function',\n        ACTION: 'action',\n        SERVER_API: 'serverapi',\n        REGEX: 'regex',\n    };\n\n    // all registered filters\n    var filters = [];\n\n    // loops over matching filters and passes options to each filter, returning the mapped results\n    var applyFilterChain = function applyFilterChain(key, value, utils) {\n        return new Promise(function(resolve, reject) {\n            // find matching filters for this key\n            var matchingFilters = filters\n                .filter(function(f) {\n                    return f.key === key;\n                })\n                .map(function(f) {\n                    return f.cb;\n                });\n\n            // resolve now\n            if (matchingFilters.length === 0) {\n                resolve(value);\n                return;\n            }\n\n            // first filter to kick things of\n            var initialFilter = matchingFilters.shift();\n\n            // chain filters\n            matchingFilters\n                .reduce(\n                    // loop over promises passing value to next promise\n                    function(current, next) {\n                        return current.then(function(value) {\n                            return next(value, utils);\n                        });\n                    },\n\n                    // call initial filter, will return a promise\n                    initialFilter(value, utils)\n\n                    // all executed\n                )\n                .then(function(value) {\n                    return resolve(value);\n                })\n                .catch(function(error) {\n                    return reject(error);\n                });\n        });\n    };\n\n    var applyFilters = function applyFilters(key, value, utils) {\n        return filters\n            .filter(function(f) {\n                return f.key === key;\n            })\n            .map(function(f) {\n                return f.cb(value, utils);\n            });\n    };\n\n    // adds a new filter to the list\n    var addFilter = function addFilter(key, cb) {\n        return filters.push({ key: key, cb: cb });\n    };\n\n    var extendDefaultOptions = function extendDefaultOptions(additionalOptions) {\n        return Object.assign(defaultOptions, additionalOptions);\n    };\n\n    var getOptions = function getOptions() {\n        return Object.assign({}, defaultOptions);\n    };\n\n    var setOptions = function setOptions(opts) {\n        forin(opts, function(key, value) {\n            // key does not exist, so this option cannot be set\n            if (!defaultOptions[key]) {\n                return;\n            }\n            defaultOptions[key][0] = getValueByType(\n                value,\n                defaultOptions[key][0],\n                defaultOptions[key][1]\n            );\n        });\n    };\n\n    // default options on app\n    var defaultOptions = {\n        // the id to add to the root element\n        id: [null, Type.STRING],\n\n        // input field name to use\n        name: ['filepond', Type.STRING],\n\n        // disable the field\n        disabled: [false, Type.BOOLEAN],\n\n        // classname to put on wrapper\n        className: [null, Type.STRING],\n\n        // is the field required\n        required: [false, Type.BOOLEAN],\n\n        // Allow media capture when value is set\n        captureMethod: [null, Type.STRING],\n        // - \"camera\", \"microphone\" or \"camcorder\",\n        // - Does not work with multiple on apple devices\n        // - If set, acceptedFileTypes must be made to match with media wildcard \"image/*\", \"audio/*\" or \"video/*\"\n\n        // sync `acceptedFileTypes` property with `accept` attribute\n        allowSyncAcceptAttribute: [true, Type.BOOLEAN],\n\n        // Feature toggles\n        allowDrop: [true, Type.BOOLEAN], // Allow dropping of files\n        allowBrowse: [true, Type.BOOLEAN], // Allow browsing the file system\n        allowPaste: [true, Type.BOOLEAN], // Allow pasting files\n        allowMultiple: [false, Type.BOOLEAN], // Allow multiple files (disabled by default, as multiple attribute is also required on input to allow multiple)\n        allowReplace: [true, Type.BOOLEAN], // Allow dropping a file on other file to replace it (only works when multiple is set to false)\n        allowRevert: [true, Type.BOOLEAN], // Allows user to revert file upload\n        allowRemove: [true, Type.BOOLEAN], // Allow user to remove a file\n        allowProcess: [true, Type.BOOLEAN], // Allows user to process a file, when set to false, this removes the file upload button\n        allowReorder: [false, Type.BOOLEAN], // Allow reordering of files\n        allowDirectoriesOnly: [false, Type.BOOLEAN], // Allow only selecting directories with browse (no support for filtering dnd at this point)\n\n        // Try store file if `server` not set\n        storeAsFile: [false, Type.BOOLEAN],\n\n        // Revert mode\n        forceRevert: [false, Type.BOOLEAN], // Set to 'force' to require the file to be reverted before removal\n\n        // Input requirements\n        maxFiles: [null, Type.INT], // Max number of files\n        checkValidity: [false, Type.BOOLEAN], // Enables custom validity messages\n\n        // Where to put file\n        itemInsertLocationFreedom: [true, Type.BOOLEAN], // Set to false to always add items to begin or end of list\n        itemInsertLocation: ['before', Type.STRING], // Default index in list to add items that have been dropped at the top of the list\n        itemInsertInterval: [75, Type.INT],\n\n        // Drag 'n Drop related\n        dropOnPage: [false, Type.BOOLEAN], // Allow dropping of files anywhere on page (prevents browser from opening file if dropped outside of Up)\n        dropOnElement: [true, Type.BOOLEAN], // Drop needs to happen on element (set to false to also load drops outside of Up)\n        dropValidation: [false, Type.BOOLEAN], // Enable or disable validating files on drop\n        ignoredFiles: [['.ds_store', 'thumbs.db', 'desktop.ini'], Type.ARRAY],\n\n        // Upload related\n        instantUpload: [true, Type.BOOLEAN], // Should upload files immediately on drop\n        maxParallelUploads: [2, Type.INT], // Maximum files to upload in parallel\n        allowMinimumUploadDuration: [true, Type.BOOLEAN], // if true uploads take at least 750 ms, this ensures the user sees the upload progress giving trust the upload actually happened\n\n        // Chunks\n        chunkUploads: [false, Type.BOOLEAN], // Enable chunked uploads\n        chunkForce: [false, Type.BOOLEAN], // Force use of chunk uploads even for files smaller than chunk size\n        chunkSize: [5000000, Type.INT], // Size of chunks (5MB default)\n        chunkRetryDelays: [[500, 1000, 3000], Type.ARRAY], // Amount of times to retry upload of a chunk when it fails\n\n        // The server api end points to use for uploading (see docs)\n        server: [null, Type.SERVER_API],\n\n        // File size calculations, can set to 1024, this is only used for display, properties use file size base 1000\n        fileSizeBase: [1000, Type.INT],\n\n        // Labels and status messages\n        labelFileSizeBytes: ['bytes', Type.STRING],\n        labelFileSizeKilobytes: ['KB', Type.STRING],\n        labelFileSizeMegabytes: ['MB', Type.STRING],\n        labelFileSizeGigabytes: ['GB', Type.STRING],\n\n        labelDecimalSeparator: [getDecimalSeparator(), Type.STRING], // Default is locale separator\n        labelThousandsSeparator: [getThousandsSeparator(), Type.STRING], // Default is locale separator\n\n        labelIdle: [\n            'Drag & Drop your files or <span class=\"filepond--label-action\">Browse</span>',\n            Type.STRING,\n        ],\n\n        labelInvalidField: ['Field contains invalid files', Type.STRING],\n        labelFileWaitingForSize: ['Waiting for size', Type.STRING],\n        labelFileSizeNotAvailable: ['Size not available', Type.STRING],\n        labelFileCountSingular: ['file in list', Type.STRING],\n        labelFileCountPlural: ['files in list', Type.STRING],\n        labelFileLoading: ['Loading', Type.STRING],\n        labelFileAdded: ['Added', Type.STRING], // assistive only\n        labelFileLoadError: ['Error during load', Type.STRING],\n        labelFileRemoved: ['Removed', Type.STRING], // assistive only\n        labelFileRemoveError: ['Error during remove', Type.STRING],\n        labelFileProcessing: ['Uploading', Type.STRING],\n        labelFileProcessingComplete: ['Upload complete', Type.STRING],\n        labelFileProcessingAborted: ['Upload cancelled', Type.STRING],\n        labelFileProcessingError: ['Error during upload', Type.STRING],\n        labelFileProcessingRevertError: ['Error during revert', Type.STRING],\n\n        labelTapToCancel: ['tap to cancel', Type.STRING],\n        labelTapToRetry: ['tap to retry', Type.STRING],\n        labelTapToUndo: ['tap to undo', Type.STRING],\n\n        labelButtonRemoveItem: ['Remove', Type.STRING],\n        labelButtonAbortItemLoad: ['Abort', Type.STRING],\n        labelButtonRetryItemLoad: ['Retry', Type.STRING],\n        labelButtonAbortItemProcessing: ['Cancel', Type.STRING],\n        labelButtonUndoItemProcessing: ['Undo', Type.STRING],\n        labelButtonRetryItemProcessing: ['Retry', Type.STRING],\n        labelButtonProcessItem: ['Upload', Type.STRING],\n\n        // make sure width and height plus viewpox are even numbers so icons are nicely centered\n        iconRemove: [\n            '<svg width=\"26\" height=\"26\" viewBox=\"0 0 26 26\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M11.586 13l-2.293 2.293a1 1 0 0 0 1.414 1.414L13 14.414l2.293 2.293a1 1 0 0 0 1.414-1.414L14.414 13l2.293-2.293a1 1 0 0 0-1.414-1.414L13 11.586l-2.293-2.293a1 1 0 0 0-1.414 1.414L11.586 13z\" fill=\"currentColor\" fill-rule=\"nonzero\"/></svg>',\n            Type.STRING,\n        ],\n\n        iconProcess: [\n            '<svg width=\"26\" height=\"26\" viewBox=\"0 0 26 26\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M14 10.414v3.585a1 1 0 0 1-2 0v-3.585l-1.293 1.293a1 1 0 0 1-1.414-1.415l3-3a1 1 0 0 1 1.414 0l3 3a1 1 0 0 1-1.414 1.415L14 10.414zM9 18a1 1 0 0 1 0-2h8a1 1 0 0 1 0 2H9z\" fill=\"currentColor\" fill-rule=\"evenodd\"/></svg>',\n            Type.STRING,\n        ],\n\n        iconRetry: [\n            '<svg width=\"26\" height=\"26\" viewBox=\"0 0 26 26\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M10.81 9.185l-.038.02A4.997 4.997 0 0 0 8 13.683a5 5 0 0 0 5 5 5 5 0 0 0 5-5 1 1 0 0 1 2 0A7 7 0 1 1 9.722 7.496l-.842-.21a.999.999 0 1 1 .484-1.94l3.23.806c.535.133.86.675.73 1.21l-.804 3.233a.997.997 0 0 1-1.21.73.997.997 0 0 1-.73-1.21l.23-.928v-.002z\" fill=\"currentColor\" fill-rule=\"nonzero\"/></svg>',\n            Type.STRING,\n        ],\n\n        iconUndo: [\n            '<svg width=\"26\" height=\"26\" viewBox=\"0 0 26 26\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M9.185 10.81l.02-.038A4.997 4.997 0 0 1 13.683 8a5 5 0 0 1 5 5 5 5 0 0 1-5 5 1 1 0 0 0 0 2A7 7 0 1 0 7.496 9.722l-.21-.842a.999.999 0 1 0-1.94.484l.806 3.23c.133.535.675.86 1.21.73l3.233-.803a.997.997 0 0 0 .73-1.21.997.997 0 0 0-1.21-.73l-.928.23-.002-.001z\" fill=\"currentColor\" fill-rule=\"nonzero\"/></svg>',\n            Type.STRING,\n        ],\n\n        iconDone: [\n            '<svg width=\"26\" height=\"26\" viewBox=\"0 0 26 26\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M18.293 9.293a1 1 0 0 1 1.414 1.414l-7.002 7a1 1 0 0 1-1.414 0l-3.998-4a1 1 0 1 1 1.414-1.414L12 15.586l6.294-6.293z\" fill=\"currentColor\" fill-rule=\"nonzero\"/></svg>',\n            Type.STRING,\n        ],\n\n        // event handlers\n        oninit: [null, Type.FUNCTION],\n        onwarning: [null, Type.FUNCTION],\n        onerror: [null, Type.FUNCTION],\n        onactivatefile: [null, Type.FUNCTION],\n        oninitfile: [null, Type.FUNCTION],\n        onaddfilestart: [null, Type.FUNCTION],\n        onaddfileprogress: [null, Type.FUNCTION],\n        onaddfile: [null, Type.FUNCTION],\n        onprocessfilestart: [null, Type.FUNCTION],\n        onprocessfileprogress: [null, Type.FUNCTION],\n        onprocessfileabort: [null, Type.FUNCTION],\n        onprocessfilerevert: [null, Type.FUNCTION],\n        onprocessfile: [null, Type.FUNCTION],\n        onprocessfiles: [null, Type.FUNCTION],\n        onremovefile: [null, Type.FUNCTION],\n        onpreparefile: [null, Type.FUNCTION],\n        onupdatefiles: [null, Type.FUNCTION],\n        onreorderfiles: [null, Type.FUNCTION],\n\n        // hooks\n        beforeDropFile: [null, Type.FUNCTION],\n        beforeAddFile: [null, Type.FUNCTION],\n        beforeRemoveFile: [null, Type.FUNCTION],\n        beforePrepareFile: [null, Type.FUNCTION],\n\n        // styles\n        stylePanelLayout: [null, Type.STRING], // null 'integrated', 'compact', 'circle'\n        stylePanelAspectRatio: [null, Type.STRING], // null or '3:2' or 1\n        styleItemPanelAspectRatio: [null, Type.STRING],\n        styleButtonRemoveItemPosition: ['left', Type.STRING],\n        styleButtonProcessItemPosition: ['right', Type.STRING],\n        styleLoadIndicatorPosition: ['right', Type.STRING],\n        styleProgressIndicatorPosition: ['right', Type.STRING],\n        styleButtonRemoveItemAlign: [false, Type.BOOLEAN],\n\n        // custom initial files array\n        files: [[], Type.ARRAY],\n\n        // show support by displaying credits\n        credits: [['https://pqina.nl/', 'Powered by PQINA'], Type.ARRAY],\n    };\n\n    var getItemByQuery = function getItemByQuery(items, query) {\n        // just return first index\n        if (isEmpty(query)) {\n            return items[0] || null;\n        }\n\n        // query is index\n        if (isInt(query)) {\n            return items[query] || null;\n        }\n\n        // if query is item, get the id\n        if (typeof query === 'object') {\n            query = query.id;\n        }\n\n        // assume query is a string and return item by id\n        return (\n            items.find(function(item) {\n                return item.id === query;\n            }) || null\n        );\n    };\n\n    var getNumericAspectRatioFromString = function getNumericAspectRatioFromString(aspectRatio) {\n        if (isEmpty(aspectRatio)) {\n            return aspectRatio;\n        }\n        if (/:/.test(aspectRatio)) {\n            var parts = aspectRatio.split(':');\n            return parts[1] / parts[0];\n        }\n        return parseFloat(aspectRatio);\n    };\n\n    var getActiveItems = function getActiveItems(items) {\n        return items.filter(function(item) {\n            return !item.archived;\n        });\n    };\n\n    var Status = {\n        EMPTY: 0,\n        IDLE: 1, // waiting\n        ERROR: 2, // a file is in error state\n        BUSY: 3, // busy processing or loading\n        READY: 4, // all files uploaded\n    };\n\n    var res = null;\n    var canUpdateFileInput = function canUpdateFileInput() {\n        if (res === null) {\n            try {\n                var dataTransfer = new DataTransfer();\n                dataTransfer.items.add(new File(['hello world'], 'This_Works.txt'));\n                var el = document.createElement('input');\n                el.setAttribute('type', 'file');\n                el.files = dataTransfer.files;\n                res = el.files.length === 1;\n            } catch (err) {\n                res = false;\n            }\n        }\n        return res;\n    };\n\n    var ITEM_ERROR = [\n        ItemStatus.LOAD_ERROR,\n        ItemStatus.PROCESSING_ERROR,\n        ItemStatus.PROCESSING_REVERT_ERROR,\n    ];\n\n    var ITEM_BUSY = [\n        ItemStatus.LOADING,\n        ItemStatus.PROCESSING,\n        ItemStatus.PROCESSING_QUEUED,\n        ItemStatus.INIT,\n    ];\n\n    var ITEM_READY = [ItemStatus.PROCESSING_COMPLETE];\n\n    var isItemInErrorState = function isItemInErrorState(item) {\n        return ITEM_ERROR.includes(item.status);\n    };\n    var isItemInBusyState = function isItemInBusyState(item) {\n        return ITEM_BUSY.includes(item.status);\n    };\n    var isItemInReadyState = function isItemInReadyState(item) {\n        return ITEM_READY.includes(item.status);\n    };\n\n    var isAsync = function isAsync(state) {\n        return (\n            isObject(state.options.server) &&\n            (isObject(state.options.server.process) || isFunction(state.options.server.process))\n        );\n    };\n\n    var queries = function queries(state) {\n        return {\n            GET_STATUS: function GET_STATUS() {\n                var items = getActiveItems(state.items);\n                var EMPTY = Status.EMPTY,\n                    ERROR = Status.ERROR,\n                    BUSY = Status.BUSY,\n                    IDLE = Status.IDLE,\n                    READY = Status.READY;\n\n                if (items.length === 0) return EMPTY;\n\n                if (items.some(isItemInErrorState)) return ERROR;\n\n                if (items.some(isItemInBusyState)) return BUSY;\n\n                if (items.some(isItemInReadyState)) return READY;\n\n                return IDLE;\n            },\n\n            GET_ITEM: function GET_ITEM(query) {\n                return getItemByQuery(state.items, query);\n            },\n\n            GET_ACTIVE_ITEM: function GET_ACTIVE_ITEM(query) {\n                return getItemByQuery(getActiveItems(state.items), query);\n            },\n\n            GET_ACTIVE_ITEMS: function GET_ACTIVE_ITEMS() {\n                return getActiveItems(state.items);\n            },\n\n            GET_ITEMS: function GET_ITEMS() {\n                return state.items;\n            },\n\n            GET_ITEM_NAME: function GET_ITEM_NAME(query) {\n                var item = getItemByQuery(state.items, query);\n                return item ? item.filename : null;\n            },\n\n            GET_ITEM_SIZE: function GET_ITEM_SIZE(query) {\n                var item = getItemByQuery(state.items, query);\n                return item ? item.fileSize : null;\n            },\n\n            GET_STYLES: function GET_STYLES() {\n                return Object.keys(state.options)\n                    .filter(function(key) {\n                        return /^style/.test(key);\n                    })\n                    .map(function(option) {\n                        return {\n                            name: option,\n                            value: state.options[option],\n                        };\n                    });\n            },\n\n            GET_PANEL_ASPECT_RATIO: function GET_PANEL_ASPECT_RATIO() {\n                var isShapeCircle = /circle/.test(state.options.stylePanelLayout);\n                var aspectRatio = isShapeCircle\n                    ? 1\n                    : getNumericAspectRatioFromString(state.options.stylePanelAspectRatio);\n                return aspectRatio;\n            },\n\n            GET_ITEM_PANEL_ASPECT_RATIO: function GET_ITEM_PANEL_ASPECT_RATIO() {\n                return state.options.styleItemPanelAspectRatio;\n            },\n\n            GET_ITEMS_BY_STATUS: function GET_ITEMS_BY_STATUS(status) {\n                return getActiveItems(state.items).filter(function(item) {\n                    return item.status === status;\n                });\n            },\n\n            GET_TOTAL_ITEMS: function GET_TOTAL_ITEMS() {\n                return getActiveItems(state.items).length;\n            },\n\n            SHOULD_UPDATE_FILE_INPUT: function SHOULD_UPDATE_FILE_INPUT() {\n                return state.options.storeAsFile && canUpdateFileInput() && !isAsync(state);\n            },\n\n            IS_ASYNC: function IS_ASYNC() {\n                return isAsync(state);\n            },\n\n            GET_FILE_SIZE_LABELS: function GET_FILE_SIZE_LABELS(query) {\n                return {\n                    labelBytes: query('GET_LABEL_FILE_SIZE_BYTES') || undefined,\n                    labelKilobytes: query('GET_LABEL_FILE_SIZE_KILOBYTES') || undefined,\n                    labelMegabytes: query('GET_LABEL_FILE_SIZE_MEGABYTES') || undefined,\n                    labelGigabytes: query('GET_LABEL_FILE_SIZE_GIGABYTES') || undefined,\n                };\n            },\n        };\n    };\n\n    var hasRoomForItem = function hasRoomForItem(state) {\n        var count = getActiveItems(state.items).length;\n\n        // if cannot have multiple items, to add one item it should currently not contain items\n        if (!state.options.allowMultiple) {\n            return count === 0;\n        }\n\n        // if allows multiple items, we check if a max item count has been set, if not, there's no limit\n        var maxFileCount = state.options.maxFiles;\n        if (maxFileCount === null) {\n            return true;\n        }\n\n        // we check if the current count is smaller than the max count, if so, another file can still be added\n        if (count < maxFileCount) {\n            return true;\n        }\n\n        // no more room for another file\n        return false;\n    };\n\n    var limit = function limit(value, min, max) {\n        return Math.max(Math.min(max, value), min);\n    };\n\n    var arrayInsert = function arrayInsert(arr, index, item) {\n        return arr.splice(index, 0, item);\n    };\n\n    var insertItem = function insertItem(items, item, index) {\n        if (isEmpty(item)) {\n            return null;\n        }\n\n        // if index is undefined, append\n        if (typeof index === 'undefined') {\n            items.push(item);\n            return item;\n        }\n\n        // limit the index to the size of the items array\n        index = limit(index, 0, items.length);\n\n        // add item to array\n        arrayInsert(items, index, item);\n\n        // expose\n        return item;\n    };\n\n    var isBase64DataURI = function isBase64DataURI(str) {\n        return /^\\s*data:([a-z]+\\/[a-z0-9-+.]+(;[a-z-]+=[a-z0-9-]+)?)?(;base64)?,([a-z0-9!$&',()*+;=\\-._~:@\\/?%\\s]*)\\s*$/i.test(\n            str\n        );\n    };\n\n    var getFilenameFromURL = function getFilenameFromURL(url) {\n        return url\n            .split('/')\n            .pop()\n            .split('?')\n            .shift();\n    };\n\n    var getExtensionFromFilename = function getExtensionFromFilename(name) {\n        return name.split('.').pop();\n    };\n\n    var guesstimateExtension = function guesstimateExtension(type) {\n        // if no extension supplied, exit here\n        if (typeof type !== 'string') {\n            return '';\n        }\n\n        // get subtype\n        var subtype = type.split('/').pop();\n\n        // is svg subtype\n        if (/svg/.test(subtype)) {\n            return 'svg';\n        }\n\n        if (/zip|compressed/.test(subtype)) {\n            return 'zip';\n        }\n\n        if (/plain/.test(subtype)) {\n            return 'txt';\n        }\n\n        if (/msword/.test(subtype)) {\n            return 'doc';\n        }\n\n        // if is valid subtype\n        if (/[a-z]+/.test(subtype)) {\n            // always use jpg extension\n            if (subtype === 'jpeg') {\n                return 'jpg';\n            }\n\n            // return subtype\n            return subtype;\n        }\n\n        return '';\n    };\n\n    var leftPad = function leftPad(value) {\n        var padding = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : '';\n        return (padding + value).slice(-padding.length);\n    };\n\n    var getDateString = function getDateString() {\n        var date = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : new Date();\n        return (\n            date.getFullYear() +\n            '-' +\n            leftPad(date.getMonth() + 1, '00') +\n            '-' +\n            leftPad(date.getDate(), '00') +\n            '_' +\n            leftPad(date.getHours(), '00') +\n            '-' +\n            leftPad(date.getMinutes(), '00') +\n            '-' +\n            leftPad(date.getSeconds(), '00')\n        );\n    };\n\n    var getFileFromBlob = function getFileFromBlob(blob, filename) {\n        var type = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;\n        var extension = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : null;\n        var file =\n            typeof type === 'string'\n                ? blob.slice(0, blob.size, type)\n                : blob.slice(0, blob.size, blob.type);\n        file.lastModifiedDate = new Date();\n\n        // copy relative path\n        if (blob._relativePath) file._relativePath = blob._relativePath;\n\n        // if blob has name property, use as filename if no filename supplied\n        if (!isString(filename)) {\n            filename = getDateString();\n        }\n\n        // if filename supplied but no extension and filename has extension\n        if (filename && extension === null && getExtensionFromFilename(filename)) {\n            file.name = filename;\n        } else {\n            extension = extension || guesstimateExtension(file.type);\n            file.name = filename + (extension ? '.' + extension : '');\n        }\n\n        return file;\n    };\n\n    var getBlobBuilder = function getBlobBuilder() {\n        return (window.BlobBuilder =\n            window.BlobBuilder ||\n            window.WebKitBlobBuilder ||\n            window.MozBlobBuilder ||\n            window.MSBlobBuilder);\n    };\n\n    var createBlob = function createBlob(arrayBuffer, mimeType) {\n        var BB = getBlobBuilder();\n\n        if (BB) {\n            var bb = new BB();\n            bb.append(arrayBuffer);\n            return bb.getBlob(mimeType);\n        }\n\n        return new Blob([arrayBuffer], {\n            type: mimeType,\n        });\n    };\n\n    var getBlobFromByteStringWithMimeType = function getBlobFromByteStringWithMimeType(\n        byteString,\n        mimeType\n    ) {\n        var ab = new ArrayBuffer(byteString.length);\n        var ia = new Uint8Array(ab);\n\n        for (var i = 0; i < byteString.length; i++) {\n            ia[i] = byteString.charCodeAt(i);\n        }\n\n        return createBlob(ab, mimeType);\n    };\n\n    var getMimeTypeFromBase64DataURI = function getMimeTypeFromBase64DataURI(dataURI) {\n        return (/^data:(.+);/.exec(dataURI) || [])[1] || null;\n    };\n\n    var getBase64DataFromBase64DataURI = function getBase64DataFromBase64DataURI(dataURI) {\n        // get data part of string (remove data:image/jpeg...,)\n        var data = dataURI.split(',')[1];\n\n        // remove any whitespace as that causes InvalidCharacterError in IE\n        return data.replace(/\\s/g, '');\n    };\n\n    var getByteStringFromBase64DataURI = function getByteStringFromBase64DataURI(dataURI) {\n        return atob(getBase64DataFromBase64DataURI(dataURI));\n    };\n\n    var getBlobFromBase64DataURI = function getBlobFromBase64DataURI(dataURI) {\n        var mimeType = getMimeTypeFromBase64DataURI(dataURI);\n        var byteString = getByteStringFromBase64DataURI(dataURI);\n\n        return getBlobFromByteStringWithMimeType(byteString, mimeType);\n    };\n\n    var getFileFromBase64DataURI = function getFileFromBase64DataURI(dataURI, filename, extension) {\n        return getFileFromBlob(getBlobFromBase64DataURI(dataURI), filename, null, extension);\n    };\n\n    var getFileNameFromHeader = function getFileNameFromHeader(header) {\n        // test if is content disposition header, if not exit\n        if (!/^content-disposition:/i.test(header)) return null;\n\n        // get filename parts\n        var matches = header\n            .split(/filename=|filename\\*=.+''/)\n            .splice(1)\n            .map(function(name) {\n                return name.trim().replace(/^[\"']|[;\"']{0,2}$/g, '');\n            })\n            .filter(function(name) {\n                return name.length;\n            });\n\n        return matches.length ? decodeURI(matches[matches.length - 1]) : null;\n    };\n\n    var getFileSizeFromHeader = function getFileSizeFromHeader(header) {\n        if (/content-length:/i.test(header)) {\n            var size = header.match(/[0-9]+/)[0];\n            return size ? parseInt(size, 10) : null;\n        }\n        return null;\n    };\n\n    var getTranfserIdFromHeader = function getTranfserIdFromHeader(header) {\n        if (/x-content-transfer-id:/i.test(header)) {\n            var id = (header.split(':')[1] || '').trim();\n            return id || null;\n        }\n        return null;\n    };\n\n    var getFileInfoFromHeaders = function getFileInfoFromHeaders(headers) {\n        var info = {\n            source: null,\n            name: null,\n            size: null,\n        };\n\n        var rows = headers.split('\\n');\n        var _iteratorNormalCompletion = true;\n        var _didIteratorError = false;\n        var _iteratorError = undefined;\n        try {\n            for (\n                var _iterator = rows[Symbol.iterator](), _step;\n                !(_iteratorNormalCompletion = (_step = _iterator.next()).done);\n                _iteratorNormalCompletion = true\n            ) {\n                var header = _step.value;\n\n                var name = getFileNameFromHeader(header);\n                if (name) {\n                    info.name = name;\n                    continue;\n                }\n\n                var size = getFileSizeFromHeader(header);\n                if (size) {\n                    info.size = size;\n                    continue;\n                }\n\n                var source = getTranfserIdFromHeader(header);\n                if (source) {\n                    info.source = source;\n                    continue;\n                }\n            }\n        } catch (err) {\n            _didIteratorError = true;\n            _iteratorError = err;\n        } finally {\n            try {\n                if (!_iteratorNormalCompletion && _iterator.return != null) {\n                    _iterator.return();\n                }\n            } finally {\n                if (_didIteratorError) {\n                    throw _iteratorError;\n                }\n            }\n        }\n\n        return info;\n    };\n\n    var createFileLoader = function createFileLoader(fetchFn) {\n        var state = {\n            source: null,\n            complete: false,\n            progress: 0,\n            size: null,\n            timestamp: null,\n            duration: 0,\n            request: null,\n        };\n\n        var getProgress = function getProgress() {\n            return state.progress;\n        };\n        var abort = function abort() {\n            if (state.request && state.request.abort) {\n                state.request.abort();\n            }\n        };\n\n        // load source\n        var load = function load() {\n            // get quick reference\n            var source = state.source;\n\n            api.fire('init', source);\n\n            // Load Files\n            if (source instanceof File) {\n                api.fire('load', source);\n            } else if (source instanceof Blob) {\n                // Load blobs, set default name to current date\n                api.fire('load', getFileFromBlob(source, source.name));\n            } else if (isBase64DataURI(source)) {\n                // Load base 64, set default name to current date\n                api.fire('load', getFileFromBase64DataURI(source));\n            } else {\n                // Deal as if is external URL, let's load it!\n                loadURL(source);\n            }\n        };\n\n        // loads a url\n        var loadURL = function loadURL(url) {\n            // is remote url and no fetch method supplied\n            if (!fetchFn) {\n                api.fire('error', {\n                    type: 'error',\n                    body: \"Can't load URL\",\n                    code: 400,\n                });\n\n                return;\n            }\n\n            // set request start\n            state.timestamp = Date.now();\n\n            // load file\n            state.request = fetchFn(\n                url,\n                function(response) {\n                    // update duration\n                    state.duration = Date.now() - state.timestamp;\n\n                    // done!\n                    state.complete = true;\n\n                    // turn blob response into a file\n                    if (response instanceof Blob) {\n                        response = getFileFromBlob(\n                            response,\n                            response.name || getFilenameFromURL(url)\n                        );\n                    }\n\n                    api.fire(\n                        'load',\n                        // if has received blob, we go with blob, if no response, we return null\n                        response instanceof Blob ? response : response ? response.body : null\n                    );\n                },\n                function(error) {\n                    api.fire(\n                        'error',\n                        typeof error === 'string'\n                            ? {\n                                  type: 'error',\n                                  code: 0,\n                                  body: error,\n                              }\n                            : error\n                    );\n                },\n                function(computable, current, total) {\n                    // collected some meta data already\n                    if (total) {\n                        state.size = total;\n                    }\n\n                    // update duration\n                    state.duration = Date.now() - state.timestamp;\n\n                    // if we can't compute progress, we're not going to fire progress events\n                    if (!computable) {\n                        state.progress = null;\n                        return;\n                    }\n\n                    // update progress percentage\n                    state.progress = current / total;\n\n                    // expose\n                    api.fire('progress', state.progress);\n                },\n                function() {\n                    api.fire('abort');\n                },\n                function(response) {\n                    var fileinfo = getFileInfoFromHeaders(\n                        typeof response === 'string' ? response : response.headers\n                    );\n                    api.fire('meta', {\n                        size: state.size || fileinfo.size,\n                        filename: fileinfo.name,\n                        source: fileinfo.source,\n                    });\n                }\n            );\n        };\n\n        var api = Object.assign({}, on(), {\n            setSource: function setSource(source) {\n                return (state.source = source);\n            },\n            getProgress: getProgress, // file load progress\n            abort: abort, // abort file load\n            load: load, // start load\n        });\n\n        return api;\n    };\n\n    var isGet = function isGet(method) {\n        return /GET|HEAD/.test(method);\n    };\n\n    var sendRequest = function sendRequest(data, url, options) {\n        var api = {\n            onheaders: function onheaders() {},\n            onprogress: function onprogress() {},\n            onload: function onload() {},\n            ontimeout: function ontimeout() {},\n            onerror: function onerror() {},\n            onabort: function onabort() {},\n            abort: function abort() {\n                aborted = true;\n                xhr.abort();\n            },\n        };\n\n        // timeout identifier, only used when timeout is defined\n        var aborted = false;\n        var headersReceived = false;\n\n        // set default options\n        options = Object.assign(\n            {\n                method: 'POST',\n                headers: {},\n                withCredentials: false,\n            },\n            options\n        );\n\n        // encode url\n        url = encodeURI(url);\n\n        // if method is GET, add any received data to url\n\n        if (isGet(options.method) && data) {\n            url =\n                '' +\n                url +\n                encodeURIComponent(typeof data === 'string' ? data : JSON.stringify(data));\n        }\n\n        // create request\n        var xhr = new XMLHttpRequest();\n\n        // progress of load\n        var process = isGet(options.method) ? xhr : xhr.upload;\n        process.onprogress = function(e) {\n            // no progress event when aborted ( onprogress is called once after abort() )\n            if (aborted) {\n                return;\n            }\n\n            api.onprogress(e.lengthComputable, e.loaded, e.total);\n        };\n\n        // tries to get header info to the app as fast as possible\n        xhr.onreadystatechange = function() {\n            // not interesting in these states ('unsent' and 'openend' as they don't give us any additional info)\n            if (xhr.readyState < 2) {\n                return;\n            }\n\n            // no server response\n            if (xhr.readyState === 4 && xhr.status === 0) {\n                return;\n            }\n\n            if (headersReceived) {\n                return;\n            }\n\n            headersReceived = true;\n\n            // we've probably received some useful data in response headers\n            api.onheaders(xhr);\n        };\n\n        // load successful\n        xhr.onload = function() {\n            // is classified as valid response\n            if (xhr.status >= 200 && xhr.status < 300) {\n                api.onload(xhr);\n            } else {\n                api.onerror(xhr);\n            }\n        };\n\n        // error during load\n        xhr.onerror = function() {\n            return api.onerror(xhr);\n        };\n\n        // request aborted\n        xhr.onabort = function() {\n            aborted = true;\n            api.onabort();\n        };\n\n        // request timeout\n        xhr.ontimeout = function() {\n            return api.ontimeout(xhr);\n        };\n\n        // open up open up!\n        xhr.open(options.method, url, true);\n\n        // set timeout if defined (do it after open so IE11 plays ball)\n        if (isInt(options.timeout)) {\n            xhr.timeout = options.timeout;\n        }\n\n        // add headers\n        Object.keys(options.headers).forEach(function(key) {\n            var value = unescape(encodeURIComponent(options.headers[key]));\n            xhr.setRequestHeader(key, value);\n        });\n\n        // set type of response\n        if (options.responseType) {\n            xhr.responseType = options.responseType;\n        }\n\n        // set credentials\n        if (options.withCredentials) {\n            xhr.withCredentials = true;\n        }\n\n        // let's send our data\n        xhr.send(data);\n\n        return api;\n    };\n\n    var createResponse = function createResponse(type, code, body, headers) {\n        return {\n            type: type,\n            code: code,\n            body: body,\n            headers: headers,\n        };\n    };\n\n    var createTimeoutResponse = function createTimeoutResponse(cb) {\n        return function(xhr) {\n            cb(createResponse('error', 0, 'Timeout', xhr.getAllResponseHeaders()));\n        };\n    };\n\n    var hasQS = function hasQS(str) {\n        return /\\?/.test(str);\n    };\n    var buildURL = function buildURL() {\n        var url = '';\n        for (var _len = arguments.length, parts = new Array(_len), _key = 0; _key < _len; _key++) {\n            parts[_key] = arguments[_key];\n        }\n        parts.forEach(function(part) {\n            url += hasQS(url) && hasQS(part) ? part.replace(/\\?/, '&') : part;\n        });\n        return url;\n    };\n\n    var createFetchFunction = function createFetchFunction() {\n        var apiUrl = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '';\n        var action = arguments.length > 1 ? arguments[1] : undefined;\n        // custom handler (should also handle file, load, error, progress and abort)\n        if (typeof action === 'function') {\n            return action;\n        }\n\n        // no action supplied\n        if (!action || !isString(action.url)) {\n            return null;\n        }\n\n        // set onload hanlder\n        var onload =\n            action.onload ||\n            function(res) {\n                return res;\n            };\n        var onerror =\n            action.onerror ||\n            function(res) {\n                return null;\n            };\n\n        // internal handler\n        return function(url, load, error, progress, abort, headers) {\n            // do local or remote request based on if the url is external\n            var request = sendRequest(\n                url,\n                buildURL(apiUrl, action.url),\n                Object.assign({}, action, {\n                    responseType: 'blob',\n                })\n            );\n\n            request.onload = function(xhr) {\n                // get headers\n                var headers = xhr.getAllResponseHeaders();\n\n                // get filename\n                var filename = getFileInfoFromHeaders(headers).name || getFilenameFromURL(url);\n\n                // create response\n                load(\n                    createResponse(\n                        'load',\n                        xhr.status,\n                        action.method === 'HEAD'\n                            ? null\n                            : getFileFromBlob(onload(xhr.response), filename),\n                        headers\n                    )\n                );\n            };\n\n            request.onerror = function(xhr) {\n                error(\n                    createResponse(\n                        'error',\n                        xhr.status,\n                        onerror(xhr.response) || xhr.statusText,\n                        xhr.getAllResponseHeaders()\n                    )\n                );\n            };\n\n            request.onheaders = function(xhr) {\n                headers(createResponse('headers', xhr.status, null, xhr.getAllResponseHeaders()));\n            };\n\n            request.ontimeout = createTimeoutResponse(error);\n            request.onprogress = progress;\n            request.onabort = abort;\n\n            // should return request\n            return request;\n        };\n    };\n\n    var ChunkStatus = {\n        QUEUED: 0,\n        COMPLETE: 1,\n        PROCESSING: 2,\n        ERROR: 3,\n        WAITING: 4,\n    };\n\n    /*\n                                                       function signature:\n                                                         (file, metadata, load, error, progress, abort, transfer, options) => {\n                                                           return {\n                                                           abort:() => {}\n                                                         }\n                                                       }\n                                                       */\n\n    // apiUrl, action, name, file, metadata, load, error, progress, abort, transfer, options\n    var processFileChunked = function processFileChunked(\n        apiUrl,\n        action,\n        name,\n        file,\n        metadata,\n        load,\n        error,\n        progress,\n        abort,\n        transfer,\n        options\n    ) {\n        // all chunks\n        var chunks = [];\n        var chunkTransferId = options.chunkTransferId,\n            chunkServer = options.chunkServer,\n            chunkSize = options.chunkSize,\n            chunkRetryDelays = options.chunkRetryDelays;\n\n        // default state\n        var state = {\n            serverId: chunkTransferId,\n            aborted: false,\n        };\n\n        // set onload handlers\n        var ondata =\n            action.ondata ||\n            function(fd) {\n                return fd;\n            };\n        var onload =\n            action.onload ||\n            function(xhr, method) {\n                return method === 'HEAD' ? xhr.getResponseHeader('Upload-Offset') : xhr.response;\n            };\n        var onerror =\n            action.onerror ||\n            function(res) {\n                return null;\n            };\n\n        // create server hook\n        var requestTransferId = function requestTransferId(cb) {\n            var formData = new FormData();\n\n            // add metadata under same name\n            if (isObject(metadata)) formData.append(name, JSON.stringify(metadata));\n\n            var headers =\n                typeof action.headers === 'function'\n                    ? action.headers(file, metadata)\n                    : Object.assign({}, action.headers, {\n                          'Upload-Length': file.size,\n                      });\n\n            var requestParams = Object.assign({}, action, {\n                headers: headers,\n            });\n\n            // send request object\n            var request = sendRequest(\n                ondata(formData),\n                buildURL(apiUrl, action.url),\n                requestParams\n            );\n\n            request.onload = function(xhr) {\n                return cb(onload(xhr, requestParams.method));\n            };\n\n            request.onerror = function(xhr) {\n                return error(\n                    createResponse(\n                        'error',\n                        xhr.status,\n                        onerror(xhr.response) || xhr.statusText,\n                        xhr.getAllResponseHeaders()\n                    )\n                );\n            };\n\n            request.ontimeout = createTimeoutResponse(error);\n        };\n\n        var requestTransferOffset = function requestTransferOffset(cb) {\n            var requestUrl = buildURL(apiUrl, chunkServer.url, state.serverId);\n\n            var headers =\n                typeof action.headers === 'function'\n                    ? action.headers(state.serverId)\n                    : Object.assign({}, action.headers);\n\n            var requestParams = {\n                headers: headers,\n                method: 'HEAD',\n            };\n\n            var request = sendRequest(null, requestUrl, requestParams);\n\n            request.onload = function(xhr) {\n                return cb(onload(xhr, requestParams.method));\n            };\n\n            request.onerror = function(xhr) {\n                return error(\n                    createResponse(\n                        'error',\n                        xhr.status,\n                        onerror(xhr.response) || xhr.statusText,\n                        xhr.getAllResponseHeaders()\n                    )\n                );\n            };\n\n            request.ontimeout = createTimeoutResponse(error);\n        };\n\n        // create chunks\n        var lastChunkIndex = Math.floor(file.size / chunkSize);\n        for (var i = 0; i <= lastChunkIndex; i++) {\n            var offset = i * chunkSize;\n            var data = file.slice(offset, offset + chunkSize, 'application/offset+octet-stream');\n            chunks[i] = {\n                index: i,\n                size: data.size,\n                offset: offset,\n                data: data,\n                file: file,\n                progress: 0,\n                retries: _toConsumableArray(chunkRetryDelays),\n                status: ChunkStatus.QUEUED,\n                error: null,\n                request: null,\n                timeout: null,\n            };\n        }\n\n        var completeProcessingChunks = function completeProcessingChunks() {\n            return load(state.serverId);\n        };\n\n        var canProcessChunk = function canProcessChunk(chunk) {\n            return chunk.status === ChunkStatus.QUEUED || chunk.status === ChunkStatus.ERROR;\n        };\n\n        var processChunk = function processChunk(chunk) {\n            // processing is paused, wait here\n            if (state.aborted) return;\n\n            // get next chunk to process\n            chunk = chunk || chunks.find(canProcessChunk);\n\n            // no more chunks to process\n            if (!chunk) {\n                // all done?\n                if (\n                    chunks.every(function(chunk) {\n                        return chunk.status === ChunkStatus.COMPLETE;\n                    })\n                ) {\n                    completeProcessingChunks();\n                }\n\n                // no chunk to handle\n                return;\n            }\n\n            // now processing this chunk\n            chunk.status = ChunkStatus.PROCESSING;\n            chunk.progress = null;\n\n            // allow parsing of formdata\n            var ondata =\n                chunkServer.ondata ||\n                function(fd) {\n                    return fd;\n                };\n            var onerror =\n                chunkServer.onerror ||\n                function(res) {\n                    return null;\n                };\n\n            // send request object\n            var requestUrl = buildURL(apiUrl, chunkServer.url, state.serverId);\n\n            var headers =\n                typeof chunkServer.headers === 'function'\n                    ? chunkServer.headers(chunk)\n                    : Object.assign({}, chunkServer.headers, {\n                          'Content-Type': 'application/offset+octet-stream',\n                          'Upload-Offset': chunk.offset,\n                          'Upload-Length': file.size,\n                          'Upload-Name': file.name,\n                      });\n\n            var request = (chunk.request = sendRequest(\n                ondata(chunk.data),\n                requestUrl,\n                Object.assign({}, chunkServer, {\n                    headers: headers,\n                })\n            ));\n\n            request.onload = function() {\n                // done!\n                chunk.status = ChunkStatus.COMPLETE;\n\n                // remove request reference\n                chunk.request = null;\n\n                // start processing more chunks\n                processChunks();\n            };\n\n            request.onprogress = function(lengthComputable, loaded, total) {\n                chunk.progress = lengthComputable ? loaded : null;\n                updateTotalProgress();\n            };\n\n            request.onerror = function(xhr) {\n                chunk.status = ChunkStatus.ERROR;\n                chunk.request = null;\n                chunk.error = onerror(xhr.response) || xhr.statusText;\n                if (!retryProcessChunk(chunk)) {\n                    error(\n                        createResponse(\n                            'error',\n                            xhr.status,\n                            onerror(xhr.response) || xhr.statusText,\n                            xhr.getAllResponseHeaders()\n                        )\n                    );\n                }\n            };\n\n            request.ontimeout = function(xhr) {\n                chunk.status = ChunkStatus.ERROR;\n                chunk.request = null;\n                if (!retryProcessChunk(chunk)) {\n                    createTimeoutResponse(error)(xhr);\n                }\n            };\n\n            request.onabort = function() {\n                chunk.status = ChunkStatus.QUEUED;\n                chunk.request = null;\n                abort();\n            };\n        };\n\n        var retryProcessChunk = function retryProcessChunk(chunk) {\n            // no more retries left\n            if (chunk.retries.length === 0) return false;\n\n            // new retry\n            chunk.status = ChunkStatus.WAITING;\n            clearTimeout(chunk.timeout);\n            chunk.timeout = setTimeout(function() {\n                processChunk(chunk);\n            }, chunk.retries.shift());\n\n            // we're going to retry\n            return true;\n        };\n\n        var updateTotalProgress = function updateTotalProgress() {\n            // calculate total progress fraction\n            var totalBytesTransfered = chunks.reduce(function(p, chunk) {\n                if (p === null || chunk.progress === null) return null;\n                return p + chunk.progress;\n            }, 0);\n\n            // can't compute progress\n            if (totalBytesTransfered === null) return progress(false, 0, 0);\n\n            // calculate progress values\n            var totalSize = chunks.reduce(function(total, chunk) {\n                return total + chunk.size;\n            }, 0);\n\n            // can update progress indicator\n            progress(true, totalBytesTransfered, totalSize);\n        };\n\n        // process new chunks\n        var processChunks = function processChunks() {\n            var totalProcessing = chunks.filter(function(chunk) {\n                return chunk.status === ChunkStatus.PROCESSING;\n            }).length;\n            if (totalProcessing >= 1) return;\n            processChunk();\n        };\n\n        var abortChunks = function abortChunks() {\n            chunks.forEach(function(chunk) {\n                clearTimeout(chunk.timeout);\n                if (chunk.request) {\n                    chunk.request.abort();\n                }\n            });\n        };\n\n        // let's go!\n        if (!state.serverId) {\n            requestTransferId(function(serverId) {\n                // stop here if aborted, might have happened in between request and callback\n                if (state.aborted) return;\n\n                // pass back to item so we can use it if something goes wrong\n                transfer(serverId);\n\n                // store internally\n                state.serverId = serverId;\n                processChunks();\n            });\n        } else {\n            requestTransferOffset(function(offset) {\n                // stop here if aborted, might have happened in between request and callback\n                if (state.aborted) return;\n\n                // mark chunks with lower offset as complete\n                chunks\n                    .filter(function(chunk) {\n                        return chunk.offset < offset;\n                    })\n                    .forEach(function(chunk) {\n                        chunk.status = ChunkStatus.COMPLETE;\n                        chunk.progress = chunk.size;\n                    });\n\n                // continue processing\n                processChunks();\n            });\n        }\n\n        return {\n            abort: function abort() {\n                state.aborted = true;\n                abortChunks();\n            },\n        };\n    };\n\n    /*\n                                                               function signature:\n                                                                 (file, metadata, load, error, progress, abort) => {\n                                                                   return {\n                                                                   abort:() => {}\n                                                                 }\n                                                               }\n                                                               */\n    var createFileProcessorFunction = function createFileProcessorFunction(\n        apiUrl,\n        action,\n        name,\n        options\n    ) {\n        return function(file, metadata, load, error, progress, abort, transfer) {\n            // no file received\n            if (!file) return;\n\n            // if was passed a file, and we can chunk it, exit here\n            var canChunkUpload = options.chunkUploads;\n            var shouldChunkUpload = canChunkUpload && file.size > options.chunkSize;\n            var willChunkUpload = canChunkUpload && (shouldChunkUpload || options.chunkForce);\n            if (file instanceof Blob && willChunkUpload)\n                return processFileChunked(\n                    apiUrl,\n                    action,\n                    name,\n                    file,\n                    metadata,\n                    load,\n                    error,\n                    progress,\n                    abort,\n                    transfer,\n                    options\n                );\n\n            // set handlers\n            var ondata =\n                action.ondata ||\n                function(fd) {\n                    return fd;\n                };\n            var onload =\n                action.onload ||\n                function(res) {\n                    return res;\n                };\n            var onerror =\n                action.onerror ||\n                function(res) {\n                    return null;\n                };\n\n            var headers =\n                typeof action.headers === 'function'\n                    ? action.headers(file, metadata) || {}\n                    : Object.assign(\n                          {},\n\n                          action.headers\n                      );\n\n            var requestParams = Object.assign({}, action, {\n                headers: headers,\n            });\n\n            // create formdata object\n            var formData = new FormData();\n\n            // add metadata under same name\n            if (isObject(metadata)) {\n                formData.append(name, JSON.stringify(metadata));\n            }\n\n            // Turn into an array of objects so no matter what the input, we can handle it the same way\n            (file instanceof Blob ? [{ name: null, file: file }] : file).forEach(function(item) {\n                formData.append(\n                    name,\n                    item.file,\n                    item.name === null ? item.file.name : '' + item.name + item.file.name\n                );\n            });\n\n            // send request object\n            var request = sendRequest(\n                ondata(formData),\n                buildURL(apiUrl, action.url),\n                requestParams\n            );\n            request.onload = function(xhr) {\n                load(\n                    createResponse(\n                        'load',\n                        xhr.status,\n                        onload(xhr.response),\n                        xhr.getAllResponseHeaders()\n                    )\n                );\n            };\n\n            request.onerror = function(xhr) {\n                error(\n                    createResponse(\n                        'error',\n                        xhr.status,\n                        onerror(xhr.response) || xhr.statusText,\n                        xhr.getAllResponseHeaders()\n                    )\n                );\n            };\n\n            request.ontimeout = createTimeoutResponse(error);\n            request.onprogress = progress;\n            request.onabort = abort;\n\n            // should return request\n            return request;\n        };\n    };\n\n    var createProcessorFunction = function createProcessorFunction() {\n        var apiUrl = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '';\n        var action = arguments.length > 1 ? arguments[1] : undefined;\n        var name = arguments.length > 2 ? arguments[2] : undefined;\n        var options = arguments.length > 3 ? arguments[3] : undefined;\n\n        // custom handler (should also handle file, load, error, progress and abort)\n        if (typeof action === 'function')\n            return function() {\n                for (\n                    var _len = arguments.length, params = new Array(_len), _key = 0;\n                    _key < _len;\n                    _key++\n                ) {\n                    params[_key] = arguments[_key];\n                }\n                return action.apply(void 0, [name].concat(params, [options]));\n            };\n\n        // no action supplied\n        if (!action || !isString(action.url)) return null;\n\n        // internal handler\n        return createFileProcessorFunction(apiUrl, action, name, options);\n    };\n\n    /*\n                                                      function signature:\n                                                      (uniqueFileId, load, error) => { }\n                                                      */\n    var createRevertFunction = function createRevertFunction() {\n        var apiUrl = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '';\n        var action = arguments.length > 1 ? arguments[1] : undefined;\n        // is custom implementation\n        if (typeof action === 'function') {\n            return action;\n        }\n\n        // no action supplied, return stub function, interface will work, but file won't be removed\n        if (!action || !isString(action.url)) {\n            return function(uniqueFileId, load) {\n                return load();\n            };\n        }\n\n        // set onload hanlder\n        var onload =\n            action.onload ||\n            function(res) {\n                return res;\n            };\n        var onerror =\n            action.onerror ||\n            function(res) {\n                return null;\n            };\n\n        // internal implementation\n        return function(uniqueFileId, load, error) {\n            var request = sendRequest(\n                uniqueFileId,\n                apiUrl + action.url,\n                action // contains method, headers and withCredentials properties\n            );\n            request.onload = function(xhr) {\n                load(\n                    createResponse(\n                        'load',\n                        xhr.status,\n                        onload(xhr.response),\n                        xhr.getAllResponseHeaders()\n                    )\n                );\n            };\n\n            request.onerror = function(xhr) {\n                error(\n                    createResponse(\n                        'error',\n                        xhr.status,\n                        onerror(xhr.response) || xhr.statusText,\n                        xhr.getAllResponseHeaders()\n                    )\n                );\n            };\n\n            request.ontimeout = createTimeoutResponse(error);\n\n            return request;\n        };\n    };\n\n    var getRandomNumber = function getRandomNumber() {\n        var min = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;\n        var max = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 1;\n        return min + Math.random() * (max - min);\n    };\n\n    var createPerceivedPerformanceUpdater = function createPerceivedPerformanceUpdater(cb) {\n        var duration = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 1000;\n        var offset = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 0;\n        var tickMin = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 25;\n        var tickMax = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : 250;\n        var timeout = null;\n        var start = Date.now();\n\n        var tick = function tick() {\n            var runtime = Date.now() - start;\n            var delay = getRandomNumber(tickMin, tickMax);\n\n            if (runtime + delay > duration) {\n                delay = runtime + delay - duration;\n            }\n\n            var progress = runtime / duration;\n            if (progress >= 1 || document.hidden) {\n                cb(1);\n                return;\n            }\n\n            cb(progress);\n\n            timeout = setTimeout(tick, delay);\n        };\n\n        if (duration > 0) tick();\n\n        return {\n            clear: function clear() {\n                clearTimeout(timeout);\n            },\n        };\n    };\n\n    var createFileProcessor = function createFileProcessor(processFn, options) {\n        var state = {\n            complete: false,\n            perceivedProgress: 0,\n            perceivedPerformanceUpdater: null,\n            progress: null,\n            timestamp: null,\n            perceivedDuration: 0,\n            duration: 0,\n            request: null,\n            response: null,\n        };\n        var allowMinimumUploadDuration = options.allowMinimumUploadDuration;\n\n        var process = function process(file, metadata) {\n            var progressFn = function progressFn() {\n                // we've not yet started the real download, stop here\n                // the request might not go through, for instance, there might be some server trouble\n                // if state.progress is null, the server does not allow computing progress and we show the spinner instead\n                if (state.duration === 0 || state.progress === null) return;\n\n                // as we're now processing, fire the progress event\n                api.fire('progress', api.getProgress());\n            };\n\n            var completeFn = function completeFn() {\n                state.complete = true;\n                api.fire('load-perceived', state.response.body);\n            };\n\n            // let's start processing\n            api.fire('start');\n\n            // set request start\n            state.timestamp = Date.now();\n\n            // create perceived performance progress indicator\n            state.perceivedPerformanceUpdater = createPerceivedPerformanceUpdater(\n                function(progress) {\n                    state.perceivedProgress = progress;\n                    state.perceivedDuration = Date.now() - state.timestamp;\n\n                    progressFn();\n\n                    // if fake progress is done, and a response has been received,\n                    // and we've not yet called the complete method\n                    if (state.response && state.perceivedProgress === 1 && !state.complete) {\n                        // we done!\n                        completeFn();\n                    }\n                },\n                // random delay as in a list of files you start noticing\n                // files uploading at the exact same speed\n                allowMinimumUploadDuration ? getRandomNumber(750, 1500) : 0\n            );\n\n            // remember request so we can abort it later\n            state.request = processFn(\n                // the file to process\n                file,\n\n                // the metadata to send along\n                metadata,\n\n                // callbacks (load, error, progress, abort, transfer)\n                // load expects the body to be a server id if\n                // you want to make use of revert\n                function(response) {\n                    // we put the response in state so we can access\n                    // it outside of this method\n                    state.response = isObject(response)\n                        ? response\n                        : {\n                              type: 'load',\n                              code: 200,\n                              body: '' + response,\n                              headers: {},\n                          };\n\n                    // update duration\n                    state.duration = Date.now() - state.timestamp;\n\n                    // force progress to 1 as we're now done\n                    state.progress = 1;\n\n                    // actual load is done let's share results\n                    api.fire('load', state.response.body);\n\n                    // we are really done\n                    // if perceived progress is 1 ( wait for perceived progress to complete )\n                    // or if server does not support progress ( null )\n                    if (\n                        !allowMinimumUploadDuration ||\n                        (allowMinimumUploadDuration && state.perceivedProgress === 1)\n                    ) {\n                        completeFn();\n                    }\n                },\n\n                // error is expected to be an object with type, code, body\n                function(error) {\n                    // cancel updater\n                    state.perceivedPerformanceUpdater.clear();\n\n                    // update others about this error\n                    api.fire(\n                        'error',\n                        isObject(error)\n                            ? error\n                            : {\n                                  type: 'error',\n                                  code: 0,\n                                  body: '' + error,\n                              }\n                    );\n                },\n\n                // actual processing progress\n                function(computable, current, total) {\n                    // update actual duration\n                    state.duration = Date.now() - state.timestamp;\n\n                    // update actual progress\n                    state.progress = computable ? current / total : null;\n\n                    progressFn();\n                },\n\n                // abort does not expect a value\n                function() {\n                    // stop updater\n                    state.perceivedPerformanceUpdater.clear();\n\n                    // fire the abort event so we can switch visuals\n                    api.fire('abort', state.response ? state.response.body : null);\n                },\n\n                // register the id for this transfer\n                function(transferId) {\n                    api.fire('transfer', transferId);\n                }\n            );\n        };\n\n        var abort = function abort() {\n            // no request running, can't abort\n            if (!state.request) return;\n\n            // stop updater\n            state.perceivedPerformanceUpdater.clear();\n\n            // abort actual request\n            if (state.request.abort) state.request.abort();\n\n            // if has response object, we've completed the request\n            state.complete = true;\n        };\n\n        var reset = function reset() {\n            abort();\n            state.complete = false;\n            state.perceivedProgress = 0;\n            state.progress = 0;\n            state.timestamp = null;\n            state.perceivedDuration = 0;\n            state.duration = 0;\n            state.request = null;\n            state.response = null;\n        };\n\n        var getProgress = allowMinimumUploadDuration\n            ? function() {\n                  return state.progress ? Math.min(state.progress, state.perceivedProgress) : null;\n              }\n            : function() {\n                  return state.progress || null;\n              };\n\n        var getDuration = allowMinimumUploadDuration\n            ? function() {\n                  return Math.min(state.duration, state.perceivedDuration);\n              }\n            : function() {\n                  return state.duration;\n              };\n\n        var api = Object.assign({}, on(), {\n            process: process, // start processing file\n            abort: abort, // abort active process request\n            getProgress: getProgress,\n            getDuration: getDuration,\n            reset: reset,\n        });\n\n        return api;\n    };\n\n    var getFilenameWithoutExtension = function getFilenameWithoutExtension(name) {\n        return name.substr(0, name.lastIndexOf('.')) || name;\n    };\n\n    var createFileStub = function createFileStub(source) {\n        var data = [source.name, source.size, source.type];\n\n        // is blob or base64, then we need to set the name\n        if (source instanceof Blob || isBase64DataURI(source)) {\n            data[0] = source.name || getDateString();\n        } else if (isBase64DataURI(source)) {\n            // if is base64 data uri we need to determine the average size and type\n            data[1] = source.length;\n            data[2] = getMimeTypeFromBase64DataURI(source);\n        } else if (isString(source)) {\n            // url\n            data[0] = getFilenameFromURL(source);\n            data[1] = 0;\n            data[2] = 'application/octet-stream';\n        }\n\n        return {\n            name: data[0],\n            size: data[1],\n            type: data[2],\n        };\n    };\n\n    var isFile = function isFile(value) {\n        return !!(value instanceof File || (value instanceof Blob && value.name));\n    };\n\n    var deepCloneObject = function deepCloneObject(src) {\n        if (!isObject(src)) return src;\n        var target = isArray(src) ? [] : {};\n        for (var key in src) {\n            if (!src.hasOwnProperty(key)) continue;\n            var v = src[key];\n            target[key] = v && isObject(v) ? deepCloneObject(v) : v;\n        }\n        return target;\n    };\n\n    var createItem = function createItem() {\n        var origin = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : null;\n        var serverFileReference =\n            arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;\n        var file = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;\n        // unique id for this item, is used to identify the item across views\n        var id = getUniqueId();\n\n        /**\n         * Internal item state\n         */\n        var state = {\n            // is archived\n            archived: false,\n\n            // if is frozen, no longer fires events\n            frozen: false,\n\n            // removed from view\n            released: false,\n\n            // original source\n            source: null,\n\n            // file model reference\n            file: file,\n\n            // id of file on server\n            serverFileReference: serverFileReference,\n\n            // id of file transfer on server\n            transferId: null,\n\n            // is aborted\n            processingAborted: false,\n\n            // current item status\n            status: serverFileReference ? ItemStatus.PROCESSING_COMPLETE : ItemStatus.INIT,\n\n            // active processes\n            activeLoader: null,\n            activeProcessor: null,\n        };\n\n        // callback used when abort processing is called to link back to the resolve method\n        var abortProcessingRequestComplete = null;\n\n        /**\n         * Externally added item metadata\n         */\n        var metadata = {};\n\n        // item data\n        var setStatus = function setStatus(status) {\n            return (state.status = status);\n        };\n\n        // fire event unless the item has been archived\n        var fire = function fire(event) {\n            if (state.released || state.frozen) return;\n            for (\n                var _len = arguments.length, params = new Array(_len > 1 ? _len - 1 : 0), _key = 1;\n                _key < _len;\n                _key++\n            ) {\n                params[_key - 1] = arguments[_key];\n            }\n            api.fire.apply(api, [event].concat(params));\n        };\n\n        // file data\n        var getFileExtension = function getFileExtension() {\n            return getExtensionFromFilename(state.file.name);\n        };\n        var getFileType = function getFileType() {\n            return state.file.type;\n        };\n        var getFileSize = function getFileSize() {\n            return state.file.size;\n        };\n        var getFile = function getFile() {\n            return state.file;\n        };\n\n        //\n        // logic to load a file\n        //\n        var load = function load(source, loader, onload) {\n            // remember the original item source\n            state.source = source;\n\n            // source is known\n            api.fireSync('init');\n\n            // file stub is already there\n            if (state.file) {\n                api.fireSync('load-skip');\n                return;\n            }\n\n            // set a stub file object while loading the actual data\n            state.file = createFileStub(source);\n\n            // starts loading\n            loader.on('init', function() {\n                fire('load-init');\n            });\n\n            // we'eve received a size indication, let's update the stub\n            loader.on('meta', function(meta) {\n                // set size of file stub\n                state.file.size = meta.size;\n\n                // set name of file stub\n                state.file.filename = meta.filename;\n\n                // if has received source, we done\n                if (meta.source) {\n                    origin = FileOrigin.LIMBO;\n                    state.serverFileReference = meta.source;\n                    state.status = ItemStatus.PROCESSING_COMPLETE;\n                }\n\n                // size has been updated\n                fire('load-meta');\n            });\n\n            // the file is now loading we need to update the progress indicators\n            loader.on('progress', function(progress) {\n                setStatus(ItemStatus.LOADING);\n\n                fire('load-progress', progress);\n            });\n\n            // an error was thrown while loading the file, we need to switch to error state\n            loader.on('error', function(error) {\n                setStatus(ItemStatus.LOAD_ERROR);\n\n                fire('load-request-error', error);\n            });\n\n            // user or another process aborted the file load (cannot retry)\n            loader.on('abort', function() {\n                setStatus(ItemStatus.INIT);\n                fire('load-abort');\n            });\n\n            // done loading\n            loader.on('load', function(file) {\n                // as we've now loaded the file the loader is no longer required\n                state.activeLoader = null;\n\n                // called when file has loaded succesfully\n                var success = function success(result) {\n                    // set (possibly) transformed file\n                    state.file = isFile(result) ? result : state.file;\n\n                    // file received\n                    if (origin === FileOrigin.LIMBO && state.serverFileReference) {\n                        setStatus(ItemStatus.PROCESSING_COMPLETE);\n                    } else {\n                        setStatus(ItemStatus.IDLE);\n                    }\n\n                    fire('load');\n                };\n\n                var error = function error(result) {\n                    // set original file\n                    state.file = file;\n                    fire('load-meta');\n\n                    setStatus(ItemStatus.LOAD_ERROR);\n                    fire('load-file-error', result);\n                };\n\n                // if we already have a server file reference, we don't need to call the onload method\n                if (state.serverFileReference) {\n                    success(file);\n                    return;\n                }\n\n                // no server id, let's give this file the full treatment\n                onload(file, success, error);\n            });\n\n            // set loader source data\n            loader.setSource(source);\n\n            // set as active loader\n            state.activeLoader = loader;\n\n            // load the source data\n            loader.load();\n        };\n\n        var retryLoad = function retryLoad() {\n            if (!state.activeLoader) {\n                return;\n            }\n            state.activeLoader.load();\n        };\n\n        var abortLoad = function abortLoad() {\n            if (state.activeLoader) {\n                state.activeLoader.abort();\n                return;\n            }\n            setStatus(ItemStatus.INIT);\n            fire('load-abort');\n        };\n\n        //\n        // logic to process a file\n        //\n        var process = function process(processor, onprocess) {\n            // processing was aborted\n            if (state.processingAborted) {\n                state.processingAborted = false;\n                return;\n            }\n\n            // now processing\n            setStatus(ItemStatus.PROCESSING);\n\n            // reset abort callback\n            abortProcessingRequestComplete = null;\n\n            // if no file loaded we'll wait for the load event\n            if (!(state.file instanceof Blob)) {\n                api.on('load', function() {\n                    process(processor, onprocess);\n                });\n                return;\n            }\n\n            // setup processor\n            processor.on('load', function(serverFileReference) {\n                // need this id to be able to revert the upload\n                state.transferId = null;\n                state.serverFileReference = serverFileReference;\n            });\n\n            // register transfer id\n            processor.on('transfer', function(transferId) {\n                // need this id to be able to revert the upload\n                state.transferId = transferId;\n            });\n\n            processor.on('load-perceived', function(serverFileReference) {\n                // no longer required\n                state.activeProcessor = null;\n\n                // need this id to be able to rever the upload\n                state.transferId = null;\n                state.serverFileReference = serverFileReference;\n\n                setStatus(ItemStatus.PROCESSING_COMPLETE);\n                fire('process-complete', serverFileReference);\n            });\n\n            processor.on('start', function() {\n                fire('process-start');\n            });\n\n            processor.on('error', function(error) {\n                state.activeProcessor = null;\n                setStatus(ItemStatus.PROCESSING_ERROR);\n                fire('process-error', error);\n            });\n\n            processor.on('abort', function(serverFileReference) {\n                state.activeProcessor = null;\n\n                // if file was uploaded but processing was cancelled during perceived processor time store file reference\n                state.serverFileReference = serverFileReference;\n\n                setStatus(ItemStatus.IDLE);\n                fire('process-abort');\n\n                // has timeout so doesn't interfere with remove action\n                if (abortProcessingRequestComplete) {\n                    abortProcessingRequestComplete();\n                }\n            });\n\n            processor.on('progress', function(progress) {\n                fire('process-progress', progress);\n            });\n\n            // when successfully transformed\n            var success = function success(file) {\n                // if was archived in the mean time, don't process\n                if (state.archived) return;\n\n                // process file!\n                processor.process(file, Object.assign({}, metadata));\n            };\n\n            // something went wrong during transform phase\n            var error = console.error;\n\n            // start processing the file\n            onprocess(state.file, success, error);\n\n            // set as active processor\n            state.activeProcessor = processor;\n        };\n\n        var requestProcessing = function requestProcessing() {\n            state.processingAborted = false;\n            setStatus(ItemStatus.PROCESSING_QUEUED);\n        };\n\n        var abortProcessing = function abortProcessing() {\n            return new Promise(function(resolve) {\n                if (!state.activeProcessor) {\n                    state.processingAborted = true;\n\n                    setStatus(ItemStatus.IDLE);\n                    fire('process-abort');\n\n                    resolve();\n                    return;\n                }\n\n                abortProcessingRequestComplete = function abortProcessingRequestComplete() {\n                    resolve();\n                };\n\n                state.activeProcessor.abort();\n            });\n        };\n\n        //\n        // logic to revert a processed file\n        //\n        var revert = function revert(revertFileUpload, forceRevert) {\n            return new Promise(function(resolve, reject) {\n                // a completed upload will have a serverFileReference, a failed chunked upload where\n                // getting a serverId succeeded but >=0 chunks have been uploaded will have transferId set\n                var serverTransferId =\n                    state.serverFileReference !== null\n                        ? state.serverFileReference\n                        : state.transferId;\n\n                // cannot revert without a server id for this process\n                if (serverTransferId === null) {\n                    resolve();\n                    return;\n                }\n\n                // revert the upload (fire and forget)\n                revertFileUpload(\n                    serverTransferId,\n                    function() {\n                        // reset file server id and transfer id as now it's not available on the server\n                        state.serverFileReference = null;\n                        state.transferId = null;\n                        resolve();\n                    },\n                    function(error) {\n                        // don't set error state when reverting is optional, it will always resolve\n                        if (!forceRevert) {\n                            resolve();\n                            return;\n                        }\n\n                        // oh no errors\n                        setStatus(ItemStatus.PROCESSING_REVERT_ERROR);\n                        fire('process-revert-error');\n                        reject(error);\n                    }\n                );\n\n                // fire event\n                setStatus(ItemStatus.IDLE);\n                fire('process-revert');\n            });\n        };\n\n        // exposed methods\n        var _setMetadata = function setMetadata(key, value, silent) {\n            var keys = key.split('.');\n            var root = keys[0];\n            var last = keys.pop();\n            var data = metadata;\n            keys.forEach(function(key) {\n                return (data = data[key]);\n            });\n\n            // compare old value against new value, if they're the same, we're not updating\n            if (JSON.stringify(data[last]) === JSON.stringify(value)) return;\n\n            // update value\n            data[last] = value;\n\n            // fire update\n            fire('metadata-update', {\n                key: root,\n                value: metadata[root],\n                silent: silent,\n            });\n        };\n\n        var getMetadata = function getMetadata(key) {\n            return deepCloneObject(key ? metadata[key] : metadata);\n        };\n\n        var api = Object.assign(\n            {\n                id: {\n                    get: function get() {\n                        return id;\n                    },\n                },\n                origin: {\n                    get: function get() {\n                        return origin;\n                    },\n                    set: function set(value) {\n                        return (origin = value);\n                    },\n                },\n                serverId: {\n                    get: function get() {\n                        return state.serverFileReference;\n                    },\n                },\n                transferId: {\n                    get: function get() {\n                        return state.transferId;\n                    },\n                },\n                status: {\n                    get: function get() {\n                        return state.status;\n                    },\n                },\n                filename: {\n                    get: function get() {\n                        return state.file.name;\n                    },\n                },\n                filenameWithoutExtension: {\n                    get: function get() {\n                        return getFilenameWithoutExtension(state.file.name);\n                    },\n                },\n                fileExtension: { get: getFileExtension },\n                fileType: { get: getFileType },\n                fileSize: { get: getFileSize },\n                file: { get: getFile },\n                relativePath: {\n                    get: function get() {\n                        return state.file._relativePath;\n                    },\n                },\n\n                source: {\n                    get: function get() {\n                        return state.source;\n                    },\n                },\n\n                getMetadata: getMetadata,\n                setMetadata: function setMetadata(key, value, silent) {\n                    if (isObject(key)) {\n                        var data = key;\n                        Object.keys(data).forEach(function(key) {\n                            _setMetadata(key, data[key], value);\n                        });\n                        return key;\n                    }\n                    _setMetadata(key, value, silent);\n                    return value;\n                },\n\n                extend: function extend(name, handler) {\n                    return (itemAPI[name] = handler);\n                },\n\n                abortLoad: abortLoad,\n                retryLoad: retryLoad,\n                requestProcessing: requestProcessing,\n                abortProcessing: abortProcessing,\n\n                load: load,\n                process: process,\n                revert: revert,\n            },\n\n            on(),\n            {\n                freeze: function freeze() {\n                    return (state.frozen = true);\n                },\n\n                release: function release() {\n                    return (state.released = true);\n                },\n                released: {\n                    get: function get() {\n                        return state.released;\n                    },\n                },\n\n                archive: function archive() {\n                    return (state.archived = true);\n                },\n                archived: {\n                    get: function get() {\n                        return state.archived;\n                    },\n                },\n            }\n        );\n\n        // create it here instead of returning it instantly so we can extend it later\n        var itemAPI = createObject(api);\n\n        return itemAPI;\n    };\n\n    var getItemIndexByQuery = function getItemIndexByQuery(items, query) {\n        // just return first index\n        if (isEmpty(query)) {\n            return 0;\n        }\n\n        // invalid queries\n        if (!isString(query)) {\n            return -1;\n        }\n\n        // return item by id (or -1 if not found)\n        return items.findIndex(function(item) {\n            return item.id === query;\n        });\n    };\n\n    var getItemById = function getItemById(items, itemId) {\n        var index = getItemIndexByQuery(items, itemId);\n        if (index < 0) {\n            return;\n        }\n        return items[index] || null;\n    };\n\n    var fetchBlob = function fetchBlob(url, load, error, progress, abort, headers) {\n        var request = sendRequest(null, url, {\n            method: 'GET',\n            responseType: 'blob',\n        });\n\n        request.onload = function(xhr) {\n            // get headers\n            var headers = xhr.getAllResponseHeaders();\n\n            // get filename\n            var filename = getFileInfoFromHeaders(headers).name || getFilenameFromURL(url);\n\n            // create response\n            load(\n                createResponse('load', xhr.status, getFileFromBlob(xhr.response, filename), headers)\n            );\n        };\n\n        request.onerror = function(xhr) {\n            error(createResponse('error', xhr.status, xhr.statusText, xhr.getAllResponseHeaders()));\n        };\n\n        request.onheaders = function(xhr) {\n            headers(createResponse('headers', xhr.status, null, xhr.getAllResponseHeaders()));\n        };\n\n        request.ontimeout = createTimeoutResponse(error);\n        request.onprogress = progress;\n        request.onabort = abort;\n\n        // should return request\n        return request;\n    };\n\n    var getDomainFromURL = function getDomainFromURL(url) {\n        if (url.indexOf('//') === 0) {\n            url = location.protocol + url;\n        }\n        return url\n            .toLowerCase()\n            .replace('blob:', '')\n            .replace(/([a-z])?:\\/\\//, '$1')\n            .split('/')[0];\n    };\n\n    var isExternalURL = function isExternalURL(url) {\n        return (\n            (url.indexOf(':') > -1 || url.indexOf('//') > -1) &&\n            getDomainFromURL(location.href) !== getDomainFromURL(url)\n        );\n    };\n\n    var dynamicLabel = function dynamicLabel(label) {\n        return function() {\n            return isFunction(label) ? label.apply(void 0, arguments) : label;\n        };\n    };\n\n    var isMockItem = function isMockItem(item) {\n        return !isFile(item.file);\n    };\n\n    var listUpdated = function listUpdated(dispatch, state) {\n        clearTimeout(state.listUpdateTimeout);\n        state.listUpdateTimeout = setTimeout(function() {\n            dispatch('DID_UPDATE_ITEMS', { items: getActiveItems(state.items) });\n        }, 0);\n    };\n\n    var optionalPromise = function optionalPromise(fn) {\n        for (\n            var _len = arguments.length, params = new Array(_len > 1 ? _len - 1 : 0), _key = 1;\n            _key < _len;\n            _key++\n        ) {\n            params[_key - 1] = arguments[_key];\n        }\n        return new Promise(function(resolve) {\n            if (!fn) {\n                return resolve(true);\n            }\n\n            var result = fn.apply(void 0, params);\n\n            if (result == null) {\n                return resolve(true);\n            }\n\n            if (typeof result === 'boolean') {\n                return resolve(result);\n            }\n\n            if (typeof result.then === 'function') {\n                result.then(resolve);\n            }\n        });\n    };\n\n    var sortItems = function sortItems(state, compare) {\n        state.items.sort(function(a, b) {\n            return compare(createItemAPI(a), createItemAPI(b));\n        });\n    };\n\n    // returns item based on state\n    var getItemByQueryFromState = function getItemByQueryFromState(state, itemHandler) {\n        return function() {\n            var _ref = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n            var query = _ref.query,\n                _ref$success = _ref.success,\n                success = _ref$success === void 0 ? function() {} : _ref$success,\n                _ref$failure = _ref.failure,\n                failure = _ref$failure === void 0 ? function() {} : _ref$failure,\n                options = _objectWithoutProperties(_ref, ['query', 'success', 'failure']);\n            var item = getItemByQuery(state.items, query);\n            if (!item) {\n                failure({\n                    error: createResponse('error', 0, 'Item not found'),\n                    file: null,\n                });\n\n                return;\n            }\n            itemHandler(item, success, failure, options || {});\n        };\n    };\n\n    var actions = function actions(dispatch, query, state) {\n        return {\n            /**\n             * Aborts all ongoing processes\n             */\n            ABORT_ALL: function ABORT_ALL() {\n                getActiveItems(state.items).forEach(function(item) {\n                    item.freeze();\n                    item.abortLoad();\n                    item.abortProcessing();\n                });\n            },\n\n            /**\n             * Sets initial files\n             */\n            DID_SET_FILES: function DID_SET_FILES(_ref2) {\n                var _ref2$value = _ref2.value,\n                    value = _ref2$value === void 0 ? [] : _ref2$value;\n                // map values to file objects\n                var files = value.map(function(file) {\n                    return {\n                        source: file.source ? file.source : file,\n                        options: file.options,\n                    };\n                });\n\n                // loop over files, if file is in list, leave it be, if not, remove\n                // test if items should be moved\n                var activeItems = getActiveItems(state.items);\n\n                activeItems.forEach(function(item) {\n                    // if item not is in new value, remove\n                    if (\n                        !files.find(function(file) {\n                            return file.source === item.source || file.source === item.file;\n                        })\n                    ) {\n                        dispatch('REMOVE_ITEM', { query: item, remove: false });\n                    }\n                });\n\n                // add new files\n                activeItems = getActiveItems(state.items);\n                files.forEach(function(file, index) {\n                    // if file is already in list\n                    if (\n                        activeItems.find(function(item) {\n                            return item.source === file.source || item.file === file.source;\n                        })\n                    )\n                        return;\n\n                    // not in list, add\n                    dispatch(\n                        'ADD_ITEM',\n                        Object.assign({}, file, {\n                            interactionMethod: InteractionMethod.NONE,\n                            index: index,\n                        })\n                    );\n                });\n            },\n\n            DID_UPDATE_ITEM_METADATA: function DID_UPDATE_ITEM_METADATA(_ref3) {\n                var id = _ref3.id,\n                    action = _ref3.action,\n                    change = _ref3.change;\n                // don't do anything\n                if (change.silent) return;\n\n                // if is called multiple times in close succession we combined all calls together to save resources\n                clearTimeout(state.itemUpdateTimeout);\n                state.itemUpdateTimeout = setTimeout(function() {\n                    var item = getItemById(state.items, id);\n\n                    // only revert and attempt to upload when we're uploading to a server\n                    if (!query('IS_ASYNC')) {\n                        // should we update the output data\n                        applyFilterChain('SHOULD_PREPARE_OUTPUT', false, {\n                            item: item,\n                            query: query,\n                            action: action,\n                            change: change,\n                        }).then(function(shouldPrepareOutput) {\n                            // plugins determined the output data should be prepared (or not), can be adjusted with beforePrepareOutput hook\n                            var beforePrepareFile = query('GET_BEFORE_PREPARE_FILE');\n                            if (beforePrepareFile)\n                                shouldPrepareOutput = beforePrepareFile(item, shouldPrepareOutput);\n\n                            if (!shouldPrepareOutput) return;\n\n                            dispatch(\n                                'REQUEST_PREPARE_OUTPUT',\n                                {\n                                    query: id,\n                                    item: item,\n                                    success: function success(file) {\n                                        dispatch('DID_PREPARE_OUTPUT', { id: id, file: file });\n                                    },\n                                },\n\n                                true\n                            );\n                        });\n\n                        return;\n                    }\n\n                    // if is local item we need to enable upload button so change can be propagated to server\n                    if (item.origin === FileOrigin.LOCAL) {\n                        dispatch('DID_LOAD_ITEM', {\n                            id: item.id,\n                            error: null,\n                            serverFileReference: item.source,\n                        });\n                    }\n\n                    // for async scenarios\n                    var upload = function upload() {\n                        // we push this forward a bit so the interface is updated correctly\n                        setTimeout(function() {\n                            dispatch('REQUEST_ITEM_PROCESSING', { query: id });\n                        }, 32);\n                    };\n\n                    var revert = function revert(doUpload) {\n                        item.revert(\n                            createRevertFunction(\n                                state.options.server.url,\n                                state.options.server.revert\n                            ),\n                            query('GET_FORCE_REVERT')\n                        )\n                            .then(doUpload ? upload : function() {})\n                            .catch(function() {});\n                    };\n\n                    var abort = function abort(doUpload) {\n                        item.abortProcessing().then(doUpload ? upload : function() {});\n                    };\n\n                    // if we should re-upload the file immediately\n                    if (item.status === ItemStatus.PROCESSING_COMPLETE) {\n                        return revert(state.options.instantUpload);\n                    }\n\n                    // if currently uploading, cancel upload\n                    if (item.status === ItemStatus.PROCESSING) {\n                        return abort(state.options.instantUpload);\n                    }\n\n                    if (state.options.instantUpload) {\n                        upload();\n                    }\n                }, 0);\n            },\n\n            MOVE_ITEM: function MOVE_ITEM(_ref4) {\n                var query = _ref4.query,\n                    index = _ref4.index;\n                var item = getItemByQuery(state.items, query);\n                if (!item) return;\n                var currentIndex = state.items.indexOf(item);\n                index = limit(index, 0, state.items.length - 1);\n                if (currentIndex === index) return;\n                state.items.splice(index, 0, state.items.splice(currentIndex, 1)[0]);\n            },\n\n            SORT: function SORT(_ref5) {\n                var compare = _ref5.compare;\n                sortItems(state, compare);\n                dispatch('DID_SORT_ITEMS', {\n                    items: query('GET_ACTIVE_ITEMS'),\n                });\n            },\n\n            ADD_ITEMS: function ADD_ITEMS(_ref6) {\n                var items = _ref6.items,\n                    index = _ref6.index,\n                    interactionMethod = _ref6.interactionMethod,\n                    _ref6$success = _ref6.success,\n                    success = _ref6$success === void 0 ? function() {} : _ref6$success,\n                    _ref6$failure = _ref6.failure,\n                    failure = _ref6$failure === void 0 ? function() {} : _ref6$failure;\n                var currentIndex = index;\n\n                if (index === -1 || typeof index === 'undefined') {\n                    var insertLocation = query('GET_ITEM_INSERT_LOCATION');\n                    var totalItems = query('GET_TOTAL_ITEMS');\n                    currentIndex = insertLocation === 'before' ? 0 : totalItems;\n                }\n\n                var ignoredFiles = query('GET_IGNORED_FILES');\n                var isValidFile = function isValidFile(source) {\n                    return isFile(source)\n                        ? !ignoredFiles.includes(source.name.toLowerCase())\n                        : !isEmpty(source);\n                };\n                var validItems = items.filter(isValidFile);\n\n                var promises = validItems.map(function(source) {\n                    return new Promise(function(resolve, reject) {\n                        dispatch('ADD_ITEM', {\n                            interactionMethod: interactionMethod,\n                            source: source.source || source,\n                            success: resolve,\n                            failure: reject,\n                            index: currentIndex++,\n                            options: source.options || {},\n                        });\n                    });\n                });\n\n                Promise.all(promises)\n                    .then(success)\n                    .catch(failure);\n            },\n\n            /**\n             * @param source\n             * @param index\n             * @param interactionMethod\n             */\n            ADD_ITEM: function ADD_ITEM(_ref7) {\n                var source = _ref7.source,\n                    _ref7$index = _ref7.index,\n                    index = _ref7$index === void 0 ? -1 : _ref7$index,\n                    interactionMethod = _ref7.interactionMethod,\n                    _ref7$success = _ref7.success,\n                    success = _ref7$success === void 0 ? function() {} : _ref7$success,\n                    _ref7$failure = _ref7.failure,\n                    failure = _ref7$failure === void 0 ? function() {} : _ref7$failure,\n                    _ref7$options = _ref7.options,\n                    options = _ref7$options === void 0 ? {} : _ref7$options;\n                // if no source supplied\n                if (isEmpty(source)) {\n                    failure({\n                        error: createResponse('error', 0, 'No source'),\n                        file: null,\n                    });\n\n                    return;\n                }\n\n                // filter out invalid file items, used to filter dropped directory contents\n                if (\n                    isFile(source) &&\n                    state.options.ignoredFiles.includes(source.name.toLowerCase())\n                ) {\n                    // fail silently\n                    return;\n                }\n\n                // test if there's still room in the list of files\n                if (!hasRoomForItem(state)) {\n                    // if multiple allowed, we can't replace\n                    // or if only a single item is allowed but we're not allowed to replace it we exit\n                    if (\n                        state.options.allowMultiple ||\n                        (!state.options.allowMultiple && !state.options.allowReplace)\n                    ) {\n                        var error = createResponse('warning', 0, 'Max files');\n\n                        dispatch('DID_THROW_MAX_FILES', {\n                            source: source,\n                            error: error,\n                        });\n\n                        failure({ error: error, file: null });\n\n                        return;\n                    }\n\n                    // let's replace the item\n                    // id of first item we're about to remove\n                    var _item = getActiveItems(state.items)[0];\n\n                    // if has been processed remove it from the server as well\n                    if (\n                        _item.status === ItemStatus.PROCESSING_COMPLETE ||\n                        _item.status === ItemStatus.PROCESSING_REVERT_ERROR\n                    ) {\n                        var forceRevert = query('GET_FORCE_REVERT');\n                        _item\n                            .revert(\n                                createRevertFunction(\n                                    state.options.server.url,\n                                    state.options.server.revert\n                                ),\n                                forceRevert\n                            )\n                            .then(function() {\n                                if (!forceRevert) return;\n\n                                // try to add now\n                                dispatch('ADD_ITEM', {\n                                    source: source,\n                                    index: index,\n                                    interactionMethod: interactionMethod,\n                                    success: success,\n                                    failure: failure,\n                                    options: options,\n                                });\n                            })\n                            .catch(function() {}); // no need to handle this catch state for now\n\n                        if (forceRevert) return;\n                    }\n\n                    // remove first item as it will be replaced by this item\n                    dispatch('REMOVE_ITEM', { query: _item.id });\n                }\n\n                // where did the file originate\n                var origin =\n                    options.type === 'local'\n                        ? FileOrigin.LOCAL\n                        : options.type === 'limbo'\n                        ? FileOrigin.LIMBO\n                        : FileOrigin.INPUT;\n\n                // create a new blank item\n                var item = createItem(\n                    // where did this file come from\n                    origin,\n\n                    // an input file never has a server file reference\n                    origin === FileOrigin.INPUT ? null : source,\n\n                    // file mock data, if defined\n                    options.file\n                );\n\n                // set initial meta data\n                Object.keys(options.metadata || {}).forEach(function(key) {\n                    item.setMetadata(key, options.metadata[key]);\n                });\n\n                // created the item, let plugins add methods\n                applyFilters('DID_CREATE_ITEM', item, { query: query, dispatch: dispatch });\n\n                // where to insert new items\n                var itemInsertLocation = query('GET_ITEM_INSERT_LOCATION');\n\n                // adjust index if is not allowed to pick location\n                if (!state.options.itemInsertLocationFreedom) {\n                    index = itemInsertLocation === 'before' ? -1 : state.items.length;\n                }\n\n                // add item to list\n                insertItem(state.items, item, index);\n\n                // sort items in list\n                if (isFunction(itemInsertLocation) && source) {\n                    sortItems(state, itemInsertLocation);\n                }\n\n                // get a quick reference to the item id\n                var id = item.id;\n\n                // observe item events\n                item.on('init', function() {\n                    dispatch('DID_INIT_ITEM', { id: id });\n                });\n\n                item.on('load-init', function() {\n                    dispatch('DID_START_ITEM_LOAD', { id: id });\n                });\n\n                item.on('load-meta', function() {\n                    dispatch('DID_UPDATE_ITEM_META', { id: id });\n                });\n\n                item.on('load-progress', function(progress) {\n                    dispatch('DID_UPDATE_ITEM_LOAD_PROGRESS', { id: id, progress: progress });\n                });\n\n                item.on('load-request-error', function(error) {\n                    var mainStatus = dynamicLabel(state.options.labelFileLoadError)(error);\n\n                    // is client error, no way to recover\n                    if (error.code >= 400 && error.code < 500) {\n                        dispatch('DID_THROW_ITEM_INVALID', {\n                            id: id,\n                            error: error,\n                            status: {\n                                main: mainStatus,\n                                sub: error.code + ' (' + error.body + ')',\n                            },\n                        });\n\n                        // reject the file so can be dealt with through API\n                        failure({ error: error, file: createItemAPI(item) });\n                        return;\n                    }\n\n                    // is possible server error, so might be possible to retry\n                    dispatch('DID_THROW_ITEM_LOAD_ERROR', {\n                        id: id,\n                        error: error,\n                        status: {\n                            main: mainStatus,\n                            sub: state.options.labelTapToRetry,\n                        },\n                    });\n                });\n\n                item.on('load-file-error', function(error) {\n                    dispatch('DID_THROW_ITEM_INVALID', {\n                        id: id,\n                        error: error.status,\n                        status: error.status,\n                    });\n\n                    failure({ error: error.status, file: createItemAPI(item) });\n                });\n\n                item.on('load-abort', function() {\n                    dispatch('REMOVE_ITEM', { query: id });\n                });\n\n                item.on('load-skip', function() {\n                    dispatch('COMPLETE_LOAD_ITEM', {\n                        query: id,\n                        item: item,\n                        data: {\n                            source: source,\n                            success: success,\n                        },\n                    });\n                });\n\n                item.on('load', function() {\n                    var handleAdd = function handleAdd(shouldAdd) {\n                        // no should not add this file\n                        if (!shouldAdd) {\n                            dispatch('REMOVE_ITEM', {\n                                query: id,\n                            });\n\n                            return;\n                        }\n\n                        // now interested in metadata updates\n                        item.on('metadata-update', function(change) {\n                            dispatch('DID_UPDATE_ITEM_METADATA', { id: id, change: change });\n                        });\n\n                        // let plugins decide if the output data should be prepared at this point\n                        // means we'll do this and wait for idle state\n                        applyFilterChain('SHOULD_PREPARE_OUTPUT', false, {\n                            item: item,\n                            query: query,\n                        }).then(function(shouldPrepareOutput) {\n                            // plugins determined the output data should be prepared (or not), can be adjusted with beforePrepareOutput hook\n                            var beforePrepareFile = query('GET_BEFORE_PREPARE_FILE');\n                            if (beforePrepareFile)\n                                shouldPrepareOutput = beforePrepareFile(item, shouldPrepareOutput);\n\n                            var loadComplete = function loadComplete() {\n                                dispatch('COMPLETE_LOAD_ITEM', {\n                                    query: id,\n                                    item: item,\n                                    data: {\n                                        source: source,\n                                        success: success,\n                                    },\n                                });\n\n                                listUpdated(dispatch, state);\n                            };\n\n                            // exit\n                            if (shouldPrepareOutput) {\n                                // wait for idle state and then run PREPARE_OUTPUT\n                                dispatch(\n                                    'REQUEST_PREPARE_OUTPUT',\n                                    {\n                                        query: id,\n                                        item: item,\n                                        success: function success(file) {\n                                            dispatch('DID_PREPARE_OUTPUT', { id: id, file: file });\n                                            loadComplete();\n                                        },\n                                    },\n\n                                    true\n                                );\n\n                                return;\n                            }\n\n                            loadComplete();\n                        });\n                    };\n\n                    // item loaded, allow plugins to\n                    // - read data (quickly)\n                    // - add metadata\n                    applyFilterChain('DID_LOAD_ITEM', item, { query: query, dispatch: dispatch })\n                        .then(function() {\n                            optionalPromise(query('GET_BEFORE_ADD_FILE'), createItemAPI(item)).then(\n                                handleAdd\n                            );\n                        })\n                        .catch(function(e) {\n                            if (!e || !e.error || !e.status) return handleAdd(false);\n                            dispatch('DID_THROW_ITEM_INVALID', {\n                                id: id,\n                                error: e.error,\n                                status: e.status,\n                            });\n                        });\n                });\n\n                item.on('process-start', function() {\n                    dispatch('DID_START_ITEM_PROCESSING', { id: id });\n                });\n\n                item.on('process-progress', function(progress) {\n                    dispatch('DID_UPDATE_ITEM_PROCESS_PROGRESS', { id: id, progress: progress });\n                });\n\n                item.on('process-error', function(error) {\n                    dispatch('DID_THROW_ITEM_PROCESSING_ERROR', {\n                        id: id,\n                        error: error,\n                        status: {\n                            main: dynamicLabel(state.options.labelFileProcessingError)(error),\n                            sub: state.options.labelTapToRetry,\n                        },\n                    });\n                });\n\n                item.on('process-revert-error', function(error) {\n                    dispatch('DID_THROW_ITEM_PROCESSING_REVERT_ERROR', {\n                        id: id,\n                        error: error,\n                        status: {\n                            main: dynamicLabel(state.options.labelFileProcessingRevertError)(error),\n                            sub: state.options.labelTapToRetry,\n                        },\n                    });\n                });\n\n                item.on('process-complete', function(serverFileReference) {\n                    dispatch('DID_COMPLETE_ITEM_PROCESSING', {\n                        id: id,\n                        error: null,\n                        serverFileReference: serverFileReference,\n                    });\n\n                    dispatch('DID_DEFINE_VALUE', { id: id, value: serverFileReference });\n                });\n\n                item.on('process-abort', function() {\n                    dispatch('DID_ABORT_ITEM_PROCESSING', { id: id });\n                });\n\n                item.on('process-revert', function() {\n                    dispatch('DID_REVERT_ITEM_PROCESSING', { id: id });\n                    dispatch('DID_DEFINE_VALUE', { id: id, value: null });\n                });\n\n                // let view know the item has been inserted\n                dispatch('DID_ADD_ITEM', {\n                    id: id,\n                    index: index,\n                    interactionMethod: interactionMethod,\n                });\n\n                listUpdated(dispatch, state);\n\n                // start loading the source\n                var _ref8 = state.options.server || {},\n                    url = _ref8.url,\n                    load = _ref8.load,\n                    restore = _ref8.restore,\n                    fetch = _ref8.fetch;\n\n                item.load(\n                    source,\n\n                    // this creates a function that loads the file based on the type of file (string, base64, blob, file) and location of file (local, remote, limbo)\n                    createFileLoader(\n                        origin === FileOrigin.INPUT\n                            ? // input, if is remote, see if should use custom fetch, else use default fetchBlob\n                              isString(source) && isExternalURL(source)\n                                ? fetch\n                                    ? createFetchFunction(url, fetch)\n                                    : fetchBlob // remote url\n                                : fetchBlob // try to fetch url\n                            : // limbo or local\n                            origin === FileOrigin.LIMBO\n                            ? createFetchFunction(url, restore) // limbo\n                            : createFetchFunction(url, load) // local\n                    ),\n\n                    // called when the file is loaded so it can be piped through the filters\n                    function(file, success, error) {\n                        // let's process the file\n                        applyFilterChain('LOAD_FILE', file, { query: query })\n                            .then(success)\n                            .catch(error);\n                    }\n                );\n            },\n\n            REQUEST_PREPARE_OUTPUT: function REQUEST_PREPARE_OUTPUT(_ref9) {\n                var item = _ref9.item,\n                    success = _ref9.success,\n                    _ref9$failure = _ref9.failure,\n                    failure = _ref9$failure === void 0 ? function() {} : _ref9$failure;\n                // error response if item archived\n                var err = {\n                    error: createResponse('error', 0, 'Item not found'),\n                    file: null,\n                };\n\n                // don't handle archived items, an item could have been archived (load aborted) while waiting to be prepared\n                if (item.archived) return failure(err);\n\n                // allow plugins to alter the file data\n                applyFilterChain('PREPARE_OUTPUT', item.file, { query: query, item: item }).then(\n                    function(result) {\n                        applyFilterChain('COMPLETE_PREPARE_OUTPUT', result, {\n                            query: query,\n                            item: item,\n                        }).then(function(result) {\n                            // don't handle archived items, an item could have been archived (load aborted) while being prepared\n                            if (item.archived) return failure(err);\n\n                            // we done!\n                            success(result);\n                        });\n                    }\n                );\n            },\n\n            COMPLETE_LOAD_ITEM: function COMPLETE_LOAD_ITEM(_ref10) {\n                var item = _ref10.item,\n                    data = _ref10.data;\n                var success = data.success,\n                    source = data.source;\n\n                // sort items in list\n                var itemInsertLocation = query('GET_ITEM_INSERT_LOCATION');\n                if (isFunction(itemInsertLocation) && source) {\n                    sortItems(state, itemInsertLocation);\n                }\n\n                // let interface know the item has loaded\n                dispatch('DID_LOAD_ITEM', {\n                    id: item.id,\n                    error: null,\n                    serverFileReference: item.origin === FileOrigin.INPUT ? null : source,\n                });\n\n                // item has been successfully loaded and added to the\n                // list of items so can now be safely returned for use\n                success(createItemAPI(item));\n\n                // if this is a local server file we need to show a different state\n                if (item.origin === FileOrigin.LOCAL) {\n                    dispatch('DID_LOAD_LOCAL_ITEM', { id: item.id });\n                    return;\n                }\n\n                // if is a temp server file we prevent async upload call here (as the file is already on the server)\n                if (item.origin === FileOrigin.LIMBO) {\n                    dispatch('DID_COMPLETE_ITEM_PROCESSING', {\n                        id: item.id,\n                        error: null,\n                        serverFileReference: source,\n                    });\n\n                    dispatch('DID_DEFINE_VALUE', {\n                        id: item.id,\n                        value: item.serverId || source,\n                    });\n\n                    return;\n                }\n\n                // id we are allowed to upload the file immediately, lets do it\n                if (query('IS_ASYNC') && state.options.instantUpload) {\n                    dispatch('REQUEST_ITEM_PROCESSING', { query: item.id });\n                }\n            },\n\n            RETRY_ITEM_LOAD: getItemByQueryFromState(state, function(item) {\n                // try loading the source one more time\n                item.retryLoad();\n            }),\n\n            REQUEST_ITEM_PREPARE: getItemByQueryFromState(state, function(item, _success, failure) {\n                dispatch(\n                    'REQUEST_PREPARE_OUTPUT',\n                    {\n                        query: item.id,\n                        item: item,\n                        success: function success(file) {\n                            dispatch('DID_PREPARE_OUTPUT', { id: item.id, file: file });\n                            _success({\n                                file: item,\n                                output: file,\n                            });\n                        },\n                        failure: failure,\n                    },\n\n                    true\n                );\n            }),\n\n            REQUEST_ITEM_PROCESSING: getItemByQueryFromState(state, function(\n                item,\n                success,\n                failure\n            ) {\n                // cannot be queued (or is already queued)\n                var itemCanBeQueuedForProcessing =\n                    // waiting for something\n                    item.status === ItemStatus.IDLE ||\n                    // processing went wrong earlier\n                    item.status === ItemStatus.PROCESSING_ERROR;\n\n                // not ready to be processed\n                if (!itemCanBeQueuedForProcessing) {\n                    var processNow = function processNow() {\n                        return dispatch('REQUEST_ITEM_PROCESSING', {\n                            query: item,\n                            success: success,\n                            failure: failure,\n                        });\n                    };\n\n                    var process = function process() {\n                        return document.hidden ? processNow() : setTimeout(processNow, 32);\n                    };\n\n                    // if already done processing or tried to revert but didn't work, try again\n                    if (\n                        item.status === ItemStatus.PROCESSING_COMPLETE ||\n                        item.status === ItemStatus.PROCESSING_REVERT_ERROR\n                    ) {\n                        item.revert(\n                            createRevertFunction(\n                                state.options.server.url,\n                                state.options.server.revert\n                            ),\n                            query('GET_FORCE_REVERT')\n                        )\n                            .then(process)\n                            .catch(function() {}); // don't continue with processing if something went wrong\n                    } else if (item.status === ItemStatus.PROCESSING) {\n                        item.abortProcessing().then(process);\n                    }\n\n                    return;\n                }\n\n                // already queued for processing\n                if (item.status === ItemStatus.PROCESSING_QUEUED) return;\n\n                item.requestProcessing();\n\n                dispatch('DID_REQUEST_ITEM_PROCESSING', { id: item.id });\n\n                dispatch('PROCESS_ITEM', { query: item, success: success, failure: failure }, true);\n            }),\n\n            PROCESS_ITEM: getItemByQueryFromState(state, function(item, success, failure) {\n                var maxParallelUploads = query('GET_MAX_PARALLEL_UPLOADS');\n                var totalCurrentUploads = query('GET_ITEMS_BY_STATUS', ItemStatus.PROCESSING)\n                    .length;\n\n                // queue and wait till queue is freed up\n                if (totalCurrentUploads === maxParallelUploads) {\n                    // queue for later processing\n                    state.processingQueue.push({\n                        id: item.id,\n                        success: success,\n                        failure: failure,\n                    });\n\n                    // stop it!\n                    return;\n                }\n\n                // if was not queued or is already processing exit here\n                if (item.status === ItemStatus.PROCESSING) return;\n\n                var processNext = function processNext() {\n                    // process queueud items\n                    var queueEntry = state.processingQueue.shift();\n\n                    // no items left\n                    if (!queueEntry) return;\n\n                    // get item reference\n                    var id = queueEntry.id,\n                        success = queueEntry.success,\n                        failure = queueEntry.failure;\n                    var itemReference = getItemByQuery(state.items, id);\n\n                    // if item was archived while in queue, jump to next\n                    if (!itemReference || itemReference.archived) {\n                        processNext();\n                        return;\n                    }\n\n                    // process queued item\n                    dispatch(\n                        'PROCESS_ITEM',\n                        { query: id, success: success, failure: failure },\n                        true\n                    );\n                };\n\n                // we done function\n                item.onOnce('process-complete', function() {\n                    success(createItemAPI(item));\n                    processNext();\n\n                    // if origin is local, and we're instant uploading, trigger remove of original\n                    // as revert will remove file from list\n                    var server = state.options.server;\n                    var instantUpload = state.options.instantUpload;\n                    if (\n                        instantUpload &&\n                        item.origin === FileOrigin.LOCAL &&\n                        isFunction(server.remove)\n                    ) {\n                        var noop = function noop() {};\n                        item.origin = FileOrigin.LIMBO;\n                        state.options.server.remove(item.source, noop, noop);\n                    }\n\n                    // All items processed? No errors?\n                    var allItemsProcessed =\n                        query('GET_ITEMS_BY_STATUS', ItemStatus.PROCESSING_COMPLETE).length ===\n                        state.items.length;\n                    if (allItemsProcessed) {\n                        dispatch('DID_COMPLETE_ITEM_PROCESSING_ALL');\n                    }\n                });\n\n                // we error function\n                item.onOnce('process-error', function(error) {\n                    failure({ error: error, file: createItemAPI(item) });\n                    processNext();\n                });\n\n                // start file processing\n                var options = state.options;\n                item.process(\n                    createFileProcessor(\n                        createProcessorFunction(\n                            options.server.url,\n                            options.server.process,\n                            options.name,\n                            {\n                                chunkTransferId: item.transferId,\n                                chunkServer: options.server.patch,\n                                chunkUploads: options.chunkUploads,\n                                chunkForce: options.chunkForce,\n                                chunkSize: options.chunkSize,\n                                chunkRetryDelays: options.chunkRetryDelays,\n                            }\n                        ),\n\n                        {\n                            allowMinimumUploadDuration: query('GET_ALLOW_MINIMUM_UPLOAD_DURATION'),\n                        }\n                    ),\n\n                    // called when the file is about to be processed so it can be piped through the transform filters\n                    function(file, success, error) {\n                        // allow plugins to alter the file data\n                        applyFilterChain('PREPARE_OUTPUT', file, { query: query, item: item })\n                            .then(function(file) {\n                                dispatch('DID_PREPARE_OUTPUT', { id: item.id, file: file });\n\n                                success(file);\n                            })\n                            .catch(error);\n                    }\n                );\n            }),\n\n            RETRY_ITEM_PROCESSING: getItemByQueryFromState(state, function(item) {\n                dispatch('REQUEST_ITEM_PROCESSING', { query: item });\n            }),\n\n            REQUEST_REMOVE_ITEM: getItemByQueryFromState(state, function(item) {\n                optionalPromise(query('GET_BEFORE_REMOVE_FILE'), createItemAPI(item)).then(function(\n                    shouldRemove\n                ) {\n                    if (!shouldRemove) {\n                        return;\n                    }\n                    dispatch('REMOVE_ITEM', { query: item });\n                });\n            }),\n\n            RELEASE_ITEM: getItemByQueryFromState(state, function(item) {\n                item.release();\n            }),\n\n            REMOVE_ITEM: getItemByQueryFromState(state, function(item, success, failure, options) {\n                var removeFromView = function removeFromView() {\n                    // get id reference\n                    var id = item.id;\n\n                    // archive the item, this does not remove it from the list\n                    getItemById(state.items, id).archive();\n\n                    // tell the view the item has been removed\n                    dispatch('DID_REMOVE_ITEM', { error: null, id: id, item: item });\n\n                    // now the list has been modified\n                    listUpdated(dispatch, state);\n\n                    // correctly removed\n                    success(createItemAPI(item));\n                };\n\n                // if this is a local file and the `server.remove` function has been configured,\n                // send source there so dev can remove file from server\n                var server = state.options.server;\n                if (\n                    item.origin === FileOrigin.LOCAL &&\n                    server &&\n                    isFunction(server.remove) &&\n                    options.remove !== false\n                ) {\n                    dispatch('DID_START_ITEM_REMOVE', { id: item.id });\n\n                    server.remove(\n                        item.source,\n                        function() {\n                            return removeFromView();\n                        },\n                        function(status) {\n                            dispatch('DID_THROW_ITEM_REMOVE_ERROR', {\n                                id: item.id,\n                                error: createResponse('error', 0, status, null),\n                                status: {\n                                    main: dynamicLabel(state.options.labelFileRemoveError)(status),\n                                    sub: state.options.labelTapToRetry,\n                                },\n                            });\n                        }\n                    );\n                } else {\n                    // if is requesting revert and can revert need to call revert handler (not calling request_ because that would also trigger beforeRemoveHook)\n                    if (\n                        (options.revert &&\n                            item.origin !== FileOrigin.LOCAL &&\n                            item.serverId !== null) ||\n                        // if chunked uploads are enabled and we're uploading in chunks for this specific file\n                        // or if the file isn't big enough for chunked uploads but chunkForce is set then call\n                        // revert before removing from the view...\n                        (state.options.chunkUploads && item.file.size > state.options.chunkSize) ||\n                        (state.options.chunkUploads && state.options.chunkForce)\n                    ) {\n                        item.revert(\n                            createRevertFunction(\n                                state.options.server.url,\n                                state.options.server.revert\n                            ),\n                            query('GET_FORCE_REVERT')\n                        );\n                    }\n\n                    // can now safely remove from view\n                    removeFromView();\n                }\n            }),\n\n            ABORT_ITEM_LOAD: getItemByQueryFromState(state, function(item) {\n                item.abortLoad();\n            }),\n\n            ABORT_ITEM_PROCESSING: getItemByQueryFromState(state, function(item) {\n                // test if is already processed\n                if (item.serverId) {\n                    dispatch('REVERT_ITEM_PROCESSING', { id: item.id });\n                    return;\n                }\n\n                // abort\n                item.abortProcessing().then(function() {\n                    var shouldRemove = state.options.instantUpload;\n                    if (shouldRemove) {\n                        dispatch('REMOVE_ITEM', { query: item.id });\n                    }\n                });\n            }),\n\n            REQUEST_REVERT_ITEM_PROCESSING: getItemByQueryFromState(state, function(item) {\n                // not instant uploading, revert immediately\n                if (!state.options.instantUpload) {\n                    dispatch('REVERT_ITEM_PROCESSING', { query: item });\n                    return;\n                }\n\n                // if we're instant uploading the file will also be removed if we revert,\n                // so if a before remove file hook is defined we need to run it now\n                var handleRevert = function handleRevert(shouldRevert) {\n                    if (!shouldRevert) return;\n                    dispatch('REVERT_ITEM_PROCESSING', { query: item });\n                };\n\n                var fn = query('GET_BEFORE_REMOVE_FILE');\n                if (!fn) {\n                    return handleRevert(true);\n                }\n\n                var requestRemoveResult = fn(createItemAPI(item));\n                if (requestRemoveResult == null) {\n                    // undefined or null\n                    return handleRevert(true);\n                }\n\n                if (typeof requestRemoveResult === 'boolean') {\n                    return handleRevert(requestRemoveResult);\n                }\n\n                if (typeof requestRemoveResult.then === 'function') {\n                    requestRemoveResult.then(handleRevert);\n                }\n            }),\n\n            REVERT_ITEM_PROCESSING: getItemByQueryFromState(state, function(item) {\n                item.revert(\n                    createRevertFunction(state.options.server.url, state.options.server.revert),\n                    query('GET_FORCE_REVERT')\n                )\n                    .then(function() {\n                        var shouldRemove = state.options.instantUpload || isMockItem(item);\n                        if (shouldRemove) {\n                            dispatch('REMOVE_ITEM', { query: item.id });\n                        }\n                    })\n                    .catch(function() {});\n            }),\n\n            SET_OPTIONS: function SET_OPTIONS(_ref11) {\n                var options = _ref11.options;\n                // get all keys passed\n                var optionKeys = Object.keys(options);\n\n                // get prioritized keyed to include (remove once not in options object)\n                var prioritizedOptionKeys = PrioritizedOptions.filter(function(key) {\n                    return optionKeys.includes(key);\n                });\n\n                // order the keys, prioritized first, then rest\n                var orderedOptionKeys = [].concat(\n                    _toConsumableArray(prioritizedOptionKeys),\n                    _toConsumableArray(\n                        Object.keys(options).filter(function(key) {\n                            return !prioritizedOptionKeys.includes(key);\n                        })\n                    )\n                );\n\n                // dispatch set event for each option\n                orderedOptionKeys.forEach(function(key) {\n                    dispatch('SET_' + fromCamels(key, '_').toUpperCase(), {\n                        value: options[key],\n                    });\n                });\n            },\n        };\n    };\n\n    var PrioritizedOptions = ['server'];\n\n    var formatFilename = function formatFilename(name) {\n        return name;\n    };\n\n    var createElement$1 = function createElement(tagName) {\n        return document.createElement(tagName);\n    };\n\n    var text = function text(node, value) {\n        var textNode = node.childNodes[0];\n        if (!textNode) {\n            textNode = document.createTextNode(value);\n            node.appendChild(textNode);\n        } else if (value !== textNode.nodeValue) {\n            textNode.nodeValue = value;\n        }\n    };\n\n    var polarToCartesian = function polarToCartesian(centerX, centerY, radius, angleInDegrees) {\n        var angleInRadians = (((angleInDegrees % 360) - 90) * Math.PI) / 180.0;\n        return {\n            x: centerX + radius * Math.cos(angleInRadians),\n            y: centerY + radius * Math.sin(angleInRadians),\n        };\n    };\n\n    var describeArc = function describeArc(x, y, radius, startAngle, endAngle, arcSweep) {\n        var start = polarToCartesian(x, y, radius, endAngle);\n        var end = polarToCartesian(x, y, radius, startAngle);\n        return ['M', start.x, start.y, 'A', radius, radius, 0, arcSweep, 0, end.x, end.y].join(' ');\n    };\n\n    var percentageArc = function percentageArc(x, y, radius, from, to) {\n        var arcSweep = 1;\n        if (to > from && to - from <= 0.5) {\n            arcSweep = 0;\n        }\n        if (from > to && from - to >= 0.5) {\n            arcSweep = 0;\n        }\n        return describeArc(\n            x,\n            y,\n            radius,\n            Math.min(0.9999, from) * 360,\n            Math.min(0.9999, to) * 360,\n            arcSweep\n        );\n    };\n\n    var create = function create(_ref) {\n        var root = _ref.root,\n            props = _ref.props;\n        // start at 0\n        props.spin = false;\n        props.progress = 0;\n        props.opacity = 0;\n\n        // svg\n        var svg = createElement('svg');\n        root.ref.path = createElement('path', {\n            'stroke-width': 2,\n            'stroke-linecap': 'round',\n        });\n\n        svg.appendChild(root.ref.path);\n\n        root.ref.svg = svg;\n\n        root.appendChild(svg);\n    };\n\n    var write = function write(_ref2) {\n        var root = _ref2.root,\n            props = _ref2.props;\n        if (props.opacity === 0) {\n            return;\n        }\n\n        if (props.align) {\n            root.element.dataset.align = props.align;\n        }\n\n        // get width of stroke\n        var ringStrokeWidth = parseInt(attr(root.ref.path, 'stroke-width'), 10);\n\n        // calculate size of ring\n        var size = root.rect.element.width * 0.5;\n\n        // ring state\n        var ringFrom = 0;\n        var ringTo = 0;\n\n        // now in busy mode\n        if (props.spin) {\n            ringFrom = 0;\n            ringTo = 0.5;\n        } else {\n            ringFrom = 0;\n            ringTo = props.progress;\n        }\n\n        // get arc path\n        var coordinates = percentageArc(size, size, size - ringStrokeWidth, ringFrom, ringTo);\n\n        // update progress bar\n        attr(root.ref.path, 'd', coordinates);\n\n        // hide while contains 0 value\n        attr(root.ref.path, 'stroke-opacity', props.spin || props.progress > 0 ? 1 : 0);\n    };\n\n    var progressIndicator = createView({\n        tag: 'div',\n        name: 'progress-indicator',\n        ignoreRectUpdate: true,\n        ignoreRect: true,\n        create: create,\n        write: write,\n        mixins: {\n            apis: ['progress', 'spin', 'align'],\n            styles: ['opacity'],\n            animations: {\n                opacity: { type: 'tween', duration: 500 },\n                progress: {\n                    type: 'spring',\n                    stiffness: 0.95,\n                    damping: 0.65,\n                    mass: 10,\n                },\n            },\n        },\n    });\n\n    var create$1 = function create(_ref) {\n        var root = _ref.root,\n            props = _ref.props;\n        root.element.innerHTML = (props.icon || '') + ('<span>' + props.label + '</span>');\n\n        props.isDisabled = false;\n    };\n\n    var write$1 = function write(_ref2) {\n        var root = _ref2.root,\n            props = _ref2.props;\n        var isDisabled = props.isDisabled;\n        var shouldDisable = root.query('GET_DISABLED') || props.opacity === 0;\n\n        if (shouldDisable && !isDisabled) {\n            props.isDisabled = true;\n            attr(root.element, 'disabled', 'disabled');\n        } else if (!shouldDisable && isDisabled) {\n            props.isDisabled = false;\n            root.element.removeAttribute('disabled');\n        }\n    };\n\n    var fileActionButton = createView({\n        tag: 'button',\n        attributes: {\n            type: 'button',\n        },\n\n        ignoreRect: true,\n        ignoreRectUpdate: true,\n        name: 'file-action-button',\n        mixins: {\n            apis: ['label'],\n            styles: ['translateX', 'translateY', 'scaleX', 'scaleY', 'opacity'],\n            animations: {\n                scaleX: 'spring',\n                scaleY: 'spring',\n                translateX: 'spring',\n                translateY: 'spring',\n                opacity: { type: 'tween', duration: 250 },\n            },\n\n            listeners: true,\n        },\n\n        create: create$1,\n        write: write$1,\n    });\n\n    var toNaturalFileSize = function toNaturalFileSize(bytes) {\n        var decimalSeparator =\n            arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : '.';\n        var base = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 1000;\n        var options = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {};\n        var _options$labelBytes = options.labelBytes,\n            labelBytes = _options$labelBytes === void 0 ? 'bytes' : _options$labelBytes,\n            _options$labelKilobyt = options.labelKilobytes,\n            labelKilobytes = _options$labelKilobyt === void 0 ? 'KB' : _options$labelKilobyt,\n            _options$labelMegabyt = options.labelMegabytes,\n            labelMegabytes = _options$labelMegabyt === void 0 ? 'MB' : _options$labelMegabyt,\n            _options$labelGigabyt = options.labelGigabytes,\n            labelGigabytes = _options$labelGigabyt === void 0 ? 'GB' : _options$labelGigabyt;\n\n        // no negative byte sizes\n        bytes = Math.round(Math.abs(bytes));\n\n        var KB = base;\n        var MB = base * base;\n        var GB = base * base * base;\n\n        // just bytes\n        if (bytes < KB) {\n            return bytes + ' ' + labelBytes;\n        }\n\n        // kilobytes\n        if (bytes < MB) {\n            return Math.floor(bytes / KB) + ' ' + labelKilobytes;\n        }\n\n        // megabytes\n        if (bytes < GB) {\n            return removeDecimalsWhenZero(bytes / MB, 1, decimalSeparator) + ' ' + labelMegabytes;\n        }\n\n        // gigabytes\n        return removeDecimalsWhenZero(bytes / GB, 2, decimalSeparator) + ' ' + labelGigabytes;\n    };\n\n    var removeDecimalsWhenZero = function removeDecimalsWhenZero(value, decimalCount, separator) {\n        return value\n            .toFixed(decimalCount)\n            .split('.')\n            .filter(function(part) {\n                return part !== '0';\n            })\n            .join(separator);\n    };\n\n    var create$2 = function create(_ref) {\n        var root = _ref.root,\n            props = _ref.props;\n        // filename\n        var fileName = createElement$1('span');\n        fileName.className = 'filepond--file-info-main';\n        // hide for screenreaders\n        // the file is contained in a fieldset with legend that contains the filename\n        // no need to read it twice\n        attr(fileName, 'aria-hidden', 'true');\n        root.appendChild(fileName);\n        root.ref.fileName = fileName;\n\n        // filesize\n        var fileSize = createElement$1('span');\n        fileSize.className = 'filepond--file-info-sub';\n        root.appendChild(fileSize);\n        root.ref.fileSize = fileSize;\n\n        // set initial values\n        text(fileSize, root.query('GET_LABEL_FILE_WAITING_FOR_SIZE'));\n        text(fileName, formatFilename(root.query('GET_ITEM_NAME', props.id)));\n    };\n\n    var updateFile = function updateFile(_ref2) {\n        var root = _ref2.root,\n            props = _ref2.props;\n        text(\n            root.ref.fileSize,\n            toNaturalFileSize(\n                root.query('GET_ITEM_SIZE', props.id),\n                '.',\n                root.query('GET_FILE_SIZE_BASE'),\n                root.query('GET_FILE_SIZE_LABELS', root.query)\n            )\n        );\n\n        text(root.ref.fileName, formatFilename(root.query('GET_ITEM_NAME', props.id)));\n    };\n\n    var updateFileSizeOnError = function updateFileSizeOnError(_ref3) {\n        var root = _ref3.root,\n            props = _ref3.props;\n        // if size is available don't fallback to unknown size message\n        if (isInt(root.query('GET_ITEM_SIZE', props.id))) {\n            updateFile({ root: root, props: props });\n            return;\n        }\n\n        text(root.ref.fileSize, root.query('GET_LABEL_FILE_SIZE_NOT_AVAILABLE'));\n    };\n\n    var fileInfo = createView({\n        name: 'file-info',\n        ignoreRect: true,\n        ignoreRectUpdate: true,\n        write: createRoute({\n            DID_LOAD_ITEM: updateFile,\n            DID_UPDATE_ITEM_META: updateFile,\n            DID_THROW_ITEM_LOAD_ERROR: updateFileSizeOnError,\n            DID_THROW_ITEM_INVALID: updateFileSizeOnError,\n        }),\n\n        didCreateView: function didCreateView(root) {\n            applyFilters('CREATE_VIEW', Object.assign({}, root, { view: root }));\n        },\n        create: create$2,\n        mixins: {\n            styles: ['translateX', 'translateY'],\n            animations: {\n                translateX: 'spring',\n                translateY: 'spring',\n            },\n        },\n    });\n\n    var toPercentage = function toPercentage(value) {\n        return Math.round(value * 100);\n    };\n\n    var create$3 = function create(_ref) {\n        var root = _ref.root;\n\n        // main status\n        var main = createElement$1('span');\n        main.className = 'filepond--file-status-main';\n        root.appendChild(main);\n        root.ref.main = main;\n\n        // sub status\n        var sub = createElement$1('span');\n        sub.className = 'filepond--file-status-sub';\n        root.appendChild(sub);\n        root.ref.sub = sub;\n\n        didSetItemLoadProgress({ root: root, action: { progress: null } });\n    };\n\n    var didSetItemLoadProgress = function didSetItemLoadProgress(_ref2) {\n        var root = _ref2.root,\n            action = _ref2.action;\n        var title =\n            action.progress === null\n                ? root.query('GET_LABEL_FILE_LOADING')\n                : root.query('GET_LABEL_FILE_LOADING') + ' ' + toPercentage(action.progress) + '%';\n\n        text(root.ref.main, title);\n        text(root.ref.sub, root.query('GET_LABEL_TAP_TO_CANCEL'));\n    };\n\n    var didSetItemProcessProgress = function didSetItemProcessProgress(_ref3) {\n        var root = _ref3.root,\n            action = _ref3.action;\n        var title =\n            action.progress === null\n                ? root.query('GET_LABEL_FILE_PROCESSING')\n                : root.query('GET_LABEL_FILE_PROCESSING') +\n                  ' ' +\n                  toPercentage(action.progress) +\n                  '%';\n\n        text(root.ref.main, title);\n        text(root.ref.sub, root.query('GET_LABEL_TAP_TO_CANCEL'));\n    };\n\n    var didRequestItemProcessing = function didRequestItemProcessing(_ref4) {\n        var root = _ref4.root;\n        text(root.ref.main, root.query('GET_LABEL_FILE_PROCESSING'));\n        text(root.ref.sub, root.query('GET_LABEL_TAP_TO_CANCEL'));\n    };\n\n    var didAbortItemProcessing = function didAbortItemProcessing(_ref5) {\n        var root = _ref5.root;\n        text(root.ref.main, root.query('GET_LABEL_FILE_PROCESSING_ABORTED'));\n        text(root.ref.sub, root.query('GET_LABEL_TAP_TO_RETRY'));\n    };\n\n    var didCompleteItemProcessing = function didCompleteItemProcessing(_ref6) {\n        var root = _ref6.root;\n        text(root.ref.main, root.query('GET_LABEL_FILE_PROCESSING_COMPLETE'));\n        text(root.ref.sub, root.query('GET_LABEL_TAP_TO_UNDO'));\n    };\n\n    var clear = function clear(_ref7) {\n        var root = _ref7.root;\n        text(root.ref.main, '');\n        text(root.ref.sub, '');\n    };\n\n    var error = function error(_ref8) {\n        var root = _ref8.root,\n            action = _ref8.action;\n        text(root.ref.main, action.status.main);\n        text(root.ref.sub, action.status.sub);\n    };\n\n    var fileStatus = createView({\n        name: 'file-status',\n        ignoreRect: true,\n        ignoreRectUpdate: true,\n        write: createRoute({\n            DID_LOAD_ITEM: clear,\n            DID_REVERT_ITEM_PROCESSING: clear,\n            DID_REQUEST_ITEM_PROCESSING: didRequestItemProcessing,\n            DID_ABORT_ITEM_PROCESSING: didAbortItemProcessing,\n            DID_COMPLETE_ITEM_PROCESSING: didCompleteItemProcessing,\n            DID_UPDATE_ITEM_PROCESS_PROGRESS: didSetItemProcessProgress,\n            DID_UPDATE_ITEM_LOAD_PROGRESS: didSetItemLoadProgress,\n            DID_THROW_ITEM_LOAD_ERROR: error,\n            DID_THROW_ITEM_INVALID: error,\n            DID_THROW_ITEM_PROCESSING_ERROR: error,\n            DID_THROW_ITEM_PROCESSING_REVERT_ERROR: error,\n            DID_THROW_ITEM_REMOVE_ERROR: error,\n        }),\n\n        didCreateView: function didCreateView(root) {\n            applyFilters('CREATE_VIEW', Object.assign({}, root, { view: root }));\n        },\n        create: create$3,\n        mixins: {\n            styles: ['translateX', 'translateY', 'opacity'],\n            animations: {\n                opacity: { type: 'tween', duration: 250 },\n                translateX: 'spring',\n                translateY: 'spring',\n            },\n        },\n    });\n\n    /**\n     * Button definitions for the file view\n     */\n\n    var Buttons = {\n        AbortItemLoad: {\n            label: 'GET_LABEL_BUTTON_ABORT_ITEM_LOAD',\n            action: 'ABORT_ITEM_LOAD',\n            className: 'filepond--action-abort-item-load',\n            align: 'LOAD_INDICATOR_POSITION', // right\n        },\n        RetryItemLoad: {\n            label: 'GET_LABEL_BUTTON_RETRY_ITEM_LOAD',\n            action: 'RETRY_ITEM_LOAD',\n            icon: 'GET_ICON_RETRY',\n            className: 'filepond--action-retry-item-load',\n            align: 'BUTTON_PROCESS_ITEM_POSITION', // right\n        },\n        RemoveItem: {\n            label: 'GET_LABEL_BUTTON_REMOVE_ITEM',\n            action: 'REQUEST_REMOVE_ITEM',\n            icon: 'GET_ICON_REMOVE',\n            className: 'filepond--action-remove-item',\n            align: 'BUTTON_REMOVE_ITEM_POSITION', // left\n        },\n        ProcessItem: {\n            label: 'GET_LABEL_BUTTON_PROCESS_ITEM',\n            action: 'REQUEST_ITEM_PROCESSING',\n            icon: 'GET_ICON_PROCESS',\n            className: 'filepond--action-process-item',\n            align: 'BUTTON_PROCESS_ITEM_POSITION', // right\n        },\n        AbortItemProcessing: {\n            label: 'GET_LABEL_BUTTON_ABORT_ITEM_PROCESSING',\n            action: 'ABORT_ITEM_PROCESSING',\n            className: 'filepond--action-abort-item-processing',\n            align: 'BUTTON_PROCESS_ITEM_POSITION', // right\n        },\n        RetryItemProcessing: {\n            label: 'GET_LABEL_BUTTON_RETRY_ITEM_PROCESSING',\n            action: 'RETRY_ITEM_PROCESSING',\n            icon: 'GET_ICON_RETRY',\n            className: 'filepond--action-retry-item-processing',\n            align: 'BUTTON_PROCESS_ITEM_POSITION', // right\n        },\n        RevertItemProcessing: {\n            label: 'GET_LABEL_BUTTON_UNDO_ITEM_PROCESSING',\n            action: 'REQUEST_REVERT_ITEM_PROCESSING',\n            icon: 'GET_ICON_UNDO',\n            className: 'filepond--action-revert-item-processing',\n            align: 'BUTTON_PROCESS_ITEM_POSITION', // right\n        },\n    };\n\n    // make a list of buttons, we can then remove buttons from this list if they're disabled\n    var ButtonKeys = [];\n    forin(Buttons, function(key) {\n        ButtonKeys.push(key);\n    });\n\n    var calculateFileInfoOffset = function calculateFileInfoOffset(root) {\n        if (getRemoveIndicatorAligment(root) === 'right') return 0;\n        var buttonRect = root.ref.buttonRemoveItem.rect.element;\n        return buttonRect.hidden ? null : buttonRect.width + buttonRect.left;\n    };\n\n    var calculateButtonWidth = function calculateButtonWidth(root) {\n        var buttonRect = root.ref.buttonAbortItemLoad.rect.element;\n        return buttonRect.width;\n    };\n\n    // Force on full pixels so text stays crips\n    var calculateFileVerticalCenterOffset = function calculateFileVerticalCenterOffset(root) {\n        return Math.floor(root.ref.buttonRemoveItem.rect.element.height / 4);\n    };\n    var calculateFileHorizontalCenterOffset = function calculateFileHorizontalCenterOffset(root) {\n        return Math.floor(root.ref.buttonRemoveItem.rect.element.left / 2);\n    };\n\n    var getLoadIndicatorAlignment = function getLoadIndicatorAlignment(root) {\n        return root.query('GET_STYLE_LOAD_INDICATOR_POSITION');\n    };\n    var getProcessIndicatorAlignment = function getProcessIndicatorAlignment(root) {\n        return root.query('GET_STYLE_PROGRESS_INDICATOR_POSITION');\n    };\n    var getRemoveIndicatorAligment = function getRemoveIndicatorAligment(root) {\n        return root.query('GET_STYLE_BUTTON_REMOVE_ITEM_POSITION');\n    };\n\n    var DefaultStyle = {\n        buttonAbortItemLoad: { opacity: 0 },\n        buttonRetryItemLoad: { opacity: 0 },\n        buttonRemoveItem: { opacity: 0 },\n        buttonProcessItem: { opacity: 0 },\n        buttonAbortItemProcessing: { opacity: 0 },\n        buttonRetryItemProcessing: { opacity: 0 },\n        buttonRevertItemProcessing: { opacity: 0 },\n        loadProgressIndicator: { opacity: 0, align: getLoadIndicatorAlignment },\n        processProgressIndicator: { opacity: 0, align: getProcessIndicatorAlignment },\n        processingCompleteIndicator: { opacity: 0, scaleX: 0.75, scaleY: 0.75 },\n        info: { translateX: 0, translateY: 0, opacity: 0 },\n        status: { translateX: 0, translateY: 0, opacity: 0 },\n    };\n\n    var IdleStyle = {\n        buttonRemoveItem: { opacity: 1 },\n        buttonProcessItem: { opacity: 1 },\n        info: { translateX: calculateFileInfoOffset },\n        status: { translateX: calculateFileInfoOffset },\n    };\n\n    var ProcessingStyle = {\n        buttonAbortItemProcessing: { opacity: 1 },\n        processProgressIndicator: { opacity: 1 },\n        status: { opacity: 1 },\n    };\n\n    var StyleMap = {\n        DID_THROW_ITEM_INVALID: {\n            buttonRemoveItem: { opacity: 1 },\n            info: { translateX: calculateFileInfoOffset },\n            status: { translateX: calculateFileInfoOffset, opacity: 1 },\n        },\n\n        DID_START_ITEM_LOAD: {\n            buttonAbortItemLoad: { opacity: 1 },\n            loadProgressIndicator: { opacity: 1 },\n            status: { opacity: 1 },\n        },\n\n        DID_THROW_ITEM_LOAD_ERROR: {\n            buttonRetryItemLoad: { opacity: 1 },\n            buttonRemoveItem: { opacity: 1 },\n            info: { translateX: calculateFileInfoOffset },\n            status: { opacity: 1 },\n        },\n\n        DID_START_ITEM_REMOVE: {\n            processProgressIndicator: { opacity: 1, align: getRemoveIndicatorAligment },\n            info: { translateX: calculateFileInfoOffset },\n            status: { opacity: 0 },\n        },\n\n        DID_THROW_ITEM_REMOVE_ERROR: {\n            processProgressIndicator: { opacity: 0, align: getRemoveIndicatorAligment },\n            buttonRemoveItem: { opacity: 1 },\n            info: { translateX: calculateFileInfoOffset },\n            status: { opacity: 1, translateX: calculateFileInfoOffset },\n        },\n\n        DID_LOAD_ITEM: IdleStyle,\n        DID_LOAD_LOCAL_ITEM: {\n            buttonRemoveItem: { opacity: 1 },\n            info: { translateX: calculateFileInfoOffset },\n            status: { translateX: calculateFileInfoOffset },\n        },\n\n        DID_START_ITEM_PROCESSING: ProcessingStyle,\n        DID_REQUEST_ITEM_PROCESSING: ProcessingStyle,\n        DID_UPDATE_ITEM_PROCESS_PROGRESS: ProcessingStyle,\n        DID_COMPLETE_ITEM_PROCESSING: {\n            buttonRevertItemProcessing: { opacity: 1 },\n            info: { opacity: 1 },\n            status: { opacity: 1 },\n        },\n\n        DID_THROW_ITEM_PROCESSING_ERROR: {\n            buttonRemoveItem: { opacity: 1 },\n            buttonRetryItemProcessing: { opacity: 1 },\n            status: { opacity: 1 },\n            info: { translateX: calculateFileInfoOffset },\n        },\n\n        DID_THROW_ITEM_PROCESSING_REVERT_ERROR: {\n            buttonRevertItemProcessing: { opacity: 1 },\n            status: { opacity: 1 },\n            info: { opacity: 1 },\n        },\n\n        DID_ABORT_ITEM_PROCESSING: {\n            buttonRemoveItem: { opacity: 1 },\n            buttonProcessItem: { opacity: 1 },\n            info: { translateX: calculateFileInfoOffset },\n            status: { opacity: 1 },\n        },\n\n        DID_REVERT_ITEM_PROCESSING: IdleStyle,\n    };\n\n    // complete indicator view\n    var processingCompleteIndicatorView = createView({\n        create: function create(_ref) {\n            var root = _ref.root;\n            root.element.innerHTML = root.query('GET_ICON_DONE');\n        },\n        name: 'processing-complete-indicator',\n        ignoreRect: true,\n        mixins: {\n            styles: ['scaleX', 'scaleY', 'opacity'],\n            animations: {\n                scaleX: 'spring',\n                scaleY: 'spring',\n                opacity: { type: 'tween', duration: 250 },\n            },\n        },\n    });\n\n    /**\n     * Creates the file view\n     */\n    var create$4 = function create(_ref2) {\n        var root = _ref2.root,\n            props = _ref2.props;\n        // copy Buttons object\n        var LocalButtons = Object.keys(Buttons).reduce(function(prev, curr) {\n            prev[curr] = Object.assign({}, Buttons[curr]);\n            return prev;\n        }, {});\n        var id = props.id;\n\n        // allow reverting upload\n        var allowRevert = root.query('GET_ALLOW_REVERT');\n\n        // allow remove file\n        var allowRemove = root.query('GET_ALLOW_REMOVE');\n\n        // allow processing upload\n        var allowProcess = root.query('GET_ALLOW_PROCESS');\n\n        // is instant uploading, need this to determine the icon of the undo button\n        var instantUpload = root.query('GET_INSTANT_UPLOAD');\n\n        // is async set up\n        var isAsync = root.query('IS_ASYNC');\n\n        // should align remove item buttons\n        var alignRemoveItemButton = root.query('GET_STYLE_BUTTON_REMOVE_ITEM_ALIGN');\n\n        // enabled buttons array\n        var buttonFilter;\n        if (isAsync) {\n            if (allowProcess && !allowRevert) {\n                // only remove revert button\n                buttonFilter = function buttonFilter(key) {\n                    return !/RevertItemProcessing/.test(key);\n                };\n            } else if (!allowProcess && allowRevert) {\n                // only remove process button\n                buttonFilter = function buttonFilter(key) {\n                    return !/ProcessItem|RetryItemProcessing|AbortItemProcessing/.test(key);\n                };\n            } else if (!allowProcess && !allowRevert) {\n                // remove all process buttons\n                buttonFilter = function buttonFilter(key) {\n                    return !/Process/.test(key);\n                };\n            }\n        } else {\n            // no process controls available\n            buttonFilter = function buttonFilter(key) {\n                return !/Process/.test(key);\n            };\n        }\n\n        var enabledButtons = buttonFilter ? ButtonKeys.filter(buttonFilter) : ButtonKeys.concat();\n\n        // update icon and label for revert button when instant uploading\n        if (instantUpload && allowRevert) {\n            LocalButtons['RevertItemProcessing'].label = 'GET_LABEL_BUTTON_REMOVE_ITEM';\n            LocalButtons['RevertItemProcessing'].icon = 'GET_ICON_REMOVE';\n        }\n\n        // remove last button (revert) if not allowed\n        if (isAsync && !allowRevert) {\n            var map = StyleMap['DID_COMPLETE_ITEM_PROCESSING'];\n            map.info.translateX = calculateFileHorizontalCenterOffset;\n            map.info.translateY = calculateFileVerticalCenterOffset;\n            map.status.translateY = calculateFileVerticalCenterOffset;\n            map.processingCompleteIndicator = { opacity: 1, scaleX: 1, scaleY: 1 };\n        }\n\n        // should align center\n        if (isAsync && !allowProcess) {\n            [\n                'DID_START_ITEM_PROCESSING',\n                'DID_REQUEST_ITEM_PROCESSING',\n                'DID_UPDATE_ITEM_PROCESS_PROGRESS',\n                'DID_THROW_ITEM_PROCESSING_ERROR',\n            ].forEach(function(key) {\n                StyleMap[key].status.translateY = calculateFileVerticalCenterOffset;\n            });\n            StyleMap['DID_THROW_ITEM_PROCESSING_ERROR'].status.translateX = calculateButtonWidth;\n        }\n\n        // move remove button to right\n        if (alignRemoveItemButton && allowRevert) {\n            LocalButtons['RevertItemProcessing'].align = 'BUTTON_REMOVE_ITEM_POSITION';\n            var _map = StyleMap['DID_COMPLETE_ITEM_PROCESSING'];\n            _map.info.translateX = calculateFileInfoOffset;\n            _map.status.translateY = calculateFileVerticalCenterOffset;\n            _map.processingCompleteIndicator = { opacity: 1, scaleX: 1, scaleY: 1 };\n        }\n\n        // show/hide RemoveItem button\n        if (!allowRemove) {\n            LocalButtons['RemoveItem'].disabled = true;\n        }\n\n        // create the button views\n        forin(LocalButtons, function(key, definition) {\n            // create button\n            var buttonView = root.createChildView(fileActionButton, {\n                label: root.query(definition.label),\n                icon: root.query(definition.icon),\n                opacity: 0,\n            });\n\n            // should be appended?\n            if (enabledButtons.includes(key)) {\n                root.appendChildView(buttonView);\n            }\n\n            // toggle\n            if (definition.disabled) {\n                buttonView.element.setAttribute('disabled', 'disabled');\n                buttonView.element.setAttribute('hidden', 'hidden');\n            }\n\n            // add position attribute\n            buttonView.element.dataset.align = root.query('GET_STYLE_' + definition.align);\n\n            // add class\n            buttonView.element.classList.add(definition.className);\n\n            // handle interactions\n            buttonView.on('click', function(e) {\n                e.stopPropagation();\n                if (definition.disabled) return;\n                root.dispatch(definition.action, { query: id });\n            });\n\n            // set reference\n            root.ref['button' + key] = buttonView;\n        });\n\n        // checkmark\n        root.ref.processingCompleteIndicator = root.appendChildView(\n            root.createChildView(processingCompleteIndicatorView)\n        );\n\n        root.ref.processingCompleteIndicator.element.dataset.align = root.query(\n            'GET_STYLE_BUTTON_PROCESS_ITEM_POSITION'\n        );\n\n        // create file info view\n        root.ref.info = root.appendChildView(root.createChildView(fileInfo, { id: id }));\n\n        // create file status view\n        root.ref.status = root.appendChildView(root.createChildView(fileStatus, { id: id }));\n\n        // add progress indicators\n        var loadIndicatorView = root.appendChildView(\n            root.createChildView(progressIndicator, {\n                opacity: 0,\n                align: root.query('GET_STYLE_LOAD_INDICATOR_POSITION'),\n            })\n        );\n\n        loadIndicatorView.element.classList.add('filepond--load-indicator');\n        root.ref.loadProgressIndicator = loadIndicatorView;\n\n        var progressIndicatorView = root.appendChildView(\n            root.createChildView(progressIndicator, {\n                opacity: 0,\n                align: root.query('GET_STYLE_PROGRESS_INDICATOR_POSITION'),\n            })\n        );\n\n        progressIndicatorView.element.classList.add('filepond--process-indicator');\n        root.ref.processProgressIndicator = progressIndicatorView;\n\n        // current active styles\n        root.ref.activeStyles = [];\n    };\n\n    var write$2 = function write(_ref3) {\n        var root = _ref3.root,\n            actions = _ref3.actions,\n            props = _ref3.props;\n        // route actions\n        route({ root: root, actions: actions, props: props });\n\n        // select last state change action\n        var action = actions\n            .concat()\n            .filter(function(action) {\n                return /^DID_/.test(action.type);\n            })\n            .reverse()\n            .find(function(action) {\n                return StyleMap[action.type];\n            });\n\n        // a new action happened, let's get the matching styles\n        if (action) {\n            // define new active styles\n            root.ref.activeStyles = [];\n\n            var stylesToApply = StyleMap[action.type];\n            forin(DefaultStyle, function(name, defaultStyles) {\n                // get reference to control\n                var control = root.ref[name];\n\n                // loop over all styles for this control\n                forin(defaultStyles, function(key, defaultValue) {\n                    var value =\n                        stylesToApply[name] && typeof stylesToApply[name][key] !== 'undefined'\n                            ? stylesToApply[name][key]\n                            : defaultValue;\n                    root.ref.activeStyles.push({ control: control, key: key, value: value });\n                });\n            });\n        }\n\n        // apply active styles to element\n        root.ref.activeStyles.forEach(function(_ref4) {\n            var control = _ref4.control,\n                key = _ref4.key,\n                value = _ref4.value;\n            control[key] = typeof value === 'function' ? value(root) : value;\n        });\n    };\n\n    var route = createRoute({\n        DID_SET_LABEL_BUTTON_ABORT_ITEM_PROCESSING: function DID_SET_LABEL_BUTTON_ABORT_ITEM_PROCESSING(\n            _ref5\n        ) {\n            var root = _ref5.root,\n                action = _ref5.action;\n            root.ref.buttonAbortItemProcessing.label = action.value;\n        },\n        DID_SET_LABEL_BUTTON_ABORT_ITEM_LOAD: function DID_SET_LABEL_BUTTON_ABORT_ITEM_LOAD(_ref6) {\n            var root = _ref6.root,\n                action = _ref6.action;\n            root.ref.buttonAbortItemLoad.label = action.value;\n        },\n        DID_SET_LABEL_BUTTON_ABORT_ITEM_REMOVAL: function DID_SET_LABEL_BUTTON_ABORT_ITEM_REMOVAL(\n            _ref7\n        ) {\n            var root = _ref7.root,\n                action = _ref7.action;\n            root.ref.buttonAbortItemRemoval.label = action.value;\n        },\n        DID_REQUEST_ITEM_PROCESSING: function DID_REQUEST_ITEM_PROCESSING(_ref8) {\n            var root = _ref8.root;\n            root.ref.processProgressIndicator.spin = true;\n            root.ref.processProgressIndicator.progress = 0;\n        },\n        DID_START_ITEM_LOAD: function DID_START_ITEM_LOAD(_ref9) {\n            var root = _ref9.root;\n            root.ref.loadProgressIndicator.spin = true;\n            root.ref.loadProgressIndicator.progress = 0;\n        },\n        DID_START_ITEM_REMOVE: function DID_START_ITEM_REMOVE(_ref10) {\n            var root = _ref10.root;\n            root.ref.processProgressIndicator.spin = true;\n            root.ref.processProgressIndicator.progress = 0;\n        },\n        DID_UPDATE_ITEM_LOAD_PROGRESS: function DID_UPDATE_ITEM_LOAD_PROGRESS(_ref11) {\n            var root = _ref11.root,\n                action = _ref11.action;\n            root.ref.loadProgressIndicator.spin = false;\n            root.ref.loadProgressIndicator.progress = action.progress;\n        },\n        DID_UPDATE_ITEM_PROCESS_PROGRESS: function DID_UPDATE_ITEM_PROCESS_PROGRESS(_ref12) {\n            var root = _ref12.root,\n                action = _ref12.action;\n            root.ref.processProgressIndicator.spin = false;\n            root.ref.processProgressIndicator.progress = action.progress;\n        },\n    });\n\n    var file = createView({\n        create: create$4,\n        write: write$2,\n        didCreateView: function didCreateView(root) {\n            applyFilters('CREATE_VIEW', Object.assign({}, root, { view: root }));\n        },\n        name: 'file',\n    });\n\n    /**\n     * Creates the file view\n     */\n    var create$5 = function create(_ref) {\n        var root = _ref.root,\n            props = _ref.props;\n\n        // filename\n        root.ref.fileName = createElement$1('legend');\n        root.appendChild(root.ref.fileName);\n\n        // file appended\n        root.ref.file = root.appendChildView(root.createChildView(file, { id: props.id }));\n\n        // data has moved to data.js\n        root.ref.data = false;\n    };\n\n    /**\n     * Data storage\n     */\n    var didLoadItem = function didLoadItem(_ref2) {\n        var root = _ref2.root,\n            props = _ref2.props;\n        // updates the legend of the fieldset so screenreaders can better group buttons\n        text(root.ref.fileName, formatFilename(root.query('GET_ITEM_NAME', props.id)));\n    };\n\n    var fileWrapper = createView({\n        create: create$5,\n        ignoreRect: true,\n        write: createRoute({\n            DID_LOAD_ITEM: didLoadItem,\n        }),\n\n        didCreateView: function didCreateView(root) {\n            applyFilters('CREATE_VIEW', Object.assign({}, root, { view: root }));\n        },\n        tag: 'fieldset',\n        name: 'file-wrapper',\n    });\n\n    var PANEL_SPRING_PROPS = { type: 'spring', damping: 0.6, mass: 7 };\n\n    var create$6 = function create(_ref) {\n        var root = _ref.root,\n            props = _ref.props;\n        [\n            {\n                name: 'top',\n            },\n\n            {\n                name: 'center',\n                props: {\n                    translateY: null,\n                    scaleY: null,\n                },\n\n                mixins: {\n                    animations: {\n                        scaleY: PANEL_SPRING_PROPS,\n                    },\n\n                    styles: ['translateY', 'scaleY'],\n                },\n            },\n\n            {\n                name: 'bottom',\n                props: {\n                    translateY: null,\n                },\n\n                mixins: {\n                    animations: {\n                        translateY: PANEL_SPRING_PROPS,\n                    },\n\n                    styles: ['translateY'],\n                },\n            },\n        ].forEach(function(section) {\n            createSection(root, section, props.name);\n        });\n\n        root.element.classList.add('filepond--' + props.name);\n\n        root.ref.scalable = null;\n    };\n\n    var createSection = function createSection(root, section, className) {\n        var viewConstructor = createView({\n            name: 'panel-' + section.name + ' filepond--' + className,\n            mixins: section.mixins,\n            ignoreRectUpdate: true,\n        });\n\n        var view = root.createChildView(viewConstructor, section.props);\n\n        root.ref[section.name] = root.appendChildView(view);\n    };\n\n    var write$3 = function write(_ref2) {\n        var root = _ref2.root,\n            props = _ref2.props;\n\n        // update scalable state\n        if (root.ref.scalable === null || props.scalable !== root.ref.scalable) {\n            root.ref.scalable = isBoolean(props.scalable) ? props.scalable : true;\n            root.element.dataset.scalable = root.ref.scalable;\n        }\n\n        // no height, can't set\n        if (!props.height) return;\n\n        // get child rects\n        var topRect = root.ref.top.rect.element;\n        var bottomRect = root.ref.bottom.rect.element;\n\n        // make sure height never is smaller than bottom and top seciton heights combined (will probably never happen, but who knows)\n        var height = Math.max(topRect.height + bottomRect.height, props.height);\n\n        // offset center part\n        root.ref.center.translateY = topRect.height;\n\n        // scale center part\n        // use math ceil to prevent transparent lines because of rounding errors\n        root.ref.center.scaleY = (height - topRect.height - bottomRect.height) / 100;\n\n        // offset bottom part\n        root.ref.bottom.translateY = height - bottomRect.height;\n    };\n\n    var panel = createView({\n        name: 'panel',\n        read: function read(_ref3) {\n            var root = _ref3.root,\n                props = _ref3.props;\n            return (props.heightCurrent = root.ref.bottom.translateY);\n        },\n        write: write$3,\n        create: create$6,\n        ignoreRect: true,\n        mixins: {\n            apis: ['height', 'heightCurrent', 'scalable'],\n        },\n    });\n\n    var createDragHelper = function createDragHelper(items) {\n        var itemIds = items.map(function(item) {\n            return item.id;\n        });\n        var prevIndex = undefined;\n        return {\n            setIndex: function setIndex(index) {\n                prevIndex = index;\n            },\n            getIndex: function getIndex() {\n                return prevIndex;\n            },\n            getItemIndex: function getItemIndex(item) {\n                return itemIds.indexOf(item.id);\n            },\n        };\n    };\n\n    var ITEM_TRANSLATE_SPRING = {\n        type: 'spring',\n        stiffness: 0.75,\n        damping: 0.45,\n        mass: 10,\n    };\n\n    var ITEM_SCALE_SPRING = 'spring';\n\n    var StateMap = {\n        DID_START_ITEM_LOAD: 'busy',\n        DID_UPDATE_ITEM_LOAD_PROGRESS: 'loading',\n        DID_THROW_ITEM_INVALID: 'load-invalid',\n        DID_THROW_ITEM_LOAD_ERROR: 'load-error',\n        DID_LOAD_ITEM: 'idle',\n        DID_THROW_ITEM_REMOVE_ERROR: 'remove-error',\n        DID_START_ITEM_REMOVE: 'busy',\n        DID_START_ITEM_PROCESSING: 'busy processing',\n        DID_REQUEST_ITEM_PROCESSING: 'busy processing',\n        DID_UPDATE_ITEM_PROCESS_PROGRESS: 'processing',\n        DID_COMPLETE_ITEM_PROCESSING: 'processing-complete',\n        DID_THROW_ITEM_PROCESSING_ERROR: 'processing-error',\n        DID_THROW_ITEM_PROCESSING_REVERT_ERROR: 'processing-revert-error',\n        DID_ABORT_ITEM_PROCESSING: 'cancelled',\n        DID_REVERT_ITEM_PROCESSING: 'idle',\n    };\n\n    /**\n     * Creates the file view\n     */\n    var create$7 = function create(_ref) {\n        var root = _ref.root,\n            props = _ref.props;\n\n        // select\n        root.ref.handleClick = function(e) {\n            return root.dispatch('DID_ACTIVATE_ITEM', { id: props.id });\n        };\n\n        // set id\n        root.element.id = 'filepond--item-' + props.id;\n        root.element.addEventListener('click', root.ref.handleClick);\n\n        // file view\n        root.ref.container = root.appendChildView(\n            root.createChildView(fileWrapper, { id: props.id })\n        );\n\n        // file panel\n        root.ref.panel = root.appendChildView(root.createChildView(panel, { name: 'item-panel' }));\n\n        // default start height\n        root.ref.panel.height = null;\n\n        // by default not marked for removal\n        props.markedForRemoval = false;\n\n        // if not allowed to reorder file items, exit here\n        if (!root.query('GET_ALLOW_REORDER')) return;\n\n        // set to idle so shows grab cursor\n        root.element.dataset.dragState = 'idle';\n\n        var grab = function grab(e) {\n            if (!e.isPrimary) return;\n\n            var removedActivateListener = false;\n\n            var origin = {\n                x: e.pageX,\n                y: e.pageY,\n            };\n\n            props.dragOrigin = {\n                x: root.translateX,\n                y: root.translateY,\n            };\n\n            props.dragCenter = {\n                x: e.offsetX,\n                y: e.offsetY,\n            };\n\n            var dragState = createDragHelper(root.query('GET_ACTIVE_ITEMS'));\n\n            root.dispatch('DID_GRAB_ITEM', { id: props.id, dragState: dragState });\n\n            var drag = function drag(e) {\n                if (!e.isPrimary) return;\n\n                e.stopPropagation();\n                e.preventDefault();\n\n                props.dragOffset = {\n                    x: e.pageX - origin.x,\n                    y: e.pageY - origin.y,\n                };\n\n                // if dragged stop listening to clicks, will re-add when done dragging\n                var dist =\n                    props.dragOffset.x * props.dragOffset.x +\n                    props.dragOffset.y * props.dragOffset.y;\n                if (dist > 16 && !removedActivateListener) {\n                    removedActivateListener = true;\n                    root.element.removeEventListener('click', root.ref.handleClick);\n                }\n\n                root.dispatch('DID_DRAG_ITEM', { id: props.id, dragState: dragState });\n            };\n\n            var drop = function drop(e) {\n                if (!e.isPrimary) return;\n\n                document.removeEventListener('pointermove', drag);\n                document.removeEventListener('pointerup', drop);\n\n                props.dragOffset = {\n                    x: e.pageX - origin.x,\n                    y: e.pageY - origin.y,\n                };\n\n                root.dispatch('DID_DROP_ITEM', { id: props.id, dragState: dragState });\n\n                // start listening to clicks again\n                if (removedActivateListener) {\n                    setTimeout(function() {\n                        return root.element.addEventListener('click', root.ref.handleClick);\n                    }, 0);\n                }\n            };\n\n            document.addEventListener('pointermove', drag);\n            document.addEventListener('pointerup', drop);\n        };\n\n        root.element.addEventListener('pointerdown', grab);\n    };\n\n    var route$1 = createRoute({\n        DID_UPDATE_PANEL_HEIGHT: function DID_UPDATE_PANEL_HEIGHT(_ref2) {\n            var root = _ref2.root,\n                action = _ref2.action;\n            root.height = action.height;\n        },\n    });\n\n    var write$4 = createRoute(\n        {\n            DID_GRAB_ITEM: function DID_GRAB_ITEM(_ref3) {\n                var root = _ref3.root,\n                    props = _ref3.props;\n                props.dragOrigin = {\n                    x: root.translateX,\n                    y: root.translateY,\n                };\n            },\n            DID_DRAG_ITEM: function DID_DRAG_ITEM(_ref4) {\n                var root = _ref4.root;\n                root.element.dataset.dragState = 'drag';\n            },\n            DID_DROP_ITEM: function DID_DROP_ITEM(_ref5) {\n                var root = _ref5.root,\n                    props = _ref5.props;\n                props.dragOffset = null;\n                props.dragOrigin = null;\n                root.element.dataset.dragState = 'drop';\n            },\n        },\n        function(_ref6) {\n            var root = _ref6.root,\n                actions = _ref6.actions,\n                props = _ref6.props,\n                shouldOptimize = _ref6.shouldOptimize;\n\n            if (root.element.dataset.dragState === 'drop') {\n                if (root.scaleX <= 1) {\n                    root.element.dataset.dragState = 'idle';\n                }\n            }\n\n            // select last state change action\n            var action = actions\n                .concat()\n                .filter(function(action) {\n                    return /^DID_/.test(action.type);\n                })\n                .reverse()\n                .find(function(action) {\n                    return StateMap[action.type];\n                });\n\n            // no need to set same state twice\n            if (action && action.type !== props.currentState) {\n                // set current state\n                props.currentState = action.type;\n\n                // set state\n                root.element.dataset.filepondItemState = StateMap[props.currentState] || '';\n            }\n\n            // route actions\n            var aspectRatio =\n                root.query('GET_ITEM_PANEL_ASPECT_RATIO') || root.query('GET_PANEL_ASPECT_RATIO');\n            if (!aspectRatio) {\n                route$1({ root: root, actions: actions, props: props });\n                if (!root.height && root.ref.container.rect.element.height > 0) {\n                    root.height = root.ref.container.rect.element.height;\n                }\n            } else if (!shouldOptimize) {\n                root.height = root.rect.element.width * aspectRatio;\n            }\n\n            // sync panel height with item height\n            if (shouldOptimize) {\n                root.ref.panel.height = null;\n            }\n\n            root.ref.panel.height = root.height;\n        }\n    );\n\n    var item = createView({\n        create: create$7,\n        write: write$4,\n        destroy: function destroy(_ref7) {\n            var root = _ref7.root,\n                props = _ref7.props;\n            root.element.removeEventListener('click', root.ref.handleClick);\n            root.dispatch('RELEASE_ITEM', { query: props.id });\n        },\n        tag: 'li',\n        name: 'item',\n        mixins: {\n            apis: [\n                'id',\n                'interactionMethod',\n                'markedForRemoval',\n                'spawnDate',\n                'dragCenter',\n                'dragOrigin',\n                'dragOffset',\n            ],\n            styles: ['translateX', 'translateY', 'scaleX', 'scaleY', 'opacity', 'height'],\n\n            animations: {\n                scaleX: ITEM_SCALE_SPRING,\n                scaleY: ITEM_SCALE_SPRING,\n                translateX: ITEM_TRANSLATE_SPRING,\n                translateY: ITEM_TRANSLATE_SPRING,\n                opacity: { type: 'tween', duration: 150 },\n            },\n        },\n    });\n\n    var getItemsPerRow = function(horizontalSpace, itemWidth) {\n        // add one pixel leeway, when using percentages for item width total items can be 1.99 per row\n\n        return Math.max(1, Math.floor((horizontalSpace + 1) / itemWidth));\n    };\n\n    var getItemIndexByPosition = function getItemIndexByPosition(view, children, positionInView) {\n        if (!positionInView) return;\n\n        var horizontalSpace = view.rect.element.width;\n        // const children = view.childViews;\n        var l = children.length;\n        var last = null;\n\n        // -1, don't move items to accomodate (either add to top or bottom)\n        if (l === 0 || positionInView.top < children[0].rect.element.top) return -1;\n\n        // let's get the item width\n        var item = children[0];\n        var itemRect = item.rect.element;\n        var itemHorizontalMargin = itemRect.marginLeft + itemRect.marginRight;\n        var itemWidth = itemRect.width + itemHorizontalMargin;\n        var itemsPerRow = getItemsPerRow(horizontalSpace, itemWidth);\n\n        // stack\n        if (itemsPerRow === 1) {\n            for (var index = 0; index < l; index++) {\n                var child = children[index];\n                var childMid = child.rect.outer.top + child.rect.element.height * 0.5;\n                if (positionInView.top < childMid) {\n                    return index;\n                }\n            }\n            return l;\n        }\n\n        // grid\n        var itemVerticalMargin = itemRect.marginTop + itemRect.marginBottom;\n        var itemHeight = itemRect.height + itemVerticalMargin;\n        for (var _index = 0; _index < l; _index++) {\n            var indexX = _index % itemsPerRow;\n            var indexY = Math.floor(_index / itemsPerRow);\n\n            var offsetX = indexX * itemWidth;\n            var offsetY = indexY * itemHeight;\n\n            var itemTop = offsetY - itemRect.marginTop;\n            var itemRight = offsetX + itemWidth;\n            var itemBottom = offsetY + itemHeight + itemRect.marginBottom;\n\n            if (positionInView.top < itemBottom && positionInView.top > itemTop) {\n                if (positionInView.left < itemRight) {\n                    return _index;\n                } else if (_index !== l - 1) {\n                    last = _index;\n                } else {\n                    last = null;\n                }\n            }\n        }\n\n        if (last !== null) {\n            return last;\n        }\n\n        return l;\n    };\n\n    var dropAreaDimensions = {\n        height: 0,\n        width: 0,\n        get getHeight() {\n            return this.height;\n        },\n        set setHeight(val) {\n            if (this.height === 0 || val === 0) this.height = val;\n        },\n        get getWidth() {\n            return this.width;\n        },\n        set setWidth(val) {\n            if (this.width === 0 || val === 0) this.width = val;\n        },\n        setDimensions: function setDimensions(height, width) {\n            if (this.height === 0 || height === 0) this.height = height;\n            if (this.width === 0 || width === 0) this.width = width;\n        },\n    };\n\n    var create$8 = function create(_ref) {\n        var root = _ref.root;\n        // need to set role to list as otherwise it won't be read as a list by VoiceOver\n        attr(root.element, 'role', 'list');\n\n        root.ref.lastItemSpanwDate = Date.now();\n    };\n\n    /**\n     * Inserts a new item\n     * @param root\n     * @param action\n     */\n    var addItemView = function addItemView(_ref2) {\n        var root = _ref2.root,\n            action = _ref2.action;\n        var id = action.id,\n            index = action.index,\n            interactionMethod = action.interactionMethod;\n\n        root.ref.addIndex = index;\n\n        var now = Date.now();\n        var spawnDate = now;\n        var opacity = 1;\n\n        if (interactionMethod !== InteractionMethod.NONE) {\n            opacity = 0;\n            var cooldown = root.query('GET_ITEM_INSERT_INTERVAL');\n            var dist = now - root.ref.lastItemSpanwDate;\n            spawnDate = dist < cooldown ? now + (cooldown - dist) : now;\n        }\n\n        root.ref.lastItemSpanwDate = spawnDate;\n\n        root.appendChildView(\n            root.createChildView(\n                // view type\n                item,\n\n                // props\n                {\n                    spawnDate: spawnDate,\n                    id: id,\n                    opacity: opacity,\n                    interactionMethod: interactionMethod,\n                }\n            ),\n\n            index\n        );\n    };\n\n    var moveItem = function moveItem(item, x, y) {\n        var vx = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 0;\n        var vy = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : 1;\n        // set to null to remove animation while dragging\n        if (item.dragOffset) {\n            item.translateX = null;\n            item.translateY = null;\n            item.translateX = item.dragOrigin.x + item.dragOffset.x;\n            item.translateY = item.dragOrigin.y + item.dragOffset.y;\n            item.scaleX = 1.025;\n            item.scaleY = 1.025;\n        } else {\n            item.translateX = x;\n            item.translateY = y;\n\n            if (Date.now() > item.spawnDate) {\n                // reveal element\n                if (item.opacity === 0) {\n                    introItemView(item, x, y, vx, vy);\n                }\n\n                // make sure is default scale every frame\n                item.scaleX = 1;\n                item.scaleY = 1;\n                item.opacity = 1;\n            }\n        }\n    };\n\n    var introItemView = function introItemView(item, x, y, vx, vy) {\n        if (item.interactionMethod === InteractionMethod.NONE) {\n            item.translateX = null;\n            item.translateX = x;\n            item.translateY = null;\n            item.translateY = y;\n        } else if (item.interactionMethod === InteractionMethod.DROP) {\n            item.translateX = null;\n            item.translateX = x - vx * 20;\n\n            item.translateY = null;\n            item.translateY = y - vy * 10;\n\n            item.scaleX = 0.8;\n            item.scaleY = 0.8;\n        } else if (item.interactionMethod === InteractionMethod.BROWSE) {\n            item.translateY = null;\n            item.translateY = y - 30;\n        } else if (item.interactionMethod === InteractionMethod.API) {\n            item.translateX = null;\n            item.translateX = x - 30;\n            item.translateY = null;\n        }\n    };\n\n    /**\n     * Removes an existing item\n     * @param root\n     * @param action\n     */\n    var removeItemView = function removeItemView(_ref3) {\n        var root = _ref3.root,\n            action = _ref3.action;\n        var id = action.id;\n\n        // get the view matching the given id\n        var view = root.childViews.find(function(child) {\n            return child.id === id;\n        });\n\n        // if no view found, exit\n        if (!view) {\n            return;\n        }\n\n        // animate view out of view\n        view.scaleX = 0.9;\n        view.scaleY = 0.9;\n        view.opacity = 0;\n\n        // mark for removal\n        view.markedForRemoval = true;\n    };\n\n    var getItemHeight = function getItemHeight(child) {\n        return (\n            child.rect.element.height +\n            child.rect.element.marginBottom * 0.5 +\n            child.rect.element.marginTop * 0.5\n        );\n    };\n    var getItemWidth = function getItemWidth(child) {\n        return (\n            child.rect.element.width +\n            child.rect.element.marginLeft * 0.5 +\n            child.rect.element.marginRight * 0.5\n        );\n    };\n\n    var dragItem = function dragItem(_ref4) {\n        var root = _ref4.root,\n            action = _ref4.action;\n        var id = action.id,\n            dragState = action.dragState;\n\n        // reference to item\n        var item = root.query('GET_ITEM', { id: id });\n\n        // get the view matching the given id\n        var view = root.childViews.find(function(child) {\n            return child.id === id;\n        });\n\n        var numItems = root.childViews.length;\n        var oldIndex = dragState.getItemIndex(item);\n\n        // if no view found, exit\n        if (!view) return;\n\n        var dragPosition = {\n            x: view.dragOrigin.x + view.dragOffset.x + view.dragCenter.x,\n            y: view.dragOrigin.y + view.dragOffset.y + view.dragCenter.y,\n        };\n\n        // get drag area dimensions\n        var dragHeight = getItemHeight(view);\n        var dragWidth = getItemWidth(view);\n\n        // get rows and columns (There will always be at least one row and one column if a file is present)\n        var cols = Math.floor(root.rect.outer.width / dragWidth);\n        if (cols > numItems) cols = numItems;\n\n        // rows are used to find when we have left the preview area bounding box\n        var rows = Math.floor(numItems / cols + 1);\n\n        dropAreaDimensions.setHeight = dragHeight * rows;\n        dropAreaDimensions.setWidth = dragWidth * cols;\n\n        // get new index of dragged item\n        var location = {\n            y: Math.floor(dragPosition.y / dragHeight),\n            x: Math.floor(dragPosition.x / dragWidth),\n            getGridIndex: function getGridIndex() {\n                if (\n                    dragPosition.y > dropAreaDimensions.getHeight ||\n                    dragPosition.y < 0 ||\n                    dragPosition.x > dropAreaDimensions.getWidth ||\n                    dragPosition.x < 0\n                )\n                    return oldIndex;\n                return this.y * cols + this.x;\n            },\n            getColIndex: function getColIndex() {\n                var items = root.query('GET_ACTIVE_ITEMS');\n                var visibleChildren = root.childViews.filter(function(child) {\n                    return child.rect.element.height;\n                });\n                var children = items.map(function(item) {\n                    return visibleChildren.find(function(childView) {\n                        return childView.id === item.id;\n                    });\n                });\n\n                var currentIndex = children.findIndex(function(child) {\n                    return child === view;\n                });\n                var dragHeight = getItemHeight(view);\n                var l = children.length;\n                var idx = l;\n                var childHeight = 0;\n                var childBottom = 0;\n                var childTop = 0;\n                for (var i = 0; i < l; i++) {\n                    childHeight = getItemHeight(children[i]);\n                    childTop = childBottom;\n                    childBottom = childTop + childHeight;\n                    if (dragPosition.y < childBottom) {\n                        if (currentIndex > i) {\n                            if (dragPosition.y < childTop + dragHeight) {\n                                idx = i;\n                                break;\n                            }\n                            continue;\n                        }\n                        idx = i;\n                        break;\n                    }\n                }\n                return idx;\n            },\n        };\n\n        // get new index\n        var index = cols > 1 ? location.getGridIndex() : location.getColIndex();\n        root.dispatch('MOVE_ITEM', { query: view, index: index });\n\n        // if the index of the item changed, dispatch reorder action\n        var currentIndex = dragState.getIndex();\n\n        if (currentIndex === undefined || currentIndex !== index) {\n            dragState.setIndex(index);\n\n            if (currentIndex === undefined) return;\n\n            root.dispatch('DID_REORDER_ITEMS', {\n                items: root.query('GET_ACTIVE_ITEMS'),\n                origin: oldIndex,\n                target: index,\n            });\n        }\n    };\n\n    /**\n     * Setup action routes\n     */\n    var route$2 = createRoute({\n        DID_ADD_ITEM: addItemView,\n        DID_REMOVE_ITEM: removeItemView,\n        DID_DRAG_ITEM: dragItem,\n    });\n\n    /**\n     * Write to view\n     * @param root\n     * @param actions\n     * @param props\n     */\n    var write$5 = function write(_ref5) {\n        var root = _ref5.root,\n            props = _ref5.props,\n            actions = _ref5.actions,\n            shouldOptimize = _ref5.shouldOptimize;\n        // route actions\n        route$2({ root: root, props: props, actions: actions });\n        var dragCoordinates = props.dragCoordinates;\n\n        // available space on horizontal axis\n        var horizontalSpace = root.rect.element.width;\n\n        // only draw children that have dimensions\n        var visibleChildren = root.childViews.filter(function(child) {\n            return child.rect.element.height;\n        });\n\n        // sort based on current active items\n        var children = root\n            .query('GET_ACTIVE_ITEMS')\n            .map(function(item) {\n                return visibleChildren.find(function(child) {\n                    return child.id === item.id;\n                });\n            })\n            .filter(function(item) {\n                return item;\n            });\n\n        // get index\n        var dragIndex = dragCoordinates\n            ? getItemIndexByPosition(root, children, dragCoordinates)\n            : null;\n\n        // add index is used to reserve the dropped/added item index till the actual item is rendered\n        var addIndex = root.ref.addIndex || null;\n\n        // add index no longer needed till possibly next draw\n        root.ref.addIndex = null;\n\n        var dragIndexOffset = 0;\n        var removeIndexOffset = 0;\n        var addIndexOffset = 0;\n\n        if (children.length === 0) return;\n\n        var childRect = children[0].rect.element;\n        var itemVerticalMargin = childRect.marginTop + childRect.marginBottom;\n        var itemHorizontalMargin = childRect.marginLeft + childRect.marginRight;\n        var itemWidth = childRect.width + itemHorizontalMargin;\n        var itemHeight = childRect.height + itemVerticalMargin;\n        var itemsPerRow = getItemsPerRow(horizontalSpace, itemWidth);\n\n        // stack\n        if (itemsPerRow === 1) {\n            var offsetY = 0;\n            var dragOffset = 0;\n\n            children.forEach(function(child, index) {\n                if (dragIndex) {\n                    var dist = index - dragIndex;\n                    if (dist === -2) {\n                        dragOffset = -itemVerticalMargin * 0.25;\n                    } else if (dist === -1) {\n                        dragOffset = -itemVerticalMargin * 0.75;\n                    } else if (dist === 0) {\n                        dragOffset = itemVerticalMargin * 0.75;\n                    } else if (dist === 1) {\n                        dragOffset = itemVerticalMargin * 0.25;\n                    } else {\n                        dragOffset = 0;\n                    }\n                }\n\n                if (shouldOptimize) {\n                    child.translateX = null;\n                    child.translateY = null;\n                }\n\n                if (!child.markedForRemoval) {\n                    moveItem(child, 0, offsetY + dragOffset);\n                }\n\n                var itemHeight = child.rect.element.height + itemVerticalMargin;\n\n                var visualHeight = itemHeight * (child.markedForRemoval ? child.opacity : 1);\n\n                offsetY += visualHeight;\n            });\n        }\n        // grid\n        else {\n            var prevX = 0;\n            var prevY = 0;\n\n            children.forEach(function(child, index) {\n                if (index === dragIndex) {\n                    dragIndexOffset = 1;\n                }\n\n                if (index === addIndex) {\n                    addIndexOffset += 1;\n                }\n\n                if (child.markedForRemoval && child.opacity < 0.5) {\n                    removeIndexOffset -= 1;\n                }\n\n                var visualIndex = index + addIndexOffset + dragIndexOffset + removeIndexOffset;\n\n                var indexX = visualIndex % itemsPerRow;\n                var indexY = Math.floor(visualIndex / itemsPerRow);\n\n                var offsetX = indexX * itemWidth;\n                var offsetY = indexY * itemHeight;\n\n                var vectorX = Math.sign(offsetX - prevX);\n                var vectorY = Math.sign(offsetY - prevY);\n\n                prevX = offsetX;\n                prevY = offsetY;\n\n                if (child.markedForRemoval) return;\n\n                if (shouldOptimize) {\n                    child.translateX = null;\n                    child.translateY = null;\n                }\n\n                moveItem(child, offsetX, offsetY, vectorX, vectorY);\n            });\n        }\n    };\n\n    /**\n     * Filters actions that are meant specifically for a certain child of the list\n     * @param child\n     * @param actions\n     */\n    var filterSetItemActions = function filterSetItemActions(child, actions) {\n        return actions.filter(function(action) {\n            // if action has an id, filter out actions that don't have this child id\n            if (action.data && action.data.id) {\n                return child.id === action.data.id;\n            }\n\n            // allow all other actions\n            return true;\n        });\n    };\n\n    var list = createView({\n        create: create$8,\n        write: write$5,\n        tag: 'ul',\n        name: 'list',\n        didWriteView: function didWriteView(_ref6) {\n            var root = _ref6.root;\n            root.childViews\n                .filter(function(view) {\n                    return view.markedForRemoval && view.opacity === 0 && view.resting;\n                })\n                .forEach(function(view) {\n                    view._destroy();\n                    root.removeChildView(view);\n                });\n        },\n        filterFrameActionsForChild: filterSetItemActions,\n        mixins: {\n            apis: ['dragCoordinates'],\n        },\n    });\n\n    var create$9 = function create(_ref) {\n        var root = _ref.root,\n            props = _ref.props;\n        root.ref.list = root.appendChildView(root.createChildView(list));\n        props.dragCoordinates = null;\n        props.overflowing = false;\n    };\n\n    var storeDragCoordinates = function storeDragCoordinates(_ref2) {\n        var root = _ref2.root,\n            props = _ref2.props,\n            action = _ref2.action;\n        if (!root.query('GET_ITEM_INSERT_LOCATION_FREEDOM')) return;\n        props.dragCoordinates = {\n            left: action.position.scopeLeft - root.ref.list.rect.element.left,\n            top:\n                action.position.scopeTop -\n                (root.rect.outer.top + root.rect.element.marginTop + root.rect.element.scrollTop),\n        };\n    };\n\n    var clearDragCoordinates = function clearDragCoordinates(_ref3) {\n        var props = _ref3.props;\n        props.dragCoordinates = null;\n    };\n\n    var route$3 = createRoute({\n        DID_DRAG: storeDragCoordinates,\n        DID_END_DRAG: clearDragCoordinates,\n    });\n\n    var write$6 = function write(_ref4) {\n        var root = _ref4.root,\n            props = _ref4.props,\n            actions = _ref4.actions;\n\n        // route actions\n        route$3({ root: root, props: props, actions: actions });\n\n        // current drag position\n        root.ref.list.dragCoordinates = props.dragCoordinates;\n\n        // if currently overflowing but no longer received overflow\n        if (props.overflowing && !props.overflow) {\n            props.overflowing = false;\n\n            // reset overflow state\n            root.element.dataset.state = '';\n            root.height = null;\n        }\n\n        // if is not overflowing currently but does receive overflow value\n        if (props.overflow) {\n            var newHeight = Math.round(props.overflow);\n            if (newHeight !== root.height) {\n                props.overflowing = true;\n                root.element.dataset.state = 'overflow';\n                root.height = newHeight;\n            }\n        }\n    };\n\n    var listScroller = createView({\n        create: create$9,\n        write: write$6,\n        name: 'list-scroller',\n        mixins: {\n            apis: ['overflow', 'dragCoordinates'],\n            styles: ['height', 'translateY'],\n            animations: {\n                translateY: 'spring',\n            },\n        },\n    });\n\n    var attrToggle = function attrToggle(element, name, state) {\n        var enabledValue = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : '';\n        if (state) {\n            attr(element, name, enabledValue);\n        } else {\n            element.removeAttribute(name);\n        }\n    };\n\n    var resetFileInput = function resetFileInput(input) {\n        // no value, no need to reset\n        if (!input || input.value === '') {\n            return;\n        }\n\n        try {\n            // for modern browsers\n            input.value = '';\n        } catch (err) {}\n\n        // for IE10\n        if (input.value) {\n            // quickly append input to temp form and reset form\n            var form = createElement$1('form');\n            var parentNode = input.parentNode;\n            var ref = input.nextSibling;\n            form.appendChild(input);\n            form.reset();\n\n            // re-inject input where it originally was\n            if (ref) {\n                parentNode.insertBefore(input, ref);\n            } else {\n                parentNode.appendChild(input);\n            }\n        }\n    };\n\n    var create$a = function create(_ref) {\n        var root = _ref.root,\n            props = _ref.props;\n\n        // set id so can be referenced from outside labels\n        root.element.id = 'filepond--browser-' + props.id;\n\n        // set name of element (is removed when a value is set)\n        attr(root.element, 'name', root.query('GET_NAME'));\n\n        // we have to link this element to the status element\n        attr(root.element, 'aria-controls', 'filepond--assistant-' + props.id);\n\n        // set label, we use labelled by as otherwise the screenreader does not read the \"browse\" text in the label (as it has tabindex: 0)\n        attr(root.element, 'aria-labelledby', 'filepond--drop-label-' + props.id);\n\n        // set configurable props\n        setAcceptedFileTypes({\n            root: root,\n            action: { value: root.query('GET_ACCEPTED_FILE_TYPES') },\n        });\n        toggleAllowMultiple({ root: root, action: { value: root.query('GET_ALLOW_MULTIPLE') } });\n        toggleDirectoryFilter({\n            root: root,\n            action: { value: root.query('GET_ALLOW_DIRECTORIES_ONLY') },\n        });\n        toggleDisabled({ root: root });\n        toggleRequired({ root: root, action: { value: root.query('GET_REQUIRED') } });\n        setCaptureMethod({ root: root, action: { value: root.query('GET_CAPTURE_METHOD') } });\n\n        // handle changes to the input field\n        root.ref.handleChange = function(e) {\n            if (!root.element.value) {\n                return;\n            }\n\n            // extract files and move value of webkitRelativePath path to _relativePath\n            var files = Array.from(root.element.files).map(function(file) {\n                file._relativePath = file.webkitRelativePath;\n                return file;\n            });\n\n            // we add a little delay so the OS file select window can move out of the way before we add our file\n            setTimeout(function() {\n                // load files\n                props.onload(files);\n\n                // reset input, it's just for exposing a method to drop files, should not retain any state\n                resetFileInput(root.element);\n            }, 250);\n        };\n\n        root.element.addEventListener('change', root.ref.handleChange);\n    };\n\n    var setAcceptedFileTypes = function setAcceptedFileTypes(_ref2) {\n        var root = _ref2.root,\n            action = _ref2.action;\n        if (!root.query('GET_ALLOW_SYNC_ACCEPT_ATTRIBUTE')) return;\n        attrToggle(\n            root.element,\n            'accept',\n            !!action.value,\n            action.value ? action.value.join(',') : ''\n        );\n    };\n\n    var toggleAllowMultiple = function toggleAllowMultiple(_ref3) {\n        var root = _ref3.root,\n            action = _ref3.action;\n        attrToggle(root.element, 'multiple', action.value);\n    };\n\n    var toggleDirectoryFilter = function toggleDirectoryFilter(_ref4) {\n        var root = _ref4.root,\n            action = _ref4.action;\n        attrToggle(root.element, 'webkitdirectory', action.value);\n    };\n\n    var toggleDisabled = function toggleDisabled(_ref5) {\n        var root = _ref5.root;\n        var isDisabled = root.query('GET_DISABLED');\n        var doesAllowBrowse = root.query('GET_ALLOW_BROWSE');\n        var disableField = isDisabled || !doesAllowBrowse;\n        attrToggle(root.element, 'disabled', disableField);\n    };\n\n    var toggleRequired = function toggleRequired(_ref6) {\n        var root = _ref6.root,\n            action = _ref6.action;\n        // want to remove required, always possible\n        if (!action.value) {\n            attrToggle(root.element, 'required', false);\n        }\n        // if want to make required, only possible when zero items\n        else if (root.query('GET_TOTAL_ITEMS') === 0) {\n            attrToggle(root.element, 'required', true);\n        }\n    };\n\n    var setCaptureMethod = function setCaptureMethod(_ref7) {\n        var root = _ref7.root,\n            action = _ref7.action;\n        attrToggle(\n            root.element,\n            'capture',\n            !!action.value,\n            action.value === true ? '' : action.value\n        );\n    };\n\n    var updateRequiredStatus = function updateRequiredStatus(_ref8) {\n        var root = _ref8.root;\n        var element = root.element;\n        // always remove the required attribute when more than zero items\n        if (root.query('GET_TOTAL_ITEMS') > 0) {\n            attrToggle(element, 'required', false);\n            attrToggle(element, 'name', false);\n        } else {\n            // add name attribute\n            attrToggle(element, 'name', true, root.query('GET_NAME'));\n\n            // remove any validation messages\n            var shouldCheckValidity = root.query('GET_CHECK_VALIDITY');\n            if (shouldCheckValidity) {\n                element.setCustomValidity('');\n            }\n\n            // we only add required if the field has been deemed required\n            if (root.query('GET_REQUIRED')) {\n                attrToggle(element, 'required', true);\n            }\n        }\n    };\n\n    var updateFieldValidityStatus = function updateFieldValidityStatus(_ref9) {\n        var root = _ref9.root;\n        var shouldCheckValidity = root.query('GET_CHECK_VALIDITY');\n        if (!shouldCheckValidity) return;\n        root.element.setCustomValidity(root.query('GET_LABEL_INVALID_FIELD'));\n    };\n\n    var browser = createView({\n        tag: 'input',\n        name: 'browser',\n        ignoreRect: true,\n        ignoreRectUpdate: true,\n        attributes: {\n            type: 'file',\n        },\n\n        create: create$a,\n        destroy: function destroy(_ref10) {\n            var root = _ref10.root;\n            root.element.removeEventListener('change', root.ref.handleChange);\n        },\n        write: createRoute({\n            DID_LOAD_ITEM: updateRequiredStatus,\n            DID_REMOVE_ITEM: updateRequiredStatus,\n            DID_THROW_ITEM_INVALID: updateFieldValidityStatus,\n\n            DID_SET_DISABLED: toggleDisabled,\n            DID_SET_ALLOW_BROWSE: toggleDisabled,\n            DID_SET_ALLOW_DIRECTORIES_ONLY: toggleDirectoryFilter,\n            DID_SET_ALLOW_MULTIPLE: toggleAllowMultiple,\n            DID_SET_ACCEPTED_FILE_TYPES: setAcceptedFileTypes,\n            DID_SET_CAPTURE_METHOD: setCaptureMethod,\n            DID_SET_REQUIRED: toggleRequired,\n        }),\n    });\n\n    var Key = {\n        ENTER: 13,\n        SPACE: 32,\n    };\n\n    var create$b = function create(_ref) {\n        var root = _ref.root,\n            props = _ref.props;\n\n        // create the label and link it to the file browser\n        var label = createElement$1('label');\n        attr(label, 'for', 'filepond--browser-' + props.id);\n\n        // use for labeling file input (aria-labelledby on file input)\n        attr(label, 'id', 'filepond--drop-label-' + props.id);\n\n        // hide the label for screenreaders, the input element will read the contents of the label when it's focussed. If we don't set aria-hidden the screenreader will also navigate the contents of the label separately from the input.\n        attr(label, 'aria-hidden', 'true');\n\n        // handle keys\n        root.ref.handleKeyDown = function(e) {\n            var isActivationKey = e.keyCode === Key.ENTER || e.keyCode === Key.SPACE;\n            if (!isActivationKey) return;\n            // stops from triggering the element a second time\n            e.preventDefault();\n\n            // click link (will then in turn activate file input)\n            root.ref.label.click();\n        };\n\n        root.ref.handleClick = function(e) {\n            var isLabelClick = e.target === label || label.contains(e.target);\n\n            // don't want to click twice\n            if (isLabelClick) return;\n\n            // click link (will then in turn activate file input)\n            root.ref.label.click();\n        };\n\n        // attach events\n        label.addEventListener('keydown', root.ref.handleKeyDown);\n        root.element.addEventListener('click', root.ref.handleClick);\n\n        // update\n        updateLabelValue(label, props.caption);\n\n        // add!\n        root.appendChild(label);\n        root.ref.label = label;\n    };\n\n    var updateLabelValue = function updateLabelValue(label, value) {\n        label.innerHTML = value;\n        var clickable = label.querySelector('.filepond--label-action');\n        if (clickable) {\n            attr(clickable, 'tabindex', '0');\n        }\n        return value;\n    };\n\n    var dropLabel = createView({\n        name: 'drop-label',\n        ignoreRect: true,\n        create: create$b,\n        destroy: function destroy(_ref2) {\n            var root = _ref2.root;\n            root.ref.label.addEventListener('keydown', root.ref.handleKeyDown);\n            root.element.removeEventListener('click', root.ref.handleClick);\n        },\n        write: createRoute({\n            DID_SET_LABEL_IDLE: function DID_SET_LABEL_IDLE(_ref3) {\n                var root = _ref3.root,\n                    action = _ref3.action;\n                updateLabelValue(root.ref.label, action.value);\n            },\n        }),\n\n        mixins: {\n            styles: ['opacity', 'translateX', 'translateY'],\n            animations: {\n                opacity: { type: 'tween', duration: 150 },\n                translateX: 'spring',\n                translateY: 'spring',\n            },\n        },\n    });\n\n    var blob = createView({\n        name: 'drip-blob',\n        ignoreRect: true,\n        mixins: {\n            styles: ['translateX', 'translateY', 'scaleX', 'scaleY', 'opacity'],\n            animations: {\n                scaleX: 'spring',\n                scaleY: 'spring',\n                translateX: 'spring',\n                translateY: 'spring',\n                opacity: { type: 'tween', duration: 250 },\n            },\n        },\n    });\n\n    var addBlob = function addBlob(_ref) {\n        var root = _ref.root;\n        var centerX = root.rect.element.width * 0.5;\n        var centerY = root.rect.element.height * 0.5;\n\n        root.ref.blob = root.appendChildView(\n            root.createChildView(blob, {\n                opacity: 0,\n                scaleX: 2.5,\n                scaleY: 2.5,\n                translateX: centerX,\n                translateY: centerY,\n            })\n        );\n    };\n\n    var moveBlob = function moveBlob(_ref2) {\n        var root = _ref2.root,\n            action = _ref2.action;\n        if (!root.ref.blob) {\n            addBlob({ root: root });\n            return;\n        }\n\n        root.ref.blob.translateX = action.position.scopeLeft;\n        root.ref.blob.translateY = action.position.scopeTop;\n        root.ref.blob.scaleX = 1;\n        root.ref.blob.scaleY = 1;\n        root.ref.blob.opacity = 1;\n    };\n\n    var hideBlob = function hideBlob(_ref3) {\n        var root = _ref3.root;\n        if (!root.ref.blob) {\n            return;\n        }\n        root.ref.blob.opacity = 0;\n    };\n\n    var explodeBlob = function explodeBlob(_ref4) {\n        var root = _ref4.root;\n        if (!root.ref.blob) {\n            return;\n        }\n        root.ref.blob.scaleX = 2.5;\n        root.ref.blob.scaleY = 2.5;\n        root.ref.blob.opacity = 0;\n    };\n\n    var write$7 = function write(_ref5) {\n        var root = _ref5.root,\n            props = _ref5.props,\n            actions = _ref5.actions;\n        route$4({ root: root, props: props, actions: actions });\n        var blob = root.ref.blob;\n\n        if (actions.length === 0 && blob && blob.opacity === 0) {\n            root.removeChildView(blob);\n            root.ref.blob = null;\n        }\n    };\n\n    var route$4 = createRoute({\n        DID_DRAG: moveBlob,\n        DID_DROP: explodeBlob,\n        DID_END_DRAG: hideBlob,\n    });\n\n    var drip = createView({\n        ignoreRect: true,\n        ignoreRectUpdate: true,\n        name: 'drip',\n        write: write$7,\n    });\n\n    var setInputFiles = function setInputFiles(element, files) {\n        try {\n            // Create a DataTransfer instance and add a newly created file\n            var dataTransfer = new DataTransfer();\n            files.forEach(function(file) {\n                if (file instanceof File) {\n                    dataTransfer.items.add(file);\n                } else {\n                    dataTransfer.items.add(\n                        new File([file], file.name, {\n                            type: file.type,\n                        })\n                    );\n                }\n            });\n\n            // Assign the DataTransfer files list to the file input\n            element.files = dataTransfer.files;\n        } catch (err) {\n            return false;\n        }\n        return true;\n    };\n\n    var create$c = function create(_ref) {\n        var root = _ref.root;\n        return (root.ref.fields = {});\n    };\n\n    var getField = function getField(root, id) {\n        return root.ref.fields[id];\n    };\n\n    var syncFieldPositionsWithItems = function syncFieldPositionsWithItems(root) {\n        root.query('GET_ACTIVE_ITEMS').forEach(function(item) {\n            if (!root.ref.fields[item.id]) return;\n            root.element.appendChild(root.ref.fields[item.id]);\n        });\n    };\n\n    var didReorderItems = function didReorderItems(_ref2) {\n        var root = _ref2.root;\n        return syncFieldPositionsWithItems(root);\n    };\n\n    var didAddItem = function didAddItem(_ref3) {\n        var root = _ref3.root,\n            action = _ref3.action;\n        var fileItem = root.query('GET_ITEM', action.id);\n        var isLocalFile = fileItem.origin === FileOrigin.LOCAL;\n        var shouldUseFileInput = !isLocalFile && root.query('SHOULD_UPDATE_FILE_INPUT');\n        var dataContainer = createElement$1('input');\n        dataContainer.type = shouldUseFileInput ? 'file' : 'hidden';\n        dataContainer.name = root.query('GET_NAME');\n        dataContainer.disabled = root.query('GET_DISABLED');\n        root.ref.fields[action.id] = dataContainer;\n        syncFieldPositionsWithItems(root);\n    };\n\n    var didLoadItem$1 = function didLoadItem(_ref4) {\n        var root = _ref4.root,\n            action = _ref4.action;\n        var field = getField(root, action.id);\n        if (!field) return;\n\n        // store server ref in hidden input\n        if (action.serverFileReference !== null) field.value = action.serverFileReference;\n\n        // store file item in file input\n        if (!root.query('SHOULD_UPDATE_FILE_INPUT')) return;\n\n        var fileItem = root.query('GET_ITEM', action.id);\n        setInputFiles(field, [fileItem.file]);\n    };\n\n    var didPrepareOutput = function didPrepareOutput(_ref5) {\n        var root = _ref5.root,\n            action = _ref5.action;\n        // this timeout pushes the handler after 'load'\n        if (!root.query('SHOULD_UPDATE_FILE_INPUT')) return;\n        setTimeout(function() {\n            var field = getField(root, action.id);\n            if (!field) return;\n            setInputFiles(field, [action.file]);\n        }, 0);\n    };\n\n    var didSetDisabled = function didSetDisabled(_ref6) {\n        var root = _ref6.root;\n        root.element.disabled = root.query('GET_DISABLED');\n    };\n\n    var didRemoveItem = function didRemoveItem(_ref7) {\n        var root = _ref7.root,\n            action = _ref7.action;\n        var field = getField(root, action.id);\n        if (!field) return;\n        if (field.parentNode) field.parentNode.removeChild(field);\n        delete root.ref.fields[action.id];\n    };\n\n    // only runs for server files (so doesn't deal with file input)\n    var didDefineValue = function didDefineValue(_ref8) {\n        var root = _ref8.root,\n            action = _ref8.action;\n        var field = getField(root, action.id);\n        if (!field) return;\n        if (action.value === null) {\n            // clear field value\n            field.removeAttribute('value');\n        } else {\n            // set field value\n            field.value = action.value;\n        }\n        syncFieldPositionsWithItems(root);\n    };\n\n    var write$8 = createRoute({\n        DID_SET_DISABLED: didSetDisabled,\n        DID_ADD_ITEM: didAddItem,\n        DID_LOAD_ITEM: didLoadItem$1,\n        DID_REMOVE_ITEM: didRemoveItem,\n        DID_DEFINE_VALUE: didDefineValue,\n        DID_PREPARE_OUTPUT: didPrepareOutput,\n        DID_REORDER_ITEMS: didReorderItems,\n        DID_SORT_ITEMS: didReorderItems,\n    });\n\n    var data = createView({\n        tag: 'fieldset',\n        name: 'data',\n        create: create$c,\n        write: write$8,\n        ignoreRect: true,\n    });\n\n    var getRootNode = function getRootNode(element) {\n        return 'getRootNode' in element ? element.getRootNode() : document;\n    };\n\n    var images = ['jpg', 'jpeg', 'png', 'gif', 'bmp', 'webp', 'svg', 'tiff'];\n    var text$1 = ['css', 'csv', 'html', 'txt'];\n    var map = {\n        zip: 'zip|compressed',\n        epub: 'application/epub+zip',\n    };\n\n    var guesstimateMimeType = function guesstimateMimeType() {\n        var extension = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '';\n        extension = extension.toLowerCase();\n        if (images.includes(extension)) {\n            return (\n                'image/' +\n                (extension === 'jpg' ? 'jpeg' : extension === 'svg' ? 'svg+xml' : extension)\n            );\n        }\n        if (text$1.includes(extension)) {\n            return 'text/' + extension;\n        }\n\n        return map[extension] || '';\n    };\n\n    var requestDataTransferItems = function requestDataTransferItems(dataTransfer) {\n        return new Promise(function(resolve, reject) {\n            // try to get links from transfer, if found we'll exit immediately (unless a file is in the dataTransfer as well, this is because Firefox could represent the file as a URL and a file object at the same time)\n            var links = getLinks(dataTransfer);\n            if (links.length && !hasFiles(dataTransfer)) {\n                return resolve(links);\n            }\n            // try to get files from the transfer\n            getFiles(dataTransfer).then(resolve);\n        });\n    };\n\n    /**\n     * Test if datatransfer has files\n     */\n    var hasFiles = function hasFiles(dataTransfer) {\n        if (dataTransfer.files) return dataTransfer.files.length > 0;\n        return false;\n    };\n\n    /**\n     * Extracts files from a DataTransfer object\n     */\n    var getFiles = function getFiles(dataTransfer) {\n        return new Promise(function(resolve, reject) {\n            // get the transfer items as promises\n            var promisedFiles = (dataTransfer.items ? Array.from(dataTransfer.items) : [])\n                // only keep file system items (files and directories)\n                .filter(function(item) {\n                    return isFileSystemItem(item);\n                })\n\n                // map each item to promise\n                .map(function(item) {\n                    return getFilesFromItem(item);\n                });\n\n            // if is empty, see if we can extract some info from the files property as a fallback\n            if (!promisedFiles.length) {\n                // TODO: test for directories (should not be allowed)\n                // Use FileReader, problem is that the files property gets lost in the process\n                resolve(dataTransfer.files ? Array.from(dataTransfer.files) : []);\n                return;\n            }\n\n            // done!\n            Promise.all(promisedFiles)\n                .then(function(returnedFileGroups) {\n                    // flatten groups\n                    var files = [];\n                    returnedFileGroups.forEach(function(group) {\n                        files.push.apply(files, group);\n                    });\n\n                    // done (filter out empty files)!\n                    resolve(\n                        files\n                            .filter(function(file) {\n                                return file;\n                            })\n                            .map(function(file) {\n                                if (!file._relativePath)\n                                    file._relativePath = file.webkitRelativePath;\n                                return file;\n                            })\n                    );\n                })\n                .catch(console.error);\n        });\n    };\n\n    var isFileSystemItem = function isFileSystemItem(item) {\n        if (isEntry(item)) {\n            var entry = getAsEntry(item);\n            if (entry) {\n                return entry.isFile || entry.isDirectory;\n            }\n        }\n        return item.kind === 'file';\n    };\n\n    var getFilesFromItem = function getFilesFromItem(item) {\n        return new Promise(function(resolve, reject) {\n            if (isDirectoryEntry(item)) {\n                getFilesInDirectory(getAsEntry(item))\n                    .then(resolve)\n                    .catch(reject);\n                return;\n            }\n\n            resolve([item.getAsFile()]);\n        });\n    };\n\n    var getFilesInDirectory = function getFilesInDirectory(entry) {\n        return new Promise(function(resolve, reject) {\n            var files = [];\n\n            // the total entries to read\n            var dirCounter = 0;\n            var fileCounter = 0;\n\n            var resolveIfDone = function resolveIfDone() {\n                if (fileCounter === 0 && dirCounter === 0) {\n                    resolve(files);\n                }\n            };\n\n            // the recursive function\n            var readEntries = function readEntries(dirEntry) {\n                dirCounter++;\n\n                var directoryReader = dirEntry.createReader();\n\n                // directories are returned in batches, we need to process all batches before we're done\n                var readBatch = function readBatch() {\n                    directoryReader.readEntries(function(entries) {\n                        if (entries.length === 0) {\n                            dirCounter--;\n                            resolveIfDone();\n                            return;\n                        }\n\n                        entries.forEach(function(entry) {\n                            // recursively read more directories\n                            if (entry.isDirectory) {\n                                readEntries(entry);\n                            } else {\n                                // read as file\n                                fileCounter++;\n\n                                entry.file(function(file) {\n                                    var correctedFile = correctMissingFileType(file);\n                                    if (entry.fullPath)\n                                        correctedFile._relativePath = entry.fullPath;\n                                    files.push(correctedFile);\n                                    fileCounter--;\n                                    resolveIfDone();\n                                });\n                            }\n                        });\n\n                        // try to get next batch of files\n                        readBatch();\n                    }, reject);\n                };\n\n                // read first batch of files\n                readBatch();\n            };\n\n            // go!\n            readEntries(entry);\n        });\n    };\n\n    var correctMissingFileType = function correctMissingFileType(file) {\n        if (file.type.length) return file;\n        var date = file.lastModifiedDate;\n        var name = file.name;\n        var type = guesstimateMimeType(getExtensionFromFilename(file.name));\n        if (!type.length) return file;\n        file = file.slice(0, file.size, type);\n        file.name = name;\n        file.lastModifiedDate = date;\n        return file;\n    };\n\n    var isDirectoryEntry = function isDirectoryEntry(item) {\n        return isEntry(item) && (getAsEntry(item) || {}).isDirectory;\n    };\n\n    var isEntry = function isEntry(item) {\n        return 'webkitGetAsEntry' in item;\n    };\n\n    var getAsEntry = function getAsEntry(item) {\n        return item.webkitGetAsEntry();\n    };\n\n    /**\n     * Extracts links from a DataTransfer object\n     */\n    var getLinks = function getLinks(dataTransfer) {\n        var links = [];\n        try {\n            // look in meta data property\n            links = getLinksFromTransferMetaData(dataTransfer);\n            if (links.length) {\n                return links;\n            }\n            links = getLinksFromTransferURLData(dataTransfer);\n        } catch (e) {\n            // nope nope nope (probably IE trouble)\n        }\n        return links;\n    };\n\n    var getLinksFromTransferURLData = function getLinksFromTransferURLData(dataTransfer) {\n        var data = dataTransfer.getData('url');\n        if (typeof data === 'string' && data.length) {\n            return [data];\n        }\n        return [];\n    };\n\n    var getLinksFromTransferMetaData = function getLinksFromTransferMetaData(dataTransfer) {\n        var data = dataTransfer.getData('text/html');\n        if (typeof data === 'string' && data.length) {\n            var matches = data.match(/src\\s*=\\s*\"(.+?)\"/);\n            if (matches) {\n                return [matches[1]];\n            }\n        }\n        return [];\n    };\n\n    var dragNDropObservers = [];\n\n    var eventPosition = function eventPosition(e) {\n        return {\n            pageLeft: e.pageX,\n            pageTop: e.pageY,\n            scopeLeft: e.offsetX || e.layerX,\n            scopeTop: e.offsetY || e.layerY,\n        };\n    };\n\n    var createDragNDropClient = function createDragNDropClient(\n        element,\n        scopeToObserve,\n        filterElement\n    ) {\n        var observer = getDragNDropObserver(scopeToObserve);\n\n        var client = {\n            element: element,\n            filterElement: filterElement,\n            state: null,\n            ondrop: function ondrop() {},\n            onenter: function onenter() {},\n            ondrag: function ondrag() {},\n            onexit: function onexit() {},\n            onload: function onload() {},\n            allowdrop: function allowdrop() {},\n        };\n\n        client.destroy = observer.addListener(client);\n\n        return client;\n    };\n\n    var getDragNDropObserver = function getDragNDropObserver(element) {\n        // see if already exists, if so, return\n        var observer = dragNDropObservers.find(function(item) {\n            return item.element === element;\n        });\n        if (observer) {\n            return observer;\n        }\n\n        // create new observer, does not yet exist for this element\n        var newObserver = createDragNDropObserver(element);\n        dragNDropObservers.push(newObserver);\n        return newObserver;\n    };\n\n    var createDragNDropObserver = function createDragNDropObserver(element) {\n        var clients = [];\n\n        var routes = {\n            dragenter: dragenter,\n            dragover: dragover,\n            dragleave: dragleave,\n            drop: drop,\n        };\n\n        var handlers = {};\n\n        forin(routes, function(event, createHandler) {\n            handlers[event] = createHandler(element, clients);\n            element.addEventListener(event, handlers[event], false);\n        });\n\n        var observer = {\n            element: element,\n            addListener: function addListener(client) {\n                // add as client\n                clients.push(client);\n\n                // return removeListener function\n                return function() {\n                    // remove client\n                    clients.splice(clients.indexOf(client), 1);\n\n                    // if no more clients, clean up observer\n                    if (clients.length === 0) {\n                        dragNDropObservers.splice(dragNDropObservers.indexOf(observer), 1);\n\n                        forin(routes, function(event) {\n                            element.removeEventListener(event, handlers[event], false);\n                        });\n                    }\n                };\n            },\n        };\n\n        return observer;\n    };\n\n    var elementFromPoint = function elementFromPoint(root, point) {\n        if (!('elementFromPoint' in root)) {\n            root = document;\n        }\n        return root.elementFromPoint(point.x, point.y);\n    };\n\n    var isEventTarget = function isEventTarget(e, target) {\n        // get root\n        var root = getRootNode(target);\n\n        // get element at position\n        // if root is not actual shadow DOM and does not have elementFromPoint method, use the one on document\n        var elementAtPosition = elementFromPoint(root, {\n            x: e.pageX - window.pageXOffset,\n            y: e.pageY - window.pageYOffset,\n        });\n\n        // test if target is the element or if one of its children is\n        return elementAtPosition === target || target.contains(elementAtPosition);\n    };\n\n    var initialTarget = null;\n\n    var setDropEffect = function setDropEffect(dataTransfer, effect) {\n        // is in try catch as IE11 will throw error if not\n        try {\n            dataTransfer.dropEffect = effect;\n        } catch (e) {}\n    };\n\n    var dragenter = function dragenter(root, clients) {\n        return function(e) {\n            e.preventDefault();\n\n            initialTarget = e.target;\n\n            clients.forEach(function(client) {\n                var element = client.element,\n                    onenter = client.onenter;\n\n                if (isEventTarget(e, element)) {\n                    client.state = 'enter';\n\n                    // fire enter event\n                    onenter(eventPosition(e));\n                }\n            });\n        };\n    };\n\n    var dragover = function dragover(root, clients) {\n        return function(e) {\n            e.preventDefault();\n\n            var dataTransfer = e.dataTransfer;\n\n            requestDataTransferItems(dataTransfer).then(function(items) {\n                var overDropTarget = false;\n\n                clients.some(function(client) {\n                    var filterElement = client.filterElement,\n                        element = client.element,\n                        onenter = client.onenter,\n                        onexit = client.onexit,\n                        ondrag = client.ondrag,\n                        allowdrop = client.allowdrop;\n\n                    // by default we can drop\n                    setDropEffect(dataTransfer, 'copy');\n\n                    // allow transfer of these items\n                    var allowsTransfer = allowdrop(items);\n\n                    // only used when can be dropped on page\n                    if (!allowsTransfer) {\n                        setDropEffect(dataTransfer, 'none');\n                        return;\n                    }\n\n                    // targetting this client\n                    if (isEventTarget(e, element)) {\n                        overDropTarget = true;\n\n                        // had no previous state, means we are entering this client\n                        if (client.state === null) {\n                            client.state = 'enter';\n                            onenter(eventPosition(e));\n                            return;\n                        }\n\n                        // now over element (no matter if it allows the drop or not)\n                        client.state = 'over';\n\n                        // needs to allow transfer\n                        if (filterElement && !allowsTransfer) {\n                            setDropEffect(dataTransfer, 'none');\n                            return;\n                        }\n\n                        // dragging\n                        ondrag(eventPosition(e));\n                    } else {\n                        // should be over an element to drop\n                        if (filterElement && !overDropTarget) {\n                            setDropEffect(dataTransfer, 'none');\n                        }\n\n                        // might have just left this client?\n                        if (client.state) {\n                            client.state = null;\n                            onexit(eventPosition(e));\n                        }\n                    }\n                });\n            });\n        };\n    };\n\n    var drop = function drop(root, clients) {\n        return function(e) {\n            e.preventDefault();\n\n            var dataTransfer = e.dataTransfer;\n\n            requestDataTransferItems(dataTransfer).then(function(items) {\n                clients.forEach(function(client) {\n                    var filterElement = client.filterElement,\n                        element = client.element,\n                        ondrop = client.ondrop,\n                        onexit = client.onexit,\n                        allowdrop = client.allowdrop;\n\n                    client.state = null;\n\n                    // if we're filtering on element we need to be over the element to drop\n                    if (filterElement && !isEventTarget(e, element)) return;\n\n                    // no transfer for this client\n                    if (!allowdrop(items)) return onexit(eventPosition(e));\n\n                    // we can drop these items on this client\n                    ondrop(eventPosition(e), items);\n                });\n            });\n        };\n    };\n\n    var dragleave = function dragleave(root, clients) {\n        return function(e) {\n            if (initialTarget !== e.target) {\n                return;\n            }\n\n            clients.forEach(function(client) {\n                var onexit = client.onexit;\n\n                client.state = null;\n\n                onexit(eventPosition(e));\n            });\n        };\n    };\n\n    var createHopper = function createHopper(scope, validateItems, options) {\n        // is now hopper scope\n        scope.classList.add('filepond--hopper');\n\n        // shortcuts\n        var catchesDropsOnPage = options.catchesDropsOnPage,\n            requiresDropOnElement = options.requiresDropOnElement,\n            _options$filterItems = options.filterItems,\n            filterItems =\n                _options$filterItems === void 0\n                    ? function(items) {\n                          return items;\n                      }\n                    : _options$filterItems;\n\n        // create a dnd client\n        var client = createDragNDropClient(\n            scope,\n            catchesDropsOnPage ? document.documentElement : scope,\n            requiresDropOnElement\n        );\n\n        // current client state\n        var lastState = '';\n        var currentState = '';\n\n        // determines if a file may be dropped\n        client.allowdrop = function(items) {\n            // TODO: if we can, throw error to indicate the items cannot by dropped\n\n            return validateItems(filterItems(items));\n        };\n\n        client.ondrop = function(position, items) {\n            var filteredItems = filterItems(items);\n\n            if (!validateItems(filteredItems)) {\n                api.ondragend(position);\n                return;\n            }\n\n            currentState = 'drag-drop';\n\n            api.onload(filteredItems, position);\n        };\n\n        client.ondrag = function(position) {\n            api.ondrag(position);\n        };\n\n        client.onenter = function(position) {\n            currentState = 'drag-over';\n\n            api.ondragstart(position);\n        };\n\n        client.onexit = function(position) {\n            currentState = 'drag-exit';\n\n            api.ondragend(position);\n        };\n\n        var api = {\n            updateHopperState: function updateHopperState() {\n                if (lastState !== currentState) {\n                    scope.dataset.hopperState = currentState;\n                    lastState = currentState;\n                }\n            },\n            onload: function onload() {},\n            ondragstart: function ondragstart() {},\n            ondrag: function ondrag() {},\n            ondragend: function ondragend() {},\n            destroy: function destroy() {\n                // destroy client\n                client.destroy();\n            },\n        };\n\n        return api;\n    };\n\n    var listening = false;\n    var listeners$1 = [];\n\n    var handlePaste = function handlePaste(e) {\n        // if is pasting in input or textarea and the target is outside of a filepond scope, ignore\n        var activeEl = document.activeElement;\n        if (activeEl && /textarea|input/i.test(activeEl.nodeName)) {\n            // test textarea or input is contained in filepond root\n            var inScope = false;\n            var element = activeEl;\n            while (element !== document.body) {\n                if (element.classList.contains('filepond--root')) {\n                    inScope = true;\n                    break;\n                }\n                element = element.parentNode;\n            }\n\n            if (!inScope) return;\n        }\n\n        requestDataTransferItems(e.clipboardData).then(function(files) {\n            // no files received\n            if (!files.length) {\n                return;\n            }\n\n            // notify listeners of received files\n            listeners$1.forEach(function(listener) {\n                return listener(files);\n            });\n        });\n    };\n\n    var listen = function listen(cb) {\n        // can't add twice\n        if (listeners$1.includes(cb)) {\n            return;\n        }\n\n        // add initial listener\n        listeners$1.push(cb);\n\n        // setup paste listener for entire page\n        if (listening) {\n            return;\n        }\n\n        listening = true;\n        document.addEventListener('paste', handlePaste);\n    };\n\n    var unlisten = function unlisten(listener) {\n        arrayRemove(listeners$1, listeners$1.indexOf(listener));\n\n        // clean up\n        if (listeners$1.length === 0) {\n            document.removeEventListener('paste', handlePaste);\n            listening = false;\n        }\n    };\n\n    var createPaster = function createPaster() {\n        var cb = function cb(files) {\n            api.onload(files);\n        };\n\n        var api = {\n            destroy: function destroy() {\n                unlisten(cb);\n            },\n            onload: function onload() {},\n        };\n\n        listen(cb);\n\n        return api;\n    };\n\n    /**\n     * Creates the file view\n     */\n    var create$d = function create(_ref) {\n        var root = _ref.root,\n            props = _ref.props;\n        root.element.id = 'filepond--assistant-' + props.id;\n        attr(root.element, 'role', 'status');\n        attr(root.element, 'aria-live', 'polite');\n        attr(root.element, 'aria-relevant', 'additions');\n    };\n\n    var addFilesNotificationTimeout = null;\n    var notificationClearTimeout = null;\n\n    var filenames = [];\n\n    var assist = function assist(root, message) {\n        root.element.textContent = message;\n    };\n\n    var clear$1 = function clear(root) {\n        root.element.textContent = '';\n    };\n\n    var listModified = function listModified(root, filename, label) {\n        var total = root.query('GET_TOTAL_ITEMS');\n        assist(\n            root,\n            label +\n                ' ' +\n                filename +\n                ', ' +\n                total +\n                ' ' +\n                (total === 1\n                    ? root.query('GET_LABEL_FILE_COUNT_SINGULAR')\n                    : root.query('GET_LABEL_FILE_COUNT_PLURAL'))\n        );\n\n        // clear group after set amount of time so the status is not read twice\n        clearTimeout(notificationClearTimeout);\n        notificationClearTimeout = setTimeout(function() {\n            clear$1(root);\n        }, 1500);\n    };\n\n    var isUsingFilePond = function isUsingFilePond(root) {\n        return root.element.parentNode.contains(document.activeElement);\n    };\n\n    var itemAdded = function itemAdded(_ref2) {\n        var root = _ref2.root,\n            action = _ref2.action;\n        if (!isUsingFilePond(root)) {\n            return;\n        }\n\n        root.element.textContent = '';\n        var item = root.query('GET_ITEM', action.id);\n        filenames.push(item.filename);\n\n        clearTimeout(addFilesNotificationTimeout);\n        addFilesNotificationTimeout = setTimeout(function() {\n            listModified(root, filenames.join(', '), root.query('GET_LABEL_FILE_ADDED'));\n\n            filenames.length = 0;\n        }, 750);\n    };\n\n    var itemRemoved = function itemRemoved(_ref3) {\n        var root = _ref3.root,\n            action = _ref3.action;\n        if (!isUsingFilePond(root)) {\n            return;\n        }\n\n        var item = action.item;\n        listModified(root, item.filename, root.query('GET_LABEL_FILE_REMOVED'));\n    };\n\n    var itemProcessed = function itemProcessed(_ref4) {\n        var root = _ref4.root,\n            action = _ref4.action;\n        // will also notify the user when FilePond is not being used, as the user might be occupied with other activities while uploading a file\n\n        var item = root.query('GET_ITEM', action.id);\n        var filename = item.filename;\n        var label = root.query('GET_LABEL_FILE_PROCESSING_COMPLETE');\n\n        assist(root, filename + ' ' + label);\n    };\n\n    var itemProcessedUndo = function itemProcessedUndo(_ref5) {\n        var root = _ref5.root,\n            action = _ref5.action;\n        var item = root.query('GET_ITEM', action.id);\n        var filename = item.filename;\n        var label = root.query('GET_LABEL_FILE_PROCESSING_ABORTED');\n\n        assist(root, filename + ' ' + label);\n    };\n\n    var itemError = function itemError(_ref6) {\n        var root = _ref6.root,\n            action = _ref6.action;\n        var item = root.query('GET_ITEM', action.id);\n        var filename = item.filename;\n\n        // will also notify the user when FilePond is not being used, as the user might be occupied with other activities while uploading a file\n\n        assist(root, action.status.main + ' ' + filename + ' ' + action.status.sub);\n    };\n\n    var assistant = createView({\n        create: create$d,\n        ignoreRect: true,\n        ignoreRectUpdate: true,\n        write: createRoute({\n            DID_LOAD_ITEM: itemAdded,\n            DID_REMOVE_ITEM: itemRemoved,\n            DID_COMPLETE_ITEM_PROCESSING: itemProcessed,\n\n            DID_ABORT_ITEM_PROCESSING: itemProcessedUndo,\n            DID_REVERT_ITEM_PROCESSING: itemProcessedUndo,\n\n            DID_THROW_ITEM_REMOVE_ERROR: itemError,\n            DID_THROW_ITEM_LOAD_ERROR: itemError,\n            DID_THROW_ITEM_INVALID: itemError,\n            DID_THROW_ITEM_PROCESSING_ERROR: itemError,\n        }),\n\n        tag: 'span',\n        name: 'assistant',\n    });\n\n    var toCamels = function toCamels(string) {\n        var separator = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : '-';\n        return string.replace(new RegExp(separator + '.', 'g'), function(sub) {\n            return sub.charAt(1).toUpperCase();\n        });\n    };\n\n    var debounce = function debounce(func) {\n        var interval = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 16;\n        var immidiateOnly =\n            arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : true;\n        var last = Date.now();\n        var timeout = null;\n\n        return function() {\n            for (\n                var _len = arguments.length, args = new Array(_len), _key = 0;\n                _key < _len;\n                _key++\n            ) {\n                args[_key] = arguments[_key];\n            }\n            clearTimeout(timeout);\n\n            var dist = Date.now() - last;\n\n            var fn = function fn() {\n                last = Date.now();\n                func.apply(void 0, args);\n            };\n\n            if (dist < interval) {\n                // we need to delay by the difference between interval and dist\n                // for example: if distance is 10 ms and interval is 16 ms,\n                // we need to wait an additional 6ms before calling the function)\n                if (!immidiateOnly) {\n                    timeout = setTimeout(fn, interval - dist);\n                }\n            } else {\n                // go!\n                fn();\n            }\n        };\n    };\n\n    var MAX_FILES_LIMIT = 1000000;\n\n    var prevent = function prevent(e) {\n        return e.preventDefault();\n    };\n\n    var create$e = function create(_ref) {\n        var root = _ref.root,\n            props = _ref.props;\n        // Add id\n        var id = root.query('GET_ID');\n        if (id) {\n            root.element.id = id;\n        }\n\n        // Add className\n        var className = root.query('GET_CLASS_NAME');\n        if (className) {\n            className\n                .split(' ')\n                .filter(function(name) {\n                    return name.length;\n                })\n                .forEach(function(name) {\n                    root.element.classList.add(name);\n                });\n        }\n\n        // Field label\n        root.ref.label = root.appendChildView(\n            root.createChildView(\n                dropLabel,\n                Object.assign({}, props, {\n                    translateY: null,\n                    caption: root.query('GET_LABEL_IDLE'),\n                })\n            )\n        );\n\n        // List of items\n        root.ref.list = root.appendChildView(\n            root.createChildView(listScroller, { translateY: null })\n        );\n\n        // Background panel\n        root.ref.panel = root.appendChildView(root.createChildView(panel, { name: 'panel-root' }));\n\n        // Assistant notifies assistive tech when content changes\n        root.ref.assistant = root.appendChildView(\n            root.createChildView(assistant, Object.assign({}, props))\n        );\n\n        // Data\n        root.ref.data = root.appendChildView(root.createChildView(data, Object.assign({}, props)));\n\n        // Measure (tests if fixed height was set)\n        // DOCTYPE needs to be set for this to work\n        root.ref.measure = createElement$1('div');\n        root.ref.measure.style.height = '100%';\n        root.element.appendChild(root.ref.measure);\n\n        // information on the root height or fixed height status\n        root.ref.bounds = null;\n\n        // apply initial style properties\n        root.query('GET_STYLES')\n            .filter(function(style) {\n                return !isEmpty(style.value);\n            })\n            .map(function(_ref2) {\n                var name = _ref2.name,\n                    value = _ref2.value;\n                root.element.dataset[name] = value;\n            });\n\n        // determine if width changed\n        root.ref.widthPrevious = null;\n        root.ref.widthUpdated = debounce(function() {\n            root.ref.updateHistory = [];\n            root.dispatch('DID_RESIZE_ROOT');\n        }, 250);\n\n        // history of updates\n        root.ref.previousAspectRatio = null;\n        root.ref.updateHistory = [];\n\n        // prevent scrolling and zooming on iOS (only if supports pointer events, for then we can enable reorder)\n        var canHover = window.matchMedia('(pointer: fine) and (hover: hover)').matches;\n        var hasPointerEvents = 'PointerEvent' in window;\n        if (root.query('GET_ALLOW_REORDER') && hasPointerEvents && !canHover) {\n            root.element.addEventListener('touchmove', prevent, { passive: false });\n            root.element.addEventListener('gesturestart', prevent);\n        }\n\n        // add credits\n        var credits = root.query('GET_CREDITS');\n        var hasCredits = credits.length === 2;\n        if (hasCredits) {\n            var frag = document.createElement('a');\n            frag.className = 'filepond--credits';\n            frag.setAttribute('aria-hidden', 'true');\n            frag.href = credits[0];\n            frag.tabindex = -1;\n            frag.target = '_blank';\n            frag.rel = 'noopener noreferrer';\n            frag.textContent = credits[1];\n            root.element.appendChild(frag);\n            root.ref.credits = frag;\n        }\n    };\n\n    var write$9 = function write(_ref3) {\n        var root = _ref3.root,\n            props = _ref3.props,\n            actions = _ref3.actions;\n        // route actions\n        route$5({ root: root, props: props, actions: actions });\n\n        // apply style properties\n        actions\n            .filter(function(action) {\n                return /^DID_SET_STYLE_/.test(action.type);\n            })\n            .filter(function(action) {\n                return !isEmpty(action.data.value);\n            })\n            .map(function(_ref4) {\n                var type = _ref4.type,\n                    data = _ref4.data;\n                var name = toCamels(type.substr(8).toLowerCase(), '_');\n                root.element.dataset[name] = data.value;\n                root.invalidateLayout();\n            });\n\n        if (root.rect.element.hidden) return;\n\n        if (root.rect.element.width !== root.ref.widthPrevious) {\n            root.ref.widthPrevious = root.rect.element.width;\n            root.ref.widthUpdated();\n        }\n\n        // get box bounds, we do this only once\n        var bounds = root.ref.bounds;\n        if (!bounds) {\n            bounds = root.ref.bounds = calculateRootBoundingBoxHeight(root);\n\n            // destroy measure element\n            root.element.removeChild(root.ref.measure);\n            root.ref.measure = null;\n        }\n\n        // get quick references to various high level parts of the upload tool\n        var _root$ref = root.ref,\n            hopper = _root$ref.hopper,\n            label = _root$ref.label,\n            list = _root$ref.list,\n            panel = _root$ref.panel;\n\n        // sets correct state to hopper scope\n        if (hopper) {\n            hopper.updateHopperState();\n        }\n\n        // bool to indicate if we're full or not\n        var aspectRatio = root.query('GET_PANEL_ASPECT_RATIO');\n        var isMultiItem = root.query('GET_ALLOW_MULTIPLE');\n        var totalItems = root.query('GET_TOTAL_ITEMS');\n        var maxItems = isMultiItem ? root.query('GET_MAX_FILES') || MAX_FILES_LIMIT : 1;\n        var atMaxCapacity = totalItems === maxItems;\n\n        // action used to add item\n        var addAction = actions.find(function(action) {\n            return action.type === 'DID_ADD_ITEM';\n        });\n\n        // if reached max capacity and we've just reached it\n        if (atMaxCapacity && addAction) {\n            // get interaction type\n            var interactionMethod = addAction.data.interactionMethod;\n\n            // hide label\n            label.opacity = 0;\n\n            if (isMultiItem) {\n                label.translateY = -40;\n            } else {\n                if (interactionMethod === InteractionMethod.API) {\n                    label.translateX = 40;\n                } else if (interactionMethod === InteractionMethod.BROWSE) {\n                    label.translateY = 40;\n                } else {\n                    label.translateY = 30;\n                }\n            }\n        } else if (!atMaxCapacity) {\n            label.opacity = 1;\n            label.translateX = 0;\n            label.translateY = 0;\n        }\n\n        var listItemMargin = calculateListItemMargin(root);\n\n        var listHeight = calculateListHeight(root);\n\n        var labelHeight = label.rect.element.height;\n        var currentLabelHeight = !isMultiItem || atMaxCapacity ? 0 : labelHeight;\n\n        var listMarginTop = atMaxCapacity ? list.rect.element.marginTop : 0;\n        var listMarginBottom = totalItems === 0 ? 0 : list.rect.element.marginBottom;\n\n        var visualHeight =\n            currentLabelHeight + listMarginTop + listHeight.visual + listMarginBottom;\n        var boundsHeight =\n            currentLabelHeight + listMarginTop + listHeight.bounds + listMarginBottom;\n\n        // link list to label bottom position\n        list.translateY =\n            Math.max(0, currentLabelHeight - list.rect.element.marginTop) - listItemMargin.top;\n\n        if (aspectRatio) {\n            // fixed aspect ratio\n\n            // calculate height based on width\n            var width = root.rect.element.width;\n            var height = width * aspectRatio;\n\n            // clear history if aspect ratio has changed\n            if (aspectRatio !== root.ref.previousAspectRatio) {\n                root.ref.previousAspectRatio = aspectRatio;\n                root.ref.updateHistory = [];\n            }\n\n            // remember this width\n            var history = root.ref.updateHistory;\n            history.push(width);\n\n            var MAX_BOUNCES = 2;\n            if (history.length > MAX_BOUNCES * 2) {\n                var l = history.length;\n                var bottom = l - 10;\n                var bounces = 0;\n                for (var i = l; i >= bottom; i--) {\n                    if (history[i] === history[i - 2]) {\n                        bounces++;\n                    }\n\n                    if (bounces >= MAX_BOUNCES) {\n                        // dont adjust height\n                        return;\n                    }\n                }\n            }\n\n            // fix height of panel so it adheres to aspect ratio\n            panel.scalable = false;\n            panel.height = height;\n\n            // available height for list\n            var listAvailableHeight =\n                // the height of the panel minus the label height\n                height -\n                currentLabelHeight -\n                // the room we leave open between the end of the list and the panel bottom\n                (listMarginBottom - listItemMargin.bottom) -\n                // if we're full we need to leave some room between the top of the panel and the list\n                (atMaxCapacity ? listMarginTop : 0);\n\n            if (listHeight.visual > listAvailableHeight) {\n                list.overflow = listAvailableHeight;\n            } else {\n                list.overflow = null;\n            }\n\n            // set container bounds (so pushes siblings downwards)\n            root.height = height;\n        } else if (bounds.fixedHeight) {\n            // fixed height\n\n            // fix height of panel\n            panel.scalable = false;\n\n            // available height for list\n            var _listAvailableHeight =\n                // the height of the panel minus the label height\n                bounds.fixedHeight -\n                currentLabelHeight -\n                // the room we leave open between the end of the list and the panel bottom\n                (listMarginBottom - listItemMargin.bottom) -\n                // if we're full we need to leave some room between the top of the panel and the list\n                (atMaxCapacity ? listMarginTop : 0);\n\n            // set list height\n            if (listHeight.visual > _listAvailableHeight) {\n                list.overflow = _listAvailableHeight;\n            } else {\n                list.overflow = null;\n            }\n\n            // no need to set container bounds as these are handles by CSS fixed height\n        } else if (bounds.cappedHeight) {\n            // max-height\n\n            // not a fixed height panel\n            var isCappedHeight = visualHeight >= bounds.cappedHeight;\n            var panelHeight = Math.min(bounds.cappedHeight, visualHeight);\n            panel.scalable = true;\n            panel.height = isCappedHeight\n                ? panelHeight\n                : panelHeight - listItemMargin.top - listItemMargin.bottom;\n\n            // available height for list\n            var _listAvailableHeight2 =\n                // the height of the panel minus the label height\n                panelHeight -\n                currentLabelHeight -\n                // the room we leave open between the end of the list and the panel bottom\n                (listMarginBottom - listItemMargin.bottom) -\n                // if we're full we need to leave some room between the top of the panel and the list\n                (atMaxCapacity ? listMarginTop : 0);\n\n            // set list height (if is overflowing)\n            if (visualHeight > bounds.cappedHeight && listHeight.visual > _listAvailableHeight2) {\n                list.overflow = _listAvailableHeight2;\n            } else {\n                list.overflow = null;\n            }\n\n            // set container bounds (so pushes siblings downwards)\n            root.height = Math.min(\n                bounds.cappedHeight,\n                boundsHeight - listItemMargin.top - listItemMargin.bottom\n            );\n        } else {\n            // flexible height\n\n            // not a fixed height panel\n            var itemMargin = totalItems > 0 ? listItemMargin.top + listItemMargin.bottom : 0;\n            panel.scalable = true;\n            panel.height = Math.max(labelHeight, visualHeight - itemMargin);\n\n            // set container bounds (so pushes siblings downwards)\n            root.height = Math.max(labelHeight, boundsHeight - itemMargin);\n        }\n\n        // move credits to bottom\n        if (root.ref.credits && panel.heightCurrent)\n            root.ref.credits.style.transform = 'translateY(' + panel.heightCurrent + 'px)';\n    };\n\n    var calculateListItemMargin = function calculateListItemMargin(root) {\n        var item = root.ref.list.childViews[0].childViews[0];\n        return item\n            ? {\n                  top: item.rect.element.marginTop,\n                  bottom: item.rect.element.marginBottom,\n              }\n            : {\n                  top: 0,\n                  bottom: 0,\n              };\n    };\n\n    var calculateListHeight = function calculateListHeight(root) {\n        var visual = 0;\n        var bounds = 0;\n\n        // get file list reference\n        var scrollList = root.ref.list;\n        var itemList = scrollList.childViews[0];\n        var visibleChildren = itemList.childViews.filter(function(child) {\n            return child.rect.element.height;\n        });\n        var children = root\n            .query('GET_ACTIVE_ITEMS')\n            .map(function(item) {\n                return visibleChildren.find(function(child) {\n                    return child.id === item.id;\n                });\n            })\n            .filter(function(item) {\n                return item;\n            });\n\n        // no children, done!\n        if (children.length === 0) return { visual: visual, bounds: bounds };\n\n        var horizontalSpace = itemList.rect.element.width;\n        var dragIndex = getItemIndexByPosition(itemList, children, scrollList.dragCoordinates);\n\n        var childRect = children[0].rect.element;\n\n        var itemVerticalMargin = childRect.marginTop + childRect.marginBottom;\n        var itemHorizontalMargin = childRect.marginLeft + childRect.marginRight;\n\n        var itemWidth = childRect.width + itemHorizontalMargin;\n        var itemHeight = childRect.height + itemVerticalMargin;\n\n        var newItem = typeof dragIndex !== 'undefined' && dragIndex >= 0 ? 1 : 0;\n        var removedItem = children.find(function(child) {\n            return child.markedForRemoval && child.opacity < 0.45;\n        })\n            ? -1\n            : 0;\n        var verticalItemCount = children.length + newItem + removedItem;\n        var itemsPerRow = getItemsPerRow(horizontalSpace, itemWidth);\n\n        // stack\n        if (itemsPerRow === 1) {\n            children.forEach(function(item) {\n                var height = item.rect.element.height + itemVerticalMargin;\n                bounds += height;\n                visual += height * item.opacity;\n            });\n        }\n        // grid\n        else {\n            bounds = Math.ceil(verticalItemCount / itemsPerRow) * itemHeight;\n            visual = bounds;\n        }\n\n        return { visual: visual, bounds: bounds };\n    };\n\n    var calculateRootBoundingBoxHeight = function calculateRootBoundingBoxHeight(root) {\n        var height = root.ref.measureHeight || null;\n        var cappedHeight = parseInt(root.style.maxHeight, 10) || null;\n        var fixedHeight = height === 0 ? null : height;\n\n        return {\n            cappedHeight: cappedHeight,\n            fixedHeight: fixedHeight,\n        };\n    };\n\n    var exceedsMaxFiles = function exceedsMaxFiles(root, items) {\n        var allowReplace = root.query('GET_ALLOW_REPLACE');\n        var allowMultiple = root.query('GET_ALLOW_MULTIPLE');\n        var totalItems = root.query('GET_TOTAL_ITEMS');\n        var maxItems = root.query('GET_MAX_FILES');\n\n        // total amount of items being dragged\n        var totalBrowseItems = items.length;\n\n        // if does not allow multiple items and dragging more than one item\n        if (!allowMultiple && totalBrowseItems > 1) {\n            return true;\n        }\n\n        // limit max items to one if not allowed to drop multiple items\n        maxItems = allowMultiple ? maxItems : allowReplace ? maxItems : 1;\n\n        // no more room?\n        var hasMaxItems = isInt(maxItems);\n        if (hasMaxItems && totalItems + totalBrowseItems > maxItems) {\n            root.dispatch('DID_THROW_MAX_FILES', {\n                source: items,\n                error: createResponse('warning', 0, 'Max files'),\n            });\n\n            return true;\n        }\n\n        return false;\n    };\n\n    var getDragIndex = function getDragIndex(list, children, position) {\n        var itemList = list.childViews[0];\n        return getItemIndexByPosition(itemList, children, {\n            left: position.scopeLeft - itemList.rect.element.left,\n            top:\n                position.scopeTop -\n                (list.rect.outer.top + list.rect.element.marginTop + list.rect.element.scrollTop),\n        });\n    };\n\n    /**\n     * Enable or disable file drop functionality\n     */\n    var toggleDrop = function toggleDrop(root) {\n        var isAllowed = root.query('GET_ALLOW_DROP');\n        var isDisabled = root.query('GET_DISABLED');\n        var enabled = isAllowed && !isDisabled;\n        if (enabled && !root.ref.hopper) {\n            var hopper = createHopper(\n                root.element,\n                function(items) {\n                    // allow quick validation of dropped items\n                    var beforeDropFile =\n                        root.query('GET_BEFORE_DROP_FILE') ||\n                        function() {\n                            return true;\n                        };\n\n                    // all items should be validated by all filters as valid\n                    var dropValidation = root.query('GET_DROP_VALIDATION');\n                    return dropValidation\n                        ? items.every(function(item) {\n                              return (\n                                  applyFilters('ALLOW_HOPPER_ITEM', item, {\n                                      query: root.query,\n                                  }).every(function(result) {\n                                      return result === true;\n                                  }) && beforeDropFile(item)\n                              );\n                          })\n                        : true;\n                },\n                {\n                    filterItems: function filterItems(items) {\n                        var ignoredFiles = root.query('GET_IGNORED_FILES');\n                        return items.filter(function(item) {\n                            if (isFile(item)) {\n                                return !ignoredFiles.includes(item.name.toLowerCase());\n                            }\n                            return true;\n                        });\n                    },\n                    catchesDropsOnPage: root.query('GET_DROP_ON_PAGE'),\n                    requiresDropOnElement: root.query('GET_DROP_ON_ELEMENT'),\n                }\n            );\n\n            hopper.onload = function(items, position) {\n                // get item children elements and sort based on list sort\n                var list = root.ref.list.childViews[0];\n                var visibleChildren = list.childViews.filter(function(child) {\n                    return child.rect.element.height;\n                });\n                var children = root\n                    .query('GET_ACTIVE_ITEMS')\n                    .map(function(item) {\n                        return visibleChildren.find(function(child) {\n                            return child.id === item.id;\n                        });\n                    })\n                    .filter(function(item) {\n                        return item;\n                    });\n\n                applyFilterChain('ADD_ITEMS', items, { dispatch: root.dispatch }).then(function(\n                    queue\n                ) {\n                    // these files don't fit so stop here\n                    if (exceedsMaxFiles(root, queue)) return false;\n\n                    // go\n                    root.dispatch('ADD_ITEMS', {\n                        items: queue,\n                        index: getDragIndex(root.ref.list, children, position),\n                        interactionMethod: InteractionMethod.DROP,\n                    });\n                });\n\n                root.dispatch('DID_DROP', { position: position });\n\n                root.dispatch('DID_END_DRAG', { position: position });\n            };\n\n            hopper.ondragstart = function(position) {\n                root.dispatch('DID_START_DRAG', { position: position });\n            };\n\n            hopper.ondrag = debounce(function(position) {\n                root.dispatch('DID_DRAG', { position: position });\n            });\n\n            hopper.ondragend = function(position) {\n                root.dispatch('DID_END_DRAG', { position: position });\n            };\n\n            root.ref.hopper = hopper;\n\n            root.ref.drip = root.appendChildView(root.createChildView(drip));\n        } else if (!enabled && root.ref.hopper) {\n            root.ref.hopper.destroy();\n            root.ref.hopper = null;\n            root.removeChildView(root.ref.drip);\n        }\n    };\n\n    /**\n     * Enable or disable browse functionality\n     */\n    var toggleBrowse = function toggleBrowse(root, props) {\n        var isAllowed = root.query('GET_ALLOW_BROWSE');\n        var isDisabled = root.query('GET_DISABLED');\n        var enabled = isAllowed && !isDisabled;\n        if (enabled && !root.ref.browser) {\n            root.ref.browser = root.appendChildView(\n                root.createChildView(\n                    browser,\n                    Object.assign({}, props, {\n                        onload: function onload(items) {\n                            applyFilterChain('ADD_ITEMS', items, {\n                                dispatch: root.dispatch,\n                            }).then(function(queue) {\n                                // these files don't fit so stop here\n                                if (exceedsMaxFiles(root, queue)) return false;\n\n                                // add items!\n                                root.dispatch('ADD_ITEMS', {\n                                    items: queue,\n                                    index: -1,\n                                    interactionMethod: InteractionMethod.BROWSE,\n                                });\n                            });\n                        },\n                    })\n                ),\n\n                0\n            );\n        } else if (!enabled && root.ref.browser) {\n            root.removeChildView(root.ref.browser);\n            root.ref.browser = null;\n        }\n    };\n\n    /**\n     * Enable or disable paste functionality\n     */\n    var togglePaste = function togglePaste(root) {\n        var isAllowed = root.query('GET_ALLOW_PASTE');\n        var isDisabled = root.query('GET_DISABLED');\n        var enabled = isAllowed && !isDisabled;\n        if (enabled && !root.ref.paster) {\n            root.ref.paster = createPaster();\n            root.ref.paster.onload = function(items) {\n                applyFilterChain('ADD_ITEMS', items, { dispatch: root.dispatch }).then(function(\n                    queue\n                ) {\n                    // these files don't fit so stop here\n                    if (exceedsMaxFiles(root, queue)) return false;\n\n                    // add items!\n                    root.dispatch('ADD_ITEMS', {\n                        items: queue,\n                        index: -1,\n                        interactionMethod: InteractionMethod.PASTE,\n                    });\n                });\n            };\n        } else if (!enabled && root.ref.paster) {\n            root.ref.paster.destroy();\n            root.ref.paster = null;\n        }\n    };\n\n    /**\n     * Route actions\n     */\n    var route$5 = createRoute({\n        DID_SET_ALLOW_BROWSE: function DID_SET_ALLOW_BROWSE(_ref5) {\n            var root = _ref5.root,\n                props = _ref5.props;\n            toggleBrowse(root, props);\n        },\n        DID_SET_ALLOW_DROP: function DID_SET_ALLOW_DROP(_ref6) {\n            var root = _ref6.root;\n            toggleDrop(root);\n        },\n        DID_SET_ALLOW_PASTE: function DID_SET_ALLOW_PASTE(_ref7) {\n            var root = _ref7.root;\n            togglePaste(root);\n        },\n        DID_SET_DISABLED: function DID_SET_DISABLED(_ref8) {\n            var root = _ref8.root,\n                props = _ref8.props;\n            toggleDrop(root);\n            togglePaste(root);\n            toggleBrowse(root, props);\n            var isDisabled = root.query('GET_DISABLED');\n            if (isDisabled) {\n                root.element.dataset.disabled = 'disabled';\n            } else {\n                // delete root.element.dataset.disabled; <= this does not work on iOS 10\n                root.element.removeAttribute('data-disabled');\n            }\n        },\n    });\n\n    var root = createView({\n        name: 'root',\n        read: function read(_ref9) {\n            var root = _ref9.root;\n            if (root.ref.measure) {\n                root.ref.measureHeight = root.ref.measure.offsetHeight;\n            }\n        },\n        create: create$e,\n        write: write$9,\n        destroy: function destroy(_ref10) {\n            var root = _ref10.root;\n            if (root.ref.paster) {\n                root.ref.paster.destroy();\n            }\n            if (root.ref.hopper) {\n                root.ref.hopper.destroy();\n            }\n            root.element.removeEventListener('touchmove', prevent);\n            root.element.removeEventListener('gesturestart', prevent);\n        },\n        mixins: {\n            styles: ['height'],\n        },\n    });\n\n    // creates the app\n    var createApp = function createApp() {\n        var initialOptions = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n        // let element\n        var originalElement = null;\n\n        // get default options\n        var defaultOptions = getOptions();\n\n        // create the data store, this will contain all our app info\n        var store = createStore(\n            // initial state (should be serializable)\n            createInitialState(defaultOptions),\n\n            // queries\n            [queries, createOptionQueries(defaultOptions)],\n\n            // action handlers\n            [actions, createOptionActions(defaultOptions)]\n        );\n\n        // set initial options\n        store.dispatch('SET_OPTIONS', { options: initialOptions });\n\n        // kick thread if visibility changes\n        var visibilityHandler = function visibilityHandler() {\n            if (document.hidden) return;\n            store.dispatch('KICK');\n        };\n        document.addEventListener('visibilitychange', visibilityHandler);\n\n        // re-render on window resize start and finish\n        var resizeDoneTimer = null;\n        var isResizing = false;\n        var isResizingHorizontally = false;\n        var initialWindowWidth = null;\n        var currentWindowWidth = null;\n        var resizeHandler = function resizeHandler() {\n            if (!isResizing) {\n                isResizing = true;\n            }\n            clearTimeout(resizeDoneTimer);\n            resizeDoneTimer = setTimeout(function() {\n                isResizing = false;\n                initialWindowWidth = null;\n                currentWindowWidth = null;\n                if (isResizingHorizontally) {\n                    isResizingHorizontally = false;\n                    store.dispatch('DID_STOP_RESIZE');\n                }\n            }, 500);\n        };\n        window.addEventListener('resize', resizeHandler);\n\n        // render initial view\n        var view = root(store, { id: getUniqueId() });\n\n        //\n        // PRIVATE API -------------------------------------------------------------------------------------\n        //\n        var isResting = false;\n        var isHidden = false;\n\n        var readWriteApi = {\n            // necessary for update loop\n\n            /**\n             * Reads from dom (never call manually)\n             * @private\n             */\n            _read: function _read() {\n                // test if we're resizing horizontally\n                // TODO: see if we can optimize this by measuring root rect\n                if (isResizing) {\n                    currentWindowWidth = window.innerWidth;\n                    if (!initialWindowWidth) {\n                        initialWindowWidth = currentWindowWidth;\n                    }\n\n                    if (!isResizingHorizontally && currentWindowWidth !== initialWindowWidth) {\n                        store.dispatch('DID_START_RESIZE');\n                        isResizingHorizontally = true;\n                    }\n                }\n\n                if (isHidden && isResting) {\n                    // test if is no longer hidden\n                    isResting = view.element.offsetParent === null;\n                }\n\n                // if resting, no need to read as numbers will still all be correct\n                if (isResting) return;\n\n                // read view data\n                view._read();\n\n                // if is hidden we need to know so we exit rest mode when revealed\n                isHidden = view.rect.element.hidden;\n            },\n\n            /**\n             * Writes to dom (never call manually)\n             * @private\n             */\n            _write: function _write(ts) {\n                // get all actions from store\n                var actions = store\n                    .processActionQueue()\n\n                    // filter out set actions (these will automatically trigger DID_SET)\n                    .filter(function(action) {\n                        return !/^SET_/.test(action.type);\n                    });\n\n                // if was idling and no actions stop here\n                if (isResting && !actions.length) return;\n\n                // some actions might trigger events\n                routeActionsToEvents(actions);\n\n                // update the view\n                isResting = view._write(ts, actions, isResizingHorizontally);\n\n                // will clean up all archived items\n                removeReleasedItems(store.query('GET_ITEMS'));\n\n                // now idling\n                if (isResting) {\n                    store.processDispatchQueue();\n                }\n            },\n        };\n\n        //\n        // EXPOSE EVENTS -------------------------------------------------------------------------------------\n        //\n        var createEvent = function createEvent(name) {\n            return function(data) {\n                // create default event\n                var event = {\n                    type: name,\n                };\n\n                // no data to add\n                if (!data) {\n                    return event;\n                }\n\n                // copy relevant props\n                if (data.hasOwnProperty('error')) {\n                    event.error = data.error ? Object.assign({}, data.error) : null;\n                }\n\n                if (data.status) {\n                    event.status = Object.assign({}, data.status);\n                }\n\n                if (data.file) {\n                    event.output = data.file;\n                }\n\n                // only source is available, else add item if possible\n                if (data.source) {\n                    event.file = data.source;\n                } else if (data.item || data.id) {\n                    var item = data.item ? data.item : store.query('GET_ITEM', data.id);\n                    event.file = item ? createItemAPI(item) : null;\n                }\n\n                // map all items in a possible items array\n                if (data.items) {\n                    event.items = data.items.map(createItemAPI);\n                }\n\n                // if this is a progress event add the progress amount\n                if (/progress/.test(name)) {\n                    event.progress = data.progress;\n                }\n\n                // copy relevant props\n                if (data.hasOwnProperty('origin') && data.hasOwnProperty('target')) {\n                    event.origin = data.origin;\n                    event.target = data.target;\n                }\n\n                return event;\n            };\n        };\n\n        var eventRoutes = {\n            DID_DESTROY: createEvent('destroy'),\n\n            DID_INIT: createEvent('init'),\n\n            DID_THROW_MAX_FILES: createEvent('warning'),\n\n            DID_INIT_ITEM: createEvent('initfile'),\n            DID_START_ITEM_LOAD: createEvent('addfilestart'),\n            DID_UPDATE_ITEM_LOAD_PROGRESS: createEvent('addfileprogress'),\n            DID_LOAD_ITEM: createEvent('addfile'),\n\n            DID_THROW_ITEM_INVALID: [createEvent('error'), createEvent('addfile')],\n\n            DID_THROW_ITEM_LOAD_ERROR: [createEvent('error'), createEvent('addfile')],\n\n            DID_THROW_ITEM_REMOVE_ERROR: [createEvent('error'), createEvent('removefile')],\n\n            DID_PREPARE_OUTPUT: createEvent('preparefile'),\n\n            DID_START_ITEM_PROCESSING: createEvent('processfilestart'),\n            DID_UPDATE_ITEM_PROCESS_PROGRESS: createEvent('processfileprogress'),\n            DID_ABORT_ITEM_PROCESSING: createEvent('processfileabort'),\n            DID_COMPLETE_ITEM_PROCESSING: createEvent('processfile'),\n            DID_COMPLETE_ITEM_PROCESSING_ALL: createEvent('processfiles'),\n            DID_REVERT_ITEM_PROCESSING: createEvent('processfilerevert'),\n\n            DID_THROW_ITEM_PROCESSING_ERROR: [createEvent('error'), createEvent('processfile')],\n\n            DID_REMOVE_ITEM: createEvent('removefile'),\n\n            DID_UPDATE_ITEMS: createEvent('updatefiles'),\n\n            DID_ACTIVATE_ITEM: createEvent('activatefile'),\n\n            DID_REORDER_ITEMS: createEvent('reorderfiles'),\n        };\n\n        var exposeEvent = function exposeEvent(event) {\n            // create event object to be dispatched\n            var detail = Object.assign({ pond: exports }, event);\n            delete detail.type;\n            view.element.dispatchEvent(\n                new CustomEvent('FilePond:' + event.type, {\n                    // event info\n                    detail: detail,\n\n                    // event behaviour\n                    bubbles: true,\n                    cancelable: true,\n                    composed: true, // triggers listeners outside of shadow root\n                })\n            );\n\n            // event object to params used for `on()` event handlers and callbacks `oninit()`\n            var params = [];\n\n            // if is possible error event, make it the first param\n            if (event.hasOwnProperty('error')) {\n                params.push(event.error);\n            }\n\n            // file is always section\n            if (event.hasOwnProperty('file')) {\n                params.push(event.file);\n            }\n\n            // append other props\n            var filtered = ['type', 'error', 'file'];\n            Object.keys(event)\n                .filter(function(key) {\n                    return !filtered.includes(key);\n                })\n                .forEach(function(key) {\n                    return params.push(event[key]);\n                });\n\n            // on(type, () => { })\n            exports.fire.apply(exports, [event.type].concat(params));\n\n            // oninit = () => {}\n            var handler = store.query('GET_ON' + event.type.toUpperCase());\n            if (handler) {\n                handler.apply(void 0, params);\n            }\n        };\n\n        var routeActionsToEvents = function routeActionsToEvents(actions) {\n            if (!actions.length) return;\n            actions\n                .filter(function(action) {\n                    return eventRoutes[action.type];\n                })\n                .forEach(function(action) {\n                    var routes = eventRoutes[action.type];\n                    (Array.isArray(routes) ? routes : [routes]).forEach(function(route) {\n                        // this isn't fantastic, but because of the stacking of settimeouts plugins can handle the did_load before the did_init\n                        if (action.type === 'DID_INIT_ITEM') {\n                            exposeEvent(route(action.data));\n                        } else {\n                            setTimeout(function() {\n                                exposeEvent(route(action.data));\n                            }, 0);\n                        }\n                    });\n                });\n        };\n\n        //\n        // PUBLIC API -------------------------------------------------------------------------------------\n        //\n        var setOptions = function setOptions(options) {\n            return store.dispatch('SET_OPTIONS', { options: options });\n        };\n\n        var getFile = function getFile(query) {\n            return store.query('GET_ACTIVE_ITEM', query);\n        };\n\n        var prepareFile = function prepareFile(query) {\n            return new Promise(function(resolve, reject) {\n                store.dispatch('REQUEST_ITEM_PREPARE', {\n                    query: query,\n                    success: function success(item) {\n                        resolve(item);\n                    },\n                    failure: function failure(error) {\n                        reject(error);\n                    },\n                });\n            });\n        };\n\n        var addFile = function addFile(source) {\n            var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n            return new Promise(function(resolve, reject) {\n                addFiles([{ source: source, options: options }], { index: options.index })\n                    .then(function(items) {\n                        return resolve(items && items[0]);\n                    })\n                    .catch(reject);\n            });\n        };\n\n        var isFilePondFile = function isFilePondFile(obj) {\n            return obj.file && obj.id;\n        };\n\n        var removeFile = function removeFile(query, options) {\n            // if only passed options\n            if (typeof query === 'object' && !isFilePondFile(query) && !options) {\n                options = query;\n                query = undefined;\n            }\n\n            // request item removal\n            store.dispatch('REMOVE_ITEM', Object.assign({}, options, { query: query }));\n\n            // see if item has been removed\n            return store.query('GET_ACTIVE_ITEM', query) === null;\n        };\n\n        var addFiles = function addFiles() {\n            for (\n                var _len = arguments.length, args = new Array(_len), _key = 0;\n                _key < _len;\n                _key++\n            ) {\n                args[_key] = arguments[_key];\n            }\n            return new Promise(function(resolve, reject) {\n                var sources = [];\n                var options = {};\n\n                // user passed a sources array\n                if (isArray(args[0])) {\n                    sources.push.apply(sources, args[0]);\n                    Object.assign(options, args[1] || {});\n                } else {\n                    // user passed sources as arguments, last one might be options object\n                    var lastArgument = args[args.length - 1];\n                    if (typeof lastArgument === 'object' && !(lastArgument instanceof Blob)) {\n                        Object.assign(options, args.pop());\n                    }\n\n                    // add rest to sources\n                    sources.push.apply(sources, args);\n                }\n\n                store.dispatch('ADD_ITEMS', {\n                    items: sources,\n                    index: options.index,\n                    interactionMethod: InteractionMethod.API,\n                    success: resolve,\n                    failure: reject,\n                });\n            });\n        };\n\n        var getFiles = function getFiles() {\n            return store.query('GET_ACTIVE_ITEMS');\n        };\n\n        var processFile = function processFile(query) {\n            return new Promise(function(resolve, reject) {\n                store.dispatch('REQUEST_ITEM_PROCESSING', {\n                    query: query,\n                    success: function success(item) {\n                        resolve(item);\n                    },\n                    failure: function failure(error) {\n                        reject(error);\n                    },\n                });\n            });\n        };\n\n        var prepareFiles = function prepareFiles() {\n            for (\n                var _len2 = arguments.length, args = new Array(_len2), _key2 = 0;\n                _key2 < _len2;\n                _key2++\n            ) {\n                args[_key2] = arguments[_key2];\n            }\n            var queries = Array.isArray(args[0]) ? args[0] : args;\n            var items = queries.length ? queries : getFiles();\n            return Promise.all(items.map(prepareFile));\n        };\n\n        var processFiles = function processFiles() {\n            for (\n                var _len3 = arguments.length, args = new Array(_len3), _key3 = 0;\n                _key3 < _len3;\n                _key3++\n            ) {\n                args[_key3] = arguments[_key3];\n            }\n            var queries = Array.isArray(args[0]) ? args[0] : args;\n            if (!queries.length) {\n                var files = getFiles().filter(function(item) {\n                    return (\n                        !(item.status === ItemStatus.IDLE && item.origin === FileOrigin.LOCAL) &&\n                        item.status !== ItemStatus.PROCESSING &&\n                        item.status !== ItemStatus.PROCESSING_COMPLETE &&\n                        item.status !== ItemStatus.PROCESSING_REVERT_ERROR\n                    );\n                });\n\n                return Promise.all(files.map(processFile));\n            }\n            return Promise.all(queries.map(processFile));\n        };\n\n        var removeFiles = function removeFiles() {\n            for (\n                var _len4 = arguments.length, args = new Array(_len4), _key4 = 0;\n                _key4 < _len4;\n                _key4++\n            ) {\n                args[_key4] = arguments[_key4];\n            }\n\n            var queries = Array.isArray(args[0]) ? args[0] : args;\n\n            var options;\n            if (typeof queries[queries.length - 1] === 'object') {\n                options = queries.pop();\n            } else if (Array.isArray(args[0])) {\n                options = args[1];\n            }\n\n            var files = getFiles();\n\n            if (!queries.length)\n                return Promise.all(\n                    files.map(function(file) {\n                        return removeFile(file, options);\n                    })\n                );\n\n            // when removing by index the indexes shift after each file removal so we need to convert indexes to ids\n            var mappedQueries = queries\n                .map(function(query) {\n                    return isNumber(query) ? (files[query] ? files[query].id : null) : query;\n                })\n                .filter(function(query) {\n                    return query;\n                });\n\n            return mappedQueries.map(function(q) {\n                return removeFile(q, options);\n            });\n        };\n\n        var exports = Object.assign(\n            {},\n\n            on(),\n            {},\n\n            readWriteApi,\n            {},\n\n            createOptionAPI(store, defaultOptions),\n            {\n                /**\n                 * Override options defined in options object\n                 * @param options\n                 */\n                setOptions: setOptions,\n\n                /**\n                 * Load the given file\n                 * @param source - the source of the file (either a File, base64 data uri or url)\n                 * @param options - object, { index: 0 }\n                 */\n                addFile: addFile,\n\n                /**\n                 * Load the given files\n                 * @param sources - the sources of the files to load\n                 * @param options - object, { index: 0 }\n                 */\n                addFiles: addFiles,\n\n                /**\n                 * Returns the file objects matching the given query\n                 * @param query { string, number, null }\n                 */\n                getFile: getFile,\n\n                /**\n                 * Upload file with given name\n                 * @param query { string, number, null  }\n                 */\n                processFile: processFile,\n\n                /**\n                 * Request prepare output for file with given name\n                 * @param query { string, number, null  }\n                 */\n                prepareFile: prepareFile,\n\n                /**\n                 * Removes a file by its name\n                 * @param query { string, number, null  }\n                 */\n                removeFile: removeFile,\n\n                /**\n                 * Moves a file to a new location in the files list\n                 */\n                moveFile: function moveFile(query, index) {\n                    return store.dispatch('MOVE_ITEM', { query: query, index: index });\n                },\n\n                /**\n                 * Returns all files (wrapped in public api)\n                 */\n                getFiles: getFiles,\n\n                /**\n                 * Starts uploading all files\n                 */\n                processFiles: processFiles,\n\n                /**\n                 * Clears all files from the files list\n                 */\n                removeFiles: removeFiles,\n\n                /**\n                 * Starts preparing output of all files\n                 */\n                prepareFiles: prepareFiles,\n\n                /**\n                 * Sort list of files\n                 */\n                sort: function sort(compare) {\n                    return store.dispatch('SORT', { compare: compare });\n                },\n\n                /**\n                 * Browse the file system for a file\n                 */\n                browse: function browse() {\n                    // needs to be trigger directly as user action needs to be traceable (is not traceable in requestAnimationFrame)\n                    var input = view.element.querySelector('input[type=file]');\n                    if (input) {\n                        input.click();\n                    }\n                },\n\n                /**\n                 * Destroys the app\n                 */\n                destroy: function destroy() {\n                    // request destruction\n                    exports.fire('destroy', view.element);\n\n                    // stop active processes (file uploads, fetches, stuff like that)\n                    // loop over items and depending on states call abort for ongoing processes\n                    store.dispatch('ABORT_ALL');\n\n                    // destroy view\n                    view._destroy();\n\n                    // stop listening to resize\n                    window.removeEventListener('resize', resizeHandler);\n\n                    // stop listening to the visiblitychange event\n                    document.removeEventListener('visibilitychange', visibilityHandler);\n\n                    // dispatch destroy\n                    store.dispatch('DID_DESTROY');\n                },\n\n                /**\n                 * Inserts the plugin before the target element\n                 */\n                insertBefore: function insertBefore$1(element) {\n                    return insertBefore(view.element, element);\n                },\n\n                /**\n                 * Inserts the plugin after the target element\n                 */\n                insertAfter: function insertAfter$1(element) {\n                    return insertAfter(view.element, element);\n                },\n\n                /**\n                 * Appends the plugin to the target element\n                 */\n                appendTo: function appendTo(element) {\n                    return element.appendChild(view.element);\n                },\n\n                /**\n                 * Replaces an element with the app\n                 */\n                replaceElement: function replaceElement(element) {\n                    // insert the app before the element\n                    insertBefore(view.element, element);\n\n                    // remove the original element\n                    element.parentNode.removeChild(element);\n\n                    // remember original element\n                    originalElement = element;\n                },\n\n                /**\n                 * Restores the original element\n                 */\n                restoreElement: function restoreElement() {\n                    if (!originalElement) {\n                        return; // no element to restore\n                    }\n\n                    // restore original element\n                    insertAfter(originalElement, view.element);\n\n                    // remove our element\n                    view.element.parentNode.removeChild(view.element);\n\n                    // remove reference\n                    originalElement = null;\n                },\n\n                /**\n                 * Returns true if the app root is attached to given element\n                 * @param element\n                 */\n                isAttachedTo: function isAttachedTo(element) {\n                    return view.element === element || originalElement === element;\n                },\n\n                /**\n                 * Returns the root element\n                 */\n                element: {\n                    get: function get() {\n                        return view.element;\n                    },\n                },\n\n                /**\n                 * Returns the current pond status\n                 */\n                status: {\n                    get: function get() {\n                        return store.query('GET_STATUS');\n                    },\n                },\n            }\n        );\n\n        // Done!\n        store.dispatch('DID_INIT');\n\n        // create actual api object\n        return createObject(exports);\n    };\n\n    var createAppObject = function createAppObject() {\n        var customOptions = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n        // default options\n        var defaultOptions = {};\n        forin(getOptions(), function(key, value) {\n            defaultOptions[key] = value[0];\n        });\n\n        // set app options\n        var app = createApp(\n            Object.assign(\n                {},\n\n                defaultOptions,\n                {},\n\n                customOptions\n            )\n        );\n\n        // return the plugin instance\n        return app;\n    };\n\n    var lowerCaseFirstLetter = function lowerCaseFirstLetter(string) {\n        return string.charAt(0).toLowerCase() + string.slice(1);\n    };\n\n    var attributeNameToPropertyName = function attributeNameToPropertyName(attributeName) {\n        return toCamels(attributeName.replace(/^data-/, ''));\n    };\n\n    var mapObject = function mapObject(object, propertyMap) {\n        // remove unwanted\n        forin(propertyMap, function(selector, mapping) {\n            forin(object, function(property, value) {\n                // create regexp shortcut\n                var selectorRegExp = new RegExp(selector);\n\n                // tests if\n                var matches = selectorRegExp.test(property);\n\n                // no match, skip\n                if (!matches) {\n                    return;\n                }\n\n                // if there's a mapping, the original property is always removed\n                delete object[property];\n\n                // should only remove, we done!\n                if (mapping === false) {\n                    return;\n                }\n\n                // move value to new property\n                if (isString(mapping)) {\n                    object[mapping] = value;\n                    return;\n                }\n\n                // move to group\n                var group = mapping.group;\n                if (isObject(mapping) && !object[group]) {\n                    object[group] = {};\n                }\n\n                object[group][lowerCaseFirstLetter(property.replace(selectorRegExp, ''))] = value;\n            });\n\n            // do submapping\n            if (mapping.mapping) {\n                mapObject(object[mapping.group], mapping.mapping);\n            }\n        });\n    };\n\n    var getAttributesAsObject = function getAttributesAsObject(node) {\n        var attributeMapping =\n            arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n        // turn attributes into object\n        var attributes = [];\n        forin(node.attributes, function(index) {\n            attributes.push(node.attributes[index]);\n        });\n\n        var output = attributes\n            .filter(function(attribute) {\n                return attribute.name;\n            })\n            .reduce(function(obj, attribute) {\n                var value = attr(node, attribute.name);\n\n                obj[attributeNameToPropertyName(attribute.name)] =\n                    value === attribute.name ? true : value;\n                return obj;\n            }, {});\n\n        // do mapping of object properties\n        mapObject(output, attributeMapping);\n\n        return output;\n    };\n\n    var createAppAtElement = function createAppAtElement(element) {\n        var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n        // how attributes of the input element are mapped to the options for the plugin\n        var attributeMapping = {\n            // translate to other name\n            '^class$': 'className',\n            '^multiple$': 'allowMultiple',\n            '^capture$': 'captureMethod',\n            '^webkitdirectory$': 'allowDirectoriesOnly',\n\n            // group under single property\n            '^server': {\n                group: 'server',\n                mapping: {\n                    '^process': {\n                        group: 'process',\n                    },\n\n                    '^revert': {\n                        group: 'revert',\n                    },\n\n                    '^fetch': {\n                        group: 'fetch',\n                    },\n\n                    '^restore': {\n                        group: 'restore',\n                    },\n\n                    '^load': {\n                        group: 'load',\n                    },\n                },\n            },\n\n            // don't include in object\n            '^type$': false,\n            '^files$': false,\n        };\n\n        // add additional option translators\n        applyFilters('SET_ATTRIBUTE_TO_OPTION_MAP', attributeMapping);\n\n        // create final options object by setting options object and then overriding options supplied on element\n        var mergedOptions = Object.assign({}, options);\n\n        var attributeOptions = getAttributesAsObject(\n            element.nodeName === 'FIELDSET' ? element.querySelector('input[type=file]') : element,\n            attributeMapping\n        );\n\n        // merge with options object\n        Object.keys(attributeOptions).forEach(function(key) {\n            if (isObject(attributeOptions[key])) {\n                if (!isObject(mergedOptions[key])) {\n                    mergedOptions[key] = {};\n                }\n                Object.assign(mergedOptions[key], attributeOptions[key]);\n            } else {\n                mergedOptions[key] = attributeOptions[key];\n            }\n        });\n\n        // if parent is a fieldset, get files from parent by selecting all input fields that are not file upload fields\n        // these will then be automatically set to the initial files\n        mergedOptions.files = (options.files || []).concat(\n            Array.from(element.querySelectorAll('input:not([type=file])')).map(function(input) {\n                return {\n                    source: input.value,\n                    options: {\n                        type: input.dataset.type,\n                    },\n                };\n            })\n        );\n\n        // build plugin\n        var app = createAppObject(mergedOptions);\n\n        // add already selected files\n        if (element.files) {\n            Array.from(element.files).forEach(function(file) {\n                app.addFile(file);\n            });\n        }\n\n        // replace the target element\n        app.replaceElement(element);\n\n        // expose\n        return app;\n    };\n\n    // if an element is passed, we create the instance at that element, if not, we just create an up object\n    var createApp$1 = function createApp() {\n        return isNode(arguments.length <= 0 ? undefined : arguments[0])\n            ? createAppAtElement.apply(void 0, arguments)\n            : createAppObject.apply(void 0, arguments);\n    };\n\n    var PRIVATE_METHODS = ['fire', '_read', '_write'];\n\n    var createAppAPI = function createAppAPI(app) {\n        var api = {};\n\n        copyObjectPropertiesToObject(app, api, PRIVATE_METHODS);\n\n        return api;\n    };\n\n    /**\n     * Replaces placeholders in given string with replacements\n     * @param string - \"Foo {bar}\"\"\n     * @param replacements - { \"bar\": 10 }\n     */\n    var replaceInString = function replaceInString(string, replacements) {\n        return string.replace(/(?:{([a-zA-Z]+)})/g, function(match, group) {\n            return replacements[group];\n        });\n    };\n\n    var createWorker = function createWorker(fn) {\n        var workerBlob = new Blob(['(', fn.toString(), ')()'], {\n            type: 'application/javascript',\n        });\n\n        var workerURL = URL.createObjectURL(workerBlob);\n        var worker = new Worker(workerURL);\n\n        return {\n            transfer: function transfer(message, cb) {},\n            post: function post(message, cb, transferList) {\n                var id = getUniqueId();\n\n                worker.onmessage = function(e) {\n                    if (e.data.id === id) {\n                        cb(e.data.message);\n                    }\n                };\n\n                worker.postMessage(\n                    {\n                        id: id,\n                        message: message,\n                    },\n\n                    transferList\n                );\n            },\n            terminate: function terminate() {\n                worker.terminate();\n                URL.revokeObjectURL(workerURL);\n            },\n        };\n    };\n\n    var loadImage = function loadImage(url) {\n        return new Promise(function(resolve, reject) {\n            var img = new Image();\n            img.onload = function() {\n                resolve(img);\n            };\n            img.onerror = function(e) {\n                reject(e);\n            };\n            img.src = url;\n        });\n    };\n\n    var renameFile = function renameFile(file, name) {\n        var renamedFile = file.slice(0, file.size, file.type);\n        renamedFile.lastModifiedDate = file.lastModifiedDate;\n        renamedFile.name = name;\n        return renamedFile;\n    };\n\n    var copyFile = function copyFile(file) {\n        return renameFile(file, file.name);\n    };\n\n    // already registered plugins (can't register twice)\n    var registeredPlugins = [];\n\n    // pass utils to plugin\n    var createAppPlugin = function createAppPlugin(plugin) {\n        // already registered\n        if (registeredPlugins.includes(plugin)) {\n            return;\n        }\n\n        // remember this plugin\n        registeredPlugins.push(plugin);\n\n        // setup!\n        var pluginOutline = plugin({\n            addFilter: addFilter,\n            utils: {\n                Type: Type,\n                forin: forin,\n                isString: isString,\n                isFile: isFile,\n                toNaturalFileSize: toNaturalFileSize,\n                replaceInString: replaceInString,\n                getExtensionFromFilename: getExtensionFromFilename,\n                getFilenameWithoutExtension: getFilenameWithoutExtension,\n                guesstimateMimeType: guesstimateMimeType,\n                getFileFromBlob: getFileFromBlob,\n                getFilenameFromURL: getFilenameFromURL,\n                createRoute: createRoute,\n                createWorker: createWorker,\n                createView: createView,\n                createItemAPI: createItemAPI,\n                loadImage: loadImage,\n                copyFile: copyFile,\n                renameFile: renameFile,\n                createBlob: createBlob,\n                applyFilterChain: applyFilterChain,\n                text: text,\n                getNumericAspectRatioFromString: getNumericAspectRatioFromString,\n            },\n\n            views: {\n                fileActionButton: fileActionButton,\n            },\n        });\n\n        // add plugin options to default options\n        extendDefaultOptions(pluginOutline.options);\n    };\n\n    // feature detection used by supported() method\n    var isOperaMini = function isOperaMini() {\n        return Object.prototype.toString.call(window.operamini) === '[object OperaMini]';\n    };\n    var hasPromises = function hasPromises() {\n        return 'Promise' in window;\n    };\n    var hasBlobSlice = function hasBlobSlice() {\n        return 'slice' in Blob.prototype;\n    };\n    var hasCreateObjectURL = function hasCreateObjectURL() {\n        return 'URL' in window && 'createObjectURL' in window.URL;\n    };\n    var hasVisibility = function hasVisibility() {\n        return 'visibilityState' in document;\n    };\n    var hasTiming = function hasTiming() {\n        return 'performance' in window;\n    }; // iOS 8.x\n    var hasCSSSupports = function hasCSSSupports() {\n        return 'supports' in (window.CSS || {});\n    }; // use to detect Safari 9+\n    var isIE11 = function isIE11() {\n        return /MSIE|Trident/.test(window.navigator.userAgent);\n    };\n\n    var supported = (function() {\n        // Runs immediately and then remembers result for subsequent calls\n        var isSupported =\n            // Has to be a browser\n            isBrowser() &&\n            // Can't run on Opera Mini due to lack of everything\n            !isOperaMini() &&\n            // Require these APIs to feature detect a modern browser\n            hasVisibility() &&\n            hasPromises() &&\n            hasBlobSlice() &&\n            hasCreateObjectURL() &&\n            hasTiming() &&\n            // doesn't need CSSSupports but is a good way to detect Safari 9+ (we do want to support IE11 though)\n            (hasCSSSupports() || isIE11());\n\n        return function() {\n            return isSupported;\n        };\n    })();\n\n    /**\n     * Plugin internal state (over all instances)\n     */\n    var state = {\n        // active app instances, used to redraw the apps and to find the later\n        apps: [],\n    };\n\n    // plugin name\n    var name = 'filepond';\n\n    /**\n     * Public Plugin methods\n     */\n    var fn = function fn() {};\n    exports.Status = {};\n    exports.FileStatus = {};\n    exports.FileOrigin = {};\n    exports.OptionTypes = {};\n    exports.create = fn;\n    exports.destroy = fn;\n    exports.parse = fn;\n    exports.find = fn;\n    exports.registerPlugin = fn;\n    exports.getOptions = fn;\n    exports.setOptions = fn;\n\n    // if not supported, no API\n    if (supported()) {\n        // start painter and fire load event\n        createPainter(\n            function() {\n                state.apps.forEach(function(app) {\n                    return app._read();\n                });\n            },\n            function(ts) {\n                state.apps.forEach(function(app) {\n                    return app._write(ts);\n                });\n            }\n        );\n\n        // fire loaded event so we know when FilePond is available\n        var dispatch = function dispatch() {\n            // let others know we have area ready\n            document.dispatchEvent(\n                new CustomEvent('FilePond:loaded', {\n                    detail: {\n                        supported: supported,\n                        create: exports.create,\n                        destroy: exports.destroy,\n                        parse: exports.parse,\n                        find: exports.find,\n                        registerPlugin: exports.registerPlugin,\n                        setOptions: exports.setOptions,\n                    },\n                })\n            );\n\n            // clean up event\n            document.removeEventListener('DOMContentLoaded', dispatch);\n        };\n\n        if (document.readyState !== 'loading') {\n            // move to back of execution queue, FilePond should have been exported by then\n            setTimeout(function() {\n                return dispatch();\n            }, 0);\n        } else {\n            document.addEventListener('DOMContentLoaded', dispatch);\n        }\n\n        // updates the OptionTypes object based on the current options\n        var updateOptionTypes = function updateOptionTypes() {\n            return forin(getOptions(), function(key, value) {\n                exports.OptionTypes[key] = value[1];\n            });\n        };\n\n        exports.Status = Object.assign({}, Status);\n        exports.FileOrigin = Object.assign({}, FileOrigin);\n        exports.FileStatus = Object.assign({}, ItemStatus);\n\n        exports.OptionTypes = {};\n        updateOptionTypes();\n\n        // create method, creates apps and adds them to the app array\n        exports.create = function create() {\n            var app = createApp$1.apply(void 0, arguments);\n            app.on('destroy', exports.destroy);\n            state.apps.push(app);\n            return createAppAPI(app);\n        };\n\n        // destroys apps and removes them from the app array\n        exports.destroy = function destroy(hook) {\n            // returns true if the app was destroyed successfully\n            var indexToRemove = state.apps.findIndex(function(app) {\n                return app.isAttachedTo(hook);\n            });\n            if (indexToRemove >= 0) {\n                // remove from apps\n                var app = state.apps.splice(indexToRemove, 1)[0];\n\n                // restore original dom element\n                app.restoreElement();\n\n                return true;\n            }\n\n            return false;\n        };\n\n        // parses the given context for plugins (does not include the context element itself)\n        exports.parse = function parse(context) {\n            // get all possible hooks\n            var matchedHooks = Array.from(context.querySelectorAll('.' + name));\n\n            // filter out already active hooks\n            var newHooks = matchedHooks.filter(function(newHook) {\n                return !state.apps.find(function(app) {\n                    return app.isAttachedTo(newHook);\n                });\n            });\n\n            // create new instance for each hook\n            return newHooks.map(function(hook) {\n                return exports.create(hook);\n            });\n        };\n\n        // returns an app based on the given element hook\n        exports.find = function find(hook) {\n            var app = state.apps.find(function(app) {\n                return app.isAttachedTo(hook);\n            });\n            if (!app) {\n                return null;\n            }\n            return createAppAPI(app);\n        };\n\n        // adds a plugin extension\n        exports.registerPlugin = function registerPlugin() {\n            for (\n                var _len = arguments.length, plugins = new Array(_len), _key = 0;\n                _key < _len;\n                _key++\n            ) {\n                plugins[_key] = arguments[_key];\n            }\n\n            // register plugins\n            plugins.forEach(createAppPlugin);\n\n            // update OptionTypes, each plugin might have extended the default options\n            updateOptionTypes();\n        };\n\n        exports.getOptions = function getOptions$1() {\n            var opts = {};\n            forin(getOptions(), function(key, value) {\n                opts[key] = value[0];\n            });\n            return opts;\n        };\n\n        exports.setOptions = function setOptions$1(opts) {\n            if (isObject(opts)) {\n                // update existing plugins\n                state.apps.forEach(function(app) {\n                    app.setOptions(opts);\n                });\n\n                // override defaults\n                setOptions(opts);\n            }\n\n            // return new options\n            return exports.getOptions();\n        };\n    }\n\n    exports.supported = supported;\n\n    Object.defineProperty(exports, '__esModule', { value: true });\n});\n"]},"metadata":{},"sourceType":"script"}